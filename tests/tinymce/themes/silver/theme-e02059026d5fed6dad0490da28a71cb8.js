(function(){"use strict"
var t=function(t){return function(n){return function(t){var n=typeof t
return null===t?"null":"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(n)===t}},n=function(t){return function(n){return typeof n===t}},e=function(t){return function(n){return t===n}},o=t("string"),r=t("object"),i=t("array"),u=e(null),a=n("boolean"),c=e(void 0),s=function(t){return null==t},f=function(t){return!s(t)},l=n("function"),d=n("number"),m=function(t,n){if(i(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1
return!0}return!1},g=function(){},p=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
return t(n.apply(null,e))}},h=function(t){return function(){return t}},v=function(t){return t},b=function(t,n){return t===n}
function y(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e]
return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
var r=n.concat(e)
return t.apply(null,r)}}var x=function(t){return function(n){return!t(n)}},w=function(t){return function(){throw new Error(t)}},S=h(!1),k=h(!0),C=tinymce.util.Tools.resolve("tinymce.ThemeManager"),O=function(){return(O=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])
return t}).apply(this,arguments)}
function _(t,n){var e={}
for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o])
if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0
for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function T(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r])
return t.concat(o||Array.prototype.slice.call(n))}var D,E,B=function(){return M},M={fold:function(t,n){return t()},isSome:S,isNone:k,getOr:E=v,getOrThunk:D=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:h(null),getOrUndefined:h(void 0),or:E,orThunk:D,map:B,each:g,bind:B,exists:S,forall:k,filter:function(){return B()},toArray:function(){return[]},toString:h("none()")},A=function(t){var n=h(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},isSome:k,isNone:S,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return A(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:M},toArray:function(){return[t]},toString:function(){return"some("+t+")"}}
return r},F={some:A,none:B,from:function(t){return null==t?M:A(t)}},I=Array.prototype.slice,R=Array.prototype.indexOf,V=Array.prototype.push,P=function(t,n){return R.call(t,n)},H=function(t,n){return P(t,n)>-1},z=function(t,n){for(var e=0,o=t.length;e<o;e++){if(n(t[e],e))return!0}return!1},N=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o))
return e},L=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=I.call(t,o,o+n)
e.push(r)}return e},W=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r]
o[r]=n(i,r)}return o},U=function(t,n){for(var e=0,o=t.length;e<o;e++){n(t[e],e)}},j=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},G=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o]
n(i,o)&&e.push(i)}return e},X=function(t,n,e){return function(t,n){for(var e=t.length-1;e>=0;e--)n(t[e],e)}(t,(function(t,o){e=n(e,t,o)})),e},q=function(t,n,e){return U(t,(function(t,o){e=n(e,t,o)})),e},Y=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o]
if(n(i,o))return F.some(i)
if(e(i,o))break}return F.none()}(t,n,S)},K=function(t,n){for(var e=0,o=t.length;e<o;e++){if(n(t[e],e))return F.some(e)}return F.none()},J=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!i(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t)
V.apply(n,t[e])}return n},$=function(t,n){return J(W(t,n))},Q=function(t,n){for(var e=0,o=t.length;e<o;++e){if(!0!==n(t[e],e))return!1}return!0},Z=function(t){var n=I.call(t,0)
return n.reverse(),n},tt=function(t,n){return G(t,(function(t){return!H(n,t)}))},nt=function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o]
e[String(i)]=n(i,o)}return e},et=function(t){return[t]},ot=function(t,n){var e=I.call(t,0)
return e.sort(n),e},rt=function(t,n){return n>=0&&n<t.length?F.some(t[n]):F.none()},it=function(t){return rt(t,0)},ut=function(t){return rt(t,t.length-1)},at=l(Array.from)?Array.from:function(t){return I.call(t)},ct=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e)
if(o.isSome())return o}return F.none()},st=Object.keys,ft=Object.hasOwnProperty,lt=function(t,n){for(var e=st(t),o=0,r=e.length;o<r;o++){var i=e[o]
n(t[i],i)}},dt=function(t,n){return mt(t,(function(t,e){return{k:e,v:n(t,e)}}))},mt=function(t,n){var e={}
return lt(t,(function(t,o){var r=n(t,o)
e[r.k]=r.v})),e},gt=function(t,n){var e={}
return function(t,n,e,o){lt(t,(function(t,r){(n(t,r)?e:o)(t,r)}))}(t,n,function(t){return function(n,e){t[e]=n}}(e),g),e},pt=function(t,n){var e=[]
return lt(t,(function(t,o){e.push(n(t,o))})),e},ht=function(t,n){for(var e=st(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i]
if(n(u,i,t))return F.some(u)}return F.none()},vt=function(t){return pt(t,v)},bt=function(t,n){return yt(t,n)?F.from(t[n]):F.none()},yt=function(t,n){return ft.call(t,n)},xt=function(t,n){return yt(t,n)&&void 0!==t[n]&&null!==t[n]},wt=function(t,n,e){return void 0===e&&(e=b),t.exists((function(t){return e(t,n)}))},St=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e)
return n},kt=function(t,n,e){return t.isSome()&&n.isSome()?F.some(e(t.getOrDie(),n.getOrDie())):F.none()},Ct=function(t,n){return t?F.some(n):F.none()},Ot=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},_t=function(t,n){return-1!==t.indexOf(n)},Tt=function(t,n){return Ot(t,n,0)},Dt=function(t,n){return Ot(t,n,t.length-n.length)},Et=function(t){return function(n){return n.replace(t,"")}}(/^\s+|\s+$/g),Bt=function(t){return t.length>0},Mt=function(t){return void 0!==t.style&&l(t.style.getPropertyValue)},At=function(t){if(null==t)throw new Error("Node cannot be null or undefined")
return{dom:t}},Ft={fromHtml:function(t,n){var e=(n||document).createElement("div")
if(e.innerHTML=t,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node")
return At(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t)
return At(e)},fromText:function(t,n){var e=(n||document).createTextNode(t)
return At(e)},fromDom:At,fromPoint:function(t,n,e){return F.from(t.dom.elementFromPoint(n,e)).map(At)}}
"undefined"!=typeof window?window:Function("return this;")()
var It,Rt=function(t){return t.dom.nodeName.toLowerCase()},Vt=function(t){return function(n){return function(t){return t.dom.nodeType}(n)===t}},Pt=Vt(1),Ht=Vt(3),zt=Vt(9),Nt=Vt(11),Lt=function(t){var n,e=!1
return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
return e||(e=!0,n=t.apply(null,o)),n}},Wt=function(){return Ut(0,0)},Ut=function(t,n){return{major:t,minor:n}},jt={nu:Ut,detect:function(t,n){var e=String(n).toLowerCase()
return 0===t.length?Wt():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e]
if(o.test(n))return o}}(t,n)
if(!e)return{major:0,minor:0}
var o=function(t){return Number(n.replace(e,"$"+t))}
return Ut(o(1),o(2))}(t,e)},unknown:Wt},Gt=function(t,n){var e=String(n).toLowerCase()
return Y(t,(function(t){return t.search(e)}))},Xt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,qt=function(t){return function(n){return _t(n,t)}},Yt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return _t(t,"edge/")&&_t(t,"chrome")&&_t(t,"safari")&&_t(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Xt],search:function(t){return _t(t,"chrome")&&!_t(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return _t(t,"msie")||_t(t,"trident")}},{name:"Opera",versionRegexes:[Xt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:qt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:qt("firefox")},{name:"Safari",versionRegexes:[Xt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(_t(t,"safari")||_t(t,"mobile/"))&&_t(t,"applewebkit")}}],Kt=[{name:"Windows",search:qt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return _t(t,"iphone")||_t(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:qt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:qt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:qt("linux"),versionRegexes:[]},{name:"Solaris",search:qt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:qt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:qt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Jt={browsers:h(Yt),oses:h(Kt)},$t="Edge",Qt="Chrome",Zt="Opera",tn="Firefox",nn="Safari",en=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}}
return{current:n,version:e,isEdge:o($t),isChrome:o(Qt),isIE:o("IE"),isOpera:o(Zt),isFirefox:o(tn),isSafari:o(nn)}},on={unknown:function(){return en({current:void 0,version:jt.unknown()})},nu:en,edge:h($t),chrome:h(Qt),ie:h("IE"),opera:h(Zt),firefox:h(tn),safari:h(nn)},rn="Windows",un="Android",an="Linux",cn="Solaris",sn="FreeBSD",fn="ChromeOS",ln=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}}
return{current:n,version:e,isWindows:o(rn),isiOS:o("iOS"),isAndroid:o(un),isOSX:o("OSX"),isLinux:o(an),isSolaris:o(cn),isFreeBSD:o(sn),isChromeOS:o(fn)}},dn={unknown:function(){return ln({current:void 0,version:jt.unknown()})},nu:ln,windows:h(rn),ios:h("iOS"),android:h(un),linux:h(an),osx:h("OSX"),solaris:h(cn),freebsd:h(sn),chromeos:h(fn)},mn=function(t,n,e){var o=Jt.browsers(),r=Jt.oses(),i=n.bind((function(t){return function(t,n){return ct(n.brands,(function(n){var e=n.brand.toLowerCase()
return Y(t,(function(t){var n
return e===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(t){return{current:t.name,version:jt.nu(parseInt(n.version,10),0)}}))}))}(o,t)})).orThunk((function(){return function(t,n){return Gt(t,n).map((function(t){var e=jt.detect(t.versionRegexes,n)
return{current:t.name,version:e}}))}(o,t)})).fold(on.unknown,on.nu),u=function(t,n){return Gt(t,n).map((function(t){var e=jt.detect(t.versionRegexes,n)
return{current:t.name,version:e}}))}(r,t).fold(dn.unknown,dn.nu),a=function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f
return{isiPad:h(r),isiPhone:h(i),isTablet:h(c),isPhone:h(s),isTouch:h(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:h(f),isDesktop:h(l)}}(u,i,t,e)
return{browser:i,os:u,deviceType:a}},gn=function(t){return window.matchMedia(t).matches},pn=Lt((function(){return mn(navigator.userAgent,F.from(navigator.userAgentData),gn)})),hn=function(){return pn()},vn=function(t,n){var e=t.dom
if(1!==e.nodeType)return!1
var o=e
if(void 0!==o.matches)return o.matches(n)
if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n)
if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n)
if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n)
throw new Error("Browser lacks native selectors")},bn=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},yn=function(t,n){return t.dom===n.dom},xn=function(t,n){return function(t,n){return function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)}(t,n,Node.DOCUMENT_POSITION_CONTAINED_BY)}(t.dom,n.dom)},wn=function(t,n){return hn().browser.isIE()?xn(t,n):function(t,n){var e=t.dom,o=n.dom
return e!==o&&e.contains(o)}(t,n)},Sn=function(t){return Ft.fromDom(t.dom.ownerDocument)},kn=function(t){return zt(t)?t:Sn(t)},Cn=function(t){return Ft.fromDom(kn(t).dom.documentElement)},On=function(t){return Ft.fromDom(kn(t).dom.defaultView)},_n=function(t){return F.from(t.dom.parentNode).map(Ft.fromDom)},Tn=function(t){return F.from(t.dom.offsetParent).map(Ft.fromDom)},Dn=function(t){return W(t.dom.childNodes,Ft.fromDom)},En=function(t,n){var e=t.dom.childNodes
return F.from(e[n]).map(Ft.fromDom)},Bn=function(t,n){return{element:t,offset:n}},Mn=function(t,n){var e=Dn(t)
return e.length>0&&n<e.length?Bn(e[n],0):Bn(t,n)},An=function(t){return Nt(t)&&f(t.dom.host)},Fn=l(Element.prototype.attachShadow)&&l(Node.prototype.getRootNode),In=h(Fn),Rn=Fn?function(t){return Ft.fromDom(t.dom.getRootNode())}:kn,Vn=function(t){return An(t)?t:Ft.fromDom(kn(t).dom.body)},Pn=function(t){var n=Rn(t)
return An(n)?F.some(n):F.none()},Hn=function(t){return Ft.fromDom(t.dom.host)},zn=function(t){return f(t.dom.shadowRoot)},Nn=function(t){var n=Ht(t)?t.dom.parentNode:t.dom
if(null==n||null===n.ownerDocument)return!1
var e,o,r=n.ownerDocument
return Pn(Ft.fromDom(n)).fold((function(){return r.body.contains(n)}),(e=Nn,o=Hn,function(t){return e(o(t))}))},Ln=function(){return Wn(Ft.fromDom(document))},Wn=function(t){var n=t.dom.body
if(null==n)throw new Error("Body is not available yet")
return Ft.fromDom(n)},Un=function(t,n,e){if(!(o(e)||a(e)||d(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple")
t.setAttribute(n,e+"")},jn=function(t,n,e){Un(t.dom,n,e)},Gn=function(t,n){var e=t.dom.getAttribute(n)
return null===e?void 0:e},Xn=function(t,n){return F.from(Gn(t,n))},qn=function(t,n){var e=t.dom
return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Yn=function(t,n){t.dom.removeAttribute(n)},Kn=function(t,n,e){if(!o(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e)
Mt(t)&&t.style.setProperty(n,e)},Jn=function(t,n){Mt(t)&&t.style.removeProperty(n)},$n=function(t,n,e){var o=t.dom
Kn(o,n,e)},Qn=function(t,n){var e=t.dom
lt(n,(function(t,n){Kn(e,n,t)}))},Zn=function(t,n){var e=t.dom
lt(n,(function(t,n){t.fold((function(){Jn(e,n)}),(function(t){Kn(e,n,t)}))}))},te=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n)
return""!==o||Nn(t)?o:ne(e,n)},ne=function(t,n){return Mt(t)?t.style.getPropertyValue(n):""},ee=function(t,n){var e=t.dom,o=ne(e,n)
return F.from(o).filter((function(t){return t.length>0}))},oe=function(t){var n={},e=t.dom
if(Mt(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o)
n[r]=e.style[r]}return n},re=function(t,n,e){var o=Ft.fromTag(t)
return $n(o,n,e),ee(o,n).isSome()},ie=function(t,n){var e=t.dom
Jn(e,n),wt(Xn(t,"style").map(Et),"")&&Yn(t,"style")},ue=function(t){return t.dom.offsetWidth},ae=function(t,n){var e=function(e){var o=n(e)
if(o<=0||null===o){var r=te(e,t)
return parseFloat(r)||0}return o},o=function(t,n){return q(n,(function(n,e){var o=te(t,e),r=void 0===o?0:parseInt(o,10)
return isNaN(r)?n:n+r}),0)}
return{set:function(n,e){if(!d(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e)
var o=n.dom
Mt(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e)
return n>r?n-r:0}}},ce=ae("height",(function(t){var n=t.dom
return Nn(t)?n.getBoundingClientRect().height:n.offsetHeight})),se=function(t){return ce.get(t)},fe=function(t){return ce.getOuter(t)},le=function(t,n){return{left:t,top:n,translate:function(e,o){return le(t+e,n+o)}}},de=le,me=function(t,n){return void 0!==t?t:void 0!==n?n:0},ge=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement
if(e===t.dom)return de(e.offsetLeft,e.offsetTop)
var i=me(null==o?void 0:o.pageYOffset,r.scrollTop),u=me(null==o?void 0:o.pageXOffset,r.scrollLeft),a=me(r.clientTop,e.clientTop),c=me(r.clientLeft,e.clientLeft)
return pe(t).translate(u-c,i-a)},pe=function(t){var n=t.dom,e=n.ownerDocument.body
return e===n?de(e.offsetLeft,e.offsetTop):Nn(t)?function(t){var n=t.getBoundingClientRect()
return de(n.left,n.top)}(n):de(0,0)},he=ae("width",(function(t){return t.dom.offsetWidth})),ve=function(t){return he.get(t)},be=function(t){return he.getOuter(t)},ye=function(t){var n=Ft.fromDom(function(t){if(In()&&f(t.target)){var n=Ft.fromDom(t.target)
if(Pt(n)&&zn(n)&&t.composed&&t.composedPath){var e=t.composedPath()
if(e)return it(e)}}return F.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=p(o,e)
return function(t,n,e,o,r,i,u){return{target:t,x:n,y:e,stop:o,prevent:r,kill:i,raw:u}}(n,t.clientX,t.clientY,e,o,r,t)},xe=function(t,n,e,o,r){var i=function(t,n){return function(e){t(e)&&n(ye(e))}}(e,o)
return t.dom.addEventListener(n,i,r),{unbind:y(we,t,n,i,r)}},we=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},Se=function(t,n){_n(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},ke=function(t,n){(function(t){return F.from(t.dom.nextSibling).map(Ft.fromDom)})(t).fold((function(){_n(t).each((function(t){Oe(t,n)}))}),(function(t){Se(t,n)}))},Ce=function(t,n){(function(t){return En(t,0)})(t).fold((function(){Oe(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},Oe=function(t,n){t.dom.appendChild(n.dom)},_e=function(t,n){U(n,(function(n){Oe(t,n)}))},Te=function(t){t.dom.textContent="",U(Dn(t),(function(t){De(t)}))},De=function(t){var n=t.dom
null!==n.parentNode&&n.parentNode.removeChild(n)},Ee=function(t){var n,e=Dn(t)
e.length>0&&(n=t,U(e,(function(t){Se(n,t)}))),De(t)},Be=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop
return de(e,o)},Me=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView
o&&o.scrollTo(t,n)},Ae=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Fe=function(t){var n=void 0===t?window:t,e=n.document,o=Be(Ft.fromDom(e))
return function(t){var n=void 0===t?window:t
return hn().browser.isFirefox()?F.none():F.from(n.visualViewport)}(n).fold((function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight
return Ae(o.left,o.top,e,r)}),(function(t){return Ae(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)}))},Ie=function(t,n){return t.view(n).fold(h([]),(function(n){var e=t.owner(n),o=Ie(t,e)
return[n].concat(o)}))},Re=Object.freeze({__proto__:null,view:function(t){var n
return(t.dom===document?F.none():F.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(Ft.fromDom)},owner:function(t){return Sn(t)}}),Ve=function(t){var n=Ft.fromDom(document),e=Be(n)
return function(t,n){var e=n.owner(t),o=Ie(n,e)
return F.some(o)}(t,Re).fold(y(ge,t),(function(n){var o=pe(t),r=X(n,(function(t,n){var e=pe(n)
return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0})
return de(r.left+o.left+e.left,r.top+o.top+e.top)}))},Pe=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},He=function(t){var n=ge(t),e=be(t),o=fe(t)
return Pe(n.left,n.top,e,o)},ze=function(t){var n=Ve(t),e=be(t),o=fe(t)
return Pe(n.left,n.top,e,o)},Ne=function(){return Fe(window)},Le=function(t){return{isValue:k,isError:S,getOr:h(t),getOrThunk:h(t),getOrDie:h(t),or:function(n){return Le(t)},orThunk:function(n){return Le(t)},fold:function(n,e){return e(t)},map:function(n){return Le(n(t))},mapError:function(n){return Le(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return F.some(t)}}},We=function(t){return{isValue:S,isError:k,getOr:v,getOrThunk:function(t){return t()},getOrDie:function(){return w(String(t))()},or:v,orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return We(t)},mapError:function(n){return We(n(t))},each:g,bind:function(n){return We(t)},exists:S,forall:k,toOptional:F.none}},Ue={value:Le,error:We,fromOption:function(t,n){return t.fold((function(){return We(n)}),Le)}};(function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"})(It||(It={}))
var je=function(t,n,e){return t.stype===It.Error?n(t.serror):e(t.svalue)},Ge=function(t){return{stype:It.Value,svalue:t}},Xe=function(t){return{stype:It.Error,serror:t}},qe=function(t){return t.fold(Xe,Ge)},Ye=function(t){return je(t,Ue.error,Ue.value)},Ke=Ge,Je=function(t){var n=[],e=[]
return U(t,(function(t){je(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},$e=Xe,Qe=function(t,n){return t.stype===It.Value?n(t.svalue):t},Ze=function(t,n){return t.stype===It.Error?n(t.serror):t},to=function(t,n){return t.stype===It.Value?{stype:It.Value,svalue:n(t.svalue)}:t},no=function(t,n){return t.stype===It.Error?{stype:It.Error,serror:n(t.serror)}:t},eo=je,oo=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},ro=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop)
case"custom":return e(t.newKey,t.instantiator)}},io=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e]
if(0===n.length)throw new Error("Can't merge zero objects")
for(var o={},r=0;r<n.length;r++){var i=n[r]
for(var u in i)yt(i,u)&&(o[u]=t(o[u],i[u]))}return o}},uo=io((function(t,n){return r(t)&&r(n)?uo(t,n):n})),ao=io((function(t,n){return n})),co=function(t){return{tag:"defaultedThunk",process:t}},so=function(t){return co(h(t))},fo=function(t){return{tag:"mergeWithThunk",process:t}},lo=function(t){return p($e,J)(t)},mo=function(t){var n=Je(t)
return n.errors.length>0?lo(n.errors):Ke(n.values)},go=function(t){return r(t)&&st(t).length>100?" removed due to size":JSON.stringify(t,null,2)},po=function(t,n){return $e([{path:t,getErrorInfo:n}])},ho=function(t){return{extract:function(n,e){return Ze(t(e),(function(t){return function(t,n){return po(t,h(n))}(n,t)}))},toString:h("val")}},vo=ho(Ke),bo=function(t,n,e,o){return bt(n,e).fold((function(){return function(t,n,e){return po(t,(function(){return'Could not find valid *required* value for "'+n+'" in '+go(e)}))}(t,e,n)}),o)},yo=function(t,n,e,o){return o(bt(t,n).getOrThunk((function(){return e(t)})))},xo=function(t,n,e,o,r){var i=function(t){return r.extract(n.concat([o]),t)},u=function(t){return t.fold((function(){return Ke(F.none())}),(function(t){var e=r.extract(n.concat([o]),t)
return to(e,F.some)}))}
switch(t.tag){case"required":return bo(n,e,o,i)
case"defaultedThunk":return yo(e,o,t.process,i)
case"option":return function(t,n,e){return e(bt(t,n))}(e,o,u)
case"defaultedOptionThunk":return function(t,n,e,o){return o(bt(t,n).map((function(n){return!0===n?e(t):n})))}(e,o,t.process,u)
case"mergeWithThunk":return yo(e,o,h({}),(function(n){var o=uo(t.process(e),n)
return i(o)}))}},wo=function(t){return{extract:function(n,e){return t().extract(n,e)},toString:function(){return t().toString()}}},So=function(t){return st(gt(t,f))},ko=function(t){var n=Co(t),e=X(t,(function(t,n){return ro(n,(function(n){var e
return uo(t,((e={})[n]=!0,e))}),h(t))}),{})
return{extract:function(t,o){var r=a(o)?[]:So(o),i=G(r,(function(t){return!xt(e,t)}))
return 0===i.length?n.extract(t,o):function(t,n){return po(t,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))}(t,i)},toString:n.toString}},Co=function(t){return{extract:function(n,e){return function(t,n,e){for(var o={},r=[],i=0,u=e;i<u.length;i++){var a=u[i]
ro(a,(function(e,i,u,a){var c=xo(u,t,n,e,a)
eo(c,(function(t){r.push.apply(r,t)}),(function(t){o[i]=t}))}),(function(t,e){o[t]=e(n)}))}return r.length>0?$e(r):Ke(o)}(n,e,t)},toString:function(){return"obj{\n"+W(t,(function(t){return ro(t,(function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"}}},Oo=function(t){return{extract:function(n,e){var o=W(e,(function(e,o){return t.extract(n.concat(["["+o+"]"]),e)}))
return mo(o)},toString:function(){return"array("+t.toString()+")"}}},_o=function(t){return{extract:function(n,e){for(var o=[],r=0,i=t;r<i.length;r++){var u=i[r].extract(n,e)
if(u.stype===It.Value)return u
o.push(u)}return mo(o)},toString:function(){return"oneOf("+W(t,(function(t){return t.toString()})).join(", ")+")"}}},To=function(t,n){return{extract:function(e,o){var r=st(o),i=function(n,e){return Oo(ho(t)).extract(n,e)}(e,r)
return Qe(i,(function(t){var r=W(t,(function(t){return oo(t,t,{tag:"required",process:{}},n)}))
return Co(r).extract(e,o)}))},toString:function(){return"setOf("+n.toString()+")"}}},Do=p(Oo,Co),Eo=h(vo),Bo=function(t,n){return ho((function(e){var o=typeof e
return t(e)?Ke(e):$e("Expected type: "+n+" but got: "+o)}))},Mo=Bo(d,"number"),Ao=Bo(o,"string"),Fo=Bo(a,"boolean"),Io=Bo(l,"function"),Ro=function(t){if(Object(t)!==t)return!0
switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0
case"Array":case"Object":return Object.keys(t).every((function(n){return Ro(t[n])}))
default:return!1}},Vo=ho((function(t){return Ro(t)?Ke(t):$e("Expected value to be acceptable for sending via postMessage")})),Po=function(t,n,e,o){return bt(e,o).fold((function(){return function(t,n,e){return po(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+go(n)}))}(t,e,o)}),(function(e){return e.extract(t.concat(["branch: "+o]),n)}))},Ho=function(t,n){return{extract:function(e,o){return bt(o,t).fold((function(){return function(t,n){return po(t,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))}(e,t)}),(function(t){return Po(e,o,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+st(n)}}},zo=function(t){return ho((function(n){return t(n).fold($e,Ke)}))},No=function(t,n){return To((function(n){return qe(t(n))}),n)},Lo=function(t,n,e){return Ye(function(t,n,e){var o=n.extract([t],e)
return no(o,(function(t){return{input:e,errors:t}}))}(t,n,e))},Wo=function(t){return t.fold((function(t){throw new Error(jo(t))}),v)},Uo=function(t,n,e){return Wo(Lo(t,n,e))},jo=function(t){return"Errors: \n"+(n=t.errors,e=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:h("... (only showing first ten failures)")}]):n,W(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))).join("\n")+"\n\nInput object: "+go(t.input)
var n,e},Go=function(t,n){return Ho(t,dt(n,Co))},Xo=oo,qo=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},Yo=function(t){return zo((function(n){return H(t,n)?Ue.value(n):Ue.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Ko=function(t){return Xo(t,t,{tag:"required",process:{}},Eo())},Jo=function(t,n){return Xo(t,t,{tag:"required",process:{}},n)},$o=function(t){return Jo(t,Mo)},Qo=function(t){return Jo(t,Ao)},Zo=function(t,n){return Xo(t,t,{tag:"required",process:{}},Yo(n))},tr=function(t){return Jo(t,Io)},nr=function(t,n){return Xo(t,t,{tag:"required",process:{}},Co(n))},er=function(t,n){return Xo(t,t,{tag:"required",process:{}},Do(n))},or=function(t,n){return Xo(t,t,{tag:"required",process:{}},Oo(n))},rr=function(t){return Xo(t,t,{tag:"option",process:{}},Eo())},ir=function(t,n){return Xo(t,t,{tag:"option",process:{}},n)},ur=function(t){return ir(t,Mo)},ar=function(t){return ir(t,Ao)},cr=function(t){return ir(t,Io)},sr=function(t,n){return ir(t,Oo(n))},fr=function(t,n){return ir(t,Co(n))},lr=function(t,n){return Xo(t,t,so(n),Eo())},dr=function(t,n,e){return Xo(t,t,so(n),e)},mr=function(t,n){return dr(t,n,Mo)},gr=function(t,n){return dr(t,n,Ao)},pr=function(t,n,e){return dr(t,n,Yo(e))},hr=function(t,n){return dr(t,n,Fo)},vr=function(t,n){return dr(t,n,Io)},br=function(t,n,e){return dr(t,n,Oo(e))},yr=function(t,n,e){return dr(t,n,Co(e))},xr=function(t){var n=t
return{get:function(){return n},set:function(t){n=t}}},wr=function(t){if(!i(t))throw new Error("cases must be an array")
if(0===t.length)throw new Error("there must be at least one case")
var n=[],e={}
return U(t,(function(o,r){var u=st(o)
if(1!==u.length)throw new Error("one and only one name per case")
var a=u[0],c=o[a]
if(void 0!==e[a])throw new Error("duplicate key detected:"+a)
if("cata"===a)throw new Error("cannot have a case named cata (sorry)")
if(!i(c))throw new Error("case arguments must be an array")
n.push(a),e[a]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
var i=e.length
if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i)
var u=function(t){var o=st(t)
if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","))
if(!Q(n,(function(t){return H(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "))
return t[a].apply(null,e)}
return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o]
if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length)
var i=n[r]
return i.apply(null,e)},match:u,log:function(t){console.log(t,{constructors:n,constructor:a,params:e})}}}})),e}
wr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}])
var Sr,kr=function(t,n){return function(t,n){var e={}
return lt(t,(function(t,o){H(n,o)||(e[o]=t)})),e}(t,n)},Cr=function(t,n){return function(t,n){var e
return(e={})[t]=n,e}(t,n)},Or=function(t){return function(t){var n={}
return U(t,(function(t){n[t.key]=t.value})),n}(t)},_r=function(t,n){var e,o=function(t){var n=[],e=[]
return U(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){e.push(t)}))})),{errors:n,values:e}}(t)
return o.errors.length>0?(e=o.errors,Ue.error(J(e))):function(t,n){return 0===t.length?Ue.value(n):Ue.value(uo(n,ao.apply(void 0,t)))}(o.values,n)},Tr=function(t){return l(t)?t:S},Dr=function(t,n,e){for(var o=t.dom,r=Tr(e);o.parentNode;){o=o.parentNode
var i=Ft.fromDom(o),u=n(i)
if(u.isSome())return u
if(r(i))break}return F.none()},Er=function(t,n,e){var o=n(t),r=Tr(e)
return o.orThunk((function(){return r(t)?F.none():Dr(t,n,r)}))},Br=function(t,n){return yn(t.element,n.event.target)},Mr={can:k,abort:S,run:g},Ar=function(t){if(!xt(t,"can")&&!xt(t,"abort")&&!xt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!")
return O(O({},Mr),t)},Fr=function(t){return{can:function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
return q(t,(function(t,o){return t&&n(o).apply(void 0,e)}),!0)}}(t,(function(t){return t.can})),abort:function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
return q(t,(function(t,o){return t||n(o).apply(void 0,e)}),!1)}}(t,(function(t){return t.abort})),run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e]
U(t,(function(t){t.run.apply(void 0,n)}))}}},Ir=h,Rr=Ir("touchstart"),Vr=Ir("touchmove"),Pr=Ir("touchend"),Hr=Ir("touchcancel"),zr=Ir("mousedown"),Nr=Ir("mousemove"),Lr=Ir("mouseout"),Wr=Ir("mouseup"),Ur=Ir("mouseover"),jr=Ir("focusin"),Gr=Ir("focusout"),Xr=Ir("keydown"),qr=Ir("keyup"),Yr=Ir("input"),Kr=Ir("change"),Jr=Ir("click"),$r=Ir("transitioncancel"),Qr=Ir("transitionend"),Zr=Ir("transitionstart"),ti=Ir("selectstart"),ni=function(t){return h("alloy."+t)},ei={tap:ni("tap")},oi=ni("focus"),ri=ni("blur.post"),ii=ni("paste.post"),ui=ni("receive"),ai=ni("execute"),ci=ni("focus.item"),si=ei.tap,fi=ni("longpress"),li=ni("sandbox.close"),di=ni("typeahead.cancel"),mi=ni("system.init"),gi=ni("system.touchmove"),pi=ni("system.touchend"),hi=ni("system.scroll"),vi=ni("system.resize"),bi=ni("system.attached"),yi=ni("system.detached"),xi=ni("system.dismissRequested"),wi=ni("system.repositionRequested"),Si=ni("focusmanager.shifted"),ki=ni("slotcontainer.visibility"),Ci=ni("change.tab"),Oi=ni("dismiss.tab"),_i=ni("highlight"),Ti=ni("dehighlight"),Di=function(t,n){Ai(t,t.element,n,{})},Ei=function(t,n,e){Ai(t,t.element,n,e)},Bi=function(t){Di(t,ai())},Mi=function(t,n,e){Ai(t,n,e,{})},Ai=function(t,n,e,o){var r=O({target:n},o)
t.getSystem().triggerEvent(e,n,r)},Fi=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Ii=function(t){return Or(t)},Ri=function(t,n){return{key:t,value:Ar({abort:n})}},Vi=function(t){return{key:t,value:Ar({run:function(t,n){n.event.prevent()}})}},Pi=function(t,n){return{key:t,value:Ar({run:n})}},Hi=function(t,n,e){return{key:t,value:Ar({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},zi=function(t){return function(n){return{key:t,value:Ar({run:function(t,e){Br(t,e)&&n(t,e)}})}}},Ni=function(t,n,e){return function(t,n){return Pi(t,(function(e,o){e.getSystem().getByUid(n).each((function(n){Fi(n,n.element,t,o)}))}))}(t,n.partUids[e])},Li=function(t,n){return Pi(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk((function(){return Er(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),S).getOr(t)}))
n(t,r,e)}))},Wi=function(t){return Pi(t,(function(t,n){n.cut()}))},Ui=function(t){return Pi(t,(function(t,n){n.stop()}))},ji=function(t,n){return zi(t)(n)},Gi=zi(bi()),Xi=zi(yi()),qi=zi(mi()),Yi=function(t){return function(n){return Pi(t,n)}}(ai()),Ki=function(t){return t.dom.innerHTML},Ji=function(t,n){var e,o,r=Sn(t).dom,i=Ft.fromDom(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,Dn(Ft.fromDom(o)))
_e(i,u),Te(t),Oe(t,i)},$i=function(t){return function(t,n){return Ft.fromDom(t.dom.cloneNode(n))}(t,!1)},Qi=function(t){return An(t)?"#shadow-root":function(t){var n=Ft.fromTag("div"),e=Ft.fromDom(t.dom.cloneNode(!0))
return Oe(n,e),Ki(n)}($i(t))},Zi=function(t){return Qi(t)},tu=Ii([function(t,n){return{key:t,value:Ar({can:n})}}(oi(),(function(t,n){var e=n.event,o=e.originator,r=e.target
return!function(t,n,e){return yn(n,t.element)&&!yn(n,e)}(t,o,r)||(console.warn(oi()+" did not get interpreted by the desired target. \nOriginator: "+Zi(o)+"\nTarget: "+Zi(r)+"\nCheck the "+oi()+" event handlers"),!1)}))]),nu=Object.freeze({__proto__:null,events:tu}),eu=0,ou=function(t){var n=(new Date).getTime()
return t+"_"+Math.floor(1e9*Math.random())+ ++eu+String(n)},ru=h("alloy-id-"),iu=h("data-alloy-id"),uu=ru(),au=iu(),cu=function(t,n){Object.defineProperty(t.dom,au,{value:n,writable:!0})},su=function(t){var n=Pt(t)?t.dom[au]:null
return F.from(n)},fu=function(t){return ou(t)},lu=v,du=function(t){var n=function(n){return"The component must be in a context to execute: "+n+(t?"\n"+Zi(t().element)+" is not in context.":"")},e=function(t){return function(){throw new Error(n(t))}},o=function(t){return function(){console.warn(n(t))}}
return{debugInfo:h("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:S}},mu=du(),gu=function(t){return W(t,(function(t){return Dt(t,"/*")?t.substring(0,t.length-"/*".length):t}))},pu=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/)
return t.toFunctionAnnotation=function(){return{name:n,parameters:gu(i)}},t},hu=ou("alloy-premade"),vu=function(t){return Cr(hu,t)},bu=function(t){return function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/)
return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:gu(i.slice(1))}},t}((function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o]
return t.apply(void 0,T([n.getApis(),n],e,!1))}),t)},yu={init:function(){return xu({readState:h("No State required")})}},xu=function(t){return t},wu=function(t,n){var e={}
return lt(t,(function(t,o){lt(t,(function(t,r){var i=bt(e,r).getOr([])
e[r]=i.concat([n(o,t)])}))})),e},Su=function(t){return{classes:c(t.classes)?[]:t.classes,attributes:c(t.attributes)?{}:t.attributes,styles:c(t.styles)?{}:t.styles}},ku=function(t){return t.cHandler},Cu=function(t,n){return{name:t,handler:n}},Ou=function(t,n,e){var o=O(O({},e),function(t,n){var e={}
return U(t,(function(t){e[t.name()]=t.handlers(n)})),e}(n,t))
return wu(o,Cu)},_u=function(t){var n=function(t){return l(t)?{can:k,abort:S,run:t}:t}(t)
return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r]
var i=[t,e].concat(o)
n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},Tu=function(t,n,e){var o=n[e]
return o?function(t,n,e,o){try{var r=ot(e,(function(e,r){var i=e[n],u=r[n],a=o.indexOf(i),c=o.indexOf(u)
if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2))
if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2))
return a<c?-1:c<a?1:0}))
return Ue.value(r)}catch(i){return Ue.error([i])}}("Event: "+e,"name",t,o).map((function(t){var n=W(t,(function(t){return t.handler}))
return Fr(n)})):function(t,n){return Ue.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(n,(function(t){return t.name})),null,2)])}(e,t)},Du=function(t,n){var e=pt(t,(function(t,e){return(1===t.length?Ue.value(t[0].handler):Tu(t,n,e)).map((function(o){var r=_u(o),i=t.length>1?G(n[e],(function(n){return z(t,(function(t){return t.name===n}))})).join(" > "):t[0].name
return Cr(e,function(t,n){return{handler:t,purpose:n}}(r,i))}))}))
return _r(e,{})},Eu="alloy.base.behaviour",Bu=Co([Xo("dom","dom",{tag:"required",process:{}},Co([Ko("tag"),lr("styles",{}),lr("classes",[]),lr("attributes",{}),rr("value"),rr("innerHtml")])),Ko("components"),Ko("uid"),lr("events",{}),lr("apis",{}),Xo("eventOrder","eventOrder",function(t){return fo(h(t))}((Sr={},Sr[ai()]=["disabling",Eu,"toggling","typeaheadevents"],Sr[oi()]=[Eu,"focusing","keying"],Sr[mi()]=[Eu,"disabling","toggling","representing"],Sr[Yr()]=[Eu,"representing","streaming","invalidating"],Sr[yi()]=[Eu,"representing","item-events","tooltipping"],Sr[zr()]=["focusing",Eu,"item-type-events"],Sr[Rr()]=["focusing",Eu,"item-type-events"],Sr[Ur()]=["item-type-events","tooltipping"],Sr[ui()]=["receiving","reflecting","tooltipping"],Sr)),Eo()),rr("domModification")]),Mu=function(t){return t.events},Au=function(t,n){var e=Gn(t,n)
return void 0===e||""===e?[]:e.split(" ")},Fu=function(t){return void 0!==t.dom.classList},Iu=function(t,n){return function(t,n,e){var o=Au(t,n).concat([e])
return jn(t,n,o.join(" ")),!0}(t,"class",n)},Ru=function(t,n){return function(t,n,e){var o=G(Au(t,n),(function(t){return t!==e}))
return o.length>0?jn(t,n,o.join(" ")):Yn(t,n),!1}(t,"class",n)},Vu=function(t,n){Fu(t)?t.dom.classList.add(n):Iu(t,n)},Pu=function(t){0===(Fu(t)?t.dom.classList:function(t){return Au(t,"class")}(t)).length&&Yn(t,"class")},Hu=function(t,n){Fu(t)?t.dom.classList.remove(n):Ru(t,n)
Pu(t)},zu=function(t,n){return Fu(t)&&t.dom.classList.contains(n)},Nu=function(t,n){U(n,(function(n){Vu(t,n)}))},Lu=function(t,n){U(n,(function(n){Hu(t,n)}))},Wu=function(t){return t.dom.value},Uu=function(t,n){if(void 0===n)throw new Error("Value.set was undefined")
t.dom.value=n},ju=function(t){var n=Ft.fromTag(t.tag);(function(t,n){var e=t.dom
lt(n,(function(t,n){Un(e,n,t)}))})(n,t.attributes),Nu(n,t.classes),Qn(n,t.styles),t.innerHtml.each((function(t){return Ji(n,t)}))
var e=t.domChildren
return _e(n,e),t.value.each((function(t){Uu(n,t)})),t.uid,cu(n,t.uid),n},Gu=function(t,n){return function(t,n){var e=W(n,(function(t){return fr(t.name(),[Ko("config"),lr("state",yu)])})),o=Lo("component.behaviours",Co(e),t.behaviours).fold((function(n){throw new Error(jo(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),v)
return{list:n,data:dt(o,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}))
return h(n)}))}}(t,n)},Xu=function(t){var n=function(t){var n=bt(t,"behaviours").getOr({})
return $(st(n),(function(t){var e=n[t]
return f(e)?[e.me]:[]}))}(t)
return Gu(t,n)},qu=function(t,n,e){var o,r,i,u=O(O({},(o=t).dom),{uid:o.uid,domChildren:W(o.components,(function(t){return t.element}))}),a=function(t){return t.domModification.fold((function(){return Su({})}),Su)}(t),c={"alloy.base.modification":a},s=n.length>0?function(t,n,e,o){var r=O({},n)
U(e,(function(n){r[n.name()]=n.exhibit(t,o)}))
var i=wu(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return X(t,(function(t,n){return O(O({},n.modification),t)}),{})},a=X(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles)
return Su({classes:a,attributes:c,styles:s})}(e,c,n,u):a
return i=s,O(O({},r=u),{attributes:O(O({},r.attributes),i.attributes),styles:O(O({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},Yu=function(t,n,e){var o={"alloy.base.behaviour":Mu(t)}
return function(t,n,e,o){var r=Ou(t,e,o)
return Du(r,n)}(e,t.eventOrder,n,o).getOrDie()},Ku=function(t){var n=function(){return d},e=xr(mu),o=Wo(function(t){return Lo("custom.definition",Bu,t)}(t)),r=Xu(t),i=function(t){return t.list}(r),u=function(t){return t.data}(r),a=qu(o,i,u),c=ju(a),s=Yu(o,i,u),f=xr(o.components),d={uid:t.uid,getSystem:e.get,config:function(n){var e=u
return(l(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(t){return l(u[t.name()])},spec:t,readState:function(t){return u[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(du(n))},element:c,syncComponents:function(){var t=Dn(c),n=$(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),et)}))
f.set(n)},components:f.get,events:s}
return d},Ju=function(t){var n=lu(t),e=n.events,o=_(n,["events"]),r=function(t){var n=bt(t,"components").getOr([])
return W(n,ta)}(o),i=O(O({},o),{events:O(O({},nu),e),components:r})
return Ue.value(Ku(i))},$u=function(t){var n=Ft.fromText(t)
return Qu({element:n})},Qu=function(t){var n=Uo("external.component",ko([Ko("element"),rr("uid")]),t),e=xr(du()),o=n.uid.getOrThunk((function(){return fu("external")}))
cu(n.element,o)
var r={uid:o,getSystem:e.get,config:F.none,hasConfigured:S,connect:function(t){e.set(t)},disconnect:function(){e.set(du((function(){return r})))},getApis:function(){return{}},element:n.element,spec:t,readState:h("No state"),syncComponents:g,components:h([]),events:{}}
return vu(r)},Zu=fu,ta=function(t){return function(t){return bt(t,hu)}(t).getOrThunk((function(){var n=function(t){return yt(t,"uid")}(t)?t:O({uid:Zu("")},t)
return Ju(n).getOrDie()}))},na=vu
function ea(t,n,e,o,r){return t(e,o)?F.some(e):l(r)&&r(e)?F.none():n(e,o,r)}var oa,ra=function(t,n,e){for(var o=t.dom,r=l(e)?e:S;o.parentNode;){o=o.parentNode
var i=Ft.fromDom(o)
if(n(i))return F.some(i)
if(r(i))break}return F.none()},ia=function(t,n,e){return ea((function(t,n){return n(t)}),ra,t,n,e)},ua=function(t,n,e){return ia(t,n,e).isSome()},aa=function(t,n,e){return ra(t,(function(t){return vn(t,n)}),e)},ca=function(t,n){return function(t,n){return Y(t.dom.childNodes,(function(t){return n(Ft.fromDom(t))})).map(Ft.fromDom)}(t,(function(t){return vn(t,n)}))},sa=function(t,n){return function(t,n){var e=void 0===n?document:n.dom
return bn(e)?F.none():F.from(e.querySelector(t)).map(Ft.fromDom)}(n,t)},fa=function(t,n,e){return ea((function(t,n){return vn(t,n)}),aa,t,n,e)},la=function(){var t=ou("aria-owns")
return{id:t,link:function(n){jn(n,"aria-owns",t)},unlink:function(t){Yn(t,"aria-owns")}}},da=function(t,n){return function(t){return ia(t,(function(t){if(!Pt(t))return!1
var n=Gn(t,"id")
return void 0!==n&&n.indexOf("aria-owns")>-1})).bind((function(t){var n=Gn(t,"id"),e=Rn(t)
return sa(e,'[aria-owns="'+n+'"]')}))}(n).exists((function(n){return ma(t,n)}))},ma=function(t,n){return ua(n,(function(n){return yn(n,t.element)}),S)||da(t,n)},ga="unknown";(function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.LOGGING=2]="LOGGING"})(oa||(oa={}))
var pa=xr({}),ha=function(t,n,e){switch(bt(pa.get(),t).orThunk((function(){var n=st(pa.get())
return ct(n,(function(n){return t.indexOf(n)>-1?F.some(pa.get()[n]):F.none()}))})).getOr(oa.NORMAL)){case oa.NORMAL:return e(ya())
case oa.LOGGING:var o=function(t,n){var e=[],o=(new Date).getTime()
return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=(new Date).getTime()
H(["mousemove","mouseover","mouseout",mi()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:W(e,(function(t){return H(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Zi(t.target)+")":t.outcome}))})}}}(t,n),r=e(o)
return o.write(),r
case oa.STOP:return!0}},va=["alloy/data/Fields","alloy/debugging/Debugging"],ba=function(t,n,e){return ha(t,n,e)},ya=h({logEventCut:g,logEventStopped:g,logNoParent:g,logEventNoHandlers:g,logEventResponse:g,write:g}),xa=h([Ko("menu"),Ko("selectedMenu")]),wa=h([Ko("item"),Ko("selectedItem")])
h(Co(wa().concat(xa())))
var Sa=h(Co(wa())),ka=nr("initSize",[Ko("numColumns"),Ko("numRows")]),Ca=function(){return nr("markers",[Ko("backgroundMenu")].concat(xa()).concat(wa()))},Oa=function(t){return nr("markers",W(t,Ko))},_a=function(t,n,e){return function(){var t=new Error
if(void 0!==t.stack){var n=t.stack.split("\n")
return Y(n,(function(t){return t.indexOf("alloy")>0&&!z(va,(function(n){return t.indexOf(n)>-1}))})).getOr(ga)}}(),Xo(n,n,e,zo((function(t){return Ue.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e]
return t.apply(void 0,n)}))})))},Ta=function(t){return _a(0,t,so(g))},Da=function(t){return _a(0,t,so(F.none))},Ea=function(t){return _a(0,t,{tag:"required",process:{}})},Ba=function(t){return _a(0,t,{tag:"required",process:{}})},Ma=function(t,n){return qo(t,h(n))},Aa=function(t){return qo(t,v)},Fa=h(ka),Ia=function(t,n,e,o,r,i,u,a){return void 0===a&&(a=!1),{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a}},Ra=wr([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Va=Ra.southeast,Pa=Ra.southwest,Ha=Ra.northeast,za=Ra.northwest,Na=Ra.south,La=Ra.north,Wa=Ra.east,Ua=Ra.west,ja=function(t,n,e,o){var r=t+n
return r>o?e:r<e?o:r},Ga=function(t,n,e){return Math.min(Math.max(t,n),e)},Xa=function(t,n){return nt(["left","right","top","bottom"],(function(e){return bt(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x
case 0:return t.x+t.width
case 2:return t.y
case 3:return t.y+t.height}}(t,n)}))}))},qa="layout",Ya=function(t){return t.x},Ka=function(t,n){return t.x+t.width/2-n.width/2},Ja=function(t,n){return t.x+t.width-n.width},$a=function(t,n){return t.y-n.height},Qa=function(t){return t.y+t.height},Za=function(t,n){return t.y+t.height/2-n.height/2},tc=function(t,n,e){return Ia(Ya(t),Qa(t),e.southeast(),Va(),"southeast",Xa(t,{left:1,top:3}),qa)},nc=function(t,n,e){return Ia(Ja(t,n),Qa(t),e.southwest(),Pa(),"southwest",Xa(t,{right:0,top:3}),qa)},ec=function(t,n,e){return Ia(Ya(t),$a(t,n),e.northeast(),Ha(),"northeast",Xa(t,{left:1,bottom:2}),qa)},oc=function(t,n,e){return Ia(Ja(t,n),$a(t,n),e.northwest(),za(),"northwest",Xa(t,{right:0,bottom:2}),qa)},rc=function(t,n,e){return Ia(Ka(t,n),$a(t,n),e.north(),La(),"north",Xa(t,{bottom:2}),qa)},ic=function(t,n,e){return Ia(Ka(t,n),Qa(t),e.south(),Na(),"south",Xa(t,{top:3}),qa)},uc=function(t,n,e){return Ia(function(t){return t.x+t.width}(t),Za(t,n),e.east(),Wa(),"east",Xa(t,{left:0}),qa)},ac=function(t,n,e){return Ia(function(t,n){return t.x-n.width}(t,n),Za(t,n),e.west(),Ua(),"west",Xa(t,{right:1}),qa)},cc=function(){return[tc,nc,ec,oc,ic,rc,uc,ac]},sc=function(){return[nc,tc,oc,ec,ic,rc,uc,ac]},fc=function(){return[ec,oc,tc,nc,rc,ic]},lc=function(){return[oc,ec,nc,tc,rc,ic]},dc=function(){return[tc,nc,ec,oc,ic,rc]},mc=function(){return[nc,tc,oc,ec,ic,rc]},gc=Object.freeze({__proto__:null,events:function(t){return Ii([Pi(ui(),(function(n,e){var o=t.channels,r=st(o),i=e,u=function(t,n){return n.universal?t:G(t,(function(t){return H(n.channels,t)}))}(r,i)
U(u,(function(t){var e=o[t],r=e.schema,u=Uo("channel["+t+"] data\nReceiver: "+Zi(n.element),r,i.data)
e.onReceive(n,u)}))}))])}}),pc=[Jo("channels",No(Ue.value,ko([Ea("onReceive"),lr("schema",Eo())])))],hc=function(t,n,e){return qi((function(o,r){e(o,t,n)}))},vc=function(t,n,e){return function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/)
return t.toFunctionAnnotation=function(){return{name:n,parameters:gu(u.slice(0,1).concat(u.slice(3)))}},t}((function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i]
var u=[o].concat(r)
return o.config({name:h(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(u,1)
return n.apply(void 0,[o,t.config,t.state].concat(e))}))}),e,n)},bc=function(t){return{key:t,value:void 0}},yc=function(t,n,e,o,r,i,u){var a=function(t){return xt(t,e)?t[e]():F.none()},c=dt(r,(function(t,n){return vc(e,t,n)})),s=dt(i,(function(t,n){return pu(t,n)})),f=O(O(O({},s),c),{revoke:y(bc,e),config:function(n){var o=Uo(e+"-config",t,n)
return{key:e,value:{config:o,me:f,configAsRaw:Lt((function(){return Uo(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:h(n),exhibit:function(t,n){return kt(a(t),bt(o,"exhibit"),(function(t,e){return e(n,t.config,t.state)})).getOrThunk((function(){return Su({})}))},name:h(e),handlers:function(t){return a(t).map((function(t){return bt(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}})
return f},xc=function(t){return Or(t)},wc=ko([Ko("fields"),Ko("name"),lr("active",{}),lr("apis",{}),lr("state",yu),lr("extra",{})]),Sc=function(t){var n=Uo("Creating behaviour: "+t.name,wc,t)
return function(t,n,e,o,r,i){var u,a,c=ko(t),s=fr(n,[(u="config",a=t,ir(u,ko(a)))])
return yc(c,s,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},kc=ko([Ko("branchKey"),Ko("branches"),Ko("name"),lr("active",{}),lr("apis",{}),lr("state",yu),lr("extra",{})]),Cc=function(t){var n=Uo("Creating behaviour: "+t.name,kc,t)
return function(t,n,e,o,r,i){var u=t,a=fr(n,[ir("config",t)])
return yc(u,a,n,e,o,r,i)}(Go(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},Oc=h(void 0),_c=Sc({fields:pc,name:"receiving",active:gc}),Tc=Object.freeze({__proto__:null,exhibit:function(t,n){return Su({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Dc=function(){return Ft.fromDom(document)},Ec=function(t){return t.dom.focus()},Bc=function(t){var n=Rn(t).dom
return t.dom===n.activeElement},Mc=function(t){return void 0===t&&(t=Dc()),F.from(t.dom.activeElement).map(Ft.fromDom)},Ac=function(t){return Mc(Rn(t)).filter((function(n){return t.dom.contains(n.dom)}))},Fc=function(t,n){var e=Rn(n),o=Mc(e).bind((function(t){var e,o,r=function(n){return yn(t,n)}
return r(n)?F.some(n):(e=r,(o=function(t){for(var n=0;n<t.childNodes.length;n++){var r=Ft.fromDom(t.childNodes[n])
if(e(r))return F.some(r)
var i=o(t.childNodes[n])
if(i.isSome())return i}return F.none()})(n.dom))})),r=t(n)
return o.each((function(t){Mc(e).filter((function(n){return yn(n,t)})).fold((function(){Ec(t)}),g)})),r},Ic=function(t,n,e,o,r){var i=function(t){return t+"px"}
return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}},Rc=function(t,n){Zn(t,function(t){return O(O({},t),{position:F.some(t.position)})}(n))},Vc=wr([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Pc=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=r-(a+u.width),f=i-(c+u.height),l=F.some(a),d=F.some(c),m=F.some(s),g=F.some(f),p=F.none()
return function(t,n,e,o,r,i,u,a,c){return t.fold(n,e,o,r,i,u,a,c)}(n.direction,(function(){return Ic(t,l,d,p,p)}),(function(){return Ic(t,p,d,m,p)}),(function(){return Ic(t,l,p,p,g)}),(function(){return Ic(t,p,p,m,g)}),(function(){return Ic(t,l,d,p,p)}),(function(){return Ic(t,l,p,p,g)}),(function(){return Ic(t,l,d,p,p)}),(function(){return Ic(t,p,d,m,p)}))},Hc=function(t,n){return t.fold((function(){var t=n.rect
return Ic("absolute",F.some(t.x),F.some(t.y),F.none(),F.none())}),(function(t,e,o,r){return Pc("absolute",n,t,e,o,r)}),(function(t,e,o,r){return Pc("fixed",n,t,e,o,r)}))},zc=function(t,n){var e=y(Ve,n),o=t.fold(e,e,(function(){var t=Be()
return Ve(n).translate(-t.left,-t.top)})),r=be(n),i=fe(n)
return Pe(o.left,o.top,r,i)},Nc=function(t,n){return n.fold((function(){return t.fold(Ne,Ne,Pe)}),(function(n){return t.fold(n,n,(function(){var e=n(),o=Lc(t,e.x,e.y)
return Pe(o.left,o.top,e.width,e.height)}))}))},Lc=function(t,n,e){var o=de(n,e)
return t.fold(h(o),h(o),(function(){var t=Be()
return o.translate(-t.left,-t.top)}))}
Vc.none
var Wc,Uc=Vc.relative,jc=Vc.fixed,Gc=function(t,n){return function(t,n){return{anchorBox:t,origin:n}}(t,n)},Xc="data-alloy-placement",qc=function(t){return Xn(t,Xc)},Yc=wr([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Kc=function(t,n,e,o){var r=t.bubble,i=r.offset,u=function(t,n,e){var o=function(o,r){return n[o].map((function(n){var i="top"===o||"bottom"===o,u=i?e.top:e.left,a=("left"===o||"top"===o?Math.max:Math.min)(n,r)+u
return i?Ga(a,t.y,t.bottom):Ga(a,t.x,t.right)})).getOr(r)},r=o("left",t.x),i=o("top",t.y),u=o("right",t.right),a=o("bottom",t.bottom)
return Pe(r,i,u-r,a-i)}(o,t.restriction,i),a=t.x+i.left,c=t.y+i.top,s=Pe(a,c,n,e),f=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.right,s=t.bottom,f=t.width,l=t.height
return{originInBounds:u>=e&&u<=r&&a>=o&&a<=i,sizeInBounds:c<=r&&c>=e&&s<=i&&s>=o,visibleW:Math.min(f,u>=e?r-u:c-e),visibleH:Math.min(l,a>=o?i-a:s-o)}}(s,u),l=f.originInBounds,d=f.sizeInBounds,m=f.visibleW,g=f.visibleH,p=l&&d,v=p?s:function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.width,s=t.height,f=Math.max(e,r-c),l=Math.max(o,i-s),d=Ga(u,e,f),m=Ga(a,o,l),g=Math.min(d+c,r)-d,p=Math.min(m+s,i)-m
return Pe(d,m,g,p)}(s,u),b=v.width>0&&v.height>0,y=function(t,n,e){var o=h(n.bottom-e.y),r=h(e.bottom-n.y),i=function(t,n,e,o){return t.fold(n,n,o,o,n,o,e,e)}(t,r,r,o),u=h(n.right-e.x),a=h(e.right-n.x)
return{maxWidth:function(t,n,e,o){return t.fold(n,o,n,o,e,e,n,o)}(t,a,a,u),maxHeight:i}}(t.direction,v,o),x=y.maxWidth,w={rect:v,maxHeight:y.maxHeight,maxWidth:x,direction:t.direction,placement:t.placement,classes:{on:r.classesOn,off:r.classesOff},layout:t.label,testY:c}
return p||t.alwaysFit?Yc.fit(w):Yc.nofit(w,m,g,b)},Jc=function(t){var n=xr(F.none()),e=function(){return n.get().each(t)}
return{clear:function(){e(),n.set(F.none())},isSet:function(){return n.get().isSome()},get:function(){return n.get()},set:function(t){e(),n.set(F.some(t))}}},$c=function(){return Jc((function(t){return t.unbind()}))},Qc=function(){var t=Jc(g)
return O(O({},t),{on:function(n){return t.get().each(n)}})},Zc=k,ts=function(t,n,e){return function(t,n,e,o){return xe(t,n,e,o,!1)}(t,n,Zc,e)},ns=function(t,n,e){return function(t,n,e,o){return xe(t,n,e,o,!0)}(t,n,Zc,e)},es=ye,os=["top","bottom","right","left"],rs="data-alloy-transition-timer",is=function(t,n){return function(t,n){return Q(n,(function(n){return zu(t,n)}))}(t,n.classes)},us=function(t,n){var e=function(t){return parseFloat(t).toFixed(3)}
return ht(n,(function(n,o){var r,i,u,a=t[o].map(e),c=n.map(e)
return void 0===u&&(u=b),!kt(r=a,i=c,u).getOr(r.isNone()&&i.isNone())})).isSome()},as=function(t,n){var e,r=$c(),i=$c(),u=function(n){var e,o=null!==(e=n.raw.pseudoElement)&&void 0!==e?e:""
return yn(n.target,t)&&!Bt(o)&&H(os,n.raw.propertyName)},a=function(o){if(s(o)||u(o)){r.clear(),i.clear()
var a=null==o?void 0:o.raw.type;(s(a)||a===Qr())&&(clearTimeout(e),Yn(t,rs),Lu(t,n.classes))}},c=function(){r.set(ts(t,Qr(),a)),i.set(ts(t,$r(),a))}
if("ontransitionstart"in t.dom)var f=ts(t,Zr(),(function(t){u(t)&&(f.unbind(),c())}))
else c()
var l=function(t){var n=function(n){var e=te(t,n),r=o(e)?e.split(/\s*,\s*/):[]
return G(r,Bt)},e=function(t){if(o(t)&&/^[\d.]+/.test(t)){var n=parseFloat(t)
return Dt(t,"ms")?n:1e3*n}return 0},r=n("transition-delay"),i=n("transition-duration")
return q(i,(function(t,n,o){var i=e(r[o])+e(n)
return Math.max(t,i)}),0)}(t)
requestAnimationFrame((function(){e=setTimeout(a,l+17),jn(t,rs,e)}))},cs=function(t,n,e,o,r,i){var u=function(t,n,e){return e.exists((function(e){var o=t.mode
return"all"===o||e[o]!==n[o]}))}(o,r,i)
if(u||is(t,o)){$n(t,"position",e.position)
var a=zc(n,t),c=Hc(n,O(O({},r),{rect:a})),s=nt(os,(function(t){return c[t]}))
us(e,s)&&(Zn(t,s),u&&function(t,n){Nu(t,n.classes),Xn(t,rs).each((function(n){clearTimeout(parseInt(n,10)),Yn(t,rs)})),as(t,n)}(t,o),ue(t))}else Lu(t,o.classes)},ss=function(t,n,e,o){ie(n,"max-height"),ie(n,"max-width")
var r,i={width:be(r=n),height:fe(r)}
return function(t,n,e,o,r,i){var u=o.width,a=o.height,c=function(n,c,s,f,l){var d=n(e,o,r,t,i),m=Kc(d,u,a,i)
return m.fold(h(m),(function(t,n,e,o){return(l===o?e>f||n>s:!l&&o)?m:Yc.nofit(c,s,f,l)}))}
return q(n,(function(t,n){var e=y(c,n)
return t.fold(h(t),e)}),Yc.nofit({rect:e,maxHeight:o.height,maxWidth:o.width,direction:Va(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:e.y},-1,-1,!1)).fold(v,v)}(n,o.preference,t,i,e,o.bounds)},fs=function(t,n){(function(t,n){jn(t,Xc,n)})(t,n.placement)},ls=function(t,n){(function(t,n){var e=ce.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"])
$n(t,"max-height",e+"px")})(t,Math.floor(n))},ds=h((function(t,n){ls(t,n),Qn(t,{"overflow-x":"hidden","overflow-y":"auto"})})),ms=h((function(t,n){ls(t,n)})),gs=function(t,n,e){return void 0===t[n]?e:t[n]},ps=function(t,n,e,o){var r=ss(t,n,e,o)
return function(t,n,e){var o=Hc(e.origin,n)
e.transition.each((function(r){cs(t,e.origin,o,r,n,e.lastPlacement)})),Rc(t,o)}(n,r,o),fs(n,r),function(t,n){var e=n.classes
Lu(t,e.off),Nu(t,e.on)}(n,r),function(t,n,e){(0,e.maxHeightFunction)(t,n.maxHeight)}(n,r,o),function(t,n,e){(0,e.maxWidthFunction)(t,n.maxWidth)}(n,r,o),{layout:r.layout,placement:r.placement}},hs=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],vs=function(t,n,e,o){void 0===o&&(o=1)
var r=t*o,i=n*o,u=function(t){return bt(e,t).getOr([])},a=function(t,n,e){var o=tt(hs,e)
return{offset:de(t,n),classesOn:$(e,u),classesOff:$(o,u)}}
return{southeast:function(){return a(-t,n,["top","alignLeft"])},southwest:function(){return a(t,n,["top","alignRight"])},south:function(){return a(-t/2,n,["top","alignCentre"])},northeast:function(){return a(-t,-n,["bottom","alignLeft"])},northwest:function(){return a(t,-n,["bottom","alignRight"])},north:function(){return a(-t/2,-n,["bottom","alignCentre"])},east:function(){return a(t,-n/2,["valignCentre","left"])},west:function(){return a(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return a(r,i,["top","alignLeft","inset"])},insetNorthwest:function(){return a(-r,i,["top","alignRight","inset"])},insetNorth:function(){return a(-r/2,i,["top","alignCentre","inset"])},insetSoutheast:function(){return a(r,-i,["bottom","alignLeft","inset"])},insetSouthwest:function(){return a(-r,-i,["bottom","alignRight","inset"])},insetSouth:function(){return a(-r/2,-i,["bottom","alignCentre","inset"])},insetEast:function(){return a(-r,-i/2,["valignCentre","right","inset"])},insetWest:function(){return a(r,-i/2,["valignCentre","left","inset"])}}},bs=function(){return vs(0,0,{})},ys=v,xs=function(t,n){return function(e){return"rtl"===ws(e)?n:t}},ws=function(t){return"rtl"===te(t,"direction")?"rtl":"ltr"};(function(t){t.TopToBottom="toptobottom",t.BottomToTop="bottomtotop"})(Wc||(Wc={}))
var Ss="data-alloy-vertical-dir",ks=function(t){return ua(t,(function(t){return Pt(t)&&Gn(t,"data-alloy-vertical-dir")===Wc.BottomToTop}))},Cs=function(){return fr("layouts",[Ko("onLtr"),Ko("onRtl"),rr("onBottomLtr"),rr("onBottomRtl")])},Os=function(t,n,e,o,r,i,u){var a=u.map(ks).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),f=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),l=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o)
return xs(f,l)(t)},_s=[Ko("hotspot"),rr("bubble"),lr("overrides",{}),Cs(),Ma("placement",(function(t,n,e){var o=n.hotspot,r=zc(e,o.element),i=Os(t.element,n,dc(),mc(),fc(),lc(),F.some(n.hotspot.element))
return F.some(ys({anchorBox:r,bubble:n.bubble.getOr(bs()),overrides:n.overrides,layouts:i,placer:F.none()}))}))],Ts=[Ko("x"),Ko("y"),lr("height",0),lr("width",0),lr("bubble",bs()),lr("overrides",{}),Cs(),Ma("placement",(function(t,n,e){var o=Lc(e,n.x,n.y),r=Pe(o.left,o.top,n.width,n.height),i=Os(t.element,n,cc(),sc(),cc(),sc(),F.none())
return F.some(ys({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:F.none()}))}))],Ds=wr([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Es=function(t){return t.fold(v,(function(t,n,e){return t.translate(-n,-e)}))},Bs=function(t){return t.fold(v,v)},Ms=function(t){return q(t,(function(t,n){return t.translate(n.left,n.top)}),de(0,0))},As=function(t){var n=W(t,Bs)
return Ms(n)},Fs=Ds.screen,Is=Ds.absolute,Rs=function(t,n,e){var o=Sn(t.element),r=Be(o),i=function(t,n,e){var o=On(e.root).dom
return F.from(o.frameElement).map(Ft.fromDom).filter((function(n){var e=Sn(n),o=Sn(t.element)
return yn(e,o)})).map(ge)}(t,0,e).getOr(r)
return Is(i,r.left,r.top)},Vs=function(t,n,e,o){var r=Fs(de(t,n))
return F.some(function(t,n,e){return{point:t,width:n,height:e}}(r,e,o))},Ps=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c=[n,t.point],s=(i=function(){return As(c)},u=function(){return As(c)},a=function(){return function(t){var n=W(t,Es)
return Ms(n)}(c)},o.fold(i,u,a)),f=function(t,n,e,o){return{x:t,y:n,width:e,height:o}}(s.left,s.top,t.width,t.height),l=e.showAbove?fc():dc(),d=e.showAbove?lc():mc(),m=Os(r,e,l,d,l,d,F.none())
return ys({anchorBox:f,bubble:e.bubble.getOr(bs()),overrides:e.overrides,layouts:m,placer:F.none()})}))},Hs=[Ko("node"),Ko("root"),rr("bubble"),Cs(),lr("overrides",{}),lr("showAbove",!1),Ma("placement",(function(t,n,e){var o=Rs(t,0,n)
return n.node.filter(Nn).bind((function(r){var i=r.dom.getBoundingClientRect(),u=Vs(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element)
return Ps(u,o,n,e,a)}))}))],zs=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Ns=wr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ls=(Ns.before,Ns.on,Ns.after,function(t){return t.fold(v,v,v)}),Ws=wr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Us={domRange:Ws.domRange,relative:Ws.relative,exact:Ws.exact,exactFromRange:function(t){return Ws.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=function(t){return t.match({domRange:function(t){return Ft.fromDom(t.startContainer)},relative:function(t,n){return Ls(t)},exact:function(t,n,e,o){return t}})}(t)
return On(n)},range:zs},js=function(t,n,e){var o,r=t.document.createRange()
return o=r,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),function(t,n){n.fold((function(n){t.setEndBefore(n.dom)}),(function(n,e){t.setEnd(n.dom,e)}),(function(n){t.setEndAfter(n.dom)}))}(r,e),r},Gs=function(t,n,e,o,r){var i=t.document.createRange()
return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Xs=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},qs=wr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ys=function(t,n,e){return n(Ft.fromDom(e.startContainer),e.startOffset,Ft.fromDom(e.endContainer),e.endOffset)},Ks=function(t,n){return function(t,n){var e=n.ltr()
return e.collapsed?n.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return qs.rtl(Ft.fromDom(t.endContainer),t.endOffset,Ft.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ys(0,qs.ltr,e)})):Ys(0,qs.ltr,e)}(0,function(t,n){return n.match({domRange:function(t){return{ltr:h(t),rtl:F.none}},relative:function(n,e){return{ltr:Lt((function(){return js(t,n,e)})),rtl:Lt((function(){return F.some(js(t,e,n))}))}},exact:function(n,e,o,r){return{ltr:Lt((function(){return Gs(t,n,e,o,r)})),rtl:Lt((function(){return F.some(Gs(t,o,r,n,e))}))}}})}(t,n))},Js=function(t,n){return Ks(t,n).match({ltr:function(n,e,o,r){var i=t.document.createRange()
return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange()
return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})}
qs.ltr,qs.rtl
var $s,Qs=function(t,n){var e=function(n){return t(n)?F.from(n.dom.nodeValue):F.none()}
return{get:function(o){if(!t(o))throw new Error("Can only get "+n+" value of a "+n+" node")
return e(o).getOr("")},getOption:e,set:function(e,o){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node")
e.dom.nodeValue=o}}}(Ht,"text"),Zs=function(t){return Qs.getOption(t)},tf=["img","br"],nf=function(t){return Zs(t).filter((function(t){return 0!==t.trim().length||t.indexOf(" ")>-1})).isSome()||H(tf,Rt(t))},ef=function(t,n){var e=function(t){for(var o=Dn(t),r=o.length-1;r>=0;r--){var i=o[r]
if(n(i))return F.some(i)
var u=e(i)
if(u.isSome())return u}return F.none()}
return e(t)},of=function(t,n){return function(t,n){var e=void 0===n?document:n.dom
return bn(e)?[]:W(e.querySelectorAll(t),Ft.fromDom)}(n,t)},rf=function(t,n,e,o){var r=function(t,n,e,o){var r=Sn(t).dom.createRange()
return r.setStart(t.dom,n),r.setEnd(e.dom,o),r}(t,n,e,o),i=yn(t,e)&&n===o
return r.collapsed&&!i},uf=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1)
return F.some(zs(Ft.fromDom(n.startContainer),n.startOffset,Ft.fromDom(e.endContainer),e.endOffset))}return F.none()},af=function(t){if(null===t.anchorNode||null===t.focusNode)return uf(t)
var n=Ft.fromDom(t.anchorNode),e=Ft.fromDom(t.focusNode)
return rf(n,t.anchorOffset,e,t.focusOffset)?F.some(zs(n,t.anchorOffset,e,t.focusOffset)):uf(t)},cf=function(t){return function(t){return F.from(t.getSelection())}(t).filter((function(t){return t.rangeCount>0})).bind(af)},sf=function(t,n){return function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect()
return e.width>0||e.height>0?F.some(e).map(Xs):F.none()}(Js(t,n))},ff=function(t,n){return function(t){var n=t.getBoundingClientRect()
return n.width>0||n.height>0?F.some(n).map(Xs):F.none()}(Js(t,n))},lf=function(t,n){return{element:t,offset:n}},df=function(t,n){var e=Dn(t)
if(0===e.length)return lf(t,n)
if(n<e.length)return lf(e[n],0)
var o=e[e.length-1],r=Ht(o)?function(t){return Qs.get(t)}(o).length:Dn(o).length
return lf(o,r)},mf=function(t,n){return Ht(t)?lf(t,n):df(t,n)},gf=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return cf(t)}}))().map((function(t){var n=mf(t.start,t.soffset),e=mf(t.finish,t.foffset)
return Us.range(n.element,n.offset,e.element,e.offset)}))},pf=[rr("getSelection"),Ko("root"),rr("bubble"),Cs(),lr("overrides",{}),lr("showAbove",!1),Ma("placement",(function(t,n,e){var o=On(n.root).dom,r=Rs(t,0,n),i=gf(o,n).bind((function(t){return ff(o,Us.exactFromRange(t)).orThunk((function(){var n=Ft.fromText("\ufeff")
Se(t.start,n)
var e=sf(o,Us.exact(n,0,n,1))
return De(n),e})).bind((function(t){return Vs(t.left,t.top,t.width,t.height)}))})),u=gf(o,n).bind((function(t){return Pt(t.start)?F.some(t.start):function(t){return _n(t)}(t.start)})).getOr(t.element)
return Ps(i,r,n,e,u)}))],hf="link-layout",vf=function(t){return t.x+t.width},bf=function(t,n){return t.x-n.width},yf=function(t,n){return t.y-n.height+t.height},xf=function(t){return t.y},wf=function(t,n,e){return Ia(vf(t),xf(t),e.southeast(),Va(),"southeast",Xa(t,{left:0,top:2}),hf)},Sf=function(t,n,e){return Ia(bf(t,n),xf(t),e.southwest(),Pa(),"southwest",Xa(t,{right:1,top:2}),hf)},kf=function(t,n,e){return Ia(vf(t),yf(t,n),e.northeast(),Ha(),"northeast",Xa(t,{left:0,bottom:3}),hf)},Cf=function(t,n,e){return Ia(bf(t,n),yf(t,n),e.northwest(),za(),"northwest",Xa(t,{right:1,bottom:3}),hf)},Of=function(){return[wf,Sf,kf,Cf]},_f=function(){return[Sf,wf,Cf,kf]},Tf=[Ko("item"),Cs(),lr("overrides",{}),Ma("placement",(function(t,n,e){var o=zc(e,n.item.element),r=Os(t.element,n,Of(),_f(),Of(),_f(),F.none())
return F.some(ys({anchorBox:o,bubble:bs(),overrides:n.overrides,layouts:r,placer:F.none()}))}))],Df=Go("type",{selection:pf,node:Hs,hotspot:_s,submenu:Tf,makeshift:Ts}),Ef=[or("classes",Ao),pr("mode","all",["all","layout","placement"])],Bf=[lr("useFixed",S),rr("getBounds")],Mf=[Jo("anchor",Df),fr("transition",Ef)],Af=function(t,n,e,o,r,i,u){return function(t,n,e,o,r,i,u,a){var c=gs(u,"maxHeightFunction",ds()),s=gs(u,"maxWidthFunction",g),f=t.anchorBox,l=t.origin,d={bounds:Nc(l,i),origin:l,preference:o,maxHeightFunction:c,maxWidthFunction:s,lastPlacement:r,transition:a}
return ps(f,n,e,d)}(Gc(e.anchorBox,n),r.element,e.bubble,e.layouts,i,o,e.overrides,u)},Ff=function(t,n,e,o,r,i){var u=i.map(He)
return If(t,n,e,o,r,u)},If=function(t,n,e,o,r,i){var u=Uo("placement.info",Co(Mf),r),a=u.anchor,c=o.element,s=e.get(o.uid)
Fc((function(){$n(c,"position","fixed")
var r=ee(c,"visibility")
$n(c,"visibility","hidden")
var f,l=n.useFixed()?(f=document.documentElement,jc(0,0,f.clientWidth,f.clientHeight)):function(t){var n=ge(t.element),e=t.element.dom.getBoundingClientRect()
return Uc(n.left,n.top,e.width,e.height)}(t),d=a.placement,m=i.map(h).or(n.getBounds)
d(t,a,l).each((function(n){var r=n.placer.getOr(Af)(t,l,n,m,o,s,u.transition)
e.set(o.uid,r)})),r.fold((function(){ie(c,"visibility")}),(function(t){$n(c,"visibility",t)})),ee(c,"left").isNone()&&ee(c,"top").isNone()&&ee(c,"right").isNone()&&ee(c,"bottom").isNone()&&wt(ee(c,"position"),"fixed")&&ie(c,"position")}),c)},Rf=Object.freeze({__proto__:null,position:function(t,n,e,o,r){Ff(t,n,e,o,r,F.none())},positionWithin:Ff,positionWithinBounds:If,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"},reset:function(t,n,e,o){var r=o.element
U(["position","left","right","top","bottom"],(function(t){return ie(r,t)})),function(t){Yn(t,Xc)}(r),e.clear(o.uid)}}),Vf=Object.freeze({__proto__:null,init:function(){var t={}
return xu({readState:function(){return t},clear:function(n){f(n)?delete t[n]:t={}},set:function(n,e){t[n]=e},get:function(n){return bt(t,n)}})}}),Pf=Sc({fields:Bf,name:"positioning",active:Tc,apis:Rf,state:Vf}),Hf=function(t){Di(t,yi())
var n=t.components()
U(n,Hf)},zf=function(t){var n=t.components()
U(n,zf),Di(t,bi())},Nf=function(t,n){Oe(t.element,n.element)},Lf=function(t,n){var e=t.components();(function(t){U(t.components(),(function(t){return De(t.element)})),Te(t.element),t.syncComponents()})(t)
var o=tt(e,n)
U(o,(function(n){Hf(n),t.getSystem().removeFromWorld(n)})),U(n,(function(n){n.getSystem().isConnected()?Nf(t,n):(t.getSystem().addToWorld(n),Nf(t,n),Nn(t.element)&&zf(n)),t.syncComponents()}))},Wf=function(t,n){Uf(t,n,Oe)},Uf=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Nn(t.element)&&zf(n),t.syncComponents()},jf=function(t){Hf(t),De(t.element),t.getSystem().removeFromWorld(t)},Gf=function(t){var n=_n(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))
jf(t),n.each((function(t){t.syncComponents()}))},Xf=function(t){var n=t.components()
U(n,jf),Te(t.element),t.syncComponents()},qf=function(t,n){Yf(t,n,Oe)},Yf=function(t,n,e){e(t,n.element)
var o=Dn(n.element)
U(o,(function(t){n.getByDom(t).each(zf)}))},Kf=function(t){var n=Dn(t.element)
U(n,(function(n){t.getByDom(n).each(Hf)})),De(t.element)},Jf=function(t,n,e,o){e.get().each((function(n){Xf(t)}))
var r=n.getAttachPoint(t)
Wf(r,t)
var i=t.getSystem().build(o)
return Wf(t,i),e.set(i),i},$f=function(t,n,e,o){var r=Jf(t,n,e,o)
return n.onOpen(t,r),r},Qf=function(t,n,e){e.get().each((function(o){Xf(t),Gf(t),n.onClose(t,o),e.clear()}))},Zf=function(t,n,e){return e.isOpen()},tl=function(t,n,e){var o=n.getAttachPoint(t)
$n(t.element,"position",Pf.getMode(o)),function(t,n,e,o){ee(t.element,n).fold((function(){Yn(t.element,e)}),(function(n){jn(t.element,e,n)})),$n(t.element,n,o)}(t,"visibility",n.cloakVisibilityAttr,"hidden")},nl=function(t,n,e){(function(t){return z(["top","left","right","bottom"],(function(n){return ee(t,n).isSome()}))})(t.element)||ie(t.element,"position"),function(t,n,e){Xn(t.element,e).fold((function(){return ie(t.element,n)}),(function(e){return $n(t.element,n,e)}))}(t,"visibility",n.cloakVisibilityAttr)},el=Object.freeze({__proto__:null,cloak:tl,decloak:nl,open:$f,openWhileCloaked:function(t,n,e,o,r){tl(t,n),$f(t,n,e,o),r(),nl(t,n)},close:Qf,isOpen:Zf,isPartOf:function(t,n,e,o){return Zf(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return Jf(t,n,e,o)}))}}),ol=Object.freeze({__proto__:null,events:function(t,n){return Ii([Pi(li(),(function(e,o){Qf(e,t,n)}))])}}),rl=[Ta("onOpen"),Ta("onClose"),Ko("isPartOf"),Ko("getAttachPoint"),lr("cloakVisibilityAttr","data-precloak-visibility")],il=Sc({fields:rl,name:"sandboxing",active:ol,apis:el,state:Object.freeze({__proto__:null,init:function(){var t=Qc(),n=h("not-implemented")
return xu({readState:n,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})}})}),ul=h("dismiss.popups"),al=h("reposition.popups"),cl=h("mouse.released"),sl=ko([lr("isExtraPart",S),fr("fireEventInstead",[lr("event",xi())])]),fl=function(t){var n,e=Uo("Dismissal",sl,t)
return(n={})[ul()]={schema:ko([Ko("target")]),onReceive:function(t,n){il.isOpen(t)&&(il.isPartOf(t,n.target)||e.isExtraPart(t,n.target)||e.fireEventInstead.fold((function(){return il.close(t)}),(function(n){return Di(t,n.event)})))}},n},ll=ko([fr("fireEventInstead",[lr("event",wi())]),tr("doReposition")]),dl=function(t){var n,e=Uo("Reposition",ll,t)
return(n={})[al()]={onReceive:function(t){il.isOpen(t)&&e.fireEventInstead.fold((function(){return e.doReposition(t)}),(function(n){return Di(t,n.event)}))}},n},ml=function(t,n,e){n.store.manager.onLoad(t,n,e)},gl=function(t,n,e){n.store.manager.onUnload(t,n,e)},pl=Object.freeze({__proto__:null,onLoad:ml,onUnload:gl,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),hl=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[Gi((function(e,o){ml(e,t,n)})),Xi((function(e,o){gl(e,t,n)}))]:[hc(t,n,ml)]
return Ii(e)}}),vl=function(){var t=xr(null)
return xu({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},bl=function(){var t=xr({}),n=xr({})
return xu({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return bt(t.get(),e).orThunk((function(){return bt(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={}
U(e,(function(t){i[t.value]=t,bt(t,"meta").each((function(n){bt(n,"text").each((function(n){u[n]=t}))}))})),t.set(O(O({},o),i)),n.set(O(O({},r),u))},clear:function(){t.set({}),n.set({})}})},yl=Object.freeze({__proto__:null,memory:vl,dataset:bl,manual:function(){return xu({readState:g})},init:function(t){return t.store.manager.state(t)}}),xl=function(t,n,e,o){var r=n.store
e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},wl=[rr("initialValue"),Ko("getFallbackEntry"),Ko("getDataKey"),Ko("setValue"),Ma("manager",{setValue:xl,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t)
return e.lookup(r).getOrThunk((function(){return o.getFallbackEntry(r)}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){xl(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:bl})],Sl=[Ko("getValue"),lr("setValue",g),rr("initialValue"),Ma("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:g,state:yu.init})],kl=[rr("initialValue"),Ma("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:vl})],Cl=[dr("store",{mode:"memory"},Go("mode",{memory:kl,manual:Sl,dataset:wl})),Ta("onSetValue"),lr("resetOnDom",!1)],Ol=Sc({fields:Cl,name:"representing",active:hl,apis:pl,extra:{setValueFrom:function(t,n){var e=Ol.getValue(n)
Ol.setValue(t,e)}},state:yl}),_l=function(t,n){return yr(t,{},W(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,Xo(e,e,{tag:"option",process:{}},ho((function(t){return $e("The field: "+e+" is forbidden. "+o)})))
var e,o})).concat([qo("dump",v)]))},Tl=function(t){return t.dump},Dl=function(t,n){return O(O({},xc(n)),t.dump)},El=_l,Bl=Dl,Ml="placeholder",Al=wr([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Fl=function(t){return yt(t,"uiType")},Il=function(t,n,e,o){return Fl(e)&&e.uiType===Ml?function(t,n,e,o){return t.exists((function(t){return t!==e.owner}))?Al.single(!0,h(e)):bt(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+st(o)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(t){return t.replace()}))}(t,0,e,o):Al.single(!1,h(e))},Rl=function(t,n,e,o){return Il(t,0,e,o).fold((function(r,i){var u=Fl(e)?i(n,e.config,e.validated):i(n),a=bt(u,"components").getOr([]),c=$(a,(function(e){return Rl(t,n,e,o)}))
return[O(O({},u),{components:c})]}),(function(t,o){if(Fl(e)){var r=o(n,e.config,e.validated)
return e.validated.preprocess.getOr(v)(r)}return o(n)}))},Vl=function(t,n,e,o){var r=dt(o,(function(t,n){return o=t,r=!1,{name:h(e=n),required:function(){return o.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e)
return r=!0,o}}
var e,o,r})),i=function(t,n,e,o){return $(e,(function(e){return Rl(t,n,e,o)}))}(t,n,e,r)
return lt(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),i},Pl=Al.single,Hl=Al.multiple,zl=h(Ml),Nl=wr([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Ll=lr("factory",{sketch:v}),Wl=lr("schema",[]),Ul=Ko("name"),jl=Xo("pname","pname",co((function(t){return"<alloy."+ou(t.name)+">"})),Eo()),Gl=qo("schema",(function(){return[rr("preprocess")]})),Xl=lr("defaults",h({})),ql=lr("overrides",h({})),Yl=Co([Ll,Wl,Ul,jl,Xl,ql]),Kl=Co([Ll,Wl,Ul,Xl,ql]),Jl=Co([Ll,Wl,Ul,jl,Xl,ql]),$l=Co([Ll,Gl,Ul,Ko("unit"),jl,Xl,ql]),Ql=function(t){return t.fold(F.some,F.none,F.some,F.some)},Zl=function(t){var n=function(t){return t.name}
return t.fold(n,n,n,n)},td=function(t,n){return function(e){var o=Uo("Converting part type",n,e)
return t(o)}},nd=td(Nl.required,Yl),ed=td(Nl.external,Kl),od=td(Nl.optional,Jl),rd=td(Nl.group,$l),id=h("entirety"),ud=Object.freeze({__proto__:null,required:nd,external:ed,optional:od,group:rd,asNamedPart:Ql,name:Zl,asCommon:function(t){return t.fold(v,v,v,v)},original:id}),ad=function(t,n,e,o){return uo(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},cd=function(t,n){var e={}
return U(n,(function(n){Ql(n).each((function(n){var o=sd(t,n.pname)
e[n.name]=function(e){var r=Uo("Part: "+n.name+" in "+t,Co(n.schema),e)
return O(O({},o),{config:e,validated:r})}}))})),e},sd=function(t,n){return{uiType:zl(),owner:t,name:n}},fd=function(t,n,e){return{uiType:zl(),owner:t,name:n,config:e,validated:{}}},ld=function(t){return $(t,(function(t){return t.fold(F.none,F.some,F.none,F.none).map((function(t){return nr(t.name,t.schema.concat([Aa(id())]))})).toArray()}))},dd=function(t){return W(t,Zl)},md=function(t,n,e){return function(t,n,e){var o={},r={}
return U(e,(function(t){t.fold((function(t){o[t.pname]=Pl(!0,(function(n,e,o){return t.factory.sketch(ad(n,t,e,o))}))}),(function(t){var e=n.parts[t.name]
r[t.name]=h(t.factory.sketch(ad(n,t,e[id()]),e))}),(function(t){o[t.pname]=Pl(!1,(function(n,e,o){return t.factory.sketch(ad(n,t,e,o))}))}),(function(t){o[t.pname]=Hl(!0,(function(n,e,o){var r=n[t.name]
return W(r,(function(e){return t.factory.sketch(uo(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:h(o),externals:h(r)}}(0,n,e)},gd=function(t,n,e){return Vl(F.some(t),n,n.components,e)},pd=function(t,n,e){var o=n.partUids[e]
return t.getSystem().getByUid(o).toOptional()},hd=function(t,n,e){return pd(t,n,e).getOrDie("Could not find part: "+e)},vd=function(t,n,e){var o={},r=n.partUids,i=t.getSystem()
return U(e,(function(t){o[t]=h(i.getByUid(r[t]))})),o},bd=function(t,n){var e=t.getSystem()
return dt(n.partUids,(function(t,n){return h(e.getByUid(t))}))},yd=function(t){return st(t.partUids)},xd=function(t,n,e){var o={},r=n.partUids,i=t.getSystem()
return U(e,(function(t){o[t]=h(i.getByUid(r[t]).getOrDie())})),o},wd=function(t,n){var e=dd(n)
return Or(W(e,(function(n){return{key:n,value:t+"-"+n}})))},Sd=function(t){return Xo("partUids","partUids",fo((function(n){return wd(n.uid,t)})),Eo())},kd=Object.freeze({__proto__:null,generate:cd,generateOne:fd,schemas:ld,names:dd,substitutes:md,components:gd,defaultUids:wd,defaultUidsSchema:Sd,getAllParts:bd,getAllPartNames:yd,getPart:pd,getPartOrDie:hd,getParts:vd,getPartsOrDie:xd}),Cd=function(t,n,e,o,r){var i=function(t,n){return(t.length>0?[nr("parts",t)]:[]).concat([Ko("uid"),lr("dom",{}),lr("components",[]),Aa("originalSpec"),lr("debug.sketcher",{})]).concat(n)}(o,r)
return Uo(t+" [SpecSchema]",ko(i.concat(n)),e)},Od=function(t,n,e,o,r){var i=_d(r),u=ld(e),a=Sd(e),c=Cd(t,n,i,u,[a]),s=md(0,c,e)
return o(c,gd(t,c,s.internals()),i,s.externals())},_d=function(t){return function(t){return yt(t,"uid")}(t)?t:O(O({},t),{uid:fu("uid")})},Td=ko([Ko("name"),Ko("factory"),Ko("configFields"),lr("apis",{}),lr("extraApis",{})]),Dd=ko([Ko("name"),Ko("factory"),Ko("configFields"),Ko("partFields"),lr("apis",{}),lr("extraApis",{})]),Ed=function(t){var n=Uo("Sketcher for "+t.name,Td,t),e=dt(n.apis,bu),o=dt(n.extraApis,(function(t,n){return pu(t,n)}))
return O(O({name:n.name,configFields:n.configFields,sketch:function(t){return function(t,n,e,o){var r=_d(o)
return e(Cd(t,n,r,[],[]),r)}(n.name,n.configFields,n.factory,t)}},e),o)},Bd=function(t){var n=Uo("Sketcher for "+t.name,Dd,t),e=cd(n.name,n.partFields),o=dt(n.apis,bu),r=dt(n.extraApis,(function(t,n){return pu(t,n)}))
return O(O({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Od(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},Md=function(t){return"input"===Rt(t)&&"radio"!==Gn(t,"type")||"textarea"===Rt(t)},Ad=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),Fd=[Ko("find")],Id=Sc({fields:Fd,name:"composing",apis:Ad}),Rd=["input","button","textarea","select"],Vd=function(t,n,e){(n.disabled()?Wd:Ud)(t,n)},Pd=function(t,n){return!0===n.useNative&&H(Rd,Rt(t.element))},Hd=function(t){jn(t.element,"disabled","disabled")},zd=function(t){Yn(t.element,"disabled")},Nd=function(t){jn(t.element,"aria-disabled","true")},Ld=function(t){jn(t.element,"aria-disabled","false")},Wd=function(t,n,e){n.disableClass.each((function(n){Vu(t.element,n)})),(Pd(t,n)?Hd:Nd)(t),n.onDisabled(t)},Ud=function(t,n,e){n.disableClass.each((function(n){Hu(t.element,n)})),(Pd(t,n)?zd:Ld)(t),n.onEnabled(t)},jd=function(t,n){return Pd(t,n)?function(t){return qn(t.element,"disabled")}(t):function(t){return"true"===Gn(t.element,"aria-disabled")}(t)},Gd=Object.freeze({__proto__:null,enable:Ud,disable:Wd,isDisabled:jd,onLoad:Vd,set:function(t,n,e,o){(o?Wd:Ud)(t,n)}}),Xd=Object.freeze({__proto__:null,exhibit:function(t,n){return Su({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return Ii([Ri(ai(),(function(n,e){return jd(n,t)})),hc(t,n,Vd)])}}),qd=[vr("disabled",S),lr("useNative",!0),rr("disableClass"),Ta("onDisabled"),Ta("onEnabled")],Yd=Sc({fields:qd,name:"disabling",active:Xd,apis:Gd}),Kd=function(t,n,e,o){var r=of(t.element,"."+n.highlightClass)
U(r,(function(e){z(o,(function(t){return t.element===e}))||(Hu(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Di(e,Ti())})))}))},Jd=function(t,n,e,o){Kd(t,n,0,[o]),$d(t,n,e,o)||(Vu(o.element,n.highlightClass),n.onHighlight(t,o),Di(o,_i()))},$d=function(t,n,e,o){return zu(o.element,n.highlightClass)},Qd=function(t,n,e,o){var r=of(t.element,"."+n.itemClass)
return F.from(r[o]).fold((function(){return Ue.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)},Zd=function(t,n,e){return sa(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},tm=function(t,n,e){var o=of(t.element,"."+n.itemClass)
return(o.length>0?F.some(o[o.length-1]):F.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},nm=function(t,n,e,o){var r=of(t.element,"."+n.itemClass)
return K(r,(function(t){return zu(t,n.highlightClass)})).bind((function(n){var e=ja(n,o,0,r.length-1)
return t.getSystem().getByDom(r[e]).toOptional()}))},em=function(t,n,e){var o=of(t.element,"."+n.itemClass)
return St(W(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},om=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return Kd(t,n,0,[])},dehighlight:function(t,n,e,o){$d(t,n,e,o)&&(Hu(o.element,n.highlightClass),n.onDehighlight(t,o),Di(o,Ti()))},highlight:Jd,highlightFirst:function(t,n,e){Zd(t,n).each((function(o){Jd(t,n,e,o)}))},highlightLast:function(t,n,e){tm(t,n).each((function(o){Jd(t,n,e,o)}))},highlightAt:function(t,n,e,o){Qd(t,n,e,o).fold((function(t){throw t}),(function(o){Jd(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=em(t,n)
Y(r,o).each((function(o){Jd(t,n,e,o)}))},isHighlighted:$d,getHighlighted:function(t,n,e){return sa(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:Zd,getLast:tm,getPrevious:function(t,n,e){return nm(t,n,0,-1)},getNext:function(t,n,e){return nm(t,n,0,1)},getCandidates:em}),rm=[Ko("highlightClass"),Ko("itemClass"),Ta("onHighlight"),Ta("onDehighlight")],im=Sc({fields:rm,name:"highlighting",apis:om}),um=[8],am=[9],cm=[13],sm=[27],fm=[32],lm=[37],dm=[38],mm=[39],gm=[40],pm=function(t,n,e){var o=Z(t.slice(0,n)),r=Z(t.slice(n+1))
return Y(o.concat(r),e)},hm=function(t,n,e){var o=Z(t.slice(0,n))
return Y(o,e)},vm=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1)
return Y(r.concat(o),e)},bm=function(t,n,e){var o=t.slice(n+1)
return Y(o,e)},ym=function(t){return function(n){var e=n.raw
return H(t,e.which)}},xm=function(t){return function(n){return Q(t,(function(t){return t(n)}))}},wm=function(t){return!0===t.raw.shiftKey},Sm=function(t){return!0===t.raw.ctrlKey},km=x(wm),Cm=function(t,n){return{matches:t,classification:n}},Om=function(t,n,e){n.exists((function(t){return e.exists((function(n){return yn(n,t)}))}))||Ei(t,Si(),{prevFocus:n,newFocus:e})},_m=function(){var t=function(t){return Ac(t.element)}
return{get:t,set:function(n,e){var o=t(n)
n.getSystem().triggerFocus(e,n.element)
var r=t(n)
Om(n,o,r)}}},Tm=function(){var t=function(t){return im.getHighlighted(t).map((function(t){return t.element}))}
return{get:t,set:function(n,e){var o=t(n)
n.getSystem().getByDom(e).fold(g,(function(t){im.highlight(n,t)}))
var r=t(n)
Om(n,o,r)}}};(function(t){t.OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi"})($s||($s={}))
var Dm,Em=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u,a=e(t,n,o,r)
return(i=a,u=n.event,Y(i,(function(t){return t.matches(u)})).map((function(t){return t.classification}))).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([lr("focusManager",_m()),dr("focusInside","onFocus",zo((function(t){return H(["onFocus","onEnterOrSpace","onApi"],t)?Ue.value(t):Ue.error("Invalid value for focusInside")}))),Ma("handler",u),Ma("state",n),Ma("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==$s.OnFocusMode?F.none():r(t).map((function(e){return Pi(oi(),(function(o,r){e(o,t,n),r.stop()}))})),a=[Pi(Xr(),(function(o,u){i(o,u,e,t,n).fold((function(){(function(e,o){var i=ym(fm.concat(cm))(o.event)
t.focusInside===$s.OnEnterOrSpaceMode&&i&&Br(e,o)&&r(t).each((function(r){r(e,t,n),o.stop()}))})(o,u)}),(function(t){u.stop()}))})),Pi(qr(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))]
return Ii(u.toArray().concat(a))}}
return u},Bm=function(t){var n=[rr("onEscape"),rr("onEnter"),lr("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),lr("firstTabstop",0),lr("useTabstopAt",k),rr("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return fa(n,t)})).getOr(n)
return se(e)>0},o=function(t,n,o){(function(t,n){var o=of(t.element,n.selector),r=G(o,(function(t){return e(n,t)}))
return F.from(r[n.firstTabstop])})(t,n).each((function(e){n.focusManager.set(t,e)}))},r=function(t,n,o,r,i){return i(n,o,(function(t){return function(t,n){return e(t,n)&&t.useTabstopAt(n)}(r,t)})).fold((function(){return r.cyclic?F.some(!0):F.none()}),(function(n){return r.focusManager.set(t,n),F.some(!0)}))},i=function(t,n,e,o){var i=of(t.element,e.selector)
return function(t,n){return n.focusManager.get(t).bind((function(t){return fa(t,n.selector)}))}(t,e).bind((function(n){return K(i,y(yn,n)).bind((function(n){return r(t,i,n,e,o)}))}))},u=h([Cm(xm([wm,ym(am)]),(function(t,n,e){var o=e.cyclic?pm:hm
return i(t,0,e,o)})),Cm(ym(am),(function(t,n,e){var o=e.cyclic?vm:bm
return i(t,0,e,o)})),Cm(ym(sm),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),Cm(xm([km,ym(cm)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),a=h([])
return Em(n,yu.init,u,a,(function(){return F.some(o)}))},Mm=Bm(qo("cyclic",S)),Am=Bm(qo("cyclic",k)),Fm=function(t,n,e){return Md(e)&&ym(fm)(n.event)?F.none():function(t,n,e){return Mi(t,e,ai()),F.some(!0)}(t,0,e)},Im=function(t,n){return F.some(!0)},Rm=[lr("execute",Fm),lr("useSpace",!1),lr("useEnter",!0),lr("useControlEnter",!1),lr("useDown",!1)],Vm=function(t,n,e){return e.execute(t,n,t.element)},Pm=Em(Rm,yu.init,(function(t,n,e,o){var r=e.useSpace&&!Md(t.element)?fm:[],i=e.useEnter?cm:[],u=e.useDown?gm:[],a=r.concat(i).concat(u)
return[Cm(ym(a),Vm)].concat(e.useControlEnter?[Cm(xm([Sm,ym(cm)]),Vm)]:[])}),(function(t,n,e,o){return e.useSpace&&!Md(t.element)?[Cm(ym(fm),Im)]:[]}),(function(){return F.none()})),Hm=function(){var t=Qc()
return xu({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set({numRows:n,numColumns:e})},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},zm=Object.freeze({__proto__:null,flatgrid:Hm,init:function(t){return t.state(t)}}),Nm=function(t){return function(n,e,o,r){var i=t(n.element)
return jm(i,n,e,o,r)}},Lm=function(t,n){var e=xs(t,n)
return Nm(e)},Wm=function(t,n){var e=xs(n,t)
return Nm(e)},Um=function(t){return function(n,e,o,r){return jm(t,n,e,o,r)}},jm=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},Gm=Um,Xm=Um,qm=Um,Ym=function(t){return!function(t){return t.offsetWidth<=0&&t.offsetHeight<=0}(t.dom)},Km=function(t,n,e){var o=of(t,e)
return function(t,n){return K(t,n).map((function(n){return{index:n,candidates:t}}))}(G(o,Ym),(function(t){return yn(t,n)}))},Jm=function(t,n){return K(t,(function(t){return yn(n,t)}))},$m=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column
return o>=0&&o<t.length?F.some(t[o]):F.none()}))},Qm=function(t,n,e,o,r){return $m(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=ja(i,r,0,u-1)
return F.some({row:n,column:a})}))},Zm=function(t,n,e,o,r){return $m(t,n,o,(function(n,i){var u=ja(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Ga(i,0,a-1)
return F.some({row:u,column:c})}))},tg=[Ko("selector"),lr("execute",Fm),Da("onEscape"),lr("captureTab",!1),Fa()],ng=function(t,n,e){sa(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},eg=function(t){return function(n,e,o,r){return Km(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},og=function(t,n,e){return e.captureTab?F.some(!0):F.none()},rg=eg((function(t,n,e,o){return Qm(t,n,e,o,-1)})),ig=eg((function(t,n,e,o){return Qm(t,n,e,o,1)})),ug=eg((function(t,n,e,o){return Zm(t,n,e,o,-1)})),ag=eg((function(t,n,e,o){return Zm(t,n,e,o,1)})),cg=h([Cm(ym(lm),Lm(rg,ig)),Cm(ym(mm),Wm(rg,ig)),Cm(ym(dm),Gm(ug)),Cm(ym(gm),Xm(ag)),Cm(xm([wm,ym(am)]),og),Cm(xm([km,ym(am)]),og),Cm(ym(sm),(function(t,n,e){return e.onEscape(t,n)})),Cm(ym(fm.concat(cm)),(function(t,n,e,o){return function(t,n){return n.focusManager.get(t).bind((function(t){return fa(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))}))]),sg=h([Cm(ym(fm),Im)]),fg=Em(tg,Hm,cg,sg,(function(){return F.some(ng)})),lg=function(t,n,e,o){var r=function(t,n,e){var i,u=ja(n,o,0,e.length-1)
return u===t?F.none():(i=e[u],"button"===Rt(i)&&"disabled"===Gn(i,"disabled")?r(t,u,e):F.from(e[u]))}
return Km(t,e,n).bind((function(t){var n=t.index,e=t.candidates
return r(n,n,e)}))},dg=[Ko("selector"),lr("getInitial",F.none),lr("execute",Fm),Da("onEscape"),lr("executeOnMove",!1),lr("allowVertical",!0)],mg=function(t,n,e){return function(t,n){return n.focusManager.get(t).bind((function(t){return fa(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))},gg=function(t,n,e){n.getInitial(t).orThunk((function(){return sa(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},pg=function(t,n,e){return lg(t,e.selector,n,-1)},hg=function(t,n,e){return lg(t,e.selector,n,1)},vg=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?mg(n,e,o):F.some(!0)}))}},bg=function(t,n,e){return e.onEscape(t,n)},yg=h([Cm(ym(fm),Im)]),xg=Em(dg,yu.init,(function(t,n,e,o){var r=lm.concat(e.allowVertical?dm:[]),i=mm.concat(e.allowVertical?gm:[])
return[Cm(ym(r),vg(Lm(pg,hg))),Cm(ym(i),vg(Wm(pg,hg))),Cm(ym(cm),mg),Cm(ym(fm),mg),Cm(ym(sm),bg)]}),yg,(function(){return F.some(gg)})),wg=function(t,n,e){return F.from(t[n]).bind((function(t){return F.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},Sg=function(t,n,e,o){var r=t[n].length,i=ja(e,o,0,r-1)
return wg(t,n,i)},kg=function(t,n,e,o){var r=ja(e,o,0,t.length-1),i=t[r].length,u=Ga(n,0,i-1)
return wg(t,r,u)},Cg=function(t,n,e,o){var r=t[n].length,i=Ga(e+o,0,r-1)
return wg(t,n,i)},Og=function(t,n,e,o){var r=Ga(e+o,0,t.length-1),i=t[r].length,u=Ga(n,0,i-1)
return wg(t,r,u)},_g=[nr("selectors",[Ko("row"),Ko("cell")]),lr("cycles",!0),lr("previousSelector",F.none),lr("execute",Fm)],Tg=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors
return sa(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},Dg=function(t,n){return function(e,o,r){var i=r.cycles?t:n
return fa(o,r.selectors.row).bind((function(t){var n=of(t,r.selectors.cell)
return Jm(n,o).bind((function(n){var o=of(e,r.selectors.row)
return Jm(o,t).bind((function(t){var e=function(t,n){return W(t,(function(t){return of(t,n.selectors.cell)}))}(o,r)
return i(e,t,n).map((function(t){return t.cell}))}))}))}))}},Eg=Dg((function(t,n,e){return Sg(t,n,e,-1)}),(function(t,n,e){return Cg(t,n,e,-1)})),Bg=Dg((function(t,n,e){return Sg(t,n,e,1)}),(function(t,n,e){return Cg(t,n,e,1)})),Mg=Dg((function(t,n,e){return kg(t,e,n,-1)}),(function(t,n,e){return Og(t,e,n,-1)})),Ag=Dg((function(t,n,e){return kg(t,e,n,1)}),(function(t,n,e){return Og(t,e,n,1)})),Fg=h([Cm(ym(lm),Lm(Eg,Bg)),Cm(ym(mm),Wm(Eg,Bg)),Cm(ym(dm),Gm(Mg)),Cm(ym(gm),Xm(Ag)),Cm(ym(fm.concat(cm)),(function(t,n,e){return Ac(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),Ig=h([Cm(ym(fm),Im)]),Rg=Em(_g,yu.init,Fg,Ig,(function(){return F.some(Tg)})),Vg=[Ko("selector"),lr("execute",Fm),lr("moveOnTab",!1)],Pg=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},Hg=function(t,n,e){sa(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},zg=function(t,n,e){return lg(t,e.selector,n,-1)},Ng=function(t,n,e){return lg(t,e.selector,n,1)},Lg=h([Cm(ym(dm),qm(zg)),Cm(ym(gm),qm(Ng)),Cm(xm([wm,ym(am)]),(function(t,n,e,o){return e.moveOnTab?qm(zg)(t,n,e,o):F.none()})),Cm(xm([km,ym(am)]),(function(t,n,e,o){return e.moveOnTab?qm(Ng)(t,n,e,o):F.none()})),Cm(ym(cm),Pg),Cm(ym(fm),Pg)]),Wg=h([Cm(ym(fm),Im)]),Ug=Em(Vg,yu.init,Lg,Wg,(function(){return F.some(Hg)})),jg=[Da("onSpace"),Da("onEnter"),Da("onShiftEnter"),Da("onLeft"),Da("onRight"),Da("onTab"),Da("onShiftTab"),Da("onUp"),Da("onDown"),Da("onEscape"),lr("stopSpaceKeyup",!1),rr("focusIn")],Gg=Em(jg,yu.init,(function(t,n,e){return[Cm(ym(fm),e.onSpace),Cm(xm([km,ym(cm)]),e.onEnter),Cm(xm([wm,ym(cm)]),e.onShiftEnter),Cm(xm([wm,ym(am)]),e.onShiftTab),Cm(xm([km,ym(am)]),e.onTab),Cm(ym(dm),e.onUp),Cm(ym(gm),e.onDown),Cm(ym(lm),e.onLeft),Cm(ym(mm),e.onRight),Cm(ym(fm),e.onSpace),Cm(ym(sm),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[Cm(ym(fm),Im)]:[]}),(function(t){return t.focusIn})),Xg=Mm.schema(),qg=Am.schema(),Yg=xg.schema(),Kg=fg.schema(),Jg=Rg.schema(),$g=Pm.schema(),Qg=Ug.schema(),Zg=Gg.schema(),tp=Cc({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Xg,cyclic:qg,flow:Yg,flatgrid:Kg,matrix:Jg,execution:$g,menu:Qg,special:Zg}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){!function(t){return xt(t,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(o,r)}},state:zm}),np=function(t,n,e,o){var r=t.getSystem().build(o)
Uf(t,r,e)},ep=function(t,n,e,o){var r=op(t)
Y(r,(function(t){return yn(o.element,t.element)})).each(Gf)},op=function(t,n){return t.components()},rp=function(t,n,e,o,r){var i=op(t)
return F.from(i[o]).map((function(n){return ep(t,0,0,n),r.each((function(n){np(t,0,(function(t,n){(function(t,n,e){En(t,e).fold((function(){Oe(t,n)}),(function(t){Se(t,n)}))})(t,n,o)}),n)})),n}))},ip=Sc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){np(t,0,Oe,o)},prepend:function(t,n,e,o){np(t,0,Ce,o)},remove:ep,replaceAt:rp,replaceBy:function(t,n,e,o,r){var i=op(t)
return K(i,o).bind((function(n){return rp(t,0,0,n,r)}))},set:function(t,n,e,o){Fc((function(){var n=W(o,t.getSystem().build)
Lf(t,n)}),t.element)},contents:op})}),up=function(t,n){return{key:t,value:{config:{},me:function(t,n){var e=Ii(n)
return Sc({fields:[Ko("enabled")],name:t,active:{events:h(e)}})}(t,n),configAsRaw:h({}),initialConfig:{},state:yu}}},ap=function(t,n){n.ignore||(Ec(t.element),n.onFocus(t))},cp=Object.freeze({__proto__:null,focus:ap,blur:function(t,n){n.ignore||function(t){t.dom.blur()}(t.element)},isFocused:function(t){return Bc(t.element)}}),sp=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}}
return Su(e)},events:function(t){return Ii([Pi(oi(),(function(n,e){ap(n,t),e.stop()}))].concat(t.stopMousedown?[Pi(zr(),(function(t,n){n.event.prevent()}))]:[]))}}),fp=[Ta("onFocus"),lr("stopMousedown",!1),lr("ignore",!1)],lp=Sc({fields:fp,name:"focusing",active:sp,apis:cp}),dp=function(t,n,e){var o=n.aria
o.update(t,o,e.get())},mp=function(t,n,e){n.toggleClass.each((function(n){e.get()?Vu(t.element,n):Hu(t.element,n)}))},gp=function(t,n,e){vp(t,n,e,!e.get())},pp=function(t,n,e){e.set(!0),mp(t,n,e),dp(t,n,e)},hp=function(t,n,e){e.set(!1),mp(t,n,e),dp(t,n,e)},vp=function(t,n,e,o){(o?pp:hp)(t,n,e)},bp=function(t,n,e){vp(t,n,e,n.selected)},yp=Object.freeze({__proto__:null,onLoad:bp,toggle:gp,isOn:function(t,n,e){return e.get()},on:pp,off:hp,set:vp}),xp=Object.freeze({__proto__:null,exhibit:function(){return Su({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=gp,Yi((function(t){r(t,e,o)}))),u=hc(t,n,bp)
return Ii(J([t.toggleOnExecute?[i]:[],[u]]))}}),wp=function(t,n,e){jn(t.element,"aria-expanded",e)},Sp=[lr("selected",!1),rr("toggleClass"),lr("toggleOnExecute",!0),dr("aria",{mode:"none"},Go("mode",{pressed:[lr("syncWithExpanded",!1),Ma("update",(function(t,n,e){jn(t.element,"aria-pressed",e),n.syncWithExpanded&&wp(t,n,e)}))],checked:[Ma("update",(function(t,n,e){jn(t.element,"aria-checked",e)}))],expanded:[Ma("update",wp)],selected:[Ma("update",(function(t,n,e){jn(t.element,"aria-selected",e)}))],none:[Ma("update",g)]}))],kp=Sc({fields:Sp,name:"toggling",active:xp,apis:yp,state:(Dm=!1,{init:function(){var t=xr(Dm)
return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(Dm)},readState:function(){return t.get()}}}})}),Cp=function(){var t=function(t,n){n.stop(),Bi(t)}
return[Pi(Jr(),t),Pi(si(),t),Wi(Rr()),Wi(zr())]},Op=function(t){return Ii(J([t.map((function(t){return Yi((function(n,e){t(n),e.stop()}))})).toArray(),Cp()]))},_p="alloy.item-hover",Tp="alloy.item-focus",Dp=function(t){(Ac(t.element).isNone()||lp.isFocused(t))&&(lp.isFocused(t)||lp.focus(t),Ei(t,_p,{item:t}))},Ep=function(t){Ei(t,Tp,{item:t})},Bp=h(_p),Mp=h(Tp),Ap=[Ko("data"),Ko("components"),Ko("dom"),lr("hasSubmenu",!1),rr("toggling"),El("itemBehaviours",[kp,lp,tp,Ol]),lr("ignoreFocus",!1),lr("domModification",{}),Ma("builder",(function(t){return{dom:t.dom,domModification:O(O({},t.domModification),{attributes:O(O(O({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Bl(t.itemBehaviours,[t.toggling.fold(kp.revoke,(function(t){return kp.config(O({aria:{mode:"checked"}},t))})),lp.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Ep(t)}}),tp.config({mode:"execution"}),Ol.config({store:{mode:"memory",initialValue:t.data}}),up("item-type-events",T(T([],Cp(),!0),[Pi(Ur(),Dp),Pi(ci(),lp.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}})),lr("eventOrder",{})],Fp=[Ko("dom"),Ko("components"),Ma("builder",(function(t){return{dom:t.dom,components:t.components,events:Ii([Ui(ci())])}}))],Ip=h("item-widget"),Rp=h([nd({name:"widget",overrides:function(t){return{behaviours:xc([Ol.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:g}})])}}})]),Vp=[Ko("uid"),Ko("data"),Ko("components"),Ko("dom"),lr("autofocus",!1),lr("ignoreFocus",!1),El("widgetBehaviours",[Ol,lp,tp]),lr("domModification",{}),Sd(Rp()),Ma("builder",(function(t){var n=md(Ip(),t,Rp()),e=gd(Ip(),t,n.internals()),o=function(n){return pd(n,t,"widget").map((function(t){return tp.focusIn(t),t}))},r=function(n,e){return Md(e.event.target)?F.none():t.autofocus?(e.setSource(n.element),F.none()):F.none()}
return{dom:t.dom,components:e,domModification:t.domModification,events:Ii([Yi((function(t,n){o(t).each((function(t){n.stop()}))})),Pi(Ur(),Dp),Pi(ci(),(function(n,e){t.autofocus?o(n):lp.focus(n)}))]),behaviours:Bl(t.widgetBehaviours,[Ol.config({store:{mode:"memory",initialValue:t.data}}),lp.config({ignore:t.ignoreFocus,onFocus:function(t){Ep(t)}}),tp.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:Oc(),onLeft:r,onRight:r,onEscape:function(n,e){return lp.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element),F.none()):F.none():(lp.focus(n),F.some(!0))}})])}}))],Pp=Go("type",{widget:Vp,item:Ap,separator:Fp}),Hp=h([rd({factory:{sketch:function(t){var n=Uo("menu.spec item",Pp,t)
return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return yt(n,"uid")?n:O(O({},n),{uid:fu("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),zp=h([Ko("value"),Ko("items"),Ko("dom"),Ko("components"),lr("eventOrder",{}),_l("menuBehaviours",[im,Ol,Id,tp]),dr("movement",{mode:"menu",moveOnTab:!0},Go("mode",{grid:[Fa(),Ma("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[Ma("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Ko("rowSelector")],menu:[lr("moveOnTab",!0),Ma("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Jo("markers",Sa()),lr("fakeFocus",!1),lr("focusManager",_m()),Ta("onHighlight")]),Np=h("alloy.menu-focus"),Lp=Bd({name:"Menu",configFields:zp(),partFields:Hp(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Dl(t.menuBehaviours,[im.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Ol.config({store:{mode:"memory",initialValue:t.value}}),Id.config({find:F.some}),tp.config(t.movement.config(t,t.movement))]),events:Ii([Pi(Mp(),(function(t,n){var e=n.event
t.getSystem().getByDom(e.target).each((function(e){im.highlight(t,e),n.stop(),Ei(t,Np(),{menu:t,item:e})}))})),Pi(Bp(),(function(t,n){var e=n.event.item
im.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Wp=function(t,n,e,o){return bt(e,o).bind((function(o){return bt(t,o).bind((function(o){var r=Wp(t,n,e,o)
return F.some([o].concat(r))}))})).getOr([])},Up=function(t,n){var e={}
lt(t,(function(t,n){U(t,(function(t){e[t]=n}))}))
var o=n,r=mt(n,(function(t,n){return{k:t,v:n}})),i=dt(r,(function(t,n){return[n].concat(Wp(e,o,r,n))}))
return dt(e,(function(t){return bt(i,t).getOr([t])}))},jp=function(t){return"prepared"===t.type?F.some(t.menu):F.none()},Gp={init:function(){var t=xr({}),n=xr({}),e=xr({}),o=Qc(),r=xr({}),i=function(n,e,o){return u(n).bind((function(r){return function(n){return ht(t.get(),(function(t,e){return t===n}))}(n).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}))}))},u=function(t){return a(t).bind(jp)},a=function(t){return bt(n.get(),t)},c=function(n){return bt(t.get(),n)}
return{setMenuBuilt:function(t,e){var o
n.set(O(O({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(i),t.set(a),n.set(u),r.set(c)
var s=Up(c,a)
e.set(s)},expand:function(n){return bt(t.get(),n).map((function(t){var o=bt(e.get(),n).getOr([])
return[t].concat(o)}))},refresh:function(t){return bt(e.get(),t)},collapse:function(t){return bt(e.get(),t).bind((function(t){return t.length>1?F.some(t.slice(1)):F.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get()
return tt(st(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.clear()},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=G(c(t).toArray(),(function(t){return u(t).isSome()}))
return bt(e.get(),t).bind((function(t){var e=Z(r.concat(t))
return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e]
if(!o.isSome())return F.none()
n.push(o.getOrDie())}return F.some(n)}($(e,(function(t,r){return i(t,n,e.slice(0,r+1)).fold((function(){return wt(o.get(),t)?[]:[F.none()]}),(function(t){return[F.some(t)]}))})))}))}}},extractPreparedMenu:jp},Xp=h("collapse-item"),qp=Ed({name:"TieredMenu",configFields:[Ba("onExecute"),Ba("onEscape"),Ea("onOpenMenu"),Ea("onOpenSubmenu"),Ta("onRepositionMenu"),Ta("onCollapseMenu"),lr("highlightImmediately",!0),nr("data",[Ko("primary"),Ko("menus"),Ko("expansions")]),lr("fakeFocus",!1),Ta("onHighlight"),Ta("onHover"),Ca(),Ko("dom"),lr("navigateOnHover",!0),lr("stayInDom",!1),_l("tmenuBehaviours",[tp,im,Id,ip]),lr("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o=Qc(),r=Gp.init(),i=function(n){var e=function(n,e,o){return dt(o,(function(o,r){var i=function(){return Lp.sketch(O(O({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Tm():_m()}))}
return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))}(n,t.data.primary,t.data.menus),o=a()
return r.setContents(t.data.primary,e,t.data.expansions,o),r.getPrimary()},u=function(t){return Ol.getValue(t).value},a=function(n){return dt(t.data.menus,(function(t,n){return $(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},c=function(t,n){im.highlight(t,n),im.getHighlighted(n).orThunk((function(){return im.getFirst(n)})).each((function(n){Mi(t,n.element,ci())}))},s=function(t,n){return St(W(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?F.some(t.menu):F.none()}))})))},f=function(n,e,o){var r=s(e,e.otherMenus(o))
U(r,(function(e){Lu(e.element,[t.markers.backgroundMenu]),t.stayInDom||ip.remove(n,e)}))},l=function(n,e){var r=function(n){return o.get().getOrThunk((function(){var e={},r=of(n.element,"."+t.markers.item),i=G(r,(function(t){return"true"===Gn(t,"aria-haspopup")}))
return U(i,(function(t){n.getSystem().getByDom(t).each((function(t){var n=u(t)
e[n]=t}))})),o.set(e),e}))}(n)
lt(r,(function(t,n){var o=H(e,n)
jn(t.element,"aria-expanded",o)}))},d=function(n,e,o){return F.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return F.none()
var i=r.menu,u=s(e,o.slice(1))
return U(u,(function(n){Vu(n.element,t.markers.backgroundMenu)})),Nn(i.element)||ip.append(n,na(i)),Lu(i.element,[t.markers.backgroundMenu]),c(n,i),f(n,e,o),F.some(i)}))}))};(function(t){t[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent"})(e||(e={}))
var m=function(n,o,i){if(void 0===i&&(i=e.HighlightSubmenu),o.hasConfigured(Yd)&&Yd.isDisabled(o))return F.some(o)
var a=u(o)
return r.expand(a).bind((function(u){return l(n,u),F.from(u[0]).bind((function(a){return r.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"===e.type){var o=t.getSystem().build(e.nbMenu())
return r.setMenuBuilt(n,o),o}return e.menu}(n,a,c)
return Nn(s.element)||ip.append(n,na(s)),t.onOpenSubmenu(n,o,s,Z(u)),i===e.HighlightSubmenu?(im.highlightFirst(s),d(n,r,u)):(im.dehighlightAll(s),F.some(o))}))}))}))},p=function(n,e){var o=u(e)
return r.collapse(o).bind((function(o){return l(n,o),d(n,r,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},h=function(n){return function(e,o){return fa(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(k)}))}))}},v=Ii([Pi(Np(),(function(t,n){var e=n.event.item
r.lookupItem(u(e)).each((function(){var e=n.event.menu
im.highlight(t,e)
var o=u(n.event.item)
r.refresh(o).each((function(n){return f(t,r,n)}))}))})),Yi((function(n,o){var r=o.event.target
n.getSystem().getByDom(r).each((function(o){0===u(o).indexOf("collapse-item")&&p(n,o),m(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),g)}))})),Gi((function(n,e){i(n).each((function(e){ip.append(n,na(e)),t.onOpenMenu(n,e),t.highlightImmediately&&c(n,e)}))}))].concat(t.navigateOnHover?[Pi(Bp(),(function(n,o){var i=o.event.item;(function(t,n){var e=u(n)
r.refresh(e).bind((function(n){return l(t,n),d(t,r,n)}))})(n,i),m(n,i,e.HighlightParent),t.onHover(n,i)}))]:[])),b=function(t){return im.getHighlighted(t).bind(im.getHighlighted)},y={collapseMenu:function(t){b(t).each((function(n){p(t,n)}))},highlightPrimary:function(t){r.getPrimary().each((function(n){c(t,n)}))},repositionMenus:function(n){r.getPrimary().bind((function(t){return b(n).bind((function(t){var n=u(t),e=vt(r.getMenus()),o=St(W(e,Gp.extractPreparedMenu))
return r.getTriggeringPath(n,(function(t){return function(t,n,e){return ct(n,(function(t){if(!t.getSystem().isConnected())return F.none()
var n=im.getCandidates(t)
return Y(n,(function(t){return u(t)===e}))}))}(0,o,t)}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){(function(t){return F.from(t.components()[0]).filter((function(t){return"menu"===Gn(t.element,"role")}))})(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath
t.onRepositionMenu(n,o,r)}))}}
return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Dl(t.tmenuBehaviours,[tp.config({mode:"special",onRight:h((function(t,n){return Md(n.element)?F.none():m(t,n,e.HighlightSubmenu)})),onLeft:h((function(t,n){return Md(n.element)?F.none():p(t,n)})),onEscape:h((function(n,e){return p(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){r.getPrimary().each((function(n){Mi(t,n.element,ci())}))}}),im.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),Id.config({find:function(t){return im.getHighlighted(t)}}),ip.config({})]),eventOrder:t.eventOrder,apis:y,events:v}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Cr(t,n),expansions:{}}},collapseItem:function(t){return{value:ou(Xp()),meta:{text:t}}}}}),Yp=Ed({name:"InlineView",configFields:[Ko("lazySink"),Ta("onShow"),Ta("onHide"),cr("onEscape"),_l("inlineBehaviours",[il,Ol,_c]),fr("fireDismissalEventInstead",[lr("event",xi())]),fr("fireRepositionEventInstead",[lr("event",wi())]),lr("getRelated",F.none),lr("isExtraPart",S),lr("eventOrder",F.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map((function(t){return He(t)}))}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie()
il.openWhileCloaked(n,e,(function(){return Pf.positionWithinBounds(i,n,o,r())})),Ol.setValue(n,F.some({mode:"position",config:o,getBounds:r}))},r=function(n,e,o,r){var i=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return dc()},onRtl:function(){return mc()}}}:{},a=function(t){return function(t){return 2===t.length}(t)?u:{}}
return qp.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return il.close(n),t.onEscape.map((function(t){return t(n)})),F.some(!0)},onExecute:function(){return F.some(!0)},onOpenMenu:function(t,n){Pf.positionWithinBounds(i().getOrDie(),n,e,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie()
Pf.position(r,e,{anchor:O({type:"submenu",item:n},a(o))})},onRepositionMenu:function(t,n,o){var u=i().getOrDie()
Pf.positionWithinBounds(u,n,e,r()),U(o,(function(t){var n=a(t.triggeringPath)
Pf.position(u,t.triggeredMenu,{anchor:O({type:"submenu",item:t.triggeringItem},n)})}))}})}(t,n,e,o,r)
il.open(n,i),Ol.setValue(n,F.some({mode:"menu",menu:i}))},i=function(n){il.isOpen(n)&&Ol.getValue(n).each((function(e){switch(e.mode){case"menu":il.getState(n).each(qp.repositionMenus)
break
case"position":var o=t.lazySink(n).getOrDie()
Pf.positionWithinBounds(o,n,e.config,e.getBounds())}}))},u={setContent:function(t,n){il.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,F.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,F.none)},showMenuWithinBounds:r,hide:function(t){il.isOpen(t)&&(Ol.setValue(t,F.none()),il.close(t))},getContent:function(t){return il.getState(t)},reposition:i,isOpen:il.isOpen}
return{uid:t.uid,dom:t.dom,behaviours:Dl(t.inlineBehaviours,[il.config({isPartOf:function(n,e,o){return ma(e,o)||function(n,e){return t.getRelated(n).exists((function(t){return ma(t,e)}))}(n,o)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),Ol.config({store:{mode:"memory",initialValue:F.none()}}),_c.config({channels:O(O({},fl(O({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),dl(O(O({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),Kp="layout-inset",Jp=function(t){return t.x},$p=function(t,n){return t.x+t.width/2-n.width/2},Qp=function(t,n){return t.x+t.width-n.width},Zp=function(t){return t.y},th=function(t,n){return t.y+t.height-n.height},nh=function(t,n){return t.y+t.height/2-n.height/2},eh=function(t,n,e){return Ia(Qp(t,n),th(t,n),e.insetSouthwest(),za(),"southwest",Xa(t,{right:0,bottom:3}),Kp)},oh=function(t,n,e){return Ia(Jp(t),th(t,n),e.insetSoutheast(),Ha(),"southeast",Xa(t,{left:1,bottom:3}),Kp)},rh=function(t,n,e){return Ia(Qp(t,n),Zp(t),e.insetNorthwest(),Pa(),"northwest",Xa(t,{right:0,top:2}),Kp)},ih=function(t,n,e){return Ia(Jp(t),Zp(t),e.insetNortheast(),Va(),"northeast",Xa(t,{left:1,top:2}),Kp)},uh=function(t,n,e){return Ia($p(t,n),Zp(t),e.insetNorth(),Na(),"north",Xa(t,{top:2}),Kp)},ah=function(t,n,e){return Ia($p(t,n),th(t,n),e.insetSouth(),La(),"south",Xa(t,{bottom:3}),Kp)},ch=function(t,n,e){return Ia(Qp(t,n),nh(t,n),e.insetEast(),Ua(),"east",Xa(t,{right:0}),Kp)},sh=function(t,n,e){return Ia(Jp(t),nh(t,n),e.insetWest(),Wa(),"west",Xa(t,{left:1}),Kp)},fh=function(t){switch(t){case"north":return uh
case"northeast":return ih
case"northwest":return rh
case"south":return ah
case"southeast":return oh
case"southwest":return eh
case"east":return ch
case"west":return sh}},lh=function(t,n,e,o,r){return qc(o).map(fh).getOr(uh)(t,n,e,o,r)},dh=function(t){switch(t){case"north":return ah
case"northeast":return oh
case"northwest":return eh
case"south":return uh
case"southeast":return ih
case"southwest":return rh
case"east":return sh
case"west":return ch}},mh=function(t,n,e,o,r){return qc(o).map(dh).getOr(uh)(t,n,e,o,r)},gh=tinymce.util.Tools.resolve("tinymce.util.Delay"),ph=Ed({name:"Button",factory:function(t){var n=Op(t.action),e=t.dom.tag,o=function(n){return bt(t.dom,"attributes").bind((function(t){return bt(t,n)}))}
return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:Bl(t.buttonBehaviours,[lp.config({}),tp.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({})
return O({type:t},n)}return{role:o("role").getOr("button")}}()},eventOrder:t.eventOrder}},configFields:[lr("uid",void 0),Ko("dom"),lr("components",[]),El("buttonBehaviours",[lp,tp]),rr("action"),rr("role"),lr("eventOrder",{})]}),hh=function(t){var n=function(t){return void 0!==t.uid}(t)&&xt(t,"uid")?t.uid:fu("memento")
return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return O(O({},t),{uid:n})}}},vh=tinymce.util.Tools.resolve("tinymce.util.I18n"),bh={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},yh="temporary-placeholder",xh=function(t){return function(){return bt(t,yh).getOr("!not found!")}},wh=function(t,n){var e=t.toLowerCase()
if(vh.isRtl()){var o=function(t,n){return Dt(t,n)?t:function(t,n){return t+n}(t,n)}(e,"-rtl")
return yt(n,o)?o:e}return e},Sh=function(t,n){return bt(n,wh(t,n))},kh=function(t,n){var e=n()
return Sh(t,e).getOrThunk(xh(e))},Ch=function(){return up("add-focusable",[Gi((function(t){ca(t.element,"svg").each((function(t){return jn(t,"focusable","false")}))}))])},Oh=function(t,n,e,o){var r,i,u=function(t){return!!vh.isRtl()&&yt(bh,t)}(n)?["tox-icon--flip"]:[],a=bt(e,wh(n,e)).or(o).getOrThunk(xh(e))
return{dom:{tag:t.tag,attributes:null!==(r=t.attributes)&&void 0!==r?r:{},classes:t.classes.concat(u),innerHtml:a},behaviours:xc(T(T([],null!==(i=t.behaviours)&&void 0!==i?i:[],!0),[Ch()],!1))}},_h=function(t,n,e,o){return void 0===o&&(o=F.none()),Oh(n,t,e(),o)},Th={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Dh=Ed({name:"Notification",factory:function(t){var n,e,o,r,i,u=hh({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:xc([ip.config({})])}),a=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},c=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},s=hh({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[a(0)]},c(0)],behaviours:xc([ip.config({})])}),f={updateProgress:function(t,n){t.getSystem().isConnected()&&s.getOpt(t).each((function(t){ip.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[a(n)]},c(n)])}))},updateText:function(t,n){if(t.getSystem().isConnected()){var e=u.get(t)
ip.set(e,[$u(n)])}}},l=J([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return F.from(Th[t])})).toArray()]),d=hh(ph.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[_h("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),m=[(n=l,e={tag:"div",classes:["tox-notification__icon"]},o=t.iconProvider,r=o(),i=Y(n,(function(t){return yt(r,wh(t,r))})),Oh(e,i.getOr(yh),r,F.none())),{dom:{tag:"div",classes:["tox-notification__body"]},components:[u.asSpec()],behaviours:xc([ip.config({})])}]
return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:xc([lp.config({}),up("notification-events",[Pi(jr(),(function(t){d.getOpt(t).each(lp.focus)}))])]),components:m.concat(t.progress?[s.asSpec()]:[]).concat(t.closeButton?[d.asSpec()]:[]),apis:f}},configFields:[rr("level"),Ko("progress"),Ko("icon"),Ko("onAction"),Ko("text"),Ko("iconProvider"),Ko("translationProvider"),hr("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}})
function Eh(t,n,e){var o=n.backstage.shared
return{open:function(n,r){var i=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),u=function(){r(),Yp.hide(c)},a=ta(Dh.sketch({text:n.text,level:H(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:F.from(n.icon),closeButton:!i,onAction:u,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),c=ta(Yp.sketch(O({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{}},o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})))
e.add(c),n.timeout>0&&gh.setTimeout((function(){u()}),n.timeout)
var s=function(){var n=He(Ft.fromDom(t.getContentAreaContainer())),e=Ne(),o=Ga(e.x,n.x,n.right),r=Ga(e.y,n.y,n.bottom),i=Math.max(n.right,e.right),u=Math.max(n.bottom,e.bottom)
return F.some(Pe(o,r,i-o,u-r))}
return{close:u,moveTo:function(t,n){Yp.showAt(c,na(a),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,n){var e=na(a),r={maxHeightFunction:ms()}
if("banner"!==n&&f(t)){var i=function(t){switch(t){case"bc-bc":return ah
case"tc-tc":return uh
case"tc-bc":return rc
case"bc-tc":default:return ic}}(n),u={type:"node",root:Ln(),node:F.some(Ft.fromDom(t)),overrides:r,layouts:{onRtl:function(){return[i]},onLtr:function(){return[i]}}}
Yp.showWithinBounds(c,e,{anchor:u},s)}else{var l=O(O({},o.anchors.banner()),{overrides:r})
Yp.showWithinBounds(c,e,{anchor:l},s)}},text:function(t){Dh.updateText(a,t)},settings:n,getEl:function(){return a.element.dom},progressBar:{value:function(t){Dh.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){t.length>0&&U(t,(function(n,e){0===e?n.moveRel(null,"banner"):n.moveRel(t[e-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}var Bh,Mh=function(t,n){var e=null,o=function(){u(e)||(clearTimeout(e),e=null)}
return{cancel:o,throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i]
o(),e=setTimeout((function(){e=null,t.apply(null,r)}),n)}}},Ah=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Fh=function(t,n,e,o,r){var i=Ah(t,(function(n){return function(t,n){return t.isBlock(n)||H(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)}(t,n)}))
return F.from(i.backwards(n,e,o,r))},Ih=function(t,n){return Rh(Ft.fromDom(t.selection.getNode())).getOrThunk((function(){var e=Ft.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc())
return Oe(e,Ft.fromDom(n.extractContents())),n.insertNode(e.dom),_n(e).each((function(t){return t.dom.normalize()})),function(t){return ef(t,nf)}(e).map((function(n){t.selection.setCursorLocation(n.dom,function(t){return"img"===Rt(t)?1:Zs(t).fold((function(){return Dn(t).length}),(function(t){return t.length}))}(n))})),e}))},Rh=function(t){return fa(t,"[data-mce-autocompleter]")},Vh=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Ph=function(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)},Hh=function(t,n){return t.substring(n.length)},zh=function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return F.none()
var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot()
return Fh(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){var o
for(o=n-1;o>=0;o--){var r=t.charAt(o)
if(Ph(r))return F.none()
if(r===e)break}return F.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange()
if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return F.none()
var i=Vh(r)
return 0!==i.lastIndexOf(e)||Hh(i,e).length<o?F.none():F.some({text:Hh(i,e),range:r,triggerChar:e})}))},Nh=function(t,n,e,o){return void 0===o&&(o=0),Rh(Ft.fromDom(n.startContainer)).fold((function(){return zh(t,n,e,o)}),(function(n){var o=t.createRng()
o.selectNode(n.dom)
var r=Vh(o)
return F.some({range:o,text:Hh(r,e),triggerChar:e})}))},Lh=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel)
var e=function(t,n){Ei(t,Xr(),{raw:n})}
n.on("keydown",(function(n){var o=function(){return t.getView().bind(im.getHighlighted)}
8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Bi),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(im.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&Rh(Ft.fromDom(n.element)).isNone()&&t.cancelIfNecessary()}))},Wh=tinymce.util.Tools.resolve("tinymce.util.Promise"),Uh=function(t,n){return{container:t,offset:n}},jh=function(t){if(function(t){return 3===t.nodeType}(t))return Uh(t,t.data.length)
var n=t.childNodes
return n.length>0?jh(n[n.length-1]):Uh(t,n.length)},Gh=function(t,n){var e=t.childNodes
return e.length>0&&n<e.length?Gh(e[n],0):e.length>0&&function(t){return 1===t.nodeType}(t)&&e.length===n?jh(e[e.length-1]):Uh(t,n)},Xh=function(t){return function(n){var e=Gh(n.startContainer,n.startOffset)
return!function(t,n){return Fh(t,n.container,n.offset,(function(t,n){return 0===n?-1:n}),t.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1)
return!Ph(n)})).isSome()}(t,e)}},qh=function(t,n){var e=n(),o=t.selection.getRng()
return function(t,n,e){return ct(e.triggerChars,(function(e){return Nh(t,n,e)}))}(t.dom,o,e).bind((function(e){return Yh(t,n,e)}))},Yh=function(t,n,e,o){void 0===o&&(o={})
var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=G(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return Xh(t.dom)}))(e.range,i,e.text)}))
if(0===u.length)return F.none()
var a=Wh.all(W(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})))
return F.some({lookupData:a,context:e})},Kh=Co([Qo("type"),ar("text")]),Jh=Co([lr("type","autocompleteitem"),lr("active",!1),lr("disabled",!1),lr("meta",{}),Qo("value"),ar("text"),ar("icon")]),$h=Co([Qo("type"),Qo("ch"),mr("minChars",1),lr("columns",1),mr("maxResults",10),cr("matches"),tr("fetch"),tr("onAction"),br("highlightOn",[],Ao)]),Qh=[hr("disabled",!1),ar("tooltip"),ar("icon"),ar("text"),vr("onSetup",(function(){return g}))],Zh=Co([Qo("type"),tr("onAction")].concat(Qh)),tv=function(t){return Lo("toolbarbutton",Zh,t)},nv=[hr("active",!1)].concat(Qh),ev=Co(nv.concat([Qo("type"),tr("onAction")])),ov=function(t){return Lo("ToggleButton",ev,t)},rv=[vr("predicate",S),pr("scope","node",["node","editor"]),pr("position","selection",["node","selection","line"])],iv=Qh.concat([lr("type","contextformbutton"),lr("primary",!1),tr("onAction"),qo("original",v)]),uv=nv.concat([lr("type","contextformbutton"),lr("primary",!1),tr("onAction"),qo("original",v)]),av=Qh.concat([lr("type","contextformbutton")]),cv=nv.concat([lr("type","contextformtogglebutton")]),sv=Go("type",{contextformbutton:iv,contextformtogglebutton:uv}),fv=Co([lr("type","contextform"),vr("initValue",h("")),ar("label"),or("commands",sv),ir("launch",Go("type",{contextformbutton:av,contextformtogglebutton:cv}))].concat(rv)),lv=Co([lr("type","contexttoolbar"),Qo("items")].concat(rv)),dv=function(t){var n=t.ui.registry.getAll().popups,e=dt(n,(function(t){return(n=t,Lo("Autocompleter",$h,n)).fold((function(t){throw new Error(jo(t))}),v)
var n})),o=function(t){var n={}
return U(t,(function(t){n[t]={}})),st(n)}(pt(e,(function(t){return t.ch}))),r=vt(e)
return{dataset:e,triggerChars:o,lookupByChar:function(t){return G(r,(function(n){return n.ch===t}))}}};(function(t){t[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"})(Bh||(Bh={}))
var mv,gv=Bh,pv="tox-menu-nav__js",hv="tox-collection__item",vv="tox-swatch",bv={normal:pv,color:vv},yv="tox-collection__item--enabled",xv="tox-collection__item-icon",wv="tox-collection__item-label",Sv="tox-collection__item-caret",kv="tox-collection__item--active",Cv="tox-collection__item-container",Ov="tox-collection__item-container--row",_v=function(t){return bt(bv,t).getOr(pv)},Tv=function(t){return"color"===t?"tox-swatches":"tox-menu"},Dv=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Tv(t),tieredMenu:"tox-tiered-menu"}},Ev=function(t){var n=Dv(t)
return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:_v(t)}},Bv=function(t,n,e){var o=Dv(e)
return{tag:"div",classes:J([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},Mv=[Lp.parts.items({})],Av=function(t,n,e){var o=Dv(e)
return{dom:{tag:"div",classes:J([[o.tieredMenu]])},markers:Ev(e)}},Fv=function(t,n){return function(e){var o=L(e,n)
return W(o,(function(n){return{dom:t,components:n}}))}},Iv=function(t,n){var e=[],o=[]
return U(t,(function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],yt(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),o.length>0&&e.push(o),W(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Rv=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[Lp.parts.items({preprocess:function(e){return"auto"!==t&&t>1?Fv({tag:"div",classes:["tox-collection__group"]},t)(e):Iv(e,(function(t,e){return"separator"===n[e].type}))}})]}},Vv=function(t){return z(t,(function(t){return"icon"in t&&void 0!==t.icon}))},Pv=function(t){return console.error(jo(t)),console.log(t),F.none()},Hv=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Lp.parts.items({preprocess:function(t){return Iv(t,(function(t,n){return"separator"===i[n].type}))}})]})
return{value:t,dom:u.dom,components:u.components,items:e}},zv=function(t,n,e,o,r){var i
return"color"===r?{value:t,dom:(i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Lp.parts.items({preprocess:"auto"!==t?Fv({tag:"div",classes:["tox-swatches__row"]},t):v})]}]}}(o)).dom,components:i.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(i=Rv(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=Rv(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=Rv(o,e)).dom,components:i.components,items:e}:"listpreview"===r&&"auto"!==o?{value:t,dom:(i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Lp.parts.items({preprocess:Fv({tag:"div",classes:["tox-collection__group"]},t)})]}}(o)).dom,components:i.components,items:e}:{value:t,dom:Bv(n,o,r),components:Mv,items:e}},Nv=[Qo("type"),Qo("src"),ar("alt"),br("classes",[],Ao)],Lv=Co(Nv),Wv=[Qo("type"),Qo("text"),ar("name"),br("classes",["tox-collection__item-label"],Ao)],Uv=Co(Wv),jv=wo((function(){return Ho("type",{cardimage:Lv,cardtext:Uv,cardcontainer:Gv})})),Gv=Co([Qo("type"),gr("direction","horizontal"),gr("align","left"),gr("valign","middle"),or("items",jv)]),Xv=[hr("disabled",!1),ar("text"),ar("shortcut"),Xo("value","value",co((function(){return ou("menuitem-value")})),Eo()),lr("meta",{})],qv=Co([Qo("type"),ar("label"),or("items",jv),vr("onSetup",(function(){return g})),vr("onAction",g)].concat(Xv)),Yv=Co([Qo("type"),hr("active",!1),ar("icon")].concat(Xv)),Kv=[Qo("type"),Qo("fancytype"),vr("onAction",g)],Jv=[lr("initData",{})].concat(Kv),$v=[yr("initData",{},[hr("allowCustomColors",!0),sr("colors",Eo())])].concat(Kv),Qv=Go("fancytype",{inserttable:Jv,colorswatch:$v}),Zv=Co([Qo("type"),vr("onSetup",(function(){return g})),vr("onAction",g),ar("icon")].concat(Xv)),tb=Co([Qo("type"),tr("getSubmenuItems"),vr("onSetup",(function(){return g})),ar("icon")].concat(Xv)),nb=Co([Qo("type"),ar("icon"),hr("active",!1),vr("onSetup",(function(){return g})),tr("onAction")].concat(Xv)),eb=function(t,n,e){var o=of(t.element,"."+e)
if(o.length>0){var r=K(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top
return Math.abs(e-r)>n})).getOr(o.length)
return F.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return F.none()},ob=function(t,n){return xc([up(t,n)])},rb=function(t){return ob(ou("unnamed-events"),t)},ib=ou("tooltip.exclusive"),ub=ou("tooltip.show"),ab=ou("tooltip.hide"),cb=function(t,n,e){t.getSystem().broadcastOn([ib],{})},sb=Object.freeze({__proto__:null,hideAllExclusive:cb,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&ip.set(t,o)}))}}),fb=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){Gf(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()}
return Ii(J([[Pi(ub,(function(e){n.resetTimer((function(){(function(e){if(!n.isShowing()){cb(e)
var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Ii("normal"===t.mode?[Pi(Ur(),(function(t){Di(e,ub)})),Pi(Lr(),(function(t){Di(e,ab)}))]:[]),behaviours:xc([ip.config({})])})
n.setTooltip(r),Wf(o,r),t.onShow(e,r),Pf.position(o,r,{anchor:t.anchor(e)})}})(e)}),t.delay)})),Pi(ab,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Pi(ui(),(function(t,n){var o=n
o.universal||H(o.channels,ib)&&e(t)})),Xi((function(t){e(t)}))],"normal"===t.mode?[Pi(jr(),(function(t){Di(t,ub)})),Pi(ri(),(function(t){Di(t,ab)})),Pi(Ur(),(function(t){Di(t,ub)})),Pi(Lr(),(function(t){Di(t,ab)}))]:[Pi(_i(),(function(t,n){Di(t,ub)})),Pi(Ti(),(function(t){Di(t,ab)}))]]))}}),lb=[Ko("lazySink"),Ko("tooltipDom"),lr("exclusive",!0),lr("tooltipComponents",[]),lr("delay",300),pr("mode","normal",["normal","follow-highlight"]),lr("anchor",(function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:h([ic,rc,tc,ec,nc,oc]),onRtl:h([ic,rc,tc,ec,nc,oc])}}})),Ta("onHide"),Ta("onShow")],db=Sc({fields:lb,name:"tooltipping",active:fb,state:Object.freeze({__proto__:null,init:function(){var t=Qc(),n=Qc(),e=function(){t.on(clearTimeout)},o=h("not-implemented")
return xu({getTooltip:n.get,isShowing:n.isSet,setTooltip:n.set,clearTooltip:n.clear,clearTimer:e,resetTimer:function(n,o){e(),t.set(setTimeout(n,o))},readState:o})}}),apis:sb}),mb=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),gb=tinymce.util.Tools.resolve("tinymce.EditorManager"),pb=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},hb=function(t){return t.getParam("width",mb.DOM.getStyle(t.getElement(),"width"))},vb=function(t){return F.from(t.getParam("min_width")).filter(d)},bb=function(t){return F.from(t.getParam("min_height")).filter(d)},yb=function(t){return F.from(t.getParam("max_width")).filter(d)},xb=function(t){return F.from(t.getParam("max_height")).filter(d)},wb=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Sb=function(t){var n=t.getParam("toolbar",!0),e=!0===n,r=o(n),u=i(n)&&n.length>0
return!Cb(t)&&(u||r||e)},kb=function(t){var n=N(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=G(n,(function(t){return"string"==typeof t}))
return e.length>0?F.some(e):F.none()},Cb=function(t){return kb(t).fold((function(){return t.getParam("toolbar",[],"string[]").length>0}),k)};(function(t){t.default="wrap",t.floating="floating",t.sliding="sliding",t.scrolling="scrolling"})(mv||(mv={}))
var Ob,_b=function(t){return t.getParam("toolbar_mode","","string")};(function(t){t.auto="auto",t.top="top",t.bottom="bottom"})(Ob||(Ob={}))
var Tb,Db,Eb=function(t){return t.getParam("toolbar_location",Ob.auto,"string")},Bb=function(t){return Eb(t)===Ob.bottom},Mb=function(t){if(!t.inline)return F.none()
var n=function(t){return t.getParam("fixed_toolbar_container","","string")}(t)
if(n.length>0)return sa(Ln(),n)
var e=function(t){return t.getParam("fixed_toolbar_container_target")}(t)
return f(e)?F.some(Ft.fromDom(e)):F.none()},Ab=function(t){return t.inline&&Mb(t).isSome()},Fb=function(t){return Mb(t).getOrThunk((function(){return Vn(Rn(Ft.fromDom(t.getElement())))}))},Ib=function(t){return t.inline&&!wb(t)&&!Sb(t)&&!Cb(t)},Rb=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!Ab(t)&&!Ib(t)},Vb=function(t){var n=t.getParam("menu")
return n?dt(n,(function(t){return O(O({},t),{items:t.items})})):{}},Pb=function(t){return t.getParam("menubar")},Hb=function(t){return t.getParam("anchor_top","#top")},zb=function(t){return t.getParam("anchor_bottom","#bottom")},Nb="silver.readonly",Lb=Co([(Tb="readonly",Jo(Tb,Fo))]),Wb=function(t,n){var e=t.outerContainer.element
n&&(t.mothership.broadcastOn([ul()],{target:e}),t.uiMothership.broadcastOn([ul()],{target:e})),t.mothership.broadcastOn([Nb],{readonly:n}),t.uiMothership.broadcastOn([Nb],{readonly:n})},Ub=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&Wb(n,!0)})),t.on("SwitchMode",(function(){return Wb(n,t.mode.isReadOnly())})),function(t){return t.getParam("readonly",!1,"boolean")}(t)&&t.setMode("readonly")},jb=function(){var t
return _c.config({channels:(t={},t[Nb]={schema:Lb,onReceive:function(t,n){Yd.set(t,n.readonly)}},t)})},Gb=function(t){return Yd.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Xb=function(t){return Yd.config({disabled:t})},qb=function(t){return Yd.config({disabled:t,disableClass:"tox-tbtn--disabled"})},Yb=function(t){return Yd.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Kb=function(t,n){var e=t.getApi(n)
return function(t){t(e)}},Jb=function(t,n){return Gi((function(e){Kb(t,e)((function(e){var o=t.onSetup(e)
l(o)&&n.set(o)}))}))},$b=function(t,n){return Xi((function(e){return Kb(t,e)(n.get())}))},Qb=function(t,n){return Yi((function(e,o){Kb(t,e)(t.onAction),t.triggersSubmenu||n!==gv.CLOSE_ON_EXECUTE||(Di(e,li()),o.stop())}))},Zb=((Db={})[ai()]=["disabling","alloy.base.behaviour","toggling","item-events"],Db),ty=St,ny=function(t,n,e,o){var r=xr(g)
return{type:"item",dom:n.dom,components:ty(n.optComponents),data:t.data,eventOrder:Zb,hasSubmenu:t.triggersSubmenu,itemBehaviours:xc([up("item-events",[Qb(t,e),Jb(t,r),$b(t,r)]),Gb((function(){return t.disabled||o.isDisabled()})),jb(),ip.config({})].concat(t.itemBehaviours))}},ey=function(t){return{value:t.value,meta:O({text:t.text.getOr("")},t.meta)}},oy=tinymce.util.Tools.resolve("tinymce.Env"),ry=function(t){var n=oy.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=t.split("+"),o=W(e,(function(t){var e=t.toLowerCase().trim()
return yt(n,e)?n[e]:t}))
return oy.mac?o.join(""):o.join("+")},iy=function(t,n,e){return void 0===e&&(e=[xv]),_h(t,{tag:"div",classes:e},n)},uy=function(t){return{dom:{tag:"div",classes:[wv]},components:[$u(vh.translate(t))]}},ay=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},cy=function(t,n){return{dom:{tag:"div",classes:[wv]},components:[{dom:{tag:t.tag,styles:t.styles},components:[$u(vh.translate(n))]}]}},sy=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:ry(t)}}},fy=function(t){return iy("checkmark",t,["tox-collection__item-checkmark"])},ly=function(t,n,e){var o,r,i=t.ariaLabel,u=t.value,a=t.iconContent.map((function(t){return function(t,n,e){var o=n()
return Sh(t,o).or(e).getOrThunk(xh(o))}(t,n.icons,e)}))
return{dom:(o=a.getOr(""),r={tag:"div",attributes:i.map((function(t){return{title:n.translate(t)}})).getOr({}),classes:["tox-swatch"]},O(O({},r),"custom"===u?{tag:"button",classes:T(T([],r.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:o}:"remove"===u?{classes:T(T([],r.classes,!0),["tox-swatch--remove"],!1),innerHtml:o}:{attributes:O(O({},r.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}},dy=function(t){var n=t.map((function(t){return{attributes:{title:vh.translate(t)}}})).getOr({})
return O({tag:"div",classes:[pv,hv]},n)},my=function(t,n,e,o){return void 0===o&&(o=F.none()),"color"===t.presets?ly(t,n,o):function(t,n,e,o){var r={tag:"div",classes:[xv]},i=e?t.iconContent.map((function(t){return _h(t,r,n.icons,o)})).orThunk((function(){return F.some({dom:r})})):F.none(),u=t.checkMark,a=F.from(t.meta).fold((function(){return uy}),(function(t){return yt(t,"style")?y(cy,t.style):uy})),c=t.htmlContent.fold((function(){return t.textContent.map(a)}),(function(t){return F.some(ay(t,[wv]))}))
return{dom:dy(t.ariaLabel),optComponents:[i,c,t.shortcutContent.map(sy),u,t.caret]}}(t,n,e,o)},gy=function(t,n){return bt(t,"tooltipWorker").map((function(t){return[db.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:ms}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){db.setComponents(n,[Qu({element:Ft.fromDom(t)})])}))}})]})).getOr([])},py=function(t,n){var e=function(t){return mb.DOM.encode(t)}(vh.translate(t))
if(n.length>0){var o=new RegExp(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(n),"gi")
return e.replace(o,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return e},hy=function(t,n){return W(t,(function(t){switch(t.type){case"cardcontainer":return function(t,n){var e="vertical"===t.direction?"tox-collection__item-container--column":Ov,o="left"===t.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right"
return{dom:{tag:"div",classes:[Cv,e,o,function(){switch(t.valign){case"top":return"tox-collection__item-container--valign-top"
case"middle":return"tox-collection__item-container--valign-middle"
case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:n}}(t,hy(t.items,n))
case"cardimage":return function(t,n,e){return{dom:{tag:"img",classes:n,attributes:{src:t,alt:e.getOr("")}}}}(t.src,t.classes,t.alt)
case"cardtext":var e=t.name.exists((function(t){return H(n.cardText.highlightOn,t)}))?F.from(n.cardText.matchText).getOr(""):""
return ay(py(t.text,e),t.classes)}}))},vy=cd(Ip(),Rp()),by=function(t){return{value:t}},yy=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,xy=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,wy=function(t){return yy.test(t)||xy.test(t)},Sy=function(t){return function(t,n){return Tt(t,n)?function(t,n){return t.substring(n)}(t,n.length):t}(t,"#").toUpperCase()},ky=function(t){var n=function(t){return{value:t.value.replace(yy,(function(t,n,e,o){return n+n+e+e+o+o}))}}(t),e=xy.exec(n.value)
return null===e?["FFFFFF","FF","FF","FF"]:e},Cy=function(t){var n=t.toString(16)
return(1===n.length?"0"+n:n).toUpperCase()},Oy=function(t){var n=Cy(t.red)+Cy(t.green)+Cy(t.blue)
return by(n)},_y=Math.min,Ty=Math.max,Dy=Math.round,Ey=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,By=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,My=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Ay=function(t){var n=parseInt(t,10)
return n.toString()===t&&n>=0&&n<=255},Fy=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100
if(i=Ty(0,_y(i,1)),u=Ty(0,_y(u,1)),0===i)return n=e=o=Dy(255*u),My(n,e,o,1)
var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c
switch(Math.floor(a)){case 0:n=c,e=s,o=0
break
case 1:n=s,e=c,o=0
break
case 2:n=0,e=c,o=s
break
case 3:n=0,e=s,o=c
break
case 4:n=s,e=0,o=c
break
case 5:n=c,e=0,o=s
break
default:n=e=o=0}return n=Dy(255*(n+f)),e=Dy(255*(e+f)),o=Dy(255*(o+f)),My(n,e,o,1)},Iy=function(t){var n=ky(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16)
return My(e,o,r,1)},Ry=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o)
return My(r,i,u,a)},Vy=function(t){if("transparent"===t)return F.some(My(0,0,0,0))
var n=Ey.exec(t)
if(null!==n)return F.some(Ry(n[1],n[2],n[3],"1"))
var e=By.exec(t)
return null!==e?F.some(Ry(e[1],e[2],e[3],e[4])):F.none()},Py=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Hy=My(255,0,0,1),zy=function(t,n){return t.fire("ResizeContent",n)},Ny=function(t,n,e){return{hue:t,saturation:n,value:e}},Ly=function(t){var n,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u))
return a===c?Ny(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),n=(c-a)/c,o=c,Ny(Math.round(e),Math.round(100*n),Math.round(100*o)))},Wy=function(t){return Oy(Fy(t))},Uy=function(t){return(n=t,wy(n)?F.some({value:Sy(n)}):F.none()).orThunk((function(){return Vy(t).map(Oy)})).getOrThunk((function(){var n=document.createElement("canvas")
n.height=1,n.width=1
var e=n.getContext("2d")
e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1)
var o=e.getImageData(0,0,1,1).data,r=o[0],i=o[1],u=o[2],a=o[3]
return Oy(My(r,i,u,a))}))
var n},jy=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Gy="tinymce-custom-colors"
var Xy,qy="choiceitem",Yy=[{type:qy,text:"Light Green",value:"#BFEDD2"},{type:qy,text:"Light Yellow",value:"#FBEEB8"},{type:qy,text:"Light Red",value:"#F8CAC6"},{type:qy,text:"Light Purple",value:"#ECCAFA"},{type:qy,text:"Light Blue",value:"#C2E0F4"},{type:qy,text:"Green",value:"#2DC26B"},{type:qy,text:"Yellow",value:"#F1C40F"},{type:qy,text:"Red",value:"#E03E2D"},{type:qy,text:"Purple",value:"#B96AD9"},{type:qy,text:"Blue",value:"#3598DB"},{type:qy,text:"Dark Turquoise",value:"#169179"},{type:qy,text:"Orange",value:"#E67E23"},{type:qy,text:"Dark Red",value:"#BA372A"},{type:qy,text:"Dark Purple",value:"#843FA1"},{type:qy,text:"Dark Blue",value:"#236FA1"},{type:qy,text:"Light Gray",value:"#ECF0F1"},{type:qy,text:"Medium Gray",value:"#CED4D9"},{type:qy,text:"Gray",value:"#95A5A6"},{type:qy,text:"Dark Gray",value:"#7E8C8D"},{type:qy,text:"Navy Blue",value:"#34495E"},{type:qy,text:"Black",value:"#000000"},{type:qy,text:"White",value:"#ffffff"}],Ky=function(t){void 0===t&&(t=10)
var n,e=jy.getItem(Gy),r=o(e)?JSON.parse(e):[],i=t-(n=r).length<0?n.slice(0,t):n,u=function(t){i.splice(t,1)}
return{add:function(n){(function(t,n){var e=P(t,n)
return-1===e?F.none():F.some(e)})(i,n).each(u),i.unshift(n),i.length>t&&i.pop(),jy.setItem(Gy,JSON.stringify(i))},state:function(){return i.slice(0)}}}(10),Jy=function(t){return!1!==t.getParam("custom_colors")},$y=function(t){var n=function(t){return t.getParam("color_map")}(t)
return void 0!==n?function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+Uy(t[e]).value,type:"choiceitem"})
return n}(n):Yy},Qy=function(t){Ky.add(t)},Zy=function(t){return function(t,n){return t.getParam("color_cols",n,"number")}(t,function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))}($y(t).length))},tx=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"}
return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]},nx=function(t,n,e,o){"custom"===e?ax(t)((function(e){e.each((function(e){Qy(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},ex=function(t,n){return t.concat(W(Ky.state(),(function(t){return{type:qy,text:t,value:t}})).concat(tx(n)))},ox=function(t,n){return function(e){e(ex(t,n))}},rx=function(t,n,e){var o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color"
t.setIconFill(o,e)},ix=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){return F.from(function(t,n){var e
return t.dom.getParents(t.selection.getStart(),(function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)})),e}(t,e)).bind((function(t){return Vy(t).map((function(t){var e=Oy(t).value
return _t(n.toLowerCase(),e)}))})).getOr(!1)},columns:Zy(t),fetch:ox($y(t),Jy(t)),onAction:function(n){null!==r.get()&&nx(t,e,r.get(),g)},onItemAction:function(o,i){nx(t,e,i,(function(e){r.set(e),function(t,n){t.fire("TextColorChange",n)}(t,{name:n,color:e})}))},onSetup:function(e){null!==r.get()&&rx(e,n,r.get())
var o=function(t){t.name===n&&rx(e,t.name,t.color)}
return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},ux=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){nx(t,e,n.value,g)}}]}})},ax=function(t){return function(n,e){var o=!1,r={colorpicker:e}
t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(e){var r=e.getData().colorpicker
o?(n(F.from(r)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",r]))},onClose:g,onCancel:function(){n(F.none())}})}},cx=function(t,n,e,o,r,i,u,a){var c=Vv(n),s=sx(n,e,o,"color"!==r?"normal":"color",i,u,a)
return zv(t,c,s,o,r)},sx=function(t,n,e,o,r,i,u){return St(W(t,(function(a){return"choiceitem"===a.type?(c=a,Lo("choicemenuitem",Yv,c)).fold(Pv,(function(c){return F.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0)
var c=my({presets:e,textContent:n?t.text:F.none(),htmlContent:F.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:F.none(),checkMark:n?F.some(fy(u.icons)):F.none(),caret:F.none(),value:t.value},u,a)
return uo(ny({data:ey(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){kp.set(t,n)},isActive:function(){return kp.isOn(t)},isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),g},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:yv,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,Vv(t)))})):F.none()
var c})))},fx=function(t,n){var e=Ev(n)
return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},lx=function(t,n){var e=t.initData.allowCustomColors&&n.colorinput.hasCustomColors()
return t.initData.colors.fold((function(){return ex(n.colorinput.getColors(),e)}),(function(t){return t.concat(tx(e))}))},dx=ou("cell-over"),mx=ou("cell-execute"),gx=function(t,n,e){var o,r=function(e){return Ei(e,mx,{row:t,col:n})},i=function(t,n){n.stop(),r(t)}
return ta({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:xc([up("insert-table-picker-cell",[Pi(Ur(),lp.focus),Pi(ai(),r),Pi(Jr(),i),Pi(si(),i)]),kp.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),lp.config({onFocus:function(e){return Ei(e,dx,{row:t,col:n})}})])})},px=function(t){return $(t,(function(t){return W(t,na)}))},hx=function(t,n){return $u(n+1+"x"+(t+1))},vx={inserttable:function(t){var n=ou("size-label"),e=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(gx(r,u,t))
o.push(i)}return o}(n,10,10),o=hh({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[$u("0x0")],behaviours:xc([ip.config({})])})
return{type:"widget",data:{value:ou("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[vy.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:px(e).concat(o.asSpec()),behaviours:xc([up("insert-table-picker",[Li(dx,(function(t,n,r){var i=r.event.row,u=r.event.col;(function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)kp.set(t[i][u],i<=n&&u<=e)})(e,i,u,10,10),ip.set(o.get(t),[hx(i,u)])})),Li(mx,(function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Di(n,li())}))]),tp.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=lx(t,n),o=n.colorinput.getColorCols(),r="color",i=cx(ou("menu-value"),e,(function(n){t.onAction({value:n})}),o,r,gv.CLOSE_ON_EXECUTE,S,n.shared.providers),u=O(O({},i),{markers:Ev(r),movement:fx(o,r)})
return{type:"widget",data:{value:ou("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[vy.widget(Lp.sketch(u))]}}},bx=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0)
var c=my({presets:o,textContent:F.none(),htmlContent:e?t.text.map((function(t){return py(t,n)})):F.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:F.none(),checkMark:F.none(),caret:F.none(),value:t.value},u.providers,a,t.icon)
return ny({data:ey(t),disabled:t.disabled,getApi:h({}),onAction:function(n){return r(t.value,t.meta)},onSetup:h(g),triggersSubmenu:!1,itemBehaviours:gy(t.meta,u)},c,i,u.providers)},yx=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}))
return{type:"separator",dom:O({tag:"div",classes:[hv,"tox-collection__group-heading"]},n),components:[]}},xx=function(t,n,e,o){void 0===o&&(o=!0)
var r=my({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:F.none(),ariaLabel:t.text,caret:F.none(),checkMark:F.none(),shortcutContent:t.shortcut},e,o)
return ny({data:ey(t),getApi:function(t){return{isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},wx=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1)
var i,u=r?(i=e.icons,iy("chevron-down",i,[Sv])):function(t){return iy("chevron-right",t,[Sv])}(e.icons),a=my({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:F.none(),ariaLabel:t.text,caret:F.some(u),checkMark:F.none(),shortcutContent:t.shortcut},e,o)
return ny({data:ey(t),getApi:function(t){return{isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)}}},disabled:t.disabled,onAction:g,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},a,n,e)},Sx=function(t,n,e,o){void 0===o&&(o=!0)
var r=my({iconContent:t.icon,textContent:t.text,htmlContent:F.none(),ariaLabel:t.text,checkMark:F.some(fy(e.icons)),caret:F.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o)
return uo(ny({data:ey(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){kp.set(t,n)},isActive:function(){return kp.isOn(t)},isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:yv,toggleOnExecute:!1,selected:t.active}})},kx=function(t,n){return bt(vx,t.fancytype).map((function(e){return e(t,n)}))},Cx=function(t,n,e,o){var r={dom:dy(t.label),optComponents:[F.some({dom:{tag:"div",classes:[Cv,Ov]},components:hy(t.items,o)})]}
return ny({data:ey(O({text:F.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){Yd.set(t,n),U(of(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(Yd)&&Yd.set(t,n)}))}))}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:F.from(o.itemBehaviours).getOr([])},r,n,e.providers)};(function(t){t[t.ContentFocus=0]="ContentFocus",t[t.UiFocus=1]="UiFocus"})(Xy||(Xy={}))
var Ox=function(t,n,e,o,r){var i,u=e.shared.providers,a=function(t){return r?O(O({},t),{shortcut:F.none(),icon:t.text.isSome()?F.none():t.icon}):t}
switch(t.type){case"menuitem":return(i=t,Lo("menuitem",Zv,i)).fold(Pv,(function(t){return F.some(xx(a(t),n,u,o))}))
case"nestedmenuitem":return function(t){return Lo("nestedmenuitem",tb,t)}(t).fold(Pv,(function(t){return F.some(wx(a(t),n,u,o,r))}))
case"togglemenuitem":return function(t){return Lo("togglemenuitem",nb,t)}(t).fold(Pv,(function(t){return F.some(Sx(a(t),n,u,o))}))
case"separator":return function(t){return Lo("separatormenuitem",Kh,t)}(t).fold(Pv,(function(t){return F.some(yx(t))}))
case"fancymenuitem":return function(t){return Lo("fancymenuitem",Qv,t)}(t).fold(Pv,(function(t){return kx(a(t),e)}))
default:return console.error("Unknown item in general menu",t),F.none()}},_x=function(t,n,e,o,r,i,u){var a=1===o,c=!a||Vv(t)
return St(W(t,(function(t){switch(t.type){case"separator":return(o=t,Lo("Autocompleter.Separator",Kh,o)).fold(Pv,(function(t){return F.some(yx(t))}))
case"cardmenuitem":return function(t){return Lo("cardmenuitem",qv,t)}(t).fold(Pv,(function(t){return F.some(Cx(O(O({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:gy(t.meta,i),cardText:{matchText:n,highlightOn:u}}))}))
case"autocompleteitem":default:return function(t){return Lo("Autocompleter.Item",Jh,t)}(t).fold(Pv,(function(t){return F.some(bx(t,n,a,"normal",e,r,i,c))}))}var o})))},Tx=function(t,n,e,o,r){var i=Vv(n),u=St(W(n,(function(t){var n=function(t){return Ox(t,e,o,function(t){return r?!yt(t,"text"):i}(t),r)}
return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(O(O({},t),{disabled:!0})):n(t)})))
return(r?Hv:zv)(t,i,u,1,"normal")},Dx=function(t){return qp.singleData(t.value,t)},Ex=function(t,n){var e=Qc(),o=xr(!1),r=ta(Yp.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:xc([up("dismissAutocompleter",[Pi(xi(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&Yp.hide(r)},a=function(){if(i()){var n=e.get().map((function(t){return t.element}))
Rh(n.getOr(Ft.fromDom(t.selection.getNode()))).each(Ee),u(),e.clear(),o.set(!1)}},c=Lt((function(){return dv(t)})),s=function(n,e,o,i){n.matchLength=e.text.length
var u=ct(o,(function(t){return F.from(t.columns)})).getOr(1)
Yp.showAt(r,Lp.sketch(function(t,n,e,o){var r=e===Xy.ContentFocus?Tm():_m(),i=fx(n,o),u=Ev(o)
return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===Xy.ContentFocus,focusManager:r,menuBehaviours:rb("auto"!==n?[]:[Gi((function(t,n){eb(t,4,u.item).each((function(n){var e=n.numColumns,o=n.numRows
tp.setGridSize(t,o,e)}))}))])}}(zv("autocompleter-value",!0,i,u,"normal"),u,Xy.ContentFocus,"normal")),{anchor:{type:"node",root:Ft.fromDom(t.getBody()),node:F.from(n.element)}}),Yp.getContent(r).each(im.highlightFirst)},f=function(r){(function(n){return e.get().map((function(e){return Nh(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return Yh(t,c,e,n)}))})).getOrThunk((function(){return qh(t,c)}))})(r).fold(a,(function(r){(function(n){if(!i()){var r=Ih(t,n.range)
e.set({triggerChar:n.triggerChar,element:r,matchLength:n.text.length}),o.set(!1)}})(r.context),r.lookupData.then((function(i){e.get().map((function(e){var c,l,d,m=r.context
if(e.triggerChar===m.triggerChar){var g=(c=m.triggerChar,d=ct(l=i,(function(t){return F.from(t.columns)})).getOr(1),$(l,(function(e){var r=e.items
return _x(r,e.matchText,(function(n,r){var i=t.selection.getRng()
Nh(t.dom,i,c).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),f(t)}}
o.set(!0),e.onAction(c,i,n,r),o.set(!1)}))}),d,gv.BUBBLE_TO_SANDBOX,n,e.highlightOn)})))
g.length>0?s(e,m,i,g):m.text.length-e.matchLength>=10?a():u()}}))}))}))},l={onKeypress:Mh((function(t){27!==t.which&&f()}),50),cancelIfNecessary:a,isMenuOpen:function(){return Yp.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return Yp.getContent(r)}}
!1===t.hasPlugin("rtc")&&Lh(l,t)},Bx=function(t,n,e){return fa(t,n,e).isSome()},Mx=function(t,n){var e=null
return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Ax=function(t){var n=t.raw
return void 0===n.touches||1!==n.touches.length?F.none():F.some(n.touches[0])},Fx=function(t){var n=Qc(),e=xr(!1),o=Mx((function(n){t.triggerEvent(fi(),n),e.set(!0)}),400),r=Or([{key:Rr(),value:function(t){return Ax(t).each((function(r){o.cancel()
var i={x:r.clientX,y:r.clientY,target:t.target}
o.schedule(t),e.set(!1),n.set(i)})),F.none()}},{key:Vr(),value:function(t){return o.cancel(),Ax(t).each((function(t){n.on((function(e){(function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y)
return e>5||o>5})(t,e)&&n.clear()}))})),F.none()}},{key:Pr(),value:function(r){o.cancel()
return n.get().filter((function(t){return yn(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(si(),r)}))}}])
return{fireIfReady:function(t,n){return bt(r,n).bind((function(n){return n(t)}))}}},Ix=function(){return hn().browser.isFirefox()},Rx=function(t,n){var e=O({stopBackspace:!0},n),o=Fx(e),r=W(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return ts(t,n,(function(t){o.fireIfReady(t,n).each((function(n){n&&t.kill()})),e.triggerEvent(n,t)&&t.kill()}))})),i=Qc(),u=ts(t,"paste",(function(t){o.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),e.triggerEvent("paste",t)&&t.kill(),i.set(setTimeout((function(){e.triggerEvent(ii(),t)}),0))})),a=ts(t,"keydown",(function(t){e.triggerEvent("keydown",t)?t.kill():e.stopBackspace&&function(t){return t.raw.which===um[0]&&!H(["input","textarea"],Rt(t.target))&&!Bx(t.target,'[contenteditable="true"]')}(t)&&t.prevent()})),c=function(t,n){return Ix()?ns(t,"focus",n):ts(t,"focusin",n)}(t,(function(t){e.triggerEvent("focusin",t)&&t.kill()})),s=Qc(),f=function(t,n){return Ix()?ns(t,"blur",n):ts(t,"focusout",n)}(t,(function(t){e.triggerEvent("focusout",t)&&t.kill(),s.set(setTimeout((function(){e.triggerEvent(ri(),t)}),0))}))
return{unbind:function(){U(r,(function(t){t.unbind()})),a.unbind(),c.unbind(),f.unbind(),u.unbind(),i.on(clearTimeout),s.on(clearTimeout)}}},Vx=function(t,n){var e=bt(t,"target").getOr(n)
return xr(e)},Px=wr([{stopped:[]},{resume:["element"]},{complete:[]}]),Hx=function(t,n,e,o,r,i){var u=t(n,o),a=function(t,n){var e=xr(!1),o=xr(!1)
return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}}(e,r)
return u.fold((function(){return i.logEventNoHandlers(n,o),Px.complete()}),(function(t){var e=t.descHandler
return ku(e)(a),a.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Px.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),Px.complete()):_n(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),Px.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),Px.resume(o)}))}))},zx=function(t,n,e,o,r,i){return Hx(t,n,e,o,r,i).fold(k,(function(o){return zx(t,n,e,o,r,i)}),S)},Nx=function(t,n,e){var o=function(t){var n=xr(!1)
return{stop:function(){n.set(!0)},cut:g,isStopped:n.get,isCut:S,event:t,setSource:w("Cannot set source of a broadcasted event"),getSource:w("Cannot get source of a broadcasted event")}}(n)
return U(t,(function(t){var n=t.descHandler
ku(n)(o)})),o.isStopped()},Lx=function(t,n,e,o,r){var i=Vx(e,o)
return zx(t,n,e,o,i,r)},Wx=function(){var t={}
return{registerId:function(n,e,o){lt(o,(function(o,r){var i=void 0!==t[r]?t[r]:{}
i[e]=function(t,n){return e=y.apply(void 0,[t.handler].concat(n)),o=t.purpose,{cHandler:e,purpose:o}
var e,o}(o,n),t[r]=i}))},unregisterId:function(n){lt(t,(function(t,e){yt(t,n)&&delete t[n]}))},filterByType:function(n){return bt(t,n).map((function(t){return pt(t,(function(t,n){return function(t,n){return{id:t,descHandler:n}}(n,t)}))})).getOr([])},find:function(n,e,o){return bt(t,e).bind((function(t){return Er(o,(function(n){return function(t,n){return su(n).bind((function(n){return bt(t,n)})).map((function(t){return function(t,n){return{element:t,descHandler:n}}(n,t)}))}(t,n)}),n)}))}}},Ux=function(){var t=Wx(),n={},e=function(t){var n=t.element
return su(n).getOrThunk((function(){return function(t,n){var e=ou(uu+t)
return cu(n,e),e}("uid-",t.element)}))},o=function(e){su(e.element).each((function(e){delete n[e],t.unregisterId(e)}))}
return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(r){var i=e(r)
xt(n,i)&&function(t,e){var r=n[e]
if(r!==t)throw new Error('The tagId "'+e+'" is already used by: '+Zi(r.element)+"\nCannot use it for: "+Zi(t.element)+"\nThe conflicting element is"+(Nn(r.element)?" ":" not ")+"already in the DOM")
o(t)}(r,i)
var u=[r]
t.registerId(u,i,r.events),n[i]=r},unregister:o,getById:function(t){return bt(n,t)}}},jx=Ed({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=_(n,["attributes"])
return{uid:t.uid,dom:O({tag:"div",attributes:O({role:"presentation"},e)},o),components:t.components,behaviours:Tl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[lr("components",[]),_l("containerBehaviours",[]),lr("events",{}),lr("domModification",{}),lr("eventOrder",{})]}),Gx=function(t){var n=function(n){return _n(t.element).fold(k,(function(t){return yn(n,t)}))},e=Ux(),o=function(t,o){return e.find(n,t,o)},r=Rx(t.element,{triggerEvent:function(t,n){return ba(t,n.target,(function(e){return function(t,n,e,o){return Lx(t,n,e,e.target,o)}(o,t,n,e)}))}}),i={debugInfo:h("real"),triggerEvent:function(t,n,e){ba(t,n,(function(r){return Lx(o,t,e,n,r)}))},triggerFocus:function(t,n){su(t).fold((function(){Ec(t)}),(function(e){ba(oi(),t,(function(e){return function(t,n,e,o,r){var i=Vx(e,o)
Hx(t,n,e,o,i,r)}(o,oi(),{originator:n,kill:g,prevent:g,target:t},t,e),!1}))}))},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return p(t)},getByDom:function(t){return v(t)},build:ta,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){l(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:k},u=function(t){t.connect(i),Ht(t.element)||(e.register(t),U(t.components(),u),i.triggerEvent(mi(),t.element,{target:t.element}))},a=function(t){Ht(t.element)||(U(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){Wf(t,n)},s=function(t){Gf(t)},f=function(t){var n=e.filter(ui())
U(n,(function(n){var e=n.descHandler
ku(e)(t)}))},l=function(t){f({universal:!0,data:t})},d=function(t,n){f({universal:!1,channels:t,data:n})},m=function(t,n){var o=e.filter(t)
return Nx(o,n)},p=function(t){return e.getById(t).fold((function(){return Ue.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),Ue.value)},v=function(t){var n=su(t).getOr("not found")
return p(n)}
return u(t),{root:t,element:t.element,destroy:function(){r.unbind(),De(t.element)},add:c,remove:s,getByUid:p,getByDom:v,addToWorld:u,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:m}},Xx=h([lr("prefix","form-field"),_l("fieldBehaviours",[Id,Ol])]),qx=h([od({schema:[Ko("dom")],name:"label"}),od({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Ko("text")],name:"aria-descriptor"}),nd({factory:{sketch:function(t){var n=kr(t,["factory"])
return t.factory.sketch(n)}},schema:[Ko("factory")],name:"field"})]),Yx=Bd({name:"FormField",configFields:Xx(),partFields:qx(),factory:function(t,n,e,o){var r=Dl(t.fieldBehaviours,[Id.config({find:function(n){return pd(n,t,"field")}}),Ol.config({store:{mode:"manual",getValue:function(t){return Id.getCurrent(t).bind(Ol.getValue)},setValue:function(t,n){Id.getCurrent(t).each((function(t){Ol.setValue(t,n)}))}}})]),i=Ii([Gi((function(n,e){var o=vd(n,t,["label","field","aria-descriptor"])
o.field().each((function(n){var e=ou(t.prefix)
o.label().each((function(t){jn(t.element,"for",e),jn(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=ou(t.prefix)
jn(e.element,"id",o),jn(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return pd(n,t,"field")},getLabel:function(n){return pd(n,t,"label")}}
return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),Kx=Object.freeze({__proto__:null,exhibit:function(t,n){return Su({attributes:Or([{key:n.tabAttr,value:"true"}])})}}),Jx=[lr("tabAttr","data-alloy-tabstop")],$x=Sc({fields:Jx,name:"tabstopping",active:Kx}),Qx=tinymce.util.Tools.resolve("tinymce.html.Entities"),Zx=function(t,n,e,o){var r=tw(t,n,e,o)
return Yx.sketch(r)},tw=function(t,n,e,o){return{dom:nw(e),components:t.toArray().concat([n]),fieldBehaviours:xc(o)}},nw=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},ew=function(t,n){return Yx.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},ow=ou("form-component-change"),rw=ou("form-close"),iw=ou("form-cancel"),uw=ou("form-action"),aw=ou("form-submit"),cw=ou("form-block"),sw=ou("form-unblock"),fw=ou("form-tabchange"),lw=ou("form-resize"),dw=function(t,n){var e,o,r,i=t.label.map((function(t){return ew(t,n)})),u=function(t){return function(n,e){fa(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,Gn(o,"data-collection-item-value"))}))}},a=u((function(e,o,r,i){o.stop(),n.isDisabled()||Ei(e,uw,{name:t.name,value:i})})),c=[Pi(Ur(),u((function(t,n,e){Ec(e)}))),Pi(Jr(),a),Pi(si(),a),Pi(jr(),u((function(t,n,e){sa(t.element,"."+kv).each((function(t){Hu(t,kv)})),Vu(e,kv)}))),Pi(Gr(),u((function(t){sa(t.element,"."+kv).each((function(t){Hu(t,kv)}))}))),Yi(u((function(n,e,o,r){Ei(n,uw,{name:t.name,value:r})})))],s=function(t,n){return W(of(t.element,".tox-collection__item"),n)},f=Yx.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:v},behaviours:xc([Yd.config({disabled:n.isDisabled,onDisabled:function(t){s(t,(function(t){Vu(t,"tox-collection__item--state-disabled"),jn(t,"aria-disabled",!0)}))},onEnabled:function(t){s(t,(function(t){Hu(t,"tox-collection__item--state-disabled"),Yn(t,"aria-disabled")}))}}),jb(),ip.config({}),Ol.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){(function(e,o){var r=W(o,(function(e){var o=vh.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}))
return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+Qx.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==t.columns&&t.columns>1?L(r,t.columns):[r],u=W(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}))
Ji(e.element,u.join(""))})(e,o),"auto"===t.columns&&eb(e,5,"tox-collection__item").each((function(t){var n=t.numRows,o=t.numColumns
tp.setGridSize(e,n,o)})),Di(e,lw)}}),$x.config({}),tp.config((o=t.columns,r="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===r?".tox-swatches__row":".tox-collection__group",cell:"color"===r?".tox-swatch":"."+hv}})),up("collection-events",c)]),eventOrder:(e={},e[ai()]=["disabling","alloy.base.behaviour","collection-events"],e)})
return Zx(i,f,["tox-form__group--collection"],[])},mw=h([rr("data"),lr("inputAttributes",{}),lr("inputStyles",{}),lr("tag","input"),lr("inputClasses",[]),Ta("onSetValue"),lr("styles",{}),lr("eventOrder",{}),_l("inputBehaviours",[Ol,lp]),lr("selectOnFocus",!0)]),gw=function(t){return xc([lp.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=Wu(n)
n.dom.setSelectionRange(0,e.length)}:g})])},pw=function(t){return O(O({},gw(t)),Dl(t.inputBehaviours,[Ol.config({store:O(O({mode:"manual"},t.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return Wu(t.element)},setValue:function(t,n){Wu(t.element)!==n&&Uu(t.element,n)}}),onSetValue:t.onSetValue})]))},hw=function(t){return{tag:t.tag,attributes:O({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},vw=Ed({name:"Input",configFields:mw(),factory:function(t,n){return{uid:t.uid,dom:hw(t),components:[],behaviours:pw(t),eventOrder:t.eventOrder}}}),bw={},yw={exports:bw};(function(t,n,e,o){(function(o,r){"object"==typeof n&&void 0!==e?e.exports=r():"function"==typeof t&&t.amd?t(r):(o="undefined"!=typeof globalThis?globalThis:o||self).EphoxContactWrapper=r()})(this,(function(){var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n={exports:{}};(function(n){(function(t){var e=setTimeout
function o(){}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new")
if("function"!=typeof t)throw new TypeError("not a function")
this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function i(t,n){for(;3===t._state;)t=t._value
0!==t._state?(t._handled=!0,r._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected
if(null!==e){var o
try{o=e(t._value)}catch(r){return void a(n.promise,r)}u(n.promise,o)}else(1===t._state?u:a)(n.promise,t._value)}))):t._deferreds.push(n)}function u(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.")
if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then
if(n instanceof r)return t._state=3,t._value=n,void c(t)
if("function"==typeof e)return void f((o=e,i=n,function(){o.apply(i,arguments)}),t)}t._state=1,t._value=n,c(t)}catch(u){a(t,u)}var o,i}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn((function(){t._handled||r._unhandledRejectionFn(t._value)}))
for(var n=0,e=t._deferreds.length;n<e;n++)i(t,t._deferreds[n])
t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function f(t,n){var e=!1
try{t((function(t){e||(e=!0,u(n,t))}),(function(t){e||(e=!0,a(n,t))}))}catch(o){if(e)return
e=!0,a(n,o)}}r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var e=new this.constructor(o)
return i(this,new s(t,n,e)),e},r.all=function(t){var n=Array.prototype.slice.call(t)
return new r((function(t,e){if(0===n.length)return t([])
var o=n.length
function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then
if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0==--o&&t(n)}catch(c){e(c)}}for(var i=0;i<n.length;i++)r(i,n[i])}))},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r((function(n){n(t)}))},r.reject=function(t){return new r((function(n,e){e(t)}))},r.race=function(t){return new r((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},r._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},n.exports?n.exports=r:t.Promise||(t.Promise=r)})(t)})(n)
var e=n.exports
return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||e}}))})(void 0,bw,yw)
var xw,ww=yw.exports.boltExport,Sw=function(t){var n=F.none(),e=[],o=function(t){r()?u(t):e.push(t)},r=function(){return n.isSome()},i=function(t){U(t,u)},u=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))}
return t((function(t){r()||(n=F.some(t),i(e),e=[])})),{get:o,map:function(t){return Sw((function(n){o((function(e){n(t(e))}))}))},isReady:r}},kw={nu:Sw,pure:function(t){return Sw((function(n){n(t)}))}},Cw=function(t){setTimeout((function(){throw t}),0)},Ow=function(t){var n=function(n){t().then(n,Cw)}
return{map:function(n){return Ow((function(){return t().then(n)}))},bind:function(n){return Ow((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return Ow((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return kw.nu(n)},toCached:function(){var n=null
return Ow((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},_w=function(t){return Ow((function(){return new ww(t)}))},Tw=function(t){return Ow((function(){return ww.resolve(t)}))},Dw=["input","textarea"],Ew=function(t){var n=Rt(t)
return H(Dw,n)},Bw=function(t,n){var e=n.getRoot(t).getOr(t.element)
Hu(e,n.invalidClass),n.notify.each((function(n){Ew(t.element)&&jn(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Ji(t,n.validHtml)})),n.onValid(t)}))},Mw=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element)
Vu(r,n.invalidClass),n.notify.each((function(n){Ew(t.element)&&jn(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Ji(t,o)})),n.onInvalid(t,o)}))},Aw=function(t,n,e){return n.validator.fold((function(){return Tw(Ue.value(!0))}),(function(n){return n.validate(t)}))},Fw=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),Aw(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return Mw(t,n,0,e),Ue.error(e)}),(function(e){return Bw(t,n),Ue.value(e)})):Ue.error("No longer in system")}))},Iw=Object.freeze({__proto__:null,markValid:Bw,markInvalid:Mw,query:Aw,run:Fw,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element)
return zu(e,n.invalidClass)}}),Rw=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map((function(n){return Ii([Pi(n.onEvent,(function(n){Fw(n,t).get(v)}))].concat(n.validateOnLoad?[Gi((function(n){Fw(n,t).get(g)}))]:[]))})).getOr({})}}),Vw=[Ko("invalidClass"),lr("getRoot",F.none),fr("notify",[lr("aria","alert"),lr("getContainer",F.none),lr("validHtml",""),Ta("onValid"),Ta("onInvalid"),Ta("onValidate")]),fr("validator",[Ko("validate"),lr("onEvent","input"),lr("validateOnLoad",!0)])],Pw=Sc({fields:Vw,name:"invalidating",active:Rw,apis:Iw,extra:{validation:function(t){return function(n){var e=Ol.getValue(n)
return Tw(t(e))}}}}),Hw=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),zw=[Jo("others",No(Ue.value,Eo()))],Nw=Sc({fields:zw,name:"coupling",apis:Hw,state:Object.freeze({__proto__:null,init:function(){var t={},n=h({})
return xu({readState:n,getOrCreate:function(n,e,o){var r=st(e.others)
if(r)return bt(t,o).getOrThunk((function(){var r=bt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r)
return t[o]=i,i}))
throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),Lw=h("sink"),Ww=h(od({name:Lw(),overrides:h({dom:{tag:"div"},behaviours:xc([Pf.config({useFixed:k})]),events:Ii([Wi(Xr()),Wi(zr()),Wi(Jr())])})}));(function(t){t[t.HighlightFirst=0]="HighlightFirst",t[t.HighlightNone=1]="HighlightNone"})(xw||(xw={}))
var Uw,jw,Gw,Xw=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides()
return t.layouts.fold((function(){return{type:o,hotspot:e,overrides:r}}),(function(t){return{type:o,hotspot:e,overrides:r,layouts:t}}))},qw=function(t,n,e,o,r,i,u){return function(t,n,e,o,r,i,u){var a=function(t,n,e){return(0,t.fetch)(e).map(n)}(t,n,o),c=$w(o,t)
return a.map((function(t){return t.bind((function(t){return F.from(qp.sketch(O(O({},i.menu()),{uid:fu(""),data:t,highlightImmediately:u===xw.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie()
Pf.position(o,n,{anchor:e}),il.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie()
Pf.position(o,e,{anchor:{type:"submenu",item:n}}),il.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie()
Pf.position(r,n,{anchor:e}),U(o,(function(t){Pf.position(r,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})}))},onEscape:function(){return lp.focus(o),il.close(r),F.some(!0)}})))}))}))}(t,n,Xw(t,e),e,o,r,u).map((function(t){return t.fold((function(){il.isOpen(o)&&il.close(o)}),(function(t){il.cloak(o),il.open(o,t),i(o)})),o}))},Yw=function(t,n,e,o,r,i,u){return il.close(o),Tw(o)},Kw=function(t,n,e,o,r,i){var u=Nw.getCoupled(e,"sandbox")
return(il.isOpen(u)?Yw:qw)(t,n,e,u,o,r,i)},Jw=function(t,n,e){var o=Id.getCurrent(n).getOr(n),r=ve(t.element)
e?$n(o.element,"min-width",r+"px"):function(t,n){he.set(t,n)}(o.element,r)},$w=function(t,n){return t.getSystem().getByUid(n.uid+"-"+Lw()).map((function(t){return function(){return Ue.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return Ue.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},Qw=function(t){il.getState(t).each((function(t){qp.repositionMenus(t)}))},Zw=function(t,n,e){var o=la(),r=$w(n,t)
return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Bl(t.sandboxBehaviours,[Ol.config({store:{mode:"memory",initialValue:n}}),il.config({onOpen:function(r,i){var u=Xw(t,n)
o.link(n.element),t.matchWidth&&Jw(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return ma(e,o)||ma(n,o)},getAttachPoint:function(){return r().getOrDie()}}),Id.config({find:function(t){return il.getState(t).bind((function(t){return Id.getCurrent(t)}))}}),_c.config({channels:O(O({},fl({isExtraPart:S})),dl({doReposition:Qw}))})])}},tS=function(t){var n=Nw.getCoupled(t,"sandbox")
Qw(n)},nS=function(){return[lr("sandboxClasses",[]),El("sandboxBehaviours",[Id,_c,il,Ol])]},eS=h([Ko("dom"),Ko("fetch"),Ta("onOpen"),Da("onExecute"),lr("getHotspot",F.some),lr("getAnchorOverrides",h({})),Cs(),_l("dropdownBehaviours",[kp,Nw,tp,lp]),Ko("toggleClass"),lr("eventOrder",{}),rr("lazySink"),lr("matchWidth",!1),lr("useMinWidth",!1),rr("role")].concat(nS())),oS=h([ed({schema:[Ca()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Ww()]),rS=Bd({name:"Dropdown",configFields:eS(),partFields:oS(),factory:function(t,n,e,o){var r,i,u=function(t){il.getState(t).each((function(t){qp.highlightPrimary(t)}))},a={expand:function(n){kp.isOn(n)||Kw(t,v,n,o,g,xw.HighlightNone).get(g)},open:function(n){kp.isOn(n)||Kw(t,v,n,o,g,xw.HighlightFirst).get(g)},isOpen:kp.isOn,close:function(n){kp.isOn(n)&&Kw(t,v,n,o,g,xw.HighlightFirst).get(g)},repositionMenus:function(t){kp.isOn(t)&&tS(t)}},c=function(t,n){return Bi(t),F.some(!0)}
return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.dropdownBehaviours,[kp.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),Nw.config({others:{sandbox:function(n){return Zw(t,n,{onOpen:function(){return kp.on(n)},onClose:function(){return kp.off(n)}})}}}),tp.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t,n){if(rS.isOpen(t)){var e=Nw.getCoupled(t,"sandbox")
u(e)}else rS.open(t)
return F.some(!0)},onEscape:function(t,n){return rS.isOpen(t)?(rS.close(t),F.some(!0)):F.none()}}),lp.config({})]),events:Op(F.some((function(n){Kw(t,v,n,o,u,xw.HighlightFirst).get(g)}))),eventOrder:O(O({},t.eventOrder),(r={},r[ai()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:a,domModification:{attributes:O(O({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:(i="type",bt(t.dom,"attributes").bind((function(t){return bt(t,i)}))).getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),iS=Object.freeze({__proto__:null,events:function(){return Ii([Ri(ti(),k)])},exhibit:function(){return Su({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),uS=Sc({fields:[],name:"unselecting",active:iS}),aS=ou("color-input-change"),cS=ou("color-swatch-change"),sS=ou("color-picker-cancel"),fS=function(t,n,e){var o=Yx.parts.field({factory:vw,inputClasses:["tox-textfield"],onSetValue:function(t){return Pw.run(t).get(g)},inputBehaviours:xc([Yd.config({disabled:n.providers.isDisabled}),jb(),$x.config({}),Pw.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return _n(t.element)},notify:{onValid:function(t){var n=Ol.getValue(t)
Ei(t,aS,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=Ol.getValue(t)
if(0===n.length)return Tw(Ue.value(!0))
var e=Ft.fromTag("span")
$n(e,"background-color",n)
var o=ee(e,"background-color").fold((function(){return Ue.error("blah")}),(function(t){return Ue.value(n)}))
return Tw(o)}}})]),selectOnFocus:!1}),r=t.label.map((function(t){return ew(t,n.providers)})),i=function(t,n){Ei(t,cS,{value:n})},u=hh(function(t,n){return rS.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:xc([Xb(n.providers.isDisabled),jb(),uS.config({}),$x.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return _w((function(n){return t.fetch(n)})).map((function(o){return F.from(Dx(uo(cx(ou("menu-value"),o,(function(n){t.onItemAction(e,n)}),t.columns,t.presets,gv.CLOSE_ON_EXECUTE,S,n.providers),{movement:fx(t.columns,t.presets)})))}))},parts:{menu:Av(0,0,t.presets)}})}({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[nc,tc,ic]},onLtr:function(){return[tc,nc,ic]}},components:[],fetch:ox(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){u.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return Di(t,sS)}),(function(n){i(t,n),Qy(n)}))}),"#ffffff"):i(t,"remove"===n?"":n)}))}},n))
return Yx.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,u.asSpec()]}]),fieldBehaviours:xc([up("form-field-events",[Pi(aS,(function(n,e){u.getOpt(n).each((function(t){$n(t.element,"background-color",e.event.color)})),Ei(n,ow,{name:t.name})})),Pi(cS,(function(t,n){Yx.getField(t).each((function(e){Ol.setValue(e,n.event.value),Id.getCurrent(t).each(lp.focus)}))})),Pi(sS,(function(t,n){Yx.getField(t).each((function(n){Id.getCurrent(t).each(lp.focus)}))}))])])})},lS=od({schema:[Ko("dom")],name:"label"}),dS=function(t){return od({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:Ii([Hi(Rr(),(function(n,e,o){return t(n,o)}),[n]),Hi(zr(),(function(n,e,o){return t(n,o)}),[n]),Hi(Nr(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},mS=dS("top-left"),gS=dS("top"),pS=dS("top-right"),hS=dS("right"),vS=dS("bottom-right"),bS=dS("bottom"),yS=dS("bottom-left"),xS=dS("left"),wS=nd({name:"thumb",defaults:h({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Ii([Ni(Rr(),t,"spectrum"),Ni(Vr(),t,"spectrum"),Ni(Pr(),t,"spectrum"),Ni(zr(),t,"spectrum"),Ni(Nr(),t,"spectrum"),Ni(Wr(),t,"spectrum")])}}}),SS=nd({schema:[qo("mouseIsDown",(function(){return xr(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))}
return{behaviours:xc([tp.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),lp.config({})]),events:Ii([Pi(Rr(),e),Pi(Vr(),e),Pi(zr(),e),Pi(Nr(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}}),kS=[lS,xS,hS,gS,bS,mS,pS,yS,vS,wS,SS],CS=h("slider.change.value"),OS=function(t){var n=t.event.raw
if(function(t){return-1!==t.type.indexOf("touch")}(n)){var e=n
return void 0!==e.touches&&1===e.touches.length?F.some(e.touches[0]).map((function(t){return de(t.clientX,t.clientY)})):F.none()}var o=n
return void 0!==o.clientX?F.some(o).map((function(t){return de(t.clientX,t.clientY)})):F.none()},_S=function(t){return t.model.minX},TS=function(t){return t.model.minY},DS=function(t){return t.model.minX-1},ES=function(t){return t.model.minY-1},BS=function(t){return t.model.maxX},MS=function(t){return t.model.maxY},AS=function(t){return t.model.maxX+1},FS=function(t){return t.model.maxY+1},IS=function(t,n,e){return n(t)-e(t)},RS=function(t){return IS(t,BS,_S)},VS=function(t){return IS(t,MS,TS)},PS=function(t){return RS(t)/2},HS=function(t){return VS(t)/2},zS=function(t){return t.stepSize},NS=function(t){return t.snapToGrid},LS=function(t){return t.snapStart},WS=function(t){return t.rounded},US=function(t,n){return void 0!==t[n+"-edge"]},jS=function(t){return US(t,"left")},GS=function(t){return US(t,"right")},XS=function(t){return US(t,"top")},qS=function(t){return US(t,"bottom")},YS=function(t){return t.model.value.get()},KS=function(t){return{x:t}},JS=function(t){return{y:t}},$S=function(t,n){return{x:t,y:n}},QS=function(t,n){Ei(t,CS(),{value:n})},ZS=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},tk=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},nk=function(t,n,e){return Math.max(n,Math.min(e,t))},ek=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e
if(r<l)return g
if(r>d)return p
var h=function(t,n,e){return Math.min(e,Math.max(t,n))-n}(r,l,d),v=nk(h/m*o+n,g,p)
return u&&v>=n&&v<=e?function(t,n,e,o,r){return r.fold((function(){var r=t-n,i=Math.round(r/o)*o
return nk(n+i,n-1,e+1)}),(function(n){var r=(t-n)%o,i=Math.round(r/o),u=Math.floor((t-n)/o),a=Math.floor((e-n)/o),c=n+Math.min(a,u+i)*o
return Math.max(n,c)}))}(v,n,e,i,a):c?Math.round(v):v},ok=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge
return r<n?i?0:s:r>e?u?a:f:(r-n)/o*c},rk="top",ik="right",uk="bottom",ak="left",ck=function(t){return t.element.dom.getBoundingClientRect()},sk=function(t,n){return t[n]},fk=function(t){var n=ck(t)
return sk(n,ak)},lk=function(t){var n=ck(t)
return sk(n,ik)},dk=function(t){var n=ck(t)
return sk(n,rk)},mk=function(t){var n=ck(t)
return sk(n,uk)},gk=function(t){var n=ck(t)
return sk(n,"width")},pk=function(t){var n=ck(t)
return sk(n,"height")},hk=function(t,n,e){return(t+n)/2-e},vk=function(t,n){var e=ck(t),o=ck(n),r=sk(e,ak),i=sk(e,ik),u=sk(o,ak)
return hk(r,i,u)},bk=function(t,n){var e=ck(t),o=ck(n),r=sk(e,rk),i=sk(e,uk),u=sk(o,rk)
return hk(r,i,u)},yk=function(t,n){Ei(t,CS(),{value:n})},xk=function(t){return{x:t}},wk=function(t,n,e){var o={min:_S(n),max:BS(n),range:RS(n),value:e,step:zS(n),snap:NS(n),snapStart:LS(n),rounded:WS(n),hasMinEdge:jS(n),hasMaxEdge:GS(n),minBound:fk(t),maxBound:lk(t),screenRange:gk(t)}
return ek(o)},Sk=function(t){return function(n,e){return function(t,n,e){var o=(t>0?tk:ZS)(YS(e).x,_S(e),BS(e),zS(e))
return yk(n,xk(o)),F.some(o)}(t,n,e).map(k)}},kk=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=gk(t),u=o.bind((function(n){return F.some(vk(n,t))})).getOr(0),a=r.bind((function(n){return F.some(vk(n,t))})).getOr(i),c={min:_S(n),max:BS(n),range:RS(n),value:e,hasMinEdge:jS(n),hasMaxEdge:GS(n),minBound:fk(t),minOffset:0,maxBound:lk(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a}
return ok(c)}(n,i,e,o,r)
return fk(n)-fk(t)+u},Ck=Sk(-1),Ok=Sk(1),_k=F.none,Tk=F.none,Dk={"top-left":F.none(),top:F.none(),"top-right":F.none(),right:F.some((function(t,n){QS(t,KS(AS(n)))})),"bottom-right":F.none(),bottom:F.none(),"bottom-left":F.none(),left:F.some((function(t,n){QS(t,KS(DS(n)))}))},Ek=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=wk(t,n,e),r=xk(o)
return yk(t,r),o},setToMin:function(t,n){var e=_S(n)
yk(t,xk(e))},setToMax:function(t,n){var e=BS(n)
yk(t,xk(e))},findValueOfOffset:wk,getValueFromEvent:function(t){return OS(t).map((function(t){return t.left}))},findPositionOfValue:kk,setPositionFromValue:function(t,n,e,o){var r=YS(e),i=kk(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=ve(n.element)/2
$n(n.element,"left",i-u+"px")},onLeft:Ck,onRight:Ok,onUp:_k,onDown:Tk,edgeActions:Dk}),Bk=function(t,n){Ei(t,CS(),{value:n})},Mk=function(t){return{y:t}},Ak=function(t,n,e){var o={min:TS(n),max:MS(n),range:VS(n),value:e,step:zS(n),snap:NS(n),snapStart:LS(n),rounded:WS(n),hasMinEdge:XS(n),hasMaxEdge:qS(n),minBound:dk(t),maxBound:mk(t),screenRange:pk(t)}
return ek(o)},Fk=function(t){return function(n,e){return function(t,n,e){var o=(t>0?tk:ZS)(YS(e).y,TS(e),MS(e),zS(e))
return Bk(n,Mk(o)),F.some(o)}(t,n,e).map(k)}},Ik=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=pk(t),u=o.bind((function(n){return F.some(bk(n,t))})).getOr(0),a=r.bind((function(n){return F.some(bk(n,t))})).getOr(i),c={min:TS(n),max:MS(n),range:VS(n),value:e,hasMinEdge:XS(n),hasMaxEdge:qS(n),minBound:dk(t),minOffset:0,maxBound:mk(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a}
return ok(c)}(n,i,e,o,r)
return dk(n)-dk(t)+u},Rk=F.none,Vk=F.none,Pk=Fk(-1),Hk=Fk(1),zk={"top-left":F.none(),top:F.some((function(t,n){QS(t,JS(ES(n)))})),"top-right":F.none(),right:F.none(),"bottom-right":F.none(),bottom:F.some((function(t,n){QS(t,JS(FS(n)))})),"bottom-left":F.none(),left:F.none()},Nk=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Ak(t,n,e),r=Mk(o)
return Bk(t,r),o},setToMin:function(t,n){var e=TS(n)
Bk(t,Mk(e))},setToMax:function(t,n){var e=MS(n)
Bk(t,Mk(e))},findValueOfOffset:Ak,getValueFromEvent:function(t){return OS(t).map((function(t){return t.top}))},findPositionOfValue:Ik,setPositionFromValue:function(t,n,e,o){var r=YS(e),i=Ik(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=se(n.element)/2
$n(n.element,"top",i-u+"px")},onLeft:Rk,onRight:Vk,onUp:Pk,onDown:Hk,edgeActions:zk}),Lk=function(t,n){Ei(t,CS(),{value:n})},Wk=function(t,n){return{x:t,y:n}},Uk=function(t,n){return function(e,o){return function(t,n,e,o){var r=t>0?tk:ZS,i=n?YS(o).x:r(YS(o).x,_S(o),BS(o),zS(o)),u=n?r(YS(o).y,TS(o),MS(o),zS(o)):YS(o).y
return Lk(e,Wk(i,u)),F.some(i)}(t,n,e,o).map(k)}},jk=Uk(-1,!1),Gk=Uk(1,!1),Xk=Uk(-1,!0),qk=Uk(1,!0),Yk={"top-left":F.some((function(t,n){QS(t,$S(DS(n),ES(n)))})),top:F.some((function(t,n){QS(t,$S(PS(n),ES(n)))})),"top-right":F.some((function(t,n){QS(t,$S(AS(n),ES(n)))})),right:F.some((function(t,n){QS(t,$S(AS(n),HS(n)))})),"bottom-right":F.some((function(t,n){QS(t,$S(AS(n),FS(n)))})),bottom:F.some((function(t,n){QS(t,$S(PS(n),FS(n)))})),"bottom-left":F.some((function(t,n){QS(t,$S(DS(n),FS(n)))})),left:F.some((function(t,n){QS(t,$S(DS(n),HS(n)))}))},Kk=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=wk(t,n,e.left),r=Ak(t,n,e.top),i=Wk(o,r)
return Lk(t,i),i},setToMin:function(t,n){var e=_S(n),o=TS(n)
Lk(t,Wk(e,o))},setToMax:function(t,n){var e=BS(n),o=MS(n)
Lk(t,Wk(e,o))},getValueFromEvent:function(t){return OS(t)},setPositionFromValue:function(t,n,e,o){var r=YS(e),i=kk(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Ik(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=ve(n.element)/2,c=se(n.element)/2
$n(n.element,"left",i-a+"px"),$n(n.element,"top",u-c+"px")},onLeft:jk,onRight:Gk,onUp:Xk,onDown:qk,edgeActions:Yk}),Jk=Bd({name:"Slider",configFields:[lr("stepSize",1),lr("onChange",g),lr("onChoose",g),lr("onInit",g),lr("onDragStart",g),lr("onDragEnd",g),lr("snapToGrid",!1),lr("rounded",!0),rr("snapStart"),Jo("model",Go("mode",{x:[lr("minX",0),lr("maxX",100),qo("value",(function(t){return xr(t.mode.minX)})),Ko("getInitialValue"),Ma("manager",Ek)],y:[lr("minY",0),lr("maxY",100),qo("value",(function(t){return xr(t.mode.minY)})),Ko("getInitialValue"),Ma("manager",Nk)],xy:[lr("minX",0),lr("maxX",100),lr("minY",0),lr("maxY",100),qo("value",(function(t){return xr({x:t.mode.minX,y:t.mode.minY})})),Ko("getInitialValue"),Ma("manager",Kk)]})),_l("sliderBehaviours",[tp,Ol]),qo("mouseIsDown",(function(){return xr(!1)}))],partFields:kS,factory:function(t,n,e,o){var r,i=function(n){return hd(n,t,"thumb")},u=function(n){return hd(n,t,"spectrum")},a=function(n){return pd(n,t,"left-edge")},c=function(n){return pd(n,t,"right-edge")},s=function(n){return pd(n,t,"top-edge")},f=function(n){return pd(n,t,"bottom-edge")},l=t.model,d=l.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(t,n){l.value.set(n)
var e=i(t)
m(t,e)},p=function(n){var e=t.mouseIsDown.get()
t.mouseIsDown.set(!1),e&&pd(n,t,"thumb").each((function(e){var o=l.value.get()
t.onChoose(n,e,o)}))},h=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},v=function(n,e){e.stop(),t.onDragEnd(n,i(n)),p(n)}
return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.sliderBehaviours,[tp.config({mode:"special",focusIn:function(n){return pd(n,t,"spectrum").map(tp.focusIn).map(k)}}),Ol.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),_c.config({channels:(r={},r[cl()]={onReceive:p},r)})]),events:Ii([Pi(CS(),(function(n,e){(function(n,e){g(n,e)
var o=i(n)
t.onChange(n,o,e),F.some(!0)})(n,e.event.value)})),Gi((function(n,e){var o=l.getInitialValue()
l.value.set(o)
var r=i(n)
m(n,r)
var a=u(n)
t.onInit(n,r,a,l.value.get())})),Pi(Rr(),h),Pi(Pr(),v),Pi(zr(),h),Pi(Wr(),v)]),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),$k=ou("rgb-hex-update"),Qk=ou("slider-update"),Zk=ou("palette-update"),tC="form",nC=[_l("formBehaviours",[Ol])],eC=function(t){return"<alloy.field."+t+">"},oC=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.formBehaviours,[Ol.config({store:{mode:"manual",getValue:function(n){var e=bd(n,t)
return dt(e,(function(t,n){return t().bind((function(t){var e,o,r=Id.getCurrent(t)
return e=r,o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Zi(t.element)),e.fold((function(){return Ue.error(o)}),Ue.value)})).map(Ol.getValue)}))},setValue:function(n,e){lt(e,(function(e,o){pd(n,t,o).each((function(t){Id.getCurrent(t).each((function(t){Ol.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return pd(n,t,e).bind(Id.getCurrent)}}}},rC={getField:bu((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n=function(){var t=[]
return{field:function(n,e){return t.push(n),fd(tC,eC(n),e)},record:h(t)}}(),e=t(n),o=n.record(),r=W(o,(function(t){return nd({name:t,pname:eC(t)})}))
return Od(tC,nC,r,oC,e)}},iC=ou("valid-input"),uC=ou("invalid-input"),aC=ou("validating-input"),cC="colorcustom.rgb.",sC=function(t,n,e,o){var r=function(e,o){return Pw.config({invalidClass:n("invalid"),notify:{onValidate:function(t){Ei(t,aC,{type:e})},onValid:function(t){Ei(t,iC,{type:e,value:Ol.getValue(t)})},onInvalid:function(t){Ei(t,uC,{type:e,value:Ol.getValue(t)})}},validator:{validate:function(n){var e=Ol.getValue(n),r=o(e)?Ue.value(!0):Ue.error(t("aria.input.invalid"))
return Tw(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=t("colorcustom.rgb.range"),s=[Yx.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Yx.parts.field({data:a,factory:vw,inputAttributes:O({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:xc([r(o,e),$x.config({})]),onSetValue:function(t){Pw.isInvalid(t)&&Pw.run(t).get(g)}})],f="hex"!==o?[Yx.parts["aria-descriptor"]({text:c})]:[]
return{dom:{tag:"div",attributes:{role:"presentation"}},components:s.concat(f)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue
Ol.setValue(t,{red:e,green:o,blue:r})},a=hh({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){$n(t.element,"background-color","#"+n.value)}))}
return Ed({factory:function(){var r={red:xr(F.some(255)),green:xr(F.some(255)),blue:xr(F.some(255)),hex:xr(F.some("ffffff"))},s=function(t){return r[t].get()},f=function(t,n){r[t].set(n)},l=function(t){var n=t.red,e=t.green,o=t.blue
f("red",F.some(n)),f("green",F.some(e)),f("blue",F.some(o))},d=function(t,n){var e=n.event
"hex"!==e.type?f(e.type,F.none()):o(t)},m=function(t,n,e){var o=parseInt(e,10)
f(n,F.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return My(t,n,e,1)}))}))})).each((function(n){var e=function(t,n){var e=Oy(n)
return rC.getField(t,"hex").each((function(n){lp.isFocused(n)||Ol.setValue(t,{hex:e.value})})),e}(t,n)
Ei(t,$k,{hex:e}),c(t,e)}))},g=function(t,n){var o=n.event
!function(t){return"hex"===t.type}(o)?m(t,o.type,o.value):function(t,n){e(t)
var o=by(n)
f("hex",F.some(n))
var r=Iy(o)
u(t,r),l(r),Ei(t,$k,{hex:o}),c(t,o)}(t,o.value)},p=function(n){return{label:t(cC+n+".label"),description:t(cC+n+".description")}},h=p("red"),v=p("green"),b=p("blue"),y=p("hex")
return uo(rC.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",Yx.sketch(i(Ay,"red",h.label,h.description,255))),e.field("green",Yx.sketch(i(Ay,"green",v.label,v.description,255))),e.field("blue",Yx.sketch(i(Ay,"blue",b.label,b.description,255))),e.field("hex",Yx.sketch(i(wy,"hex",y.label,y.description,"ffffff"))),a.asSpec()],formBehaviours:xc([Pw.config({invalidClass:n("form-invalid")}),up("rgb-form-events",[Pi(iC,g),Pi(uC,d),Pi(aC,d)])])}})),{apis:{updateHex:function(t,n){Ol.setValue(t,{hex:n.value}),function(t,n){var e=Iy(n)
u(t,e),l(e)}(t,n),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},fC=function(t,n){var e=Jk.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=Jk.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d")
if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o)
var i=r.createLinearGradient(0,0,e,0)
i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o)
var u=r.createLinearGradient(0,0,0,o)
u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}}
return Ed({factory:function(t){var i=h({x:0,y:0}),u=xc([Id.config({find:F.some}),lp.config({})])
return Jk.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:function(t,n,e){Ei(t,Zk,{value:e})},onInit:function(t,n,e,o){r(e.element.dom,Py(Hy))},sliderBehaviours:u})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){(function(t,n){var e=t.components()[0].element.dom,o=Ny(n,100,100),i=Fy(o)
r(e,Py(i))})(n,e)},setThumb:function(t,n,e){(function(t,n){var e=Ly(Iy(n))
Jk.setValue(t,{x:e.saturation,y:100-e.value})})(n,e)}},extraApis:{}})},lC=function(t,n){return Ed({name:"ColourPicker",configFields:[Ko("dom"),lr("onValidHex",g),lr("onInvalidHex",g)],factory:function(e){var o,r=sC(t,n,e.onValidHex,e.onInvalidHex),i=fC(0,n),u=function(t){return 100-t/360*100},a={paletteRgba:xr(Hy),paletteHue:xr(0)},c=hh(function(t,n){var e=Jk.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=Jk.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}})
return Jk.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:h({y:0})},components:[e,o],sliderBehaviours:xc([lp.config({})]),onChange:function(t,n,e){Ei(t,Qk,{value:e})}})}(0,n)),s=hh(i.sketch({})),f=hh(r.sketch({})),l=function(t,n,e){s.getOpt(t).each((function(t){i.setHue(t,e)}))},d=function(t,n){f.getOpt(t).each((function(t){r.updateHex(t,n)}))},m=function(t,n,e){c.getOpt(t).each((function(t){Jk.setValue(t,{y:u(e)})}))},g=function(t,n){s.getOpt(t).each((function(t){i.setThumb(t,n)}))},p=function(t,n,e,o){(function(t,n){var e=Iy(t)
a.paletteRgba.set(e),a.paletteHue.set(n)})(n,e),U(o,(function(o){o(t,n,e)}))}
return{uid:e.uid,dom:e.dom,components:[s.asSpec(),c.asSpec(),f.asSpec()],behaviours:xc([up("colour-picker-events",[Pi($k,(o=[l,m,g],function(t,n){var e=n.event.hex,r=function(t){return Ly(Iy(t))}(e)
p(t,e,r.hue,o)})),Pi(Zk,function(){var t=[d]
return function(n,e){var o=e.event.value,r=a.paletteHue.get(),i=Ny(r,o.x,100-o.y),u=Wy(i)
p(n,u,r,t)}}()),Pi(Qk,function(){var t=[l,d]
return function(n,e){var o=function(t){return(100-t)/100*360}(e.event.value.y),r=a.paletteRgba.get(),i=Ly(r),u=Ny(o,i.saturation,i.value),c=Wy(u)
p(n,c,o,t)}}())]),Id.config({find:function(t){return f.getOpt(t)}}),tp.config({mode:"acyclic"})])}}})},dC=function(){return Id.config({find:F.some})},mC=function(t){return Id.config({find:t.getOpt})},gC=function(t){return Id.config({find:function(n){return En(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},pC={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},hC=function(t){return function(t){return pC[t]}(t)},vC=tinymce.util.Tools.resolve("tinymce.Resource"),bC=tinymce.util.Tools.resolve("tinymce.util.Tools"),yC=Co([lr("preprocess",v),lr("postprocess",v)]),xC=function(t,n,e){return Ol.config(uo({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},wC=function(t,n,e){return xC(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))},SC=function(t,n){var e=Uo("RepresentingConfigs.memento processors",yC,n)
return Ol.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=Ol.getValue(o)
return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n)
Ol.setValue(i,r)}}})},kC=xC,CC=function(t){return wC(t,Ki,Ji)},OC=function(t){return Ol.config({store:{mode:"memory",initialValue:t}})},_C=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){U(t,(function(t){t(n,e)}))}},r=function(t,n){if(!Yd.isDisabled(t)){var e=n.event.raw
u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event.raw.target
u(t,e.files)},u=function(e,o){Ol.setValue(e,function(t,n){var e=bC.explode(n.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"))
return G(at(t),(function(t){return z(e,(function(n){return Dt(t.name.toLowerCase(),"."+n.toLowerCase())}))}))}(o,n)),Ei(e,ow,{name:t.name})},a=hh({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:xc([up("input-file-events",[Wi(Jr()),Wi(si())])])}),c=t.label.map((function(t){return ew(t,n)})),s=Yx.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:xc([OC([]),dC(),Yd.config({}),kp.config({toggleClass:"dragenter",toggleOnExecute:!1}),up("dropzone-events",[Pi("dragenter",o([e,kp.toggle])),Pi("dragleave",o([e,kp.toggle])),Pi("dragover",e),Pi("drop",o([e,r])),Pi(Kr(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},ph.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:xc([$x.config({}),Xb(n.isDisabled),jb()])})]}]}}}})
return Zx(c,s,["tox-form__group--stretched"],[])},TC=ou("alloy-fake-before-tabstop"),DC=ou("alloy-fake-after-tabstop"),EC=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:xc([lp.config({ignore:!0}),$x.config({})])}},BC=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[EC([TC]),t,EC([DC])],behaviours:xc([gC(1)])}},MC=function(t,n){Ei(t,Xr(),{raw:{which:9,shiftKey:n}})},AC=function(t,n){var e=n.element
zu(e,TC)?MC(t,!0):zu(e,DC)&&MC(t,!1)},FC=function(t){return Bx(t,["."+TC,"."+DC].join(","),S)},IC=!(hn().browser.isIE()||hn().browser.isEdge()),RC=function(t,n){var e=IC&&t.sandboxed,o=O(O({},t.label.map((function(t){return{title:t}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(t){var n=xr("")
return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)jn(e.element,"srcdoc",o)
else{jn(e.element,"src","javascript:''")
var r=e.element.dom.contentWindow.document
r.open(),r.write(o),r.close()}n.set(o)}}}(e),i=t.label.map((function(t){return ew(t,n)})),u=Yx.parts.field({factory:{sketch:function(t){return BC({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:xc([$x.config({}),lp.config({}),kC(F.none(),r.getValue,r.setValue)])})}}})
return Zx(i,u,["tox-form__group--stretched"],[])},VC=function(t,n){return zC(document.createElement("canvas"),t,n)},PC=function(t){var n=VC(t.width,t.height)
return HC(n).drawImage(t,0,0),n},HC=function(t){return t.getContext("2d")},zC=function(t,n,e){return t.width=n,t.height=e,t},NC=function(t){return t.naturalWidth||t.width},LC=function(t){return t.naturalHeight||t.height},WC=function(t){return new ww((function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0])
if(!e)return F.none()
for(var o=e[1],r=n[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0)
s[f]=new Uint8Array(m)}return F.some(new Blob(s,{type:o}))})(t).fold((function(){e("uri is not base64: "+t)}),n)}))},UC=function(t,n,e){return n=n||"image/png",l(HTMLCanvasElement.prototype.toBlob)?new ww((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):WC(t.toDataURL(n,e))},jC=function(t){return function(t){return new ww((function(n,e){var o=URL.createObjectURL(t),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),n(r)},a=function(){i(),e("Unable to load data of type "+t.type+": "+o)}
r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))}(t).then((function(t){GC(t)
var n=VC(NC(t),LC(t))
return HC(n).drawImage(t,0,0),n}))},GC=function(t){URL.revokeObjectURL(t.src)},XC=function(t,n,e){var o=n.type,r=h(o),i=h(e),u=function(n,e){return t.then((function(t){return function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)}(t,n,e)}))}
return{getType:r,toBlob:function(){return ww.resolve(n)},toDataURL:i,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return UC(t,n,e)}))},toAdjustedDataURL:u,toAdjustedBase64:function(t,n){return u(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(PC)}}},qC=function(t){return function(t){return new ww((function(n){var e=new FileReader
e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}))}(t).then((function(n){return XC(jC(t),t,n)}))},YC=function(t,n){return UC(t,n).then((function(n){return XC(ww.resolve(t),n,t.toDataURL())}))},KC=function(t,n,e){var o="string"==typeof t?parseFloat(t):t
return o>e?o=e:o<n&&(o=n),o},JC=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],$C=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i]
for(u=0;u<5;u++){e=0
for(var a=0;a<5;a++)e+=t[u+5*a]*o[a]
r[u+5*i]=e}}return r},QC=function(t,n){return t.toCanvas().then((function(e){return ZC(e,t.getType(),n)}))},ZC=function(t,n,e){var o=HC(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_
return t}(o.getImageData(0,0,t.width,t.height),e)
return o.putImageData(r,0,0),YC(t,n)},tO=function(t,n,e){var o=HC(t),r=o.getImageData(0,0,t.width,t.height),i=o.getImageData(0,0,t.width,t.height)
return i=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=4*(o(f+p-i,0,s-1)*c+v),y=e[p*r+h]
d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(f*c+l)
a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return n}(r,i,e),o.putImageData(i,0,0),YC(t,n)},nO=function(t){return function(n,e){return QC(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}},eO=function(t){return function(n){return QC(n,t)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),oO=nO((function(t,n){return n=KC(255*n,-255,255),$C(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),rO=nO((function(t,n){var e
return n=KC(n,-1,1),e=(n*=100)<0?127+n/100*127:127*(e=0===(e=n%1)?JC[n]:JC[Math.floor(n)]*(1-e)+JC[Math.floor(n)+1]*e)+127,$C(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),iO=function(t,n,e,o){return QC(t,function(t,n,e,o){return n=KC(n,0,2),e=KC(e,0,2),o=KC(o,0,2),$C(t,[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],n,e,o))},uO=(Uw=[0,-1,0,-1,5,-1,0,-1,0],function(t){return function(t,n){return t.toCanvas().then((function(e){return tO(e,t.getType(),n)}))}(t,Uw)}),aO=(jw=function(t,n){return 255*Math.pow(t/255,1-n)},function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){for(var o=HC(t),r=new Array(256),i=0;i<r.length;i++)r[i]=jw(i,e)
var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]]
return t}(o.getImageData(0,0,t.width,t.height),r)
return o.putImageData(u,0,0),YC(t,n)}(e,t.getType(),n)}))}),cO=function(t,n,e){var o=NC(t),r=LC(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0)
var c=sO(t,i,u)
return a?c.then((function(t){return cO(t,n,e)})):c},sO=function(t,n,e){return new ww((function(o){var r=NC(t),i=LC(t),u=Math.floor(r*n),a=Math.floor(i*e),c=VC(u,a)
HC(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},fO=function(t,n){void 0===n&&(n=2)
var e=Math.pow(10,n),o=Math.round(t*e)
return Math.ceil(o/e)},lO=function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=fO(Math.abs(r*a)+Math.abs(i*u)),s=fO(Math.abs(r*u)+Math.abs(i*a)),f=VC(c,s),l=HC(f)
return l.translate(c/2,s/2),l.rotate(o),l.drawImage(t,-r/2,-i/2),YC(f,n)},dO=function(t,n,e){var o=VC(t.width,t.height),r=HC(o)
return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),YC(o,n)},mO=function(t,n,e,o,r,i){var u=VC(r,i)
return HC(u).drawImage(t,-e,-o),YC(u,n)},gO=function(t){return eO(t)},pO=function(t){return uO(t)},hO=function(t,n){return aO(t,n)},vO=function(t,n){return oO(t,n)},bO=function(t,n){return rO(t,n)},yO=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return dO(e,t.getType(),n)}))}(t,n)},xO=function(t,n,e,o,r){return function(t,n,e,o,r){return t.toCanvas().then((function(i){return mO(i,t.getType(),n,e,o,r)}))}(t,n,e,o,r)},wO=function(t,n,e){return function(t,n,e){return t.toCanvas().then((function(o){return cO(o,n,e).then((function(n){return YC(n,t.getType())}))}))}(t,n,e)},SO=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return lO(e,t.getType(),n)}))}(t,n)},kO=function(t,n,e){return _h(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)},CO=function(t,n){return kO(t,n,[])},OO=function(t,n){return kO(t,n,[ip.config({})])},_O=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:xc([ip.config({})])}},TO=ou("toolbar.button.execute"),DO=((Gw={})[ai()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Gw),EO=ou("update-menu-text"),BO=ou("update-menu-icon"),MO=function(t,n,e){var o=xr(g),r=t.text.map((function(t){return hh(_O(t,n,e.providers))})),i=t.icon.map((function(t){return hh(OO(t,e.providers.icons))})),u=function(t,n){var e=Ol.getValue(t)
return lp.focus(e),Ei(e,"keydown",{raw:n.event.raw}),rS.close(e),F.some(!0)},a=t.role.fold((function(){return{}}),(function(t){return{role:t}})),c=t.tooltip.fold((function(){return{}}),(function(t){var n=e.providers.translate(t)
return{title:n,"aria-label":n}})),s=_h("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},e.providers.icons)
return hh(rS.sketch(O(O(O({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(W(t.classes,(function(t){return n+"--"+t}))),attributes:O({},c)},components:ty([i.map((function(t){return t.asSpec()})),r.map((function(t){return t.asSpec()})),F.some(s)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:xc(T(T([],t.dropdownBehaviours,!0),[Xb((function(){return t.disabled||e.providers.isDisabled()})),jb(),uS.config({}),ip.config({}),up("dropdown-events",[Jb(t,o),$b(t,o)]),up("menubutton-update-display-text",[Pi(EO,(function(t,n){r.bind((function(n){return n.getOpt(t)})).each((function(t){ip.set(t,[$u(e.providers.translate(n.event.text))])}))})),Pi(BO,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){ip.set(t,[OO(n.event.icon,e.providers.icons)])}))}))])],!1)),eventOrder:uo(DO,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:xc([tp.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:Av(0,t.columns,t.presets)},fetch:function(n){return _w(y(t.fetch,n))}}))).asSpec()},AO=function(t){return"separator"===t.type},FO={type:"separator"},IO=function(t,n){var e=q(t,(function(t,e){return function(t){return o(t)}(e)?""===e?t:"|"===e?t.length>0&&!AO(t[t.length-1])?t.concat([FO]):t:yt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[])
return e.length>0&&AO(e[e.length-1])&&e.pop(),e},RO=function(t,n){return function(t){return yt(t,"getSubmenuItems")}(t)?function(t,n){var e=t.getSubmenuItems(),o=VO(e,n)
return{item:t,menus:uo(o.menus,Cr(t.value,o.items)),expansions:uo(o.expansions,Cr(t.value,t.value))}}(t,n):{item:t,menus:{},expansions:{}}},VO=function(t,n){var e=IO(o(t)?t.split(" "):t,n)
return X(e,(function(t,e){var o=function(t){if(AO(t))return t
var n=bt(t,"value").getOrThunk((function(){return ou("generated-menu-item")}))
return uo({value:n},t)}(e),r=RO(o,n)
return{menus:uo(t.menus,r.menus),items:[r.item].concat(t.items),expansions:uo(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},PO=function(t,n,e,o){var r=ou("primary-menu"),i=VO(t,e.shared.providers.menuItems())
if(0===i.items.length)return F.none()
var u=Tx(r,i.items,n,e,o),a=dt(i.menus,(function(t,o){return Tx(o,t,n,e,!1)})),c=uo(a,Cr(r,u))
return F.from(qp.tieredData(r,c,i.expansions))},HO=function(t){return{isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)},setActive:function(n){var e=t.element
n?(Vu(e,"tox-tbtn--enabled"),jn(e,"aria-pressed",!0)):(Hu(e,"tox-tbtn--enabled"),Yn(e,"aria-pressed"))},isActive:function(){return zu(t.element,"tox-tbtn--enabled")}}},zO=function(t,n,e,o){return MO({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(PO(t,gv.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:HO,columns:1,presets:"normal",classes:[],dropdownBehaviours:[$x.config({})]},n,e.shared)},NO=function(t,n,e){var o=function(t){return function(o){var r=!o.isActive()
o.setActive(r),t.storage.set(r),e.shared.getSink().each((function(e){n().getOpt(e).each((function(n){Ec(n.element),Ei(n,uw,{name:t.name,value:t.storage.get()})}))}))}},r=function(t){return function(n){n.setActive(t.storage.get())}}
return function(n){n(W(t,(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{text:t}}))
return O(O({type:t.type,active:!1},n),{onAction:o(t),onSetup:r(t)})})))}},LO=function(t,n,e,o,r,i){void 0===e&&(e=[])
var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=O({buttonBehaviours:xc([Xb((function(){return t.disabled||i.isDisabled()})),jb(),$x.config({}),up("button press",[Vi("click"),Vi("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=uo(a,{dom:o})
return uo(c,{components:r})},WO=function(t,n,e,o){void 0===o&&(o=[])
var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return CO(t,e.icons)})),u=ty([i])
return LO(t,n,o,r,u,e)},UO=function(t,n,e,o){void 0===o&&(o=[])
var r=WO(t,F.some(n),e,o)
return ph.sketch(r)},jO=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[])
var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return CO(t,e.icons)})):F.none(),a=u.isSome()?ty([u]):[],c=u.isSome()?{}:{innerHtml:i},s=T(T(T(T([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),u.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),r,!0),f=O(O({tag:"button",classes:s},c),{attributes:{title:i}})
return LO(t,n,o,f,a,e)},GO=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[])
var i=jO(t,F.some(n),e,o,r)
return ph.sketch(i)},XO=function(t,n){return function(e){"custom"===n?Ei(e,uw,{name:t,value:{}}):"submit"===n?Di(e,aw):"cancel"===n?Di(e,iw):console.error("Unknown button type: ",n)}},qO=function(t,n,e){if(function(t,n){return"menu"===n}(0,n)){var o=t,r=O(O({},t),{onSetup:function(n){return n.setDisabled(t.disabled),g},fetch:NO(o.items,(function(){return i}),e)}),i=hh(zO(r,"tox-tbtn",e,F.none()))
return i.asSpec()}if(function(t,n){return"custom"===n||"cancel"===n||"submit"===n}(0,n)){var u=XO(t.name,n),a=O(O({},t),{borderless:!1})
return GO(a,u,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},YO=function(t,n){var e,o,r=XO(t.name,"custom")
return e=F.none(),o=Yx.parts.field(O({factory:ph},jO(t,F.some(r),n,[OC(""),dC()]))),Zx(e,o,[],[])},KO=h([lr("field1Name","field1"),lr("field2Name","field2"),Ea("onLockedChange"),Oa(["lockClass"]),lr("locked",!1),El("coupledFieldBehaviours",[Id,Ol])]),JO=function(t,n){return nd({factory:Yx,name:t,overrides:function(t){return{fieldBehaviours:xc([up("coupled-input-behaviour",[Pi(Yr(),(function(e){(function(t,n,e){return pd(t,n,e).bind(Id.getCurrent)})(e,t,n).each((function(n){pd(e,t,"lock").each((function(o){kp.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},$O=h([JO("field1","field2"),JO("field2","field1"),nd({factory:ph,schema:[Ko("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:xc([kp.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),QO=Bd({name:"FormCoupledInputs",configFields:KO(),partFields:$O(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Bl(t.coupledFieldBehaviours,[Id.config({find:F.some}),Ol.config({store:{mode:"manual",getValue:function(n){var e,o=xd(n,t,["field1","field2"])
return(e={})[t.field1Name]=Ol.getValue(o.field1()),e[t.field2Name]=Ol.getValue(o.field2()),e},setValue:function(n,e){var o=xd(n,t,["field1","field2"])
xt(e,t.field1Name)&&Ol.setValue(o.field1(),e[t.field1Name]),xt(e,t.field2Name)&&Ol.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return pd(n,t,"field1")},getField2:function(n){return pd(n,t,"field2")},getLock:function(n){return pd(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),ZO=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t)
if(null!==n){var e=parseFloat(n[1]),o=n[2]
return Ue.value({value:e,unit:o})}return Ue.error(t)},t_=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return yt(e,t)}
return t.unit===n?F.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?F.some(t.value):F.some(t.value/e[t.unit]*e[n]):F.none()},n_=function(t){return F.none()},e_=function(t,n){var e=ZO(t).toOptional(),o=ZO(n).toOptional()
return kt(e,o,(function(t,n){return t_(t,n.unit).map((function(t){return n.value/t})).map((function(t){return function(t,n){return function(e){return t_(e,n).map((function(e){return{value:e*t,unit:n}}))}}(t,n.unit)})).getOr(n_)})).getOr(n_)},o_=function(t,n){var e=n_,o=ou("ratio-event"),r=function(t){return _h(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)},i=QO.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:xc([Yd.config({disabled:function(){return t.disabled||n.isDisabled()}}),jb(),$x.config({})])}),u=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},a=function(e){return Yx.parts.field({factory:vw,inputClasses:["tox-textfield"],inputBehaviours:xc([Yd.config({disabled:function(){return t.disabled||n.isDisabled()}}),jb(),$x.config({}),up("size-input-events",[Pi(jr(),(function(t,n){Ei(t,o,{isField1:e})})),Pi(Kr(),(function(n,e){Ei(n,ow,{name:t.name})}))])]),selectOnFocus:!1})},c=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},s=QO.parts.field1(u([Yx.parts.label(c("Width")),a(!0)])),f=QO.parts.field2(u([Yx.parts.label(c("Height")),a(!1)]))
return QO.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,f,u([c("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){ZO(Ol.getValue(t)).each((function(t){e(t).each((function(t){Ol.setValue(n,function(t){var n,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=t.value.toFixed((n=t.unit)in e?e[n]:1)
return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+t.unit}(t))}))}))},coupledFieldBehaviours:xc([Yd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){QO.getField1(t).bind(Yx.getField).each(Yd.disable),QO.getField2(t).bind(Yx.getField).each(Yd.disable),QO.getLock(t).each(Yd.disable)},onEnabled:function(t){QO.getField1(t).bind(Yx.getField).each(Yd.enable),QO.getField2(t).bind(Yx.getField).each(Yd.enable),QO.getLock(t).each(Yd.enable)}}),jb(),up("size-input-events2",[Pi(o,(function(t,n){var o=n.event.isField1,r=o?QO.getField1(t):QO.getField2(t),i=o?QO.getField2(t):QO.getField1(t),u=r.map(Ol.getValue).getOr(""),a=i.map(Ol.getValue).getOr("")
e=e_(u,a)}))])])})},r_={undo:h(ou("undo")),redo:h(ou("redo")),zoom:h(ou("zoom")),back:h(ou("back")),apply:h(ou("apply")),swap:h(ou("swap")),transform:h(ou("transform")),tempTransform:h(ou("temp-transform")),transformApply:h(ou("transform-apply"))},i_=h("save-state"),u_=h("disable"),a_=h("enable"),c_={formActionEvent:uw,saveState:i_,disable:u_,enable:a_},s_=function(t,n){var e=function(t,e,o,r){return hh(GO({name:t,text:t,disabled:o,primary:r,icon:F.none(),borderless:!1},e,n))},o=function(t,e,o,r){return hh(UO({name:t,icon:F.some(t),tooltip:F.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map((function(t){var e=t.get(n)
e.hasConfigured(Yd)&&Yd.disable(e)}))},i=function(t,n){t.map((function(t){var e=t.get(n)
e.hasConfigured(Yd)&&Yd.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=g,c=function(t,n,e){Ei(t,n,e)},s=function(t){return Di(t,c_.disable())},f=function(t){return Di(t,c_.enable())},l=function(t,n){s(t),c(t,r_.transform(),{transform:n}),f(t)},d=function(t){return function(){tt.getOpt(t).each((function(t){ip.set(t,[Q])}))}},m=function(t,n){s(t),c(t,r_.transformApply(),{transform:n,swap:d(t)}),f(t)},p=function(){return e("Back",(function(t){return c(t,r_.back(),{swap:d(t)})}),!1,!1)},v=function(){return hh({dom:{tag:"div",classes:["tox-spacer"]},behaviours:xc([Yd.config({})])})},b=function(){return e("Apply",(function(t){return c(t,r_.apply(),{swap:d(t)})}),!0,!0)},y=[p(),v(),e("Apply",(function(n){m(n,(function(n){var e=t.getRect()
return xO(n,e.x,e.y,e.w,e.h)})),t.hideCrop()}),!1,!0)],x=jx.sketch({dom:u,components:y.map((function(t){return t.asSpec()})),containerBehaviours:xc([up("image-tools-crop-buttons-events",[Pi(c_.disable(),(function(t,n){r(y,t)})),Pi(c_.enable(),(function(t,n){i(y,t)}))])])}),w=hh(o_({name:"size",label:F.none(),constrain:!0,disabled:!1},n)),S=[p(),v(),w,v(),e("Apply",(function(t){w.getOpt(t).each((function(n){var e=Ol.getValue(n),o=function(t,n){return function(e){return wO(e,t,n)}}(parseInt(e.width,10),parseInt(e.height,10))
m(t,o)}))}),!1,!0)],k=jx.sketch({dom:u,components:S.map((function(t){return t.asSpec()})),containerBehaviours:xc([up("image-tools-resize-buttons-events",[Pi(c_.disable(),(function(t,n){r(S,t)})),Pi(c_.enable(),(function(t,n){i(S,t)}))])])}),C=function(t,n){return function(e){return t(e,n)}},O=C(yO,"h"),_=C(yO,"v"),T=C(SO,-90),D=C(SO,90),E=function(t,n){(function(t,n){s(t),c(t,r_.tempTransform(),{transform:n}),f(t)})(t,n)},B=[p(),v(),o("flip-horizontally","Flip horizontally",(function(t){E(t,O)}),!1),o("flip-vertically","Flip vertically",(function(t){E(t,_)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){E(t,T)}),!1),o("rotate-right","Rotate clockwise",(function(t){E(t,D)}),!1),v(),b()],M=jx.sketch({dom:u,components:B.map((function(t){return t.asSpec()})),containerBehaviours:xc([up("image-tools-fliprotate-buttons-events",[Pi(c_.disable(),(function(t,n){r(B,t)})),Pi(c_.enable(),(function(t,n){i(B,t)}))])])}),A=function(t,e,o,r,i){var u=Jk.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=Jk.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=Jk.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}})
return hh(Jk.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:h({x:r})},components:[u,a,c],sliderBehaviours:xc([lp.config({})]),onChoose:e}))},I=function(t,n,e,o,r){return A(t,(function(t,e,o){var r=C(n,o.x/100)
l(t,r)}),e,o,r)},R=function(t,n,e,o,a){var c=function(t,n,e,o,r){return[p(),I(t,n,e,o,r),b()]}(t,n,e,o,a)
return jx.sketch({dom:u,components:c.map((function(t){return t.asSpec()})),containerBehaviours:xc([up("image-tools-filter-panel-buttons-events",[Pi(c_.disable(),(function(t,n){r(c,t)})),Pi(c_.enable(),(function(t,n){i(c,t)}))])])})},V=[p(),v(),b()],P=jx.sketch({dom:u,components:V.map((function(t){return t.asSpec()}))}),H=R("Brightness",vO,-100,0,100),z=R("Contrast",bO,-100,0,100),N=R("Gamma",hO,-100,0,100),L=function(t,n,e){return function(o){return function(t,n,e,o){return iO(t,n,e,o)}(o,t,n,e)}},W=function(t){return A(t,(function(t,n,e){var o=U.getOpt(t),r=G.getOpt(t),i=j.getOpt(t)
o.each((function(n){r.each((function(e){i.each((function(o){var r=Ol.getValue(n).x/100,i=Ol.getValue(o).x/100,u=Ol.getValue(e).x/100,a=L(r,i,u)
l(t,a)}))}))}))}),0,100,200)},U=W("R"),j=W("G"),G=W("B"),X=[p(),U,j,G,b()],q=jx.sketch({dom:u,components:X.map((function(t){return t.asSpec()}))}),Y=function(t,n,e){return function(o){c(o,r_.swap(),{transform:n,swap:function(){tt.getOpt(o).each((function(n){ip.set(n,[t]),e(n)}))}})}},K=F.some(pO),J=F.some(gO),$=[o("crop","Crop",Y(x,F.none(),(function(n){t.showCrop()})),!1),o("resize","Resize",Y(k,F.none(),(function(n){w.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height
Ol.setValue(n,{width:o,height:r})}))})),!1),o("orientation","Orientation",Y(M,F.none(),a),!1),o("brightness","Brightness",Y(H,F.none(),a),!1),o("sharpen","Sharpen",Y(P,K,a),!1),o("contrast","Contrast",Y(z,F.none(),a),!1),o("color-levels","Color levels",Y(q,F.none(),a),!1),o("gamma","Gamma",Y(N,F.none(),a),!1),o("invert","Invert",Y(P,J,a),!1)],Q=jx.sketch({dom:u,components:$.map((function(t){return t.asSpec()}))}),Z=jx.sketch({dom:{tag:"div"},components:[Q],containerBehaviours:xc([ip.config({})])}),tt=hh(Z)
return{memContainer:tt,getApplyButton:function(t){return tt.getOpt(t).map((function(t){var n=t.components()[0]
return n.components()[n.components().length-1]}))}}},f_=tinymce.util.Tools.resolve("tinymce.geom.Rect"),l_=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),d_=tinymce.util.Tools.resolve("tinymce.util.Observable"),m_=tinymce.util.Tools.resolve("tinymce.util.VK"),g_=function(t){var n,e
if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}
function p_(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(g_(t),t.button!==o)return s(t)
t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function(t){g_(t),l_(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),n.stop&&n.stop(t)}
return l_(a).on("mousedown touchstart",(function(t){var f,l=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight)
return{width:r<u?i:r,height:a<n(e.offsetHeight,o.offsetHeight)?c:a}}(u)
g_(t),t.preventDefault(),o=t.button
var d=a
r=t.screenX,i=t.screenY,f=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,e=l_("<div></div>").css({position:"absolute",top:0,left:0,width:l.width,height:l.height,zIndex:2147483647,opacity:1e-4,cursor:f}).appendTo(u.body),l_(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)})),{destroy:function(){l_(a).off()}}}var h_=0,v_=function(t,n,e,o,r){var i,u="tox-crid-"+h_++,a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],c=["top","right","bottom","left"],s=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},f=function(n,o,r,i){var u,a,c,f,l
u=o.x,a=o.y,c=o.w,f=o.h,u+=r*n.deltaX,a+=i*n.deltaY,(c+=r*n.deltaW)<20&&(c=20),(f+=i*n.deltaH)<20&&(f=20),l=t=f_.clamp({x:u,y:a,w:c,h:f},e,"move"===n.name),l=s(e,l),g.fire("updateRect",{rect:l}),m(l)},l=function(t){var e=function(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),l_("#"+u+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}
bC.each(a,(function(n){l_("#"+u+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},d=function(n){l(t=n)},m=function(t){var n,o
d((n=e,{x:(o=t).x+n.x,y:o.y+n.y,w:o.w,h:o.h}))}
l_('<div id="'+u+'" class="tox-croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),bC.each(c,(function(t){l_("#"+u,o).append('<div id="'+u+"-"+t+'"class="tox-croprect-block" style="display: none" data-mce-bogus="all">')})),bC.each(a,(function(t){l_("#"+u,o).append('<div id="'+u+"-"+t.name+'" class="tox-croprect-handle tox-croprect-handle-'+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),i=bC.map(a,(function(n){var e
return p_(u,{document:o.ownerDocument,handle:u+"-"+n.name,start:function(){e=t},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})})),l(t),l_(o).on("focusin focusout",(function(t){l_(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),l_(o).on("keydown",(function(n){var e
bC.each(a,(function(t){if(n.target.id===u+"-"+t.name)return e=t,!1}))
var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),f(e,o,r,i)}
switch(n.keyCode){case m_.LEFT:o(n,0,t,-10,0)
break
case m_.RIGHT:o(n,0,t,10,0)
break
case m_.UP:o(n,0,t,0,-10)
break
case m_.DOWN:o(n,0,t,0,10)
break
case m_.ENTER:case m_.SPACEBAR:n.preventDefault(),r()}}))
var g=bC.extend({toggleVisibility:function(t){var n=bC.map(a,(function(t){return"#"+u+"-"+t.name})).concat(bC.map(c,(function(t){return"#"+u+"-"+t}))).join(",")
t?l_(n,o).show():l_(n,o).hide()},setClampRect:function(n){e=n,l(t)},setRect:d,getInnerRect:function(){return s(e,t)},setInnerRect:m,setViewPortRect:function(e){n=e,l(t)},destroy:function(){bC.each(i,(function(t){t.destroy()})),i=[]}},d_)
return g},b_=function(t){var n=hh({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=xr(1),o=Qc(),r=xr({x:0,y:0,w:1,h:1}),i=xr({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each((function(t){var u=e.get(),a=ve(t.element),c=se(t.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"}
Qn(i,m),n.getOpt(t).each((function(t){Qn(t.element,m)})),o.on((function(t){var n=r.get()
t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){var o,a=Ft.fromTag("img")
return jn(a,"src",n),(o=a.dom,new Wh((function(t){var n=function(){o.removeEventListener("load",n),t(o)}
o.complete?t(o):o.addEventListener("load",n)}))).then((function(){t.getSystem().isConnected()&&s.getOpt(t).map((function(t){var n=Qu({element:a})
ip.replaceAt(t,1,F.some(n))
var o=i.get(),c={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight}
i.set(c)
var f=f_.inflate(c,-20,-20)
r.set(f),o.w===c.w&&o.h===c.h||function(t,n){s.getOpt(t).each((function(t){var o=ve(t.element),r=se(t.element),i=n.dom.naturalWidth,u=n.dom.naturalHeight,a=Math.min(o/i,r/u)
a>=1?e.set(1):e.set(a)}))}(t,a),u(t,a)}))}))},c=jx.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:xc([up("image-panel-crop-events",[Gi((function(t){s.getOpt(t).each((function(t){var n=t.element.dom,i=v_({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,g)
i.toggleVisibility(!1),i.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)}
r.set(i)})),o.set(i)}))}))])])}],containerBehaviours:xc([ip.config({}),up("image-panel-events",[Gi((function(n){a(n,t)}))])])}),s=hh(c)
return{memContainer:s,updateSrc:a,zoom:function(t,n){var o=e.get(),r=n>0?Math.min(2,o+.1):Math.max(.1,o-.1)
e.set(r),s.getOpt(t).each((function(t){var n=t.components()[1].element
u(t,n)}))},showCrop:function(){o.on((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){o.on((function(t){t.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get()
return{width:t.w,height:t.h}}}},y_=function(t,n,e,o,r){return UO({name:t,icon:F.some(n),disabled:e,tooltip:F.some(t),primary:!1,borderless:!1},o,r)},x_=function(t,n){n?Yd.enable(t):Yd.disable(t)}
var w_,S_=function(t){var n,e,o,r,i=xr(t),u=Qc(),a=(e=-1,{data:n=[],add:function(t){var o=n.splice(++e)
return n.push(t),{state:t,removed:o}},undo:function(){if(o())return n[--e]},redo:function(){if(r())return n[++e]},canUndo:o=function(){return e>0},canRedo:r=function(){return-1!==e&&e<n.length-1}})
a.add(t)
var c=function(t){i.set(t)},s=function(t){return{blob:t,url:URL.createObjectURL(t)}},f=function(t){URL.revokeObjectURL(t.url)},l=function(){u.on(f),u.clear()},d=function(t){var n=s(t)
c(n)
var e,o=a.add(n).removed
return e=o,bC.each(e,f),n.url}
return{getBlobState:function(){return i.get()},setBlobState:c,addBlobState:d,getTempState:function(){return u.get().getOrThunk(i.get)},updateTempState:function(t){var n=s(t)
return l(),u.set(n),n.url},addTempState:function(t){var n=s(t)
return u.set(n),n.url},applyTempState:function(t){return u.get().fold(g,(function(n){d(n.blob),t()}))},destroyTempState:l,undo:function(){var t=a.undo()
return c(t),t.url},redo:function(){var t=a.redo()
return c(t),t.url},getHistoryStates:function(){return{undoEnabled:a.canUndo(),redoEnabled:a.canRedo()}}}},k_=function(t,n){var e=S_(t.currentState),o=function(t){var n=e.getHistoryStates()
d.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Ei(t,c_.formActionEvent,{name:c_.saveState(),value:n.undoEnabled})},r=function(t){return t.toBlob()},i=function(t){Ei(t,c_.formActionEvent,{name:c_.disable(),value:{}})},u=function(t){m.getApplyButton(t).each((function(t){Yd.enable(t)})),Ei(t,c_.formActionEvent,{name:c_.enable(),value:{}})},a=function(t,n){return i(t),l.updateSrc(t,n)},c=function(t,n,e,c,s){i(t),function(t){return qC(t)}(n).then(e).then(r).then(c).then((function(n){return a(t,n)})).then((function(){o(t),s(),u(t)})).catch((function(n){console.log(n),t.getSystem().isConnected()&&u(t)}))},s=function(t,n,o){var r=e.getBlobState().blob
c(t,r,n,(function(t){return e.updateTempState(t)}),o)},f=function(t){var n=e.getBlobState().url
return e.destroyTempState(),o(t),n},l=b_(t.currentState.url),d=function(t){var n=hh(y_("Undo","undo",!0,(function(t){Ei(t,r_.undo(),{direction:1})}),t)),e=hh(y_("Redo","redo",!0,(function(t){Ei(t,r_.redo(),{direction:1})}),t))
return{container:jx.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),e.asSpec(),y_("Zoom in","zoom-in",!1,(function(t){Ei(t,r_.zoom(),{direction:1})}),t),y_("Zoom out","zoom-out",!1,(function(t){Ei(t,r_.zoom(),{direction:-1})}),t)]}),updateButtonUndoStates:function(t,o,r){n.getOpt(t).each((function(t){x_(t,o)})),e.getOpt(t).each((function(t){x_(t,r)}))}}}(n),m=s_(l,n)
return{dom:{tag:"div",attributes:{role:"presentation"}},components:[m.memContainer.asSpec(),l.memContainer.asSpec(),d.container],behaviours:xc([Ol.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),up("image-tools-events",[Pi(r_.undo(),(function(t,n){var r=e.undo()
a(t,r).then((function(n){u(t),o(t)}))})),Pi(r_.redo(),(function(t,n){var r=e.redo()
a(t,r).then((function(n){u(t),o(t)}))})),Pi(r_.zoom(),(function(t,n){var e=n.event.direction
l.zoom(t,e)})),Pi(r_.back(),(function(t,n){(function(t){var n=f(t)
a(t,n).then((function(n){u(t)}))})(t),(0,n.event.swap)(),l.hideCrop()})),Pi(r_.apply(),(function(t,n){e.applyTempState((function(){f(t),(0,n.event.swap)()}))})),Pi(r_.transform(),(function(t,n){return s(t,n.event.transform,g)})),Pi(r_.tempTransform(),(function(t,n){return function(t,n){var o=e.getTempState().blob
c(t,o,n,(function(t){return e.addTempState(t)}),g)}(t,n.event.transform)})),Pi(r_.transformApply(),(function(t,n){return function(t,n,o){var r=e.getBlobState().blob
c(t,r,n,(function(n){var o=e.addBlobState(n)
return f(t),o}),o)}(t,n.event.transform,n.event.swap)})),Pi(r_.swap(),(function(t,n){(function(t){d.updateButtonUndoStates(t,!1,!1)})(t)
var e=n.event.transform,o=n.event.swap
e.fold((function(){o()}),(function(n){s(t,n,o)}))}))]),dC()])}},C_=function(t){return!yt(t,"items")},O_="data-value",__=function(t,n,e,o){return W(e,(function(e){return C_(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Ol.setValue(t,e.value),Ei(t,ow,{name:n}),lp.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return __(t,n,e.items,o)}}}))},T_=function(t,n){return ct(t,(function(t){return C_(t)?Ct(t.value===n,t):T_(t.items,n)}))},D_=Ed({name:"HtmlSelect",configFields:[Ko("options"),_l("selectBehaviours",[lp,Ol]),lr("selectClasses",[]),lr("selectAttributes",{}),rr("data")],factory:function(t,n){var e=W(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return Cr("initialValue",t)})).getOr({})
return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Dl(t.selectBehaviours,[lp.config({}),Ol.config({store:O({mode:"manual",getValue:function(t){return Wu(t.element)},setValue:function(n,e){Y(t.options,(function(t){return t.value===e})).isSome()&&Uu(n.element,e)}},o)})])}}}),E_=function(t,n){var e=t.label.map((function(t){return ew(t,n)})),o=[Yd.config({disabled:function(){return t.disabled||n.isDisabled()}}),jb(),tp.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Di(t,aw),F.some(!0)}}),up("textfield-change",[Pi(Yr(),(function(n,e){Ei(n,ow,{name:t.name})})),Pi(ii(),(function(n,e){Ei(n,ow,{name:t.name})}))]),$x.config({})],r=t.validation.map((function(t){return Pw.config({getRoot:function(t){return _n(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=Ol.getValue(n),o=t.validator(e)
return Tw(!0===o?Ue.value(e):Ue.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=t.placeholder.fold(h({}),(function(t){return{placeholder:n.translate(t)}})),u=t.inputMode.fold(h({}),(function(t){return{inputmode:t}})),a=O(O({},i),u),c=Yx.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:xc(J([o,r])),selectOnFocus:!1,factory:vw}),s=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),f=[Yd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Yx.getField(t).each(Yd.disable)},onEnabled:function(t){Yx.getField(t).each(Yd.enable)}}),jb()]
return Zx(e,c,s,f)},B_=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n)
return Ii([Pi(t.event,e),Xi((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Pi(t,(function(){return n.cancel()}))]})).getOr([])))}}),M_=function(t){var n=xr(null)
return xu({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get()
null!==t&&t.cancel()}})},A_=Object.freeze({__proto__:null,throttle:M_,init:function(t){return t.stream.streams.state(t)}}),F_=[Jo("stream",Go("mode",{throttle:[Ko("delay"),lr("stopEvent",!0),Ma("streams",{setup:function(t,n){var e=t.stream,o=Mh(t.onStream,e.delay)
return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:M_})]})),lr("event","input"),rr("cancelEvent"),Ea("onStream")],I_=Sc({fields:F_,name:"streaming",active:B_,state:A_}),R_=function(t,n,e){var o=Ol.getValue(e)
Ol.setValue(n,o),P_(n)},V_=function(t,n){var e=t.element,o=Wu(e),r=e.dom
"number"!==Gn(e,"type")&&n(r,o)},P_=function(t){V_(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},H_=function(t,n,e){if(t.selectsOver){var o=Ol.getValue(n),r=t.getDisplayText(o),i=Ol.getValue(e)
return 0===t.getDisplayText(i).indexOf(r)?F.some((function(){R_(0,n,e),function(t,n){V_(t,(function(t,e){return t.setSelectionRange(n,e.length)}))}(n,r.length)})):F.none()}return F.none()},z_=h("alloy.typeahead.itemexecute"),N_=h([rr("lazySink"),Ko("fetch"),lr("minChars",5),lr("responseTime",1e3),Ta("onOpen"),lr("getHotspot",F.some),lr("getAnchorOverrides",h({})),lr("layouts",F.none()),lr("eventOrder",{}),yr("model",{},[lr("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),lr("selectsOver",!0),lr("populateFromBrowse",!0)]),Ta("onSetValue"),Da("onExecute"),Ta("onItemExecute"),lr("inputClasses",[]),lr("inputAttributes",{}),lr("inputStyles",{}),lr("matchWidth",!0),lr("useMinWidth",!1),lr("dismissOnBlur",!0),Oa(["openClass"]),rr("initialData"),_l("typeaheadBehaviours",[lp,Ol,I_,tp,kp,Nw]),qo("previewing",(function(){return xr(!0)}))].concat(mw()).concat(nS())),L_=h([ed({schema:[Ca()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){H_(t.model,o,e).fold((function(){return im.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&R_(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Ei(t,z_(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&R_(t.model,n,e)}))}}}})]),W_=Bd({name:"Typeahead",configFields:N_(),partFields:L_(),factory:function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1)
var i=Nw.getCoupled(n,"sandbox")
if(il.isOpen(i))Id.getCurrent(i).each((function(t){im.getHighlighted(t).fold((function(){r(t)}),(function(){Fi(i,t.element,"keydown",e)}))}))
else{qw(t,u(n),n,i,o,(function(t){Id.getCurrent(t).each(r)}),xw.HighlightFirst).get(g)}},i=gw(t),u=function(t){return function(n){return n.map((function(n){var e=vt(n.menus),o=$(e,(function(t){return G(t.items,(function(t){return"item"===t.type}))}))
return Ol.getState(t).update(W(o,(function(t){return t.data}))),n}))}},a=[lp.config({}),Ol.config({onSetValue:t.onSetValue,store:O({mode:"dataset",getDataKey:function(t){return Wu(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){Uu(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return Cr("initialValue",t)})).getOr({}))}),I_.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=Nw.getCoupled(n,"sandbox")
if(lp.isFocused(n)&&Wu(n.element).length>=t.minChars){var i=Id.getCurrent(r).bind((function(t){return im.getHighlighted(t).map(Ol.getValue)}))
t.previewing.set(!0)
qw(t,u(n),n,r,o,(function(n){Id.getCurrent(r).each((function(n){i.fold((function(){t.model.selectsOver&&im.highlightFirst(n)}),(function(t){im.highlightBy(n,(function(n){return Ol.getValue(n).value===t.value})),im.getHighlighted(n).orThunk((function(){return im.highlightFirst(n),F.none()}))}))}))}),xw.HighlightFirst).get(g)}},cancelEvent:di()}),tp.config({mode:"special",onDown:function(t,n){return r(t,n,im.highlightFirst),F.some(!0)},onEscape:function(t){var n=Nw.getCoupled(t,"sandbox")
return il.isOpen(n)?(il.close(n),F.some(!0)):F.none()},onUp:function(t,n){return r(t,n,im.highlightLast),F.some(!0)},onEnter:function(n){var e=Nw.getCoupled(n,"sandbox"),o=il.isOpen(e)
if(o&&!t.previewing.get())return Id.getCurrent(e).bind((function(t){return im.getHighlighted(t)})).map((function(t){return Ei(n,z_(),{item:t}),!0}))
var r=Ol.getValue(n)
return Di(n,di()),t.onExecute(e,n,r),o&&il.close(e),F.some(!0)}}),kp.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),Nw.config({others:{sandbox:function(n){return Zw(t,n,{onOpen:function(){return kp.on(n)},onClose:function(){return kp.off(n)}})}}}),up("typeaheadevents",[Yi((function(n){var e=g
Kw(t,u(n),n,o,e,xw.HighlightFirst).get(g)})),Pi(z_(),(function(n,e){var o=Nw.getCoupled(n,"sandbox")
R_(t.model,n,e.event.item),Di(n,di()),t.onItemExecute(n,o,e.event.item,Ol.getValue(n)),il.close(o),P_(n)}))].concat(t.dismissOnBlur?[Pi(ri(),(function(t){var n=Nw.getCoupled(t,"sandbox")
Ac(n.element).isNone()&&il.close(n)}))]:[]))]
return{uid:t.uid,dom:hw(uo(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:O(O({},i),Dl(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}}}),U_=function(t){return O(O({},t),{toCached:function(){return U_(t.toCached())},bindFuture:function(n){return U_(t.bind((function(t){return t.fold((function(t){return Tw(Ue.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return U_(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return U_(t.map((function(t){return t.map(n)})))},mapError:function(n){return U_(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return U_(_w((function(o){var r=!1,i=setTimeout((function(){r=!0,o(Ue.error(e()))}),n)
t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},j_=function(t){return U_(_w(t))},G_=j_,X_={type:"separator"},q_=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:g}},Y_=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:g}},K_=function(t,n){return function(t){return W(t,q_)}(function(t,n){return G(n,(function(n){return n.type===t}))}(t,n))},J_=function(t){return K_("header",t.targets)},$_=function(t){return K_("anchor",t.targets)},Q_=function(t){return F.from(t.anchorTop).map((function(t){return Y_("<top>",t)})).toArray()},Z_=function(t){return F.from(t.anchorBottom).map((function(t){return Y_("<bottom>",t)})).toArray()},tT=function(t,n){var e=t.toLowerCase()
return G(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text
return _t(n.toLowerCase(),e)||_t(t.value.toLowerCase(),e)}))},nT=function(t,n,e){var o=Ol.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value
return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i=tT(r,function(t){return W(t,(function(t){return Y_(t,t)}))}(e.getHistory(t)))
return"file"===t?(o=[i,tT(r,J_(n)),tT(r,J([Q_(n),$_(n),Z_(n)]))],q(o,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(X_,n)}),[])):i}))},eT=ou("aria-invalid"),oT=function(t){return function(n,e,o){return bt(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},rT={bar:oT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:W(t.items,n.interpreter)}}(t,n.shared)})),collection:oT((function(t,n){return dw(t,n.shared.providers)})),alertbanner:oT((function(t,n){return function(t,n){return jx.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[ph.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:kh(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){Ei(n,uw,{name:"alert-banner",value:t.url})},buttonBehaviours:xc([Ch()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})}(t,n.shared.providers)})),input:oT((function(t,n){return function(t,n){return E_({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:F.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),textarea:oT((function(t,n){return function(t,n){return E_({name:t.name,multiline:!0,label:t.label,inputMode:F.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:F.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),label:oT((function(t,n){return function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},o=W(t.items,n.interpreter)
return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:xc([dC(),ip.config({}),CC(F.none()),tp.config({mode:"acyclic"})])}}(t,n.shared)})),iframe:function(t){return function(n,e,o){var r=uo(e,{source:"dynamic"})
return oT(t)(n,r,o)}}((function(t,n){return RC(t,n.shared.providers)})),button:oT((function(t,n){return YO(t,n.shared.providers)})),checkbox:oT((function(t,n){return function(t,n){var e=Ol.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),o=function(t){return t.element.dom.click(),F.some(!0)},r=Yx.parts.field({factory:{sketch:v},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:xc([dC(),Yd.config({disabled:function(){return t.disabled||n.isDisabled()}}),$x.config({}),lp.config({}),e,tp.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),up("checkbox-events",[Pi(Kr(),(function(n,e){Ei(n,ow,{name:t.name})}))])])}),i=Yx.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:xc([uS.config({})])}),u=function(t){return _h("checked"===t?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},n.icons)},a=hh({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]})
return Yx.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:xc([Yd.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Yx.getField(t).each(Yd.disable)},onEnabled:function(t){Yx.getField(t).each(Yd.enable)}}),jb()])})}(t,n.shared.providers)})),colorinput:oT((function(t,n){return fS(t,n.shared,n.colorinput)})),colorpicker:oT((function(t){var n=function(t){return"tox-"+t},e=lC(hC,n),o=hh(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){Ei(t,uw,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Ei(t,uw,{name:"hex-valid",value:!1})}}))
return{dom:{tag:"div"},components:[o.asSpec()],behaviours:xc([Ol.config({store:{mode:"manual",getValue:function(t){var n=o.get(t)
return Id.getCurrent(n).bind((function(t){return Ol.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t)
Id.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){Ol.setValue(t,{hex:F.from(e[1]).getOr("")}),rC.getField(t,"hex").each((function(t){Di(t,Yr())}))}))}}}),dC()])}})),dropzone:oT((function(t,n){return _C(t,n.shared.providers)})),grid:oT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:W(t.items,n.interpreter)}}(t,n.shared)})),listbox:oT((function(t,n){return function(t,n){var e=n.shared.providers,o=it(t.items).filter(C_),r=t.label.map((function(t){return ew(t,e)})),i={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Yx.parts.field({dom:{},factory:{sketch:function(e){return MO({uid:e.uid,text:o.map((function(t){return t.text})),icon:F.none(),tooltip:t.label,role:F.none(),fetch:function(e,o){var r=__(e,t.name,t.items,Ol.getValue(e))
o(PO(r,gv.CLOSE_ON_EXECUTE,n,!1))},onSetup:h(g),getApi:h({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[$x.config({}),Ol.config({store:{mode:"manual",initialValue:o.map((function(t){return t.value})).getOr(""),getValue:function(t){return Gn(t.element,O_)},setValue:function(n,e){T_(t.items,e).each((function(t){jn(n.element,O_,t.value),Ei(n,EO,{text:t.text})}))}}})]},"tox-listbox",n.shared)}}})]}
return Yx.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:J([r.toArray(),[i]]),fieldBehaviours:xc([Yd.config({disabled:h(t.disabled),onDisabled:function(t){Yx.getField(t).each(Yd.disable)},onEnabled:function(t){Yx.getField(t).each(Yd.enable)}})])})}(t,n)})),selectbox:oT((function(t,n){return function(t,n){var e=W(t.items,(function(t){return{text:n.translate(t.text),value:t.value}})),o=t.label.map((function(t){return ew(t,n)})),r=Yx.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:D_,selectBehaviours:xc([Yd.config({disabled:function(){return t.disabled||n.isDisabled()}}),$x.config({}),up("selectbox-change",[Pi(Kr(),(function(n,e){Ei(n,ow,{name:t.name})}))])])}),i=t.size>1?F.none():F.some(_h("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:J([[r],i.toArray()])}
return Yx.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:J([o.toArray(),[u]]),fieldBehaviours:xc([Yd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Yx.getField(t).each(Yd.disable)},onEnabled:function(t){Yx.getField(t).each(Yd.enable)}}),jb()])})}(t,n.shared.providers)})),sizeinput:oT((function(t,n){return o_(t,n.shared.providers)})),urlinput:oT((function(t,n){return function(t,n,e){var o,r=n.shared.providers,i=function(n){var o=Ol.getValue(n)
e.addToHistory(o.value,t.filetype)},u=Yx.parts.field({factory:W_,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":eT,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=nT(t.filetype,o,e),i=PO(r,gv.BUBBLE_TO_SANDBOX,n,!1)
return Tw(i)},getHotspot:function(t){return d.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(Pw)&&Pw.run(t).get(g)},typeaheadBehaviours:xc(J([e.getValidationHandler().map((function(n){return Pw.config({getRoot:function(t){return _n(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){c.getOpt(t).each((function(t){jn(t.element,"title",r.translate(n))}))}},validator:{validate:function(e){var o=Ol.getValue(e)
return G_((function(e){n({type:t.filetype,url:o.value},(function(t){if("invalid"===t.status){var n=Ue.error(t.message)
e(n)}else{var o=Ue.value(t.message)
e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[Yd.config({disabled:function(){return t.disabled||r.isDisabled()}}),$x.config({}),up("urlinput-events",J(["file"===t.filetype?[Pi(Yr(),(function(n){Ei(n,ow,{name:t.name})}))]:[],[Pi(Kr(),(function(n){Ei(n,ow,{name:t.name}),i(n)})),Pi(ii(),(function(n){Ei(n,ow,{name:t.name}),i(n)}))]]))]])),eventOrder:(o={},o[Yr()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Av(0,0,"normal")},onExecute:function(t,n,e){Ei(n,aw,{})},onItemExecute:function(n,e,o,r){i(n),Ei(n,ow,{name:t.name})}}),a=t.label.map((function(t){return ew(t,r)})),c=hh(function(t,n,e,o){return void 0===e&&(e=t),void 0===o&&(o=t),_h(e,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],attributes:O({title:r.translate(o),"aria-live":"polite"},n.fold((function(){return{}}),(function(t){return{id:t}})))},r.icons)}("invalid",F.some(eT),"warning")),s=hh({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c.asSpec()]}),f=e.getUrlPicker(t.filetype),l=ou("browser.url.event"),d=hh({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,s.asSpec()],behaviours:xc([Yd.config({disabled:function(){return t.disabled||r.isDisabled()}})])}),m=hh(GO({name:t.name,icon:F.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return Di(t,l)}),r,[],["tox-browse-url"]))
return Yx.sketch({dom:nw([]),components:a.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:J([[d.asSpec()],f.map((function(){return m.asSpec()})).toArray()])}]),fieldBehaviours:xc([Yd.config({disabled:function(){return t.disabled||r.isDisabled()},onDisabled:function(t){Yx.getField(t).each(Yd.disable),m.getOpt(t).each(Yd.disable)},onEnabled:function(t){Yx.getField(t).each(Yd.enable),m.getOpt(t).each(Yd.enable)}}),jb(),up("url-input-events",[Pi(l,(function(n){Id.getCurrent(n).each((function(e){var o=Ol.getValue(e),r=O({fieldname:t.name},o)
f.each((function(o){o(r).get((function(o){Ol.setValue(e,o),Ei(n,ow,{name:t.name})}))}))}))}))])])})}(t,n,n.urlinput)})),customeditor:oT((function(t){var n=Qc(),e=hh({dom:{tag:t.tag}}),o=Qc()
return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:xc([up("custom-editor-events",[Gi((function(r){e.getOpt(r).each((function(e){(!function(t){return yt(t,"init")}(t)?vC.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)})):t.init(e.element.dom)).then((function(t){o.on((function(n){t.setValue(n)})),o.clear(),n.set(t)}))}))}))]),Ol.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(e)}),(function(t){return t.setValue(e)}))}}}),dC()]),components:[e.asSpec()]}})),htmlpanel:oT((function(t){return"presentation"===t.presets?jx.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):jx.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:xc([$x.config({}),lp.config({})])})})),imagetools:oT((function(t,n){return k_(t,n.shared.providers)})),table:oT((function(t,n){return function(t,n){var e,o,r=function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}},i=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}},u=function(t){return{dom:{tag:"tr"},components:W(t,i)}}
return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(o=t.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:W(o,r)}]}),(e=t.cells,{dom:{tag:"tbody"},components:W(e,u)})],behaviours:xc([$x.config({}),lp.config({})])}}(t,n.shared.providers)})),panel:oT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:t.classes},components:W(t.items,n.shared.interpreter)}}(t,n)}))},iT={field:function(t,n){return n}},uT=function(t,n,e){var o=uo(e,{shared:{interpreter:function(n){return aT(t,n,o)}}})
return aT(t,n,o)},aT=function(t,n,e){return bt(rT,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},cT={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},sT=function(t,n,e){var o={maxHeightFunction:ms()}
return function(){return e()?{type:"node",root:Vn(t()),node:F.from(t()),bubble:vs(12,12,cT),layouts:{onRtl:function(){return[ih]},onLtr:function(){return[rh]}},overrides:o}:{type:"hotspot",hotspot:n(),bubble:vs(-12,12,cT),layouts:{onRtl:function(){return[tc]},onLtr:function(){return[nc]}},overrides:o}}},fT=function(t,n,e){return function(){return e()?{type:"node",root:Vn(t()),node:F.from(t()),layouts:{onRtl:function(){return[uh]},onLtr:function(){return[uh]}}}:{type:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[ic]},onLtr:function(){return[ic]}}}}},lT=function(t,n){return function(){return{type:"selection",root:n(),getSelection:function(){var n=t.selection.getRng()
return F.some(Us.range(Ft.fromDom(n.startContainer),n.startOffset,Ft.fromDom(n.endContainer),n.endOffset))}}}},dT=function(t){return function(n){return{type:"node",root:t(),node:n}}},mT=function(t,n,e){var o=Ab(t),r=function(){return Ft.fromDom(t.getBody())},i=function(){return Ft.fromDom(t.getContentAreaContainer())},u=function(){return o||!e()}
return{inlineDialog:sT(i,n,u),banner:fT(i,n,u),cursor:lT(t,r),node:dT(r)}},gT=function(t){return function(n,e){ax(t)(n,e)}},pT=function(t){return function(){return Jy(t)}},hT=function(t){return function(){return $y(t)}},vT=function(t){return function(){return Zy(t)}},bT=function(t){return{colorPicker:gT(t),hasCustomColors:pT(t),getColors:hT(t),getColorCols:vT(t)}},yT=function(t){return function(){return function(t){return t.getParam("draggable_modal",!1,"boolean")}(t)}},xT=function(t){return{isDraggableModal:yT(t)}},wT=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],ST=function(t){return q(t,(function(t,n){if(yt(n,"items")){var e=ST(n.items)
return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(function(t){return yt(t,"inline")}(n)||function(t){return yt(t,"block")}(n)||function(t){return yt(t,"selector")}(n)){var r="custom-"+(o(n.name)?n.name:n.title.toLowerCase())
return{customFormats:t.customFormats.concat([{name:r,format:n}]),formats:t.formats.concat([{title:n.title,format:r,icon:n.icon}])}}return O(O({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},kT=function(t){return function(t){return F.from(t.getParam("style_formats")).filter(i)}(t).map((function(n){var e=function(t,n){var e=ST(n),o=function(n){U(n,(function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)}))}
return t.formatter?o(e.customFormats):t.on("init",(function(){o(e.customFormats)})),e.formats}(t,n)
return function(t){return t.getParam("style_formats_merge",!1,"boolean")}(t)?wT.concat(e):e})).getOr(wT)},CT=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)}
return uo(t,o)},OT=function(t,n,e,r){var i=function(n){return W(n,(function(n){var u=st(n)
if(xt(n,"items")){var a=i(n.items)
return uo(function(t){return uo(t,{type:"submenu"})}(n),{getStyleItems:h(a)})}return xt(n,"format")?function(t){return CT(t,e,r)}(n):1===u.length&&H(u,"title")?uo(n,{type:"separator"}):function(n){var i=o(n.name)?n.name:ou(n.title),u="custom-"+i,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:r(u)},c=uo(n,a)
return t.formatter.register(i,c),c}(n)}))}
return i(n)},_T=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n)
return void 0!==e?F.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):F.none()}},o=function(t){var n=t.items
return void 0!==n&&n.length>0?$(n,o):[t.format]},r=xr([]),i=xr([]),u=xr([]),a=xr([]),c=xr(!1)
t.on("PreInit",(function(u){var a=kT(t),c=OT(t,a,n,e)
r.set(c),i.set($(c,o))})),t.on("addStyleModifications",(function(r){var i=OT(t,r.items,n,e)
u.set(i),c.set(r.replace),a.set($(i,o))}))
return{getData:function(){var t=c.get()?[]:r.get(),n=u.get()
return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get()
return t.concat(n)}}},TT=bC.trim,DT=function(t){return function(n){if(function(t){return f(t)&&1===t.nodeType}(n)){if(n.contentEditable===t)return!0
if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},ET=DT("true"),BT=DT("false"),MT=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},AT=function(t){return t.innerText||t.textContent},FT=function(t){return function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)}(t)&&RT(t)},IT=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},RT=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable
if(n&&"inherit"!==n)return ET(t)}return!1}(t)&&!BT(t)},VT=function(t){return IT(t)&&RT(t)},PT=function(t){var n=function(t){return t.id?t.id:ou("h")}(t)
return MT("header",AT(t),"#"+n,function(t){return IT(t)?parseInt(t.nodeName.substr(1),10):0}(t),(function(){t.id=n}))},HT=function(t){var n=t.id||t.name,e=AT(t)
return MT("anchor",e||"#"+n,"#"+n,0,g)},zT=function(t){var n,e
return n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,W(of(Ft.fromDom(e),n),(function(t){return t.dom}))},NT=function(t){return TT(t.title).length>0},LT=function(t){var n=zT(t)
return G(function(t){return W(G(t,VT),PT)}(n).concat(function(t){return W(G(t,FT),HT)}(n)),NT)},WT="tinymce-url-history",UT=function(t){return o(t)&&/^https?/.test(t)},jT=function(t){return r(t)&&ht(t,(function(t){return!(i(n=t)&&n.length<=5&&Q(n,UT))
var n})).isNone()},GT=function(){var t,n=jy.getItem(WT)
if(null===n)return{}
try{t=JSON.parse(n)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+WT+" was not valid JSON",e),{}
throw e}return jT(t)?t:(console.log("Local storage "+WT+" was not valid format",t),{})},XT=function(t){var n=GT()
return bt(n,t).getOr([])},qT=function(t,n){if(UT(t)){var e=GT(),o=bt(e,n).getOr([]),r=G(o,(function(n){return n!==t}))
e[n]=[t].concat(r).slice(0,5),function(t){if(!jT(t))throw new Error("Bad format for history:\n"+JSON.stringify(t))
jy.setItem(WT,JSON.stringify(t))}(e)}},YT=function(t){return!!t},KT=function(t){return dt(bC.makeMap(t,/[, ]/),YT)},JT=function(t){return F.from(function(t){return t.getParam("file_picker_callback")}(t)).filter(l)},$T=function(t,n){var e=function(t){var n=F.some(function(t){return t.getParam("file_picker_types")}(t)).filter(YT),e=F.some(function(t){return t.getParam("file_browser_callback_types")}(t)).filter(YT),o=n.or(e).map(KT)
return JT(t).fold(S,(function(t){return o.fold(k,(function(t){return st(t).length>0&&t}))}))}(t)
return a(e)?e?JT(t):F.none():e[n]?JT(t):F.none()},QT=function(t){return F.from(t).filter(o).getOrUndefined()},ZT=function(t){return{getHistory:XT,addToHistory:qT,getLinkInformation:function(){return function(t){return function(t){return!1===t.getParam("typeahead_urls")}(t)?F.none():F.some({targets:LT(t.getBody()),anchorTop:QT(Hb(t)),anchorBottom:QT(zb(t))})}(t)},getValidationHandler:function(){return function(t){return F.from(function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function")
return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n}(t))}(t)},getUrlPicker:function(n){return function(t,n){return $T(t,n).map((function(e){return function(i){return _w((function(u){var a=O({filetype:n,fieldname:i.fieldname},F.from(i.meta).getOr({}))
e.call(t,(function(t,n){if(!o(t))throw new Error("Expected value to be string")
if(void 0!==n&&!r(n))throw new Error("Expected meta to be a object")
u({value:t,meta:n})}),i.value,a)}))}}))}(t,n)}}},tD=function(t,n,e){var o=xr(!1),r=function(t){var n=xr(Bb(t)?"bottom":"top")
return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}}(n),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:vh.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return function(t,n){return aT(iT,t,n)}(t,i)},anchors:mT(n,e,r.isPositionedAtTop),header:r,getSink:function(){return Ue.value(t)}},urlinput:ZT(n),styleselect:_T(n),colorinput:bT(n),dialog:xT(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}}
return i},nD=kd,eD=ud,oD=h([lr("shell",!1),Ko("makeItem"),lr("setupItem",g),El("listBehaviours",[ip])]),rD=od({name:"items",overrides:function(){return{behaviours:xc([ip.config({})])}}}),iD=h([rD]),uD=h("CustomList"),aD=Bd({name:uD(),configFields:oD(),partFields:iD(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[ip.config({})],components:[]}:{behaviours:[],components:n},i=function(n){return t.shell?F.some(n):pd(n,t,"items")}
return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Dl(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){i(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=ip.contents(o),i=e.length,u=i-r.length,a=u>0?N(u,(function(){return t.makeItem()})):[],c=r.slice(i)
U(c,(function(t){return ip.remove(o,t)})),U(a,(function(t){return ip.append(o,t)}))
var s=ip.contents(o)
U(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),cD=h([Ko("dom"),lr("shell",!0),_l("toolbarBehaviours",[ip])]),sD=h([od({name:"groups",overrides:function(){return{behaviours:xc([ip.config({})])}}})]),fD=Bd({name:"Toolbar",configFields:cD(),partFields:sD(),factory:function(t,n,e,o){var r=function(n){return t.shell?F.some(n):pd(n,t,"groups")},i=t.shell?{behaviours:[ip.config({})],components:[]}:{behaviours:[],components:n}
return{uid:t.uid,dom:t.dom,components:i.components,behaviours:Dl(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){ip.set(t,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),lD=g,dD=S,mD=h([]),gD=Object.freeze({__proto__:null,setup:lD,isDocked:dD,getBehaviours:mD}),pD=function(t){return(wt(ee(t,"position"),"fixed")?F.none():Tn(t)).orThunk((function(){var n=Ft.fromTag("span")
return _n(t).bind((function(t){Oe(t,n)
var e=Tn(n)
return De(n),e}))}))},hD=function(t){return pD(t).map(ge).getOrThunk((function(){return de(0,0)}))},vD=wr([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),bD=function(t,n){var e=t.element
Vu(e,n.transitionClass),Hu(e,n.fadeOutClass),Vu(e,n.fadeInClass),n.onShow(t)},yD=function(t,n){var e=t.element
Vu(e,n.transitionClass),Hu(e,n.fadeInClass),Vu(e,n.fadeOutClass),n.onHide(t)},xD=function(t,n,e){return Q(t,(function(t){switch(t){case"bottom":return function(t,n){return t.bottom<=n.bottom}(n,e)
case"top":return function(t,n){return t.y>=n.y}(n,e)}}))},wD=function(t,n){return n.getInitialPos().map((function(n){return Pe(n.bounds.x,n.bounds.y,ve(t),se(t))}))},SD=function(t,n,e){return e.getInitialPos().bind((function(o){switch(e.clearInitialPos(),o.position){case"static":return F.some(vD.static())
case"absolute":var r=pD(t).map(He).getOrThunk((function(){return He(Ln())}))
return F.some(vD.absolute(Ic("absolute",bt(o.style,"left").map((function(t){return n.x-r.x})),bt(o.style,"top").map((function(t){return n.y-r.y})),bt(o.style,"right").map((function(t){return r.right-n.right})),bt(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))))
default:return F.none()}}))},kD=function(t,n,e){var o=He(t)
if(xD(e.getModes(),o,n))return F.none();(function(t,n,e){e.setInitialPos({style:oe(t),position:te(t,"position")||"static",bounds:n})})(t,o,e)
var r=Ne(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y
return F.some(vD.fixed(Ic("fixed",F.some(i),c?F.some(u):F.none(),F.none(),c?F.none():F.some(a))))},CD=function(t,n,e){var o=t.element
return wt(ee(o,"position"),"fixed")?function(t,n,e){return wD(t,e).filter((function(t){return xD(e.getModes(),t,n)})).bind((function(n){return SD(t,n,e)}))}(o,n,e):kD(o,n,e)},OD=function(t,n,e){e.setDocked(!1),U(["left","right","top","bottom","position"],(function(n){return ie(t.element,n)})),n.onUndocked(t)},_D=function(t,n,e,o){var r="fixed"===o.position
e.setDocked(r),Rc(t.element,o),(r?n.onDocked:n.onUndocked)(t)},TD=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=function(t,n){return t.y<n.bottom&&t.bottom>n.y}(i,o)
u!==e.isVisible()&&(e.setVisible(u),r&&!u?(Nu(t.element,[n.fadeOutClass]),n.onHide(t)):(u?bD:yD)(t,n))}))}))},DD=function(t,n,e){var o=t.element
e.setDocked(!1),function(t,n){var e=t.element
return wD(e,n).bind((function(t){return SD(e,t,n)}))}(t,e).each((function(o){o.fold((function(){return OD(t,n,e)}),(function(o){return _D(t,n,e,o)}),g)})),e.setVisible(!0),n.contextual.each((function(n){Lu(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),ED(t,n,e)},ED=function(t,n,e){t.getSystem().isConnected()&&function(t,n,e){var o=n.lazyViewport(t)
e.isDocked()&&TD(t,n,e,o),CD(t,o,e).each((function(r){r.fold((function(){return OD(t,n,e)}),(function(o){return _D(t,n,e,o)}),(function(r){TD(t,n,e,o,!0),_D(t,n,e,r)}))}))}(t,n,e)},BD=function(t,n,e){e.isDocked()&&DD(t,n,e)},MD=Object.freeze({__proto__:null,refresh:ED,reset:BD,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),AD=Object.freeze({__proto__:null,events:function(t,n){return Ii([ji(Qr(),(function(e,o){t.contextual.each((function(t){zu(e.element,t.transitionClass)&&(Lu(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e))
o.stop()}))})),Pi(hi(),(function(e,o){ED(e,t,n)})),Pi(vi(),(function(e,o){BD(e,t,n)}))])}}),FD=[fr("contextual",[Qo("fadeInClass"),Qo("fadeOutClass"),Qo("transitionClass"),tr("lazyContext"),Ta("onShow"),Ta("onShown"),Ta("onHide"),Ta("onHidden")]),vr("lazyViewport",Ne),br("modes",["top","bottom"],Ao),Ta("onDocked"),Ta("onUndocked")],ID=Sc({fields:FD,name:"docking",active:AD,apis:MD,state:Object.freeze({__proto__:null,init:function(t){var n=xr(!1),e=xr(!0),o=Qc(),r=xr(t.modes)
return xu({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),RD=h(ou("toolbar-height-change")),VD={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},PD="tox-tinymce--toolbar-sticky-on",HD="tox-tinymce--toolbar-sticky-off",zD=function(t,n){return H(ID.getModes(t),n)},ND=function(t){var n=t.element
_n(n).each((function(e){var o="padding-"+ID.getModes(t)[0]
if(ID.isDocked(t)){var r=ve(e)
$n(n,"width",r+"px"),$n(e,o,function(t){return fe(t)+(parseInt(te(t,"margin-top"),10)||0)+(parseInt(te(t,"margin-bottom"),10)||0)}(n)+"px")}else ie(n,"width"),ie(e,o)}))},LD=function(t,n){n?(Hu(t,VD.fadeOutClass),Nu(t,[VD.transitionClass,VD.fadeInClass])):(Hu(t,VD.fadeInClass),Nu(t,[VD.fadeOutClass,VD.transitionClass]))},WD=function(t,n){var e=Ft.fromDom(t.getContainer())
n?(Vu(e,PD),Hu(e,HD)):(Vu(e,HD),Hu(e,PD))},UD=function(t,n){var e=Qc(),o=n.getSink,r=function(t){o().each((function(n){return t(n.element)}))},i=function(n){t.inline||ND(n),WD(t,ID.isDocked(n)),n.getSystem().broadcastOn([al()],{}),o().each((function(t){return t.getSystem().broadcastOn([al()],{})}))},u=t.inline?[]:function(){var t
return[_c.config({channels:(t={},t[RD()]={onReceive:ND},t)})]}()
return T([lp.config({}),ID.config({contextual:O({lazyContext:function(n){var e=fe(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=He(Ft.fromDom(o)),i=r.height-e,u=r.y+(zD(n,"top")?0:e)
return F.some(Pe(r.x,u,r.width,i))},onShow:function(){r((function(t){return LD(t,!0)}))},onShown:function(t){r((function(t){return Lu(t,[VD.transitionClass,VD.fadeInClass])})),e.get().each((function(n){var o,r,i
o=t.element,i=Sn(r=n),Mc(i).filter((function(t){return!yn(r,t)})).filter((function(t){return yn(t,Ft.fromDom(i.dom.body))||wn(o,t)})).each((function(){return Ec(r)})),e.clear()}))},onHide:function(t){(function(t,n){return Ac(t).orThunk((function(){return n().toOptional().bind((function(t){return Ac(t.element)}))}))})(t.element,o).fold(e.clear,e.set),r((function(t){return LD(t,!1)}))},onHidden:function(){r((function(t){return Lu(t,[VD.transitionClass])}))}},VD),lazyViewport:function(n){var e=Ne(),o=function(t){return t.getParam("toolbar_sticky_offset",0,"number")}(t),r=e.y+(zD(n,"top")?o:0),i=e.height-(zD(n,"bottom")?o:0)
return Pe(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:i,onUndocked:i})],u,!0)},jD=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(ID.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(ND)})),t.on("SkinLoaded",(function(){e().each((function(t){ID.isDocked(t)?ID.reset(t):ID.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(ID.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){ID.refresh(n)
var e=n.element
Ym(e)&&function(t,n){var e=Sn(n),o=e.dom.defaultView.innerHeight,r=Be(e),i=Ft.fromDom(t.elm),u=ze(i),a=se(i),c=u.y,s=c+a,f=ge(n),l=se(n),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2
if(g&&c<m)Me(r.left,c-l,e)
else if(p&&s>d){var h=c-o+a+l
Me(r.left,h,e)}}(t,e)}))})),t.on("PostRender",(function(){WD(t,!1)}))},isDocked:function(t){return t().map(ID.isDocked).getOr(!1)},getBehaviours:UD}),GD=Co([Qo("type"),Jo("items",_o([Do([Qo("name"),or("items",Ao)]),Ao]))].concat(Qh)),XD=[ar("text"),ar("tooltip"),ar("icon"),tr("fetch"),vr("onSetup",(function(){return g}))],qD=Co(T([Qo("type")],XD,!0)),YD=function(t){return Lo("menubutton",qD,t)},KD=Co([Qo("type"),ar("tooltip"),ar("icon"),ar("text"),cr("select"),tr("fetch"),vr("onSetup",(function(){return g})),pr("presets","normal",["normal","color","listpreview"]),lr("columns",1),tr("onAction"),tr("onItemAction")]),JD=Ed({factory:function(t,n){var e={focus:tp.focusIn,setMenus:function(t,e){var o=W(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=YD(e).mapError((function(t){return jo(t)})).getOrDie()
return zO(o,"tox-mbtn",n.backstage,F.some("menuitem"))}))
ip.set(t,o)}}
return{uid:t.uid,dom:t.dom,components:[],behaviours:xc([ip.config({}),up("menubar-events",[Gi((function(n){t.onSetup(n)})),Pi(Ur(),(function(t,n){sa(t.element,".tox-mbtn--active").each((function(e){fa(n.event.target,".tox-mbtn").each((function(n){yn(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){rS.expand(t),rS.close(e),lp.focus(t)}))}))}))}))})),Pi(Si(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){rS.isOpen(e)&&(rS.expand(t),rS.close(e))}))}))}))]),tp.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),F.some(!0)}}),$x.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Ko("dom"),Ko("uid"),Ko("onEscape"),Ko("backstage"),lr("onSetup",g)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),$D=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},QD=function(t){return t.dimension.property},ZD=function(t,n){return t.dimension.getDimension(n)},tE=function(t,n){var e=$D(t,n)
Lu(e,[n.shrinkingClass,n.growingClass])},nE=function(t,n){Hu(t.element,n.openClass),Vu(t.element,n.closedClass),$n(t.element,QD(n),"0px"),ue(t.element)},eE=function(t,n){Hu(t.element,n.closedClass),Vu(t.element,n.openClass),ie(t.element,QD(n))},oE=function(t,n,e,o){e.setCollapsed(),$n(t.element,QD(n),ZD(n,t.element)),ue(t.element),tE(t,n),nE(t,n),n.onStartShrink(t),n.onShrunk(t)},rE=function(t,n,e,o){var r=o.getOrThunk((function(){return ZD(n,t.element)}))
e.setCollapsed(),$n(t.element,QD(n),r),ue(t.element)
var i=$D(t,n)
Hu(i,n.growingClass),Vu(i,n.shrinkingClass),nE(t,n),n.onStartShrink(t)},iE=function(t,n,e){var o=ZD(n,t.element);("0px"===o?oE:rE)(t,n,e,F.some(o))},uE=function(t,n,e){var o=$D(t,n),r=zu(o,n.shrinkingClass),i=ZD(n,t.element)
eE(t,n)
var u=ZD(n,t.element);(r?function(){$n(t.element,QD(n),i),ue(t.element)}:function(){nE(t,n)})(),Hu(o,n.shrinkingClass),Vu(o,n.growingClass),eE(t,n),$n(t.element,QD(n),u),e.setExpanded(),n.onStartGrow(t)},aE=function(t,n,e){var o=$D(t,n)
return!0===zu(o,n.growingClass)},cE=function(t,n,e){var o=$D(t,n)
return!0===zu(o,n.shrinkingClass)},sE=Object.freeze({__proto__:null,refresh:function(t,n,e){if(e.isExpanded()){ie(t.element,QD(n))
var o=ZD(n,t.element)
$n(t.element,QD(n),o)}},grow:function(t,n,e){e.isExpanded()||uE(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&iE(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&oE(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:aE,isShrinking:cE,isTransitioning:function(t,n,e){return aE(t,n)||cE(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?iE:uE)(t,n,e)},disableTransitions:tE}),fE=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded
return Su(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Cr(n.dimension.property,"0px")})},events:function(t,n){return Ii([ji(Qr(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(tE(e,t),n.isExpanded()&&ie(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),lE=[Ko("closedClass"),Ko("openClass"),Ko("shrinkingClass"),Ko("growingClass"),rr("getAnimationRoot"),Ta("onShrunk"),Ta("onStartShrink"),Ta("onGrown"),Ta("onStartGrow"),lr("expanded",!1),Jo("dimension",Go("property",{width:[Ma("property","width"),Ma("getDimension",(function(t){return ve(t)+"px"}))],height:[Ma("property","height"),Ma("getDimension",(function(t){return se(t)+"px"}))]}))],dE=Sc({fields:lE,name:"sliding",active:fE,apis:sE,state:Object.freeze({__proto__:null,init:function(t){var n=xr(t.expanded)
return xu({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:y(n.set,!1),setExpanded:y(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),mE="container",gE=[_l("slotBehaviours",[])],pE=function(t){return"<alloy.field."+t+">"},hE=function(t,n){var e,o=function(n){return yd(t)},r=function(n,e){return function(o,r){return pd(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==Gn(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){if(i(t)){var e=t.element
$n(e,"display","none"),jn(e,"aria-hidden","true"),Ei(t,ki(),{name:n,visible:!1})}})),c=(e=a,function(t,n){U(n,(function(n){return e(t,n)}))}),s=r((function(t,n){if(!i(t)){var e=t.element
ie(e,"display"),Yn(e,"aria-hidden"),Ei(t,ki(),{name:n,visible:!0})}})),f={getSlotNames:o,getSlot:function(n,e){return pd(n,t,e)},isShowing:u,hideSlot:a,hideAllSlots:function(t){return c(t,o())},showSlot:s}
return{uid:t.uid,dom:t.dom,components:n,behaviours:Tl(t.slotBehaviours),apis:f}},vE=dt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},(function(t){return bu(t)})),bE=O(O({},vE),{sketch:function(t){var n=function(){var t=[]
return{slot:function(n,e){return t.push(n),fd(mE,pE(n),e)},record:h(t)}}(),e=t(n),o=n.record(),r=W(o,(function(t){return nd({name:t,pname:pE(t)})}))
return Od(mE,gE,r,hE,e)}}),yE=Co([ar("icon"),ar("tooltip"),vr("onShow",g),vr("onHide",g),vr("onSetup",(function(){return g}))]),xE=function(t){return{element:function(){return t.element.dom}}},wE=function(t,n){var e=W(st(n),(function(t){var e=n[t],o=Wo(function(t){return Lo("sidebar",yE,t)}(e))
return{name:t,getApi:xE,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}))
return W(e,(function(n){var o=xr(g)
return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:rb([Jb(n,o),$b(n,o),Pi(ki(),(function(t,n){var o=n.event
Y(e,(function(t){return t.name===o.name})).each((function(n){(o.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},SE=function(t){return bE.sketch((function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:wE(n,t),slotBehaviours:rb([Gi((function(t){return bE.hideAllSlots(t)}))])}}))},kE=function(t){return Id.getCurrent(t).bind((function(t){return dE.isGrowing(t)||dE.hasGrown(t)?Id.getCurrent(t).bind((function(t){return Y(bE.getSlotNames(t),(function(n){return bE.isShowing(t,n)}))})):F.none()}))},CE=ou("FixSizeEvent"),OE=ou("AutoSizeEvent"),_E=Object.freeze({__proto__:null,block:function(t,n,e,o){jn(t.element,"aria-busy",!0)
var r=n.getRoot(t).getOr(t),i=xc([tp.config({mode:"special",onTab:function(){return F.some(!0)},onShiftTab:function(){return F.some(!0)}}),lp.config({})]),u=o(r,i),a=r.getSystem().build(u)
ip.append(r,na(a)),a.hasConfigured(tp)&&n.focus&&tp.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return ip.remove(r,a)}))},unblock:function(t,n,e){Yn(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),TE=[vr("getRoot",F.none),hr("focus",!0),Ta("onBlock"),Ta("onUnblock")],DE=Sc({fields:TE,name:"blocking",apis:_E,state:Object.freeze({__proto__:null,init:function(){var t=Jc((function(t){return t.destroy()}))
return xu({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}})}),EE=function(t){var n=Ft.fromHtml(t),e=Dn(n),o=function(t){var n=void 0!==t.dom.attributes?t.dom.attributes:[]
return q(n,(function(t,n){var e
return"class"===n.name?t:O(O({},t),((e={})[n.name]=n.value,e))}),{})}(n),r=function(t){return Array.prototype.slice.call(t.dom.classList,0)}(n),i=0===e.length?{}:{innerHtml:Ki(n)}
return O({tag:Rt(n),classes:r,attributes:o},i)},BE=function(t){return Id.getCurrent(t).each((function(t){return Ec(t.element)}))},ME=function(t,n,e,o){var r=n.element
if(function(t,n){var e="tabindex",o="data-mce-tabindex"
F.from(t.iframeElement).map(Ft.fromDom).each((function(t){n?(Xn(t,e).each((function(n){return jn(t,o,n)})),jn(t,e,-1)):(Yn(t,e),Xn(t,o).each((function(n){jn(t,e,n),Yn(t,o)})))}))}(t,e),e)DE.block(n,function(t){return function(n,e){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:EE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}}(o)),ie(r,"display"),Yn(r,"aria-hidden"),t.hasFocus()&&BE(n)
else{var i=Id.getCurrent(n).exists((function(t){return Bc(t.element)}))
DE.unblock(n),$n(r,"display","none"),jn(r,"aria-hidden","true"),i&&t.focus()}},AE=function(t,n,e){var o=xr(!1),r=Qc(),i=function(e){var r
!o.get()||function(t){return"focusin"===t.type}(r=e)&&(r.composed?it(r.composedPath()):F.from(r.target)).map(Ft.fromDom).filter(Pt).exists((function(t){return zu(t,"mce-pastebin")}))||(e.preventDefault(),BE(n()),t.editorManager.setActive(t))}
t.inline||t.on("PreInit",(function(){t.dom.bind(t.getWin(),"focusin",i),t.on("BeforeExecCommand",(function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&i(t)}))}))
var u=function(r){r!==o.get()&&(o.set(r),ME(t,n(),r,e.providers),t.fire("AfterProgressState",{state:r}))}
t.on("ProgressState",(function(n){if(r.on(gh.clearTimeout),d(n.time)){var e=gh.setEditorTimeout(t,(function(){return u(n.state)}),n.time)
r.set(e)}else u(n.state),r.clear()}))},FE=function(t,n,e){return{within:t,extra:n,withinWidth:e}},IE=function(t,n,e){var o,r=(o=function(t,n){var o=e(t)
return F.some({element:t,start:n,finish:n+o,width:o})},q(t,(function(t,n){return o(n,t.len).fold(h(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list),i=G(r,(function(t){return t.finish<=n})),u=X(i,(function(t,n){return t+n.width}),0)
return{within:i,extra:r.slice(i.length),withinWidth:u}},RE=function(t){return W(t,(function(t){return t.element}))},VE=function(t,n,e,o){var r=function(t,n,e){var o=IE(n,t,e)
return 0===o.extra.length?F.some(o):F.none()}(t,n,e).getOrThunk((function(){return IE(n,t-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth
return 1===u.length&&u[0].width<=e(o)?function(t,n,e){var o=RE(t.concat(n))
return FE(o,[],e)}(i,u,a):u.length>=1?function(t,n,e,o){var r=RE(t).concat([e])
return FE(r,RE(n),o)}(i,u,o,a):function(t,n,e){return FE(RE(t),[],e)}(i,0,a)},PE=function(t,n){var e=W(n,(function(t){return na(t)}))
fD.setGroups(t,e)},HE=function(t,n,e){var o=n.builtGroups.get()
if(0!==o.length){var r=hd(t,n,"primary"),i=Nw.getCoupled(t,"overflowGroup")
$n(r.element,"visibility","hidden")
var u=o.concat([i]),a=ct(u,(function(t){return Ac(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}))
e([]),PE(r,u)
var c=ve(r.element),s=VE(c,n.builtGroups.get(),(function(t){return ve(t.element)}),i)
0===s.extra.length?(ip.remove(r,i),e([])):(PE(r,s.within),e(s.extra)),ie(r.element,"visibility"),ue(r.element),a.each(lp.focus)}},zE=h([_l("splitToolbarBehaviours",[Nw]),qo("builtGroups",(function(){return xr([])}))]),NE=h([Oa(["overflowToggledClass"]),cr("getOverflowBounds"),Ko("lazySink"),qo("overflowGroups",(function(){return xr([])}))].concat(zE())),LE=h([nd({factory:fD,schema:cD(),name:"primary"}),ed({schema:cD(),name:"overflow"}),ed({name:"overflow-button"}),ed({name:"overflow-group"})]),WE=h((function(t,n){(function(t,n){var e=he.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"])
$n(t,"max-width",e+"px")})(t,Math.floor(n))})),UE=h([Oa(["toggledClass"]),Ko("lazySink"),tr("fetch"),cr("getBounds"),fr("fireDismissalEventInstead",[lr("event",xi())]),Cs()]),jE=h([ed({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:xc([kp.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),ed({factory:fD,schema:cD(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:xc([tp.config({mode:"cyclic",onEscape:function(n){return pd(n,t,"button").each(lp.focus),F.none()}})])}}})]),GE=function(t,n){var e=Nw.getCoupled(t,"toolbarSandbox")
il.isOpen(e)?il.close(e):il.open(e,n.toolbar())},XE=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie()
Pf.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:WE()}}},r)},qE=function(t,n,e,o,r){fD.setGroups(n,r),XE(t,n,e,o),kp.on(t)},YE=Bd({name:"FloatingToolbarButton",factory:function(t,n,e,o){return O(O({},ph.sketch(O(O({},o.button()),{action:function(t){GE(t,o)},buttonBehaviours:Bl({dump:o.button().buttonBehaviours},[Nw.config({others:{toolbarSandbox:function(n){return function(t,n,e){var o=la()
return{dom:{tag:"div",attributes:{id:o.id}},behaviours:xc([tp.config({mode:"special",onEscape:function(t){return il.close(t),F.some(!0)}}),il.config({onOpen:function(r,i){e.fetch().get((function(r){qE(t,i,e,n.layouts,r),o.link(t.element),tp.focusIn(i)}))},onClose:function(){kp.off(t),lp.focus(t),o.unlink(t.element)},isPartOf:function(n,e,o){return ma(e,o)||ma(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),_c.config({channels:O(O({},fl(O({isExtraPart:S},e.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),dl({doReposition:function(){il.getState(Nw.getCoupled(t,"toolbarSandbox")).each((function(o){XE(t,o,e,n.layouts)}))}}))})])}}(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){il.getState(Nw.getCoupled(n,"toolbarSandbox")).each((function(r){qE(n,r,t,e.layouts,o)}))},reposition:function(n){il.getState(Nw.getCoupled(n,"toolbarSandbox")).each((function(o){XE(n,o,t,e.layouts)}))},toggle:function(t){GE(t,o)},getToolbar:function(t){return il.getState(Nw.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return il.isOpen(Nw.getCoupled(t,"toolbarSandbox"))}}})},configFields:UE(),partFields:jE(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),KE=h([Ko("items"),Oa(["itemSelector"]),_l("tgroupBehaviours",[tp])]),JE=h([rd({name:"items",unit:"item"})]),$E=Bd({name:"ToolbarGroup",configFields:KE(),partFields:JE(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.tgroupBehaviours,[tp.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),QE=function(t){return W(t,(function(t){return na(t)}))},ZE=function(t,n,e){HE(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){YE.setGroups(t,QE(o))}))}))},tB=Bd({name:"SplitFloatingToolbar",configFields:NE(),partFields:LE(),factory:function(t,n,e,o){var r=hh(YE.sketch({fetch:function(){return _w((function(n){n(QE(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[nc,tc]},onRtl:function(){return[tc,nc]},onBottomLtr:function(){return[oc,ec]},onBottomRtl:function(){return[ec,oc]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}))
return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.splitToolbarBehaviours,[Nw.config({others:{overflowGroup:function(){return $E.sketch(O(O({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(W(e,n.getSystem().build)),ZE(n,r,t)},refresh:function(n){return ZE(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){YE.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(YE.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){YE.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(YE.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),nB=h([Oa(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Ta("onOpened"),Ta("onClosed")].concat(zE())),eB=h([nd({factory:fD,schema:cD(),name:"primary"}),nd({factory:fD,schema:cD(),name:"overflow",overrides:function(t){return{toolbarBehaviours:xc([dE.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){pd(n,t,"overflow-button").each((function(t){kp.off(t),lp.focus(t)})),t.onClosed(n)},onGrown:function(n){tp.focusIn(n),t.onOpened(n)},onStartGrow:function(n){pd(n,t,"overflow-button").each(kp.on)}}),tp.config({mode:"acyclic",onEscape:function(n){return pd(n,t,"overflow-button").each(lp.focus),F.some(!0)}})])}}}),ed({name:"overflow-button",overrides:function(t){return{buttonBehaviours:xc([kp.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),ed({name:"overflow-group"})]),oB=function(t,n){pd(t,n,"overflow-button").bind((function(){return pd(t,n,"overflow")})).each((function(e){rB(t,n),dE.toggleGrow(e)}))},rB=function(t,n){pd(t,n,"overflow").each((function(e){HE(t,n,(function(t){var n=W(t,(function(t){return na(t)}))
fD.setGroups(e,n)})),pd(t,n,"overflow-button").each((function(t){dE.hasGrown(e)&&kp.on(t)})),dE.refresh(e)}))},iB=Bd({name:"SplitSlidingToolbar",configFields:nB(),partFields:eB(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle"
return{uid:t.uid,dom:t.dom,components:n,behaviours:Dl(t.splitToolbarBehaviours,[Nw.config({others:{overflowGroup:function(t){return $E.sketch(O(O({},o["overflow-group"]()),{items:[ph.sketch(O(O({},o["overflow-button"]()),{action:function(n){Di(t,r)}}))]}))}}}),up("toolbar-toggle-events",[Pi(r,(function(n){oB(n,t)}))])]),apis:{setGroups:function(n,e){(function(n,e){var o=W(e,n.getSystem().build)
t.builtGroups.set(o)})(n,e),rB(n,t)},refresh:function(n){return rB(n,t)},toggle:function(n){return oB(n,t)},isOpen:function(n){return function(t,n){return pd(t,n,"overflow").map(dE.hasGrown).getOr(!1)}(n,t)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),uB=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}))
return{dom:O({tag:"div",classes:["tox-toolbar__group"]},n),components:[$E.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:xc([$x.config({}),lp.config({})])}},aB=function(t){return $E.sketch(uB(t))},cB=function(t,n){var e=Gi((function(n){var e=W(t.initGroups,aB)
fD.setGroups(n,e)}))
return xc([Yb(t.providers.isDisabled),jb(),tp.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),up("toolbar-events",[e])])},sB=function(t){var n=t.cyclicKeying?"cyclic":"acyclic"
return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":uB({title:F.none(),items:[]}),"overflow-button":WO({name:"more",icon:F.some("more-drawer"),disabled:!1,tooltip:F.some("More..."),primary:!1,borderless:!1},F.none(),t.providers)},splitToolbarBehaviours:cB(t,n)}},fB=function(t){var n=sB(t),e=tB.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}})
return tB.sketch(O(O({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=ze(n),o=Cn(n),r=ze(o),i=Math.max(o.dom.scrollHeight,r.height)
return Pe(e.x+4,r.y,e.width-8,i)},parts:O(O({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},lB=function(t){var n=iB.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=iB.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=sB(t)
return iB.sketch(O(O({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([RD()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([RD()],{type:"closed"})}}))},dB=function(t){var n=t.cyclicKeying?"cyclic":"acyclic"
return fD.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===mv.scrolling?["tox-toolbar--scrolling"]:[])},components:[fD.parts.groups({})],toolbarBehaviours:cB(t,n)})},mB=eD.optional({factory:JD,name:"menubar",schema:[Ko("backstage")]}),gB=eD.optional({factory:{sketch:function(t){return aD.sketch({uid:t.uid,dom:t.dom,listBehaviours:xc([tp.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return dB({type:t.type,uid:ou("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),F.some(!0)}})},setupItem:function(t,n,e,o){fD.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Ko("dom"),Ko("onEscape")]}),pB=eD.optional({factory:{sketch:function(t){return function(t){return t.type===mv.sliding?lB:t.type===mv.floating?fB:dB}(t)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),F.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Ko("dom"),Ko("onEscape"),Ko("getSink")]}),hB=eD.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?UD:mD
return{uid:t.uid,dom:t.dom,components:t.components,behaviours:xc(e(n,t.sharedBackstage))}}},name:"header",schema:[Ko("dom")]}),vB=eD.optional({name:"socket",schema:[Ko("dom")]}),bB=eD.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:xc([$x.config({}),lp.config({}),dE.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Id.getCurrent(t).each(bE.hideAllSlots),Di(t,OE)},onGrown:function(t){Di(t,OE)},onStartGrow:function(t){Ei(t,CE,{width:ee(t.element,"width").getOr("")})},onStartShrink:function(t){Ei(t,CE,{width:ve(t.element)+"px"})}}),ip.config({}),Id.config({find:function(t){var n=ip.contents(t)
return it(n)}})])}],behaviours:xc([gC(0),up("sidebar-sliding-events",[Pi(CE,(function(t,n){$n(t.element,"width",n.event.width)})),Pi(OE,(function(t,n){ie(t.element,"width")}))])])}}},name:"sidebar",schema:[Ko("dom")]}),yB=eD.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:xc([ip.config({}),DE.config({focus:!1}),Id.config({find:function(t){return it(t.components())}})]),components:[]}}},name:"throbber",schema:[Ko("dom")]}),xB=Bd({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return nD.getPart(n,t,"socket")},setSidebar:function(n,e){nD.getPart(n,t,"sidebar").each((function(t){return function(t,n){Id.getCurrent(t).each((function(t){return ip.set(t,[SE(n)])}))}(t,e)}))},toggleSidebar:function(n,e){nD.getPart(n,t,"sidebar").each((function(t){return function(t,n){Id.getCurrent(t).each((function(t){Id.getCurrent(t).each((function(e){dE.hasGrown(t)?bE.isShowing(e,n)?dE.shrink(t):(bE.hideAllSlots(e),bE.showSlot(e,n)):(bE.hideAllSlots(e),bE.showSlot(e,n),dE.grow(t))}))}))}(t,e)}))},whichSidebar:function(n){return nD.getPart(n,t,"sidebar").bind(kE).getOrNull()},getHeader:function(n){return nD.getPart(n,t,"header")},getToolbar:function(n){return nD.getPart(n,t,"toolbar")},setToolbar:function(n,e){nD.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){nD.getPart(n,t,"multiple-toolbar").each((function(t){aD.setItems(t,e)}))},refreshToolbar:function(n){nD.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){nD.getPart(n,t,"toolbar").each((function(t){var n,e
n=t.getApis().toggle,e=function(n){return n(t)},null!=n?F.some(e(n)):F.none()}))},isToolbarDrawerToggled:function(n){return nD.getPart(n,t,"toolbar").bind((function(t){return F.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return nD.getPart(n,t,"throbber")},focusToolbar:function(n){nD.getPart(n,t,"toolbar").orThunk((function(){return nD.getPart(n,t,"multiple-toolbar")})).each((function(t){tp.focusIn(t)}))},setMenubar:function(n,e){nD.getPart(n,t,"menubar").each((function(t){JD.setMenus(t,e)}))},focusMenubar:function(n){nD.getPart(n,t,"menubar").each((function(t){JD.focus(t)}))}}
return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Ko("dom"),Ko("behaviours")],partFields:[hB,mB,pB,gB,vB,bB,yB],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=W(e,(function(t){return aB(t)}))
t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=W(e,(function(t){return W(t,aB)}))
t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),wB={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},SB=function(t){return"string"==typeof t?t.split(" "):t},kB=function(t,n){var e=O(O({},wB),n.menus),o=st(n.menus).length>0,r=void 0===n.menubar||!0===n.menubar?SB("file edit view insert format tools table help"):SB(!1===n.menubar?"":n.menubar),i=G(r,(function(t){var e=yt(wB,t)
return o?e||bt(n.menus,t).exists((function(t){return yt(t,"items")})):e})),u=W(i,(function(o){var r=e[o]
return function(t,n,e){var o=function(t){return t.getParam("removed_menuitems","")}(e).split(/[ ,]/)
return{text:t.title,getItems:function(){return $(t.items,(function(t){var e=t.toLowerCase()
return 0===e.trim().length||z(o,(function(t){return t===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]}))}}}({title:r.title,items:SB(r.items)},n,t)}))
return G(u,(function(t){return t.getItems().length>0&&z(t.getItems(),(function(t){return"separator"!==t.type}))}))},CB=function(t){var n=function(){t._skinLoaded=!0,function(t){t.fire("SkinLoaded")}(t)}
return function(){t.initialized?n():t.on("init",n)}},OB=function(t,n,e){return new Wh((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},_B=function(t,n){return OB(t,n+"/skin.min.css",t.ui.styleSheetLoader)},TB=function(t,n){var e
return(e=Ft.fromDom(t.getElement()),Pn(e).isSome())?OB(t,n+"/skin.shadowdom.min.css",mb.DOM.styleSheetLoader):Wh.resolve()},DB=function(t,n){var e=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url")
if(!1!==n){var o=n||"oxide"
e=e?t.documentBaseURI.toAbsolute(e):gb.baseURL+"/skins/ui/"+o}return e}(n)
e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1===function(t){return!1===t.getParam("skin")}(n)&&o(e)?Wh.all([_B(n,e),TB(n,e)]).then(CB(n),function(t,n){return function(){return function(t,n){return t.fire("SkinLoadError",n)}(t,{message:n})}}(n,"Skin could not be loaded")):CB(n)()},EB=y(DB,!1),BB=y(DB,!0),MB=function(t,n){return function(e){var o=$c(),r=function(){e.setActive(t.formatter.match(n))
var r=t.formatter.formatChanged(n,e.setActive)
o.set(r)}
return t.initialized?r():t.once("init",r),function(){t.off("init",r),o.clear()}}},AB=function(t,n,e){return function(o){var r=function(){return e(o)},i=function(){e(o),t.on(n,r)}
return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}},FB=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},IB=function(t,n){return function(){return t.execCommand(n)}},RB=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title)
if("separator"===t.type)return F.some({type:"separator",text:a})
if("submenu"===t.type){var c=$(t.getStyleItems(),(function(t){return r(t,o,u)}))
return 0===o&&c.length<=0?F.none():F.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return $(t.getStyleItems(),(function(t){return r(t,o,u)}))}})}return F.some(O({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t)
return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1
return $(t,(function(t){return r(t,o,n)}))}
return{validateItems:i,getFetch:function(t,n){return function(e,o){var r=n(),u=i(r)
o(PO(u,gv.CLOSE_ON_EXECUTE,t,!1))}}}},VB=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return W(o.data,(function(t){return CT(t,e.isSelectedFor,e.getPreviewFor)}))}:o.getData
return{items:RB(0,n,e),getStyleItems:r}},PB=function(t,n,e){var o=VB(0,n,e),r=o.items,i=o.getStyleItems,u=AB(t,"NodeChange",(function(t){var n=t.getComponent()
e.updateText(n)}))
return MO({text:e.icon.isSome()?F.none():e.text,icon:e.icon,tooltip:F.from(e.tooltip),role:F.none(),fetch:r.getFetch(n,i),onSetup:u,getApi:function(t){return{getComponent:h(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};(function(t){t[t.SemiColon=0]="SemiColon",t[t.Space=1]="Space"})(w_||(w_={}))
var HB,zB,NB,LB,WB,UB=function(t,n,e,o){return{type:"basic",data:function(t){return W(t,(function(t){var n=t,e=t,o=t.split("=")
return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}}))}(function(t,n){return n===w_.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")}(t.getParam(n,e,"string"),o))}},jB=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],GB=function(t){var n={type:"basic",data:jB}
return{tooltip:"Align",text:F.none(),icon:F.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:F.none,getPreviewFor:function(t){return F.none},onAction:function(n){return function(){return Y(jB,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},updateText:function(n){var e=Y(jB,(function(n){return t.formatter.match(n.format)})).fold(h("left"),(function(t){return t.title.toLowerCase()}))
Ei(n,BO,{icon:"align-"+e})},dataset:n,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},XB=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],qB=function(t){var n=t.split(/\s*,\s*/)
return W(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},YB=function(t){var n="System Font",e=function(){var e=function(t){return t?qB(t)[0]:""},r=t.queryCommandValue("FontName"),i=o.data,u=r?r.toLowerCase():""
return{matchOpt:Y(i,(function(t){var n=t.format
return n.toLowerCase()===u||e(n).toLowerCase()===e(u).toLowerCase()})).orThunk((function(){return Ct(function(t){var n
return 0===t.indexOf("-apple-system")&&(n=qB(t.toLowerCase()),Q(XB,(function(t){return n.indexOf(t.toLowerCase())>-1})))}(u),{title:n,format:u})})),font:r}},o=UB(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",w_.SemiColon)
return{tooltip:"Fonts",text:F.some(n),icon:F.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return e().matchOpt},getPreviewFor:function(t){return function(){return F.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},updateText:function(t){var n=e(),o=n.matchOpt,r=n.font,i=o.fold(h(r),(function(t){return t.title}))
Ei(t,EO,{text:i})},dataset:o,shouldHide:!1,isInvalid:S}},KB={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},JB={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},$B=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){var e=Math.pow(10,n)
return Math.round(t*e)/e}(72*parseInt(t,10)/96,n||0)+"pt":bt(JB,t).getOr(t)},QB=function(t){var n=function(){var n=F.none(),e=o.data,r=t.queryCommandValue("FontSize")
if(r)for(var i=function(t){var o=$B(r,t),i=function(t){return bt(KB,t).getOr("")}(o)
n=Y(e,(function(t){return t.format===r||t.format===o||t.format===i}))},u=3;n.isNone()&&u>=0;u--)i(u)
return{matchOpt:n,size:r}},e=h(F.none),o=UB(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",w_.Space)
return{tooltip:"Font sizes",text:F.some("12pt"),icon:F.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(h(r),(function(t){return t.title}))
Ei(t,EO,{text:i})},dataset:o,shouldHide:!1,isInvalid:S}},ZB=function(t,n){var e=n(),o=W(e,(function(t){return t.format}))
return F.from(t.formatter.closest(o)).bind((function(t){return Y(e,(function(n){return n.format===t}))})).orThunk((function(){return Ct(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},tM=function(t){var n="Paragraph",e=UB(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",w_.SemiColon)
return{tooltip:"Blocks",text:F.some(n),icon:F.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:F.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n)
return F.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:FB(t),updateText:function(o){var r=ZB(t,(function(){return e.data})).fold(h(n),(function(t){return t.title}))
Ei(o,EO,{text:r})},dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},nM=function(t,n){var e="Paragraph"
return{tooltip:"Formats",text:F.some(e),icon:F.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:F.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n)
return void 0!==e?F.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):F.none()}},onAction:FB(t),updateText:function(n){var o=function(t){var n=t.items
return void 0!==n&&n.length>0?$(n,o):[{title:t.title,format:t.format}]},r=$(kT(t),o),i=ZB(t,h(r)).fold(h(e),(function(t){return t.title}))
Ei(n,EO,{text:i})},shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},eM=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o)
n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=W(r,e.getSystem().build)
Lf(e,i)}))}
return Ii([Pi(ui(),(function(n,o){var r=o
if(!r.universal){var i=t.channel
H(r.channels,i)&&e(n,r.data)}})),Gi((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),oM=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),rM=[Ko("channel"),rr("renderComponents"),rr("updateState"),rr("initialData")],iM=Object.freeze({__proto__:null,init:function(){var t=xr(F.none())
return{readState:function(){return t.get().getOr("none")},get:t.get,set:t.set,clear:function(){return t.set(F.none())}}}}),uM=Sc({fields:rM,name:"reflecting",active:eM,apis:oM,state:iM}),aM=h([Ko("toggleClass"),Ko("fetch"),Ea("onExecute"),lr("getHotspot",F.some),lr("getAnchorOverrides",h({})),Cs(),Ea("onItemExecute"),rr("lazySink"),Ko("dom"),Ta("onOpen"),_l("splitDropdownBehaviours",[Nw,tp,lp]),lr("matchWidth",!1),lr("useMinWidth",!1),lr("eventOrder",{}),rr("role")].concat(nS())),cM=nd({factory:ph,schema:[Ko("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:xc([lp.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Bi)},buttonBehaviours:xc([kp.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),sM=nd({factory:ph,schema:[Ko("dom")],name:"button",defaults:function(){return{buttonBehaviours:xc([lp.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),fM=h([cM,sM,od({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Ko("text")],name:"aria-descriptor"}),ed({schema:[Ca()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),Ww()]),lM=Bd({name:"SplitDropdown",configFields:aM(),partFields:fM(),factory:function(t,n,e,o){var r,i=function(t){Id.getCurrent(t).each((function(t){im.highlightFirst(t),tp.focusIn(t)}))},u=function(n){Kw(t,v,n,o,i,xw.HighlightFirst).get(g)},a=function(n){var e=hd(n,t,"button")
return Bi(e),F.some(!0)},c=O(O({},Ii([Gi((function(n,e){pd(n,t,"aria-descriptor").each((function(t){var e=ou("aria")
jn(t.element,"id",e),jn(n.element,"aria-describedby",e)}))}))])),Op(F.some(u))),s={repositionMenus:function(t){kp.isOn(t)&&tS(t)}}
return{uid:t.uid,dom:t.dom,components:n,apis:s,eventOrder:O(O({},t.eventOrder),(r={},r[ai()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:Dl(t.splitDropdownBehaviours,[Nw.config({others:{sandbox:function(n){var e=hd(n,t,"arrow")
return Zw(t,n,{onOpen:function(){kp.on(e),kp.on(n)},onClose:function(){kp.off(e),kp.off(n)}})}}}),tp.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),F.some(!0)}}),lp.config({}),kp.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),dM=function(t){return{isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)}}},mM=function(t){return{setActive:function(n){kp.set(t,n)},isActive:function(){return kp.isOn(t)},isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)}}},gM=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},pM=ou("focus-button"),hM=function(t,n,e,o,r,i){var u
return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:gM(e,i)},components:ty([t.map((function(t){return CO(t,i.icons)})),n.map((function(t){return _O(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[zr()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:xc([Yb(i.isDisabled),jb(),up("common-button-display-events",[Pi(zr(),(function(t,n){n.event.prevent(),Di(t,pM)}))])].concat(o.map((function(e){return uM.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return ty([t.icon.map((function(t){return CO(t,i.icons)})),t.text.map((function(t){return _O(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},vM=function(t,n,e){var o,r=xr(g),i=hM(t.icon,t.text,t.tooltip,F.none(),F.none(),e)
return ph.sketch({dom:i.dom,components:i.components,eventOrder:DO,buttonBehaviours:xc([up("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Yi((function(t,n){Kb(o,t)((function(n){Ei(t,TO,{buttonApi:n}),o.onAction(n)}))}))),Jb(n,r),$b(n,r)]),Yb((function(){return t.disabled||e.isDisabled()})),jb()].concat(n.toolbarButtonBehaviours))})},bM=function(t,n,e){return vM(t,{toolbarButtonBehaviours:[].concat(e.length>0?[up("toolbarButtonWith",e)]:[]),getApi:dM,onSetup:t.onSetup},n)},yM=function(t,n,e){return uo(vM(t,{toolbarButtonBehaviours:[ip.config({}),kp.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[up("toolbarToggleButtonWith",e)]:[]),getApi:mM,onSetup:t.onSetup},n))},xM=function(t,n,e){return function(o){return _w((function(t){return n.fetch(t)})).map((function(r){return F.from(Dx(uo(cx(ou("menu-value"),r,(function(e){n.onItemAction(t(o),e)}),n.columns,n.presets,gv.CLOSE_ON_EXECUTE,n.select.getOr(S),e),{movement:fx(n.columns,n.presets),menuBehaviours:rb("auto"!==n.columns?[]:[Gi((function(t,e){eb(t,4,_v(n.presets)).each((function(n){var e=n.numRows,o=n.numColumns
tp.setGridSize(t,e,o)}))}))])})))}))}},wM=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],SM=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return jo(t)})).getOrDie()
return n(i,o,r)}},kM={button:SM(tv,(function(t,n){return e=t,o=n.backstage.shared.providers,bM(e,o,[])
var e,o})),togglebutton:SM(ov,(function(t,n){return e=t,o=n.backstage.shared.providers,yM(e,o,[])
var e,o})),menubutton:SM(YD,(function(t,n){return zO(t,"tox-tbtn",n.backstage,F.none())})),splitbutton:SM((function(t){return Lo("SplitButton",KD,t)}),(function(t,n){return function(t,n){var e,o=ou("channel-update-split-dropdown-display"),r=function(t){return{isDisabled:function(){return Yd.isDisabled(t)},setDisabled:function(n){return Yd.set(t,n)},setIconFill:function(n,e){sa(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){jn(t,"fill",e)}))},setIconStroke:function(n,e){sa(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){jn(t,"stroke",e)}))},setActive:function(n){jn(t.element,"aria-pressed",n),sa(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return kp.set(t,n)}))}))},isActive:function(){return sa(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(kp.isOn)}))}}},i=xr(g),u={getApi:r,onSetup:t.onSetup}
return lM.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:O({"aria-pressed":!1},gM(t.tooltip,n.providers))},onExecute:function(n){t.onAction(r(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:xc([qb(n.providers.isDisabled),jb(),up("split-dropdown-events",[Pi(pM,lp.focus),Jb(u,i),$b(u,i)]),uS.config({})]),eventOrder:(e={},e[bi()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:xM(r,t,n.providers),parts:{menu:Av(0,t.columns,t.presets)},components:[lM.parts.button(hM(t.icon,t.text,F.none(),F.some(o),F.some([kp.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),lM.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:kh("chevron-down",n.providers.icons)},buttonBehaviours:xc([qb(n.providers.isDisabled),jb(),Ch()])}),lM.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})}(t,n.backstage.shared)})),grouptoolbarbutton:SM((function(t){return Lo("GroupToolbarButton",GD,t)}),(function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[Ss]=n.backstage.shared.header.isPositionedAtTop()?Wc.TopToBottom:Wc.BottomToTop,o)
switch(_b(e)){case mv.floating:return function(t,n,e,o){var r=n.shared
return YE.sketch({lazySink:r.getSink,fetch:function(){return _w((function(n){n(W(e(t.items),aB))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:hM(t.icon,t.text,t.tooltip,F.none(),F.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(t,n.backstage,(function(t){return TM(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,F.none())}),i)
default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return function(t,n){var e=O({type:"advanced"},n.styleselect)
return PB(t,n,nM(t,e))}(t,n.backstage)},fontsizeSelectButton:function(t,n){return function(t,n){return PB(t,n,QB(t))}(t,n.backstage)},fontSelectButton:function(t,n){return function(t,n){return PB(t,n,YB(t))}(t,n.backstage)},formatButton:function(t,n){return function(t,n){return PB(t,n,tM(t))}(t,n.backstage)},alignMenuButton:function(t,n){return function(t,n){return PB(t,n,GB(t))}(t,n.backstage)}},CM={styleselect:kM.styleSelectButton,fontsizeselect:kM.fontsizeSelectButton,fontselect:kM.fontSelectButton,formatselect:kM.formatButton,align:kM.alignMenuButton},OM=function(t){var n,e=t.toolbar,r=t.buttons
return!1===e?[]:void 0===e||!0===e?function(t){var n=W(wM,(function(n){var e=G(n.items,(function(n){return yt(t,n)||yt(CM,n)}))
return{name:n.name,items:e}}))
return G(n,(function(t){return t.items.length>0}))}(r):o(e)?(n=e.split("|"),W(n,(function(t){return{items:t.trim().split(" ")}}))):function(t){return m(t,(function(t){return yt(t,"name")&&yt(t,"items")}))}(e)?e:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},_M=function(t,n,e,o,r,i){return bt(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return ct(t,(function(t){return bt(n,t+e.toLowerCase())}))}))})).fold((function(){return bt(CM,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return F.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?function(t,n,e){return bt(kM,t.type).fold((function(){return console.error("skipping button defined by",t),F.none()}),(function(o){return F.some(o(t,n,e))}))}(n,r,t):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),F.none())}))},TM=function(t,n,e,o){var r=OM(n),i=W(r,(function(r){var i=$(r.items,(function(r){return 0===r.trim().length?[]:_M(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}))
return{title:F.from(t.translate(r.name)),items:i}}))
return G(i,(function(t){return t.items.length>0}))},DM=function(t,n,e,r){var i=n.outerContainer,u=e.toolbar,a=e.buttons
if(m(u,o)){var c=u.map((function(n){var o={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups}
return TM(t,o,{backstage:r},F.none())}))
xB.setToolbars(i,c)}else xB.setToolbar(i,TM(t,e,{backstage:r},F.none()))},EM=hn(),BM=EM.os.isiOS()&&EM.os.version.major<=12,MM=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=xr(0),a=n.outerContainer
EB(t)
var c=Ft.fromDom(r.targetNode),s=Vn(Rn(c));(function(t,n){Yf(t,n,ke)})(c,n.mothership),qf(s,n.uiMothership),t.on("PostRender",(function(){DM(t,n,e,o),i.set(t.getWin().innerWidth),xB.setMenubar(a,kB(t,e)),xB.setSidebar(a,e.sidebar),function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=xr(de(o.innerWidth,o.innerHeight)),u=xr(de(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get()
n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(de(o.innerWidth,o.innerHeight)),zy(t))},c=function(){var n=t.getDoc().documentElement,e=u.get()
e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(de(n.offsetWidth,n.offsetHeight)),zy(t))},s=function(n){return function(t,n){return t.fire("ScrollContent",n)}(t,n)}
e.bind(o,"resize",a),e.bind(o,"scroll",s)
var f=ns(Ft.fromDom(t.getBody()),"load",c),l=n.uiMothership.element
t.on("hide",(function(){$n(l,"display","none")})),t.on("show",(function(){ie(l,"display")})),t.on("NodeChange",c),t.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))}(t,n)}))
var f,l,d,m=xB.getSocket(a).getOrDie("Could not find expected socket element")
if(BM){Qn(m.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"})
var g=(f=function(){t.fire("ScrollContent")},l=20,d=null,{cancel:function(){u(d)||(clearTimeout(d),d=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]
u(d)&&(d=setTimeout((function(){d=null,f.apply(null,t)}),l))}}),p=ts(m.element,"scroll",g.throttle)
t.on("remove",p.unbind)}Ub(t,n),t.addCommand("ToggleSidebar",(function(n,e){xB.toggleSidebar(a,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return xB.whichSidebar(a)}))
var h=_b(t)
h!==mv.sliding&&h!==mv.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth
e!==i.get()&&(xB.refreshToolbar(n.outerContainer),i.set(e))}))
var v={enable:function(){Wb(n,!1)},disable:function(){Wb(n,!0)},isDisabled:function(){return Yd.isDisabled(a)}}
return{iframeContainer:m.element.dom,editorContainer:a.element.dom,api:v}}}),AM=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?F.some(parseInt(""+t,10)):F.none()},FM=function(t){return d(t)?t+"px":t},IM=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return t>n}))
return o.or(r).getOr(t)},RM=function(t){return function(t){var n=pb(t),e=bb(t),o=xb(t)
return AM(n).map((function(t){return IM(t,e,o)}))}(t).getOr(pb(t))},VM=function(t){var n=hb(t),e=vb(t),o=yb(t)
return AM(n).map((function(t){return IM(t,e,o)}))},PM=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=mb.DOM,c=Ab(t),s=Rb(t),f=yb(t).or(VM(t)),l=o.shared.header,d=l.isPositionedAtTop,m=_b(t),g=m===mv.sliding||m===mv.floating,p=xr(!1),v=function(){return p.get()&&!t.removed},b=function(t){return g?t.fold(h(0),(function(t){return t.components().length>1?se(t.components()[1].element):0})):0},y=function(){i.broadcastOn([al()],{})},x=function(t){if(void 0===t&&(t=!1),v()){var e
if(c||(e=f.getOrThunk((function(){var t=AM(te(Ln(),"margin-left")).getOr(0)
return ve(Ln())-ge(n).left+t})),$n(r.get().element,"max-width",e+"px")),g&&xB.refreshToolbar(u),c||function(){var t=xB.getToolbar(u),e=b(t),o=He(n),i=d()?Math.max(o.y-se(r.get().element)+e,0):o.bottom
Qn(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})}(),s){var o=r.get()
t?ID.reset(o):ID.refresh(o)}y()}},w=function(e){if(void 0===e&&(e=!0),!c&&s&&v()){var o=l.getDockingMode(),i=function(e){switch(Eb(t)){case Ob.auto:var o=xB.getToolbar(u),r=b(o),i=se(e.element)-r,a=He(n)
if(a.y>i)return"top"
var c=Cn(n),s=Math.max(c.dom.scrollHeight,se(c))
return a.bottom<s-i||Ne().bottom<a.bottom-i?"bottom":"top"
case Ob.bottom:return"bottom"
case Ob.top:default:return"top"}}(r.get())
i!==o&&(function(t){var n=r.get()
ID.setModes(n,[t]),l.setDockingMode(t)
var e=d()?Wc.TopToBottom:Wc.BottomToTop
jn(n.element,Ss,e)}(i),e&&x(!0))}}
return{isVisible:v,isPositionedAtTop:d,show:function(){p.set(!0),$n(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),ie(i.element,"display"),w(!1),x()},hide:function(){p.set(!1),e.outerContainer&&($n(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),$n(i.element,"display","none")},update:x,updateMode:w,repositionPopups:y}},HM=function(t,n){var e=He(t)
return{pos:n?e.y:e.bottom,bounds:e}},zM=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=xr(null),s=Ft.fromDom(r.targetNode),f=PM(t,s,n,o,c),l=function(t){return t.getParam("toolbar_persist",!1,"boolean")}(t)
BB(t)
var d=function(){if(c.get())f.show()
else{c.set(xB.getHeader(a).getOrDie())
var r=Fb(t)
qf(r,i),qf(r,u),DM(t,n,e,o),xB.setMenubar(a,kB(t,e)),f.show(),function(t,n,e,o){var r=xr(HM(n,e.isPositionedAtTop())),i=function(o){var i=HM(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width
r.set({pos:u,bounds:a}),l&&zy(t,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))}
o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){gh.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}))
var u=$c()
u.set(ns(Ft.fromDom(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,f,l),t.nodeChanged()}},m=function(){return gh.setEditorTimeout(t,d,0)}
t.on("show",d),t.on("hide",f.hide),l||(t.on("focus",m),t.on("blur",f.hide)),t.on("init",(function(){(t.hasFocus()||l)&&m()})),Ub(t,n)
var g={show:function(){f.show()},hide:function(){f.hide()},enable:function(){Wb(n,!1)},disable:function(){Wb(n,!0)},isDisabled:function(){return Yd.isDisabled(a)}}
return{editorContainer:a.element.dom,api:g}}}),NM="contexttoolbar-hide",LM=function(t,n){return Pi(TO,(function(e,o){var r=function(t){return{hide:function(){return Di(t,li())},getValue:function(){return Ol.getValue(t)}}}(t.get(e))
n.onAction(r,o.event.buttonApi)}))},WM=function(t,n,e){var o={backstage:{shared:{providers:e}}}
return"contextformtogglebutton"===n.type?function(t,n,e){var o=n.original
o.primary
var r=_(o,["primary"]),i=Wo(ov(O(O({},r),{type:"togglebutton",onAction:g})))
return yM(i,e.backstage.shared.providers,[LM(t,n)])}(t,n,o):function(t,n,e){var o=n.original
o.primary
var r=_(o,["primary"]),i=Wo(tv(O(O({},r),{type:"button",onAction:g})))
return bM(i,e.backstage.shared.providers,[LM(t,n)])}(t,n,o)},UM=function(t,n){var e=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=hh(vw.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:xc([tp.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map((function(t){return Bi(t),!0}))},onLeft:function(t,n){return n.cut(),F.none()},onRight:function(t,n){return n.cut(),F.none()}})])})),r=function(t,n,e){var o=W(n,(function(n){return hh(WM(t,n,e))}))
return{asSpecs:function(){return W(o,(function(t){return t.asSpec()}))},findPrimary:function(t){return ct(n,(function(n,e){return n.primary?F.from(o[e]).bind((function(n){return n.getOpt(t)})).filter(x(Yd.isDisabled)):F.none()}))}}}(o,t.commands,n)
return[{title:F.none(),items:[o.asSpec()]},{title:F.none(),items:r.asSpecs()}]},jM=UM,GM=function(t,n,e){return void 0===e&&(e=.01),n.bottom-t.y>=e&&t.bottom-n.y>=e},XM=function(t){var n=function(t){var n=t.getBoundingClientRect()
if(n.height<=0&&n.width<=0){var e=Mn(Ft.fromDom(t.startContainer),t.startOffset).element
return(Ht(e)?_n(e):F.some(e)).filter(Pt).map((function(t){return t.dom.getBoundingClientRect()})).getOr(n)}return n}(t.selection.getRng())
if(t.inline){var e=Be()
return Pe(e.left+n.left,e.top+n.top,n.width,n.height)}var o=ze(Ft.fromDom(t.getBody()))
return Pe(o.x+n.left,o.y+n.top,n.width,n.height)},qM=function(t,n,e,o){void 0===o&&(o=0)
var r=Fe(window),i=He(Ft.fromDom(t.getContentAreaContainer())),u=wb(t)||Sb(t)||Cb(t),a=function(t,n,e){var o=Math.max(t.x+e,n.x)
return{x:o,width:Math.min(t.right-e,n.right)-o}}(i,r,o),c=a.x,s=a.width
if(t.inline&&!u)return Pe(c,r.y,s,r.height)
var f=function(t,n,e,o,r,i){var u=Ft.fromDom(t.getContainer()),a=sa(u,".tox-editor-header").getOr(u),c=He(a),s=c.y>=n.bottom,f=o&&!s
if(t.inline&&f)return{y:Math.max(c.bottom+i,e.y),bottom:e.bottom}
if(t.inline&&!f)return{y:e.y,bottom:Math.min(c.y-i,e.bottom)}
var l="line"===r?He(u):n
return f?{y:Math.max(c.bottom+i,e.y),bottom:Math.min(l.bottom-i,e.bottom)}:{y:Math.max(l.y+i,e.y),bottom:Math.min(c.y-i,e.bottom)}}(t,i,r,n.header.isPositionedAtTop(),e,o),l=f.y,d=f.bottom
return Pe(c,l,s,d-l)},YM={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},KM={maxHeightFunction:ms(),maxWidthFunction:WE()},JM=function(t){return"node"===t},$M=function(t,n,e,o,r){var i=XM(t),u=o.lastElement().exists((function(t){return yn(e,t)}))
return function(t,n){var e=t.selection.getRng(),o=Mn(Ft.fromDom(e.startContainer),e.startOffset)
return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&yn(o.element,n)}(t,e)?u?lh:uh:u?function(t,n,e){var o=ee(t,"position")
$n(t,"position",n)
var r=e(t)
return o.each((function(n){return $n(t,"position",n)})),r}(n,o.getMode(),(function(){return GM(i,He(n))&&!o.isReposition()?mh:lh})):("fixed"===o.getMode()?r.y+Be().top:r.y)+(se(n)+12)<=i.y?uh:ah},QM=function(t,n,e,o){var r=function(n){return function(o,r,i,u,a){var c=$M(t,u,n,e,a),s=O(O({},o),{y:a.y,height:a.height})
return O(O({},c(s,r,i,u,a)),{alwaysFit:!0})}},i=function(t){return JM(o)?[r(t)]:[]}
return n?{onLtr:function(t){return[ic,tc,nc,ec,oc,rc].concat(i(t))},onRtl:function(t){return[ic,nc,tc,oc,ec,rc].concat(i(t))}}:{onLtr:function(t){return[rc,ic,ec,tc,oc,nc].concat(i(t))},onRtl:function(t){return[rc,ic,oc,nc,ec,tc].concat(i(t))}}},ZM=function(t,n){var e=G(n,(function(n){return n.predicate(t.dom)})),o=j(e,(function(t){return"contexttoolbar"===t.type}))
return{contextToolbars:o.pass,contextForms:o.fail}},tA=function(t,n,e){var o=ZM(t,n)
if(o.contextForms.length>0)return F.some({elem:t,toolbars:[o.contextForms[0]]})
var r=ZM(t,e)
if(r.contextForms.length>0)return F.some({elem:t,toolbars:[r.contextForms[0]]})
if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=function(t){if(t.length<=1)return t
var n=function(n){return z(t,(function(t){return t.position===n}))},e=function(n){return G(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node")
if(o||r){if(r&&o){var i=e("node"),u=W(e("selection"),(function(t){return O(O({},t),{position:"node"})}))
return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars))
return F.some({elem:t,toolbars:i})}return F.none()},nA=function(t,n,e){return t(n)?F.none():Dr(n,(function(t){if(Pt(t)){var n=ZM(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=r.length>0?r:function(t){if(t.length<=1)return t
var n=function(n){return Y(t,(function(t){return t.position===n}))}
return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return G(t,(function(t){return t.position===n}))}))}(o)
return i.length>0?F.some({elem:t,toolbars:i}):F.none()}return F.none()}),t)},eA=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=Wo(Lo("ContextForm",fv,a))
e[t]=c,c.launch.map((function(e){i["form:"+t]=O(O({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){var e;(e=n,Lo("ContextToolbar",lv,e)).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))},s=st(t)
return U(s,(function(n){var e=t[n]
"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},oA=ou("forward-slide"),rA=ou("backward-slide"),iA=ou("change-slide-event"),uA="tox-pop--resizing",aA="tox-pop--transition",cA=function(t,n,e,o){var r,i,u=o.backstage,a=u.shared,c=hn().deviceType.isTouch,s=Qc(),f=Qc(),l=Qc(),d=ta((r={sink:e,onEscape:function(){return t.focus(),F.some(!0)}},i=xr([]),Yp.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),Yp.getContent(t).each((function(t){ie(t.element,"visibility")})),Hu(t.element,uA),ie(t.element,"width")},inlineBehaviours:xc([up("context-toolbar-events",[ji(Qr(),(function(t,n){"width"===n.event.raw.propertyName&&(Hu(t.element,uA),ie(t.element,"width"))})),Pi(iA,(function(t,n){var e=t.element
ie(e,"width")
var o=ve(e)
Yp.setContent(t,n.event.contents),Vu(e,uA)
var r=ve(e)
$n(e,"width",o+"px"),Yp.getContent(t).each((function(t){n.event.focus.bind((function(t){return Ec(t),Ac(e)})).orThunk((function(){return tp.focusIn(t),Mc(Rn(e))}))})),gh.setTimeout((function(){$n(t.element,"width",r+"px")}),0)})),Pi(oA,(function(t,n){Yp.getContent(t).each((function(n){i.set(i.get().concat([{bar:n,focus:Mc(Rn(t.element))}]))})),Ei(t,iA,{contents:n.event.forwardContents,focus:F.none()})})),Pi(rA,(function(t,n){ut(i.get()).each((function(n){i.set(i.get().slice(0,i.get().length-1)),Ei(t,iA,{contents:na(n.bar),focus:n.focus})}))}))]),tp.config({mode:"special",onEscape:function(t){return ut(i.get()).fold((function(){return r.onEscape()}),(function(n){return Di(t,rA),F.some(!0)}))}})]),lazySink:function(){return Ue.value(r.sink)}}))),m=function(){var n=l.get().getOr("node"),e=JM(n)?1:0
return qM(t,a,n,e)},p=function(){return!(t.removed||c()&&u.isContextMenuOpen())},h=function(){if(p()){var n=m(),e=wt(l.get(),"node")?function(t,n){return n.filter(Nn).map(ze).getOrThunk((function(){return XM(t)}))}(t,s.get()):XM(t)
return n.height<=0||!GM(e,n)}return!0},v=function(){s.clear(),f.clear(),l.clear(),Yp.hide(d)},b=function(){if(Yp.isOpen(d)){var t=d.element
ie(t,"display"),h()?$n(t,"display","none"):(f.set(0),Yp.reposition(d))}},y=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:xc([tp.config({mode:"acyclic"}),up("pop-dialog-wrap-events",[Gi((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return tp.focusIn(n)}))})),Xi((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},x=Lt((function(){return eA(n,(function(t){var n=w([t])
Ei(d,oA,{forwardContents:y(n)})}))})),w=function(n){var e=t.ui.registry.getAll().buttons,r=x(),i=O(O({},e),r.formNavigators),u=_b(t)===mv.scrolling?mv.scrolling:mv.default,c=J(W(n,(function(n){return"contexttoolbar"===n.type?function(n,e){return TM(t,{buttons:n,toolbar:e.items,allowToolbarGroups:!1},o,F.some(["form:"]))}(i,n):function(t,n){return jM(t,n)}(n,a.providers)})))
return dB({type:u,uid:ou("context-toolbar"),initGroups:c,onEscape:F.none,cyclicKeying:!0,providers:a.providers})},S=function(n,o){var r="node"===n?a.anchors.node(o):a.anchors.cursor(),i=function(t,n,e,o){return"line"===n?{bubble:vs(12,0,YM),layouts:{onLtr:function(){return[uc]},onRtl:function(){return[ac]}},overrides:KM}:{bubble:vs(0,12,YM,1/12),layouts:QM(t,e,o,n),overrides:KM}}(t,n,c(),{lastElement:s.get,isReposition:function(){return wt(f.get(),0)},getMode:function(){return Pf.getMode(e)}})
return uo(r,i)},k=function(t,n){if(C.cancel(),p()){var o=w(t),r=t[0].position,i=S(r,n)
l.set(r),f.set(1)
var u=d.element
ie(u,"display"),function(t){return wt(kt(t,s.get(),yn),!0)}(n)||(Hu(u,aA),Pf.reset(e,d)),Yp.showWithinBounds(d,y(o),{anchor:i,transition:{classes:[aA],mode:"placement"}},(function(){return F.some(m())})),n.fold(s.clear,s.set),h()&&$n(u,"display","none")}},C=Mh((function(){t.hasFocus()&&!t.removed&&(zu(d.element,aA)?C.throttle():function(t,n){var e=Ft.fromDom(n.getBody()),o=function(t){return yn(t,e)},r=Ft.fromDom(n.selection.getNode())
return function(t){return!o(t)&&!wn(e,t)}(r)?F.none():tA(r,t.inNodeScope,t.inEditorScope).orThunk((function(){return nA(o,r,t)}))}(x(),t).fold(v,(function(t){k(t.toolbars,F.some(t.elem))})))}),17)
t.on("init",(function(){t.on("remove",v),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",b),t.on("click keyup focus SetContent",C.throttle),t.on(NM,v),t.on("contexttoolbar-show",(function(n){var e=x()
bt(e.lookupTable,n.toolbarKey).each((function(e){k([e],Ct(n.target!==t,n.target)),Yp.getContent(d).each(tp.focusIn)}))})),t.on("focusout",(function(n){gh.setEditorTimeout(t,(function(){Ac(e.element).isNone()&&Ac(d.element).isNone()&&v()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&v()})),t.on("AfterProgressState",(function(n){n.state?v():t.hasFocus()&&C.throttle()})),t.on("NodeChange",(function(t){Ac(d.element).fold(C.throttle,g)}))}))},sA={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},fA=(zB="[eE][+-]?[0-9]+",LB=["Infinity","[0-9]+\\."+(NB=function(t){return"(?:"+t+")?"})(HB="[0-9]+")+NB(zB),"\\.[0-9]+"+NB(zB),HB+NB(zB)].join("|"),new RegExp("^([+-]?(?:"+LB+"))(.*)$")),lA=function(t,n){return F.from(fA.exec(t)).bind((function(t){var e=Number(t[1]),o=t[2]
return function(t,n){return z(n,(function(n){return z(sA[n],(function(n){return t===n}))}))}(o,n)?F.some({value:e,unit:o}):F.none()}))},dA=function(t,n){var e=function(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=Qc()
return W(e,(function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){var u=function(t){t&&(r.on((function(t){return t.setActive(!1)})),r.set(i)),i.setActive(t)}
u(wt(o,n.hash(e)))
var a=n.watcher(t,e,u)
return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}}))}
t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})},mA={name:"lineheight",text:"Line height",icon:"line-height",getOptions:function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},hash:function(t){return function(t,n){return lA(t,n).map((function(t){return t.value+t.unit}))}(t,["fixed","relative","empty"]).getOr(t)},display:v,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return F.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},gA=function(t){dA(t,mA),function(t){return F.from(function(t){return t.getParam("content_langs",void 0,"array")}(t)).map((function(n){return{name:"language",text:"Language",icon:"language",getOptions:h(n),hash:function(t){return c(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){var n=Ft.fromDom(t.selection.getNode())
return Er(n,(function(t){return F.some(t).filter(Pt).bind((function(t){return Xn(t,"lang").map((function(n){return{code:n,customCode:Xn(t,"data-mce-lang").getOrUndefined(),title:""}}))}))}))},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(n){var e=$c()
return n.setActive(t.formatter.match("lang",{},void 0,!0)),e.set(t.formatter.formatChanged("lang",n.setActive,!0)),e.clear}}}))}(t).each((function(n){return dA(t,n)}))},pA=function(t,n){(function(t,n){var e=VB(0,n,GB(t))
t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})})(t,n),function(t,n){var e=VB(0,n,YB(t))
t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=O({type:"advanced"},n.styleselect),o=VB(0,n,nM(t,e))
t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(t,n),function(t,n){var e=VB(0,n,tM(t))
t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=VB(0,n,QB(t))
t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n)},hA=function(t){return AB(t,"NodeChange",(function(n){n.setDisabled(!t.queryCommandState("outdent"))}))},vA=function(t){(function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:hA(t),onAction:IB(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:IB(t,"indent")})})(t)},bA=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},yA=function(t){(function(t){bC.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:MB(t,n.name),onAction:bA(t,n.name)})}))
for(var n=1;n<=6;n++){var e="h"+n
t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:MB(t,e),onAction:bA(t,e)})}})(t),function(t){bC.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:IB(t,n.action)})}))}(t),function(t){bC.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:IB(t,n.action),onSetup:MB(t,n.name)})}))}(t)},xA=function(t){yA(t),function(t){bC.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:IB(t,n.action)})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:bA(t,"code")})}(t)},wA=function(t,n){return AB(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoManager[n]())}))},SA=function(t){(function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:wA(t,"hasUndo"),onAction:IB(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:wA(t,"hasRedo"),onAction:IB(t,"redo")})})(t),function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:wA(t,"hasUndo"),onAction:IB(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:wA(t,"hasRedo"),onAction:IB(t,"redo")})}(t)},kA=function(t){return AB(t,"VisualAid",(function(n){n.setActive(t.hasVisual)}))},CA=function(t){(function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:IB(t,"mceToggleVisualAid")})})(t),function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:kA(t),onAction:IB(t,"mceToggleVisualAid")})}(t)},OA=function(t,n){(function(t){U([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:IB(t,n.cmd),onSetup:MB(t,n.name)})})),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:IB(t,"JustifyNone")})})(t),xA(t),pA(t,n),SA(t),function(t){(function(t){t.addCommand("mceApplyTextcolor",(function(n,e){(function(t,n,e){t.undoManager.transact((function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()}))})(t,n,e)})),t.addCommand("mceRemoveTextcolor",(function(n){(function(t,n){t.undoManager.transact((function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()}))})(t,n)}))})(t)
var n=xr(null),e=xr(null)
ix(t,"forecolor","forecolor","Text color",n),ix(t,"backcolor","hilitecolor","Background color",e),ux(t,"forecolor","forecolor","Text color"),ux(t,"backcolor","hilitecolor","Background color")}(t),CA(t),vA(t),gA(t)},_A=function(t,n){return{type:"makeshift",x:t,y:n}},TA=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},DA=function(t,n){var e=mb.DOM.getPos(t)
return function(t,n,e){return _A(t.x+n,t.y+e)}(n,e.x,e.y)},EA=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(TA(t)){var n=t.touches[0]
return _A(n.pageX,n.pageY)}return _A(t.pageX,t.pageY)}(n):DA(t.getContentAreaContainer(),function(t){if(TA(t)){var n=t.touches[0]
return _A(n.clientX,n.clientY)}return _A(t.clientX,t.clientY)}(n)):BA(t)},BA=function(t){return{type:"selection",root:Ft.fromDom(t.selection.getNode())}},MA=function(t,n,e){switch(e){case"node":return function(t){return{type:"node",node:F.some(Ft.fromDom(t.selection.getNode())),root:Ft.fromDom(t.getBody())}}(t)
case"point":return EA(t,n)
case"selection":return BA(t)}},AA=function(t,n,e,o,r,i){var u=e(),a=MA(t,n,i)
PO(u,gv.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),Yp.showMenuAt(r,{anchor:a},{menu:{markers:Ev("normal")},data:t})}))},FA={onLtr:function(){return[ic,tc,nc,ec,oc,rc,uh,ah,ih,oh,rh,eh]},onRtl:function(){return[ic,nc,tc,oc,ec,rc,uh,ah,rh,eh,ih,oh]}},IA={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},RA=function(t,n,e,o,r,i,u){var a=function(t,n,e){var o=MA(t,n,e)
return O({bubble:vs(0,"point"===e?12:0,IA),layouts:FA,overrides:{maxWidthFunction:WE(),maxHeightFunction:ms()}},o)}(t,n,i)
PO(e,gv.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),Yp.showMenuWithinBounds(r,{anchor:a},{menu:{markers:Ev("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return F.some(qM(t,o.shared,"node"===i?"node":"selection"))})),t.fire(NM)}))},VA=function(t,n,e,o,r,i){var u=hn(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){var u=e()
RA(t,n,u,o,r,i,!(s||a||c&&f))}
if((c||a)&&"node"!==i){var d=function(){(function(t){var n=t.selection.getRng(),e=function(){gh.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()}
t.once("touchend",e)
var o=function(t){t.preventDefault(),t.stopImmediatePropagation()}
t.on("mousedown",o,!0)
var r=function(){return i()}
t.once("longpresscancel",r)
var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}})(t),l()}
!function(t,n){var e=t.selection
if(e.isCollapsed()||n.touches.length<1)return!1
var o=n.touches[0],r=e.getRng()
return sf(t.getWin(),Us.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?(t.once("selectionchange",d),t.once("touchend",(function(){return t.off("selectionchange",d)}))):d()}else l()},PA=function(t){return"string"==typeof t?t.split(/[ ,]/):t},HA=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},zA=function(t){return function(t,n,e){var o=t.ui.registry.getAll().contextMenus
return F.from(t.getParam(n)).map(PA).getOrThunk((function(){return G(PA(e),(function(t){return yt(o,t)}))}))}(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},NA=function(t){return o(t)?"|"===t:"separator"===t.type},LA={type:"separator"},WA=function(t){var n,e=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}}
if(o(t))return t
switch(t.type){case"separator":return LA
case"submenu":return O(O({type:"nestedmenuitem"},e(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems()
return o(n)?n:W(n,WA)}})
default:return O(O({type:"menuitem"},e(t)),{onAction:(n=t.onAction,function(){return n()})})}},UA=function(t,n){if(0===n.length)return t
var e=ut(t).filter((function(t){return!NA(t)})).fold((function(){return[]}),(function(t){return[LA]}))
return t.concat(e).concat(n).concat([LA])},jA=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},GA=function(t,n){return jA(t,n)?t.selection.getStart(!0):n.target},XA=function(t,n,e){var r=hn().deviceType.isTouch,i=ta(Yp.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:xc([up("dismissContextMenu",[Pi(xi(),(function(n,e){il.close(n),t.focus()}))])])})),u=function(t){return Yp.hide(i)},a=function(n){if(HA(t)&&n.preventDefault(),!function(t,n){return n.ctrlKey&&!HA(t)}(t,n)&&!function(t){return!1===t.getParam("contextmenu")}(t)){var u=function(t,n){var e=function(t){return t.getParam("contextmenu_avoid_overlap","","string")}(t),o=jA(t,n)?"selection":"point"
if(Bt(e)){var r=GA(t,n)
return Bx(Ft.fromDom(r),e)?"node":o}return o}(t,n);(r()?VA:AA)(t,n,(function(){var e=GA(t,n),r=t.ui.registry.getAll(),i=zA(t)
return function(t,n,e){var r=q(n,(function(n,r){return bt(t,r.toLowerCase()).map((function(t){var r=t.update(e)
if(o(r))return UA(n,r.split(" "))
if(r.length>0){var i=W(r,WA)
return UA(n,i)}return n})).getOrThunk((function(){return n.concat([r])}))}),[])
return r.length>0&&NA(r[r.length-1])&&r.pop(),r}(r.contextMenus,i,e)}),e,i,u)}}
t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow")
t.on(n,u),t.on("longpress contextmenu",a)}))},qA=wr([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),YA=function(t){return function(n){return n.translate(-t.left,-t.top)}},KA=function(t){return function(n){return n.translate(t.left,t.top)}},JA=function(t){return function(n,e){return q(t,(function(t,n){return n(t)}),de(n,e))}},$A=function(t,n,e){return t.fold(JA([KA(e),YA(n)]),JA([YA(n)]),JA([]))},QA=function(t,n,e){return t.fold(JA([KA(e)]),JA([]),JA([KA(n)]))},ZA=function(t,n,e){return t.fold(JA([]),JA([YA(e)]),JA([KA(n),YA(e)]))},tF=function(t,n,e){var o=t.fold((function(t,n){return{position:F.some("absolute"),left:F.some(t+"px"),top:F.some(n+"px")}}),(function(t,n){return{position:F.some("absolute"),left:F.some(t-e.left+"px"),top:F.some(n-e.top+"px")}}),(function(t,n){return{position:F.some("fixed"),left:F.some(t+"px"),top:F.some(n+"px")}}))
return O({right:F.none(),bottom:F.none()},o)},nF=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o)
return r(i.getOr(a.left),u.getOr(a.top))}}
return t.fold(r(ZA,eF),r(QA,oF),r($A,rF))},eF=qA.offset,oF=qA.absolute,rF=qA.fixed,iF=function(t,n){var e=Gn(t,n)
return c(e)?NaN:parseInt(e,10)},uF=function(t,n,e,o){return function(t,n){var e=t.element,o=iF(e,n.leftAttr),r=iF(e,n.topAttr)
return isNaN(o)||isNaN(r)?F.none():F.some(de(o,r))}(t,n).fold((function(){return e}),(function(t){return rF(t.left+o.left,t.top+o.top)}))},aF=function(t,n,e,o,r,i){var u=uF(t,n,e,o),a=n.mustSnap?fF(t,n,u,r,i):lF(t,n,u,r,i),c=$A(u,r,i)
return function(t,n,e){var o=t.element
jn(o,n.leftAttr,e.left+"px"),jn(o,n.topAttr,e.top+"px")}(t,n,c),a.fold((function(){return{coord:rF(c.left,c.top),extra:F.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},cF=function(t,n){(function(t,n){var e=t.element
Yn(e,n.leftAttr),Yn(e,n.topAttr)})(t,n)},sF=function(t,n,e,o){return ct(t,(function(t){var r=t.sensor
return function(t,n,e,o,r,i){var u=QA(t,r,i),a=QA(n,r,i)
return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o}(n,r,t.range.left,t.range.top,e,o)?F.some({output:nF(t.output,n,e,o),extra:t.extra}):F.none()}))},fF=function(t,n,e,o,r){var i=n.getSnapPoints(t)
return sF(i,e,o,r).orThunk((function(){return q(i,(function(t,n){var i=n.sensor,u=function(t,n,e,o,r,i){var u=QA(t,r,i),a=QA(n,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top)
return de(c,s)}(e,i,n.range.left,n.range.top,o,r)
return t.deltas.fold((function(){return{deltas:F.some(u),snap:F.some(n)}}),(function(e){return(u.left+u.top)/2<=(e.left+e.top)/2?{deltas:F.some(u),snap:F.some(n)}:t}))}),{deltas:F.none(),snap:F.none()}).snap.map((function(t){return{output:nF(t.output,e,o,r),extra:t.extra}}))}))},lF=function(t,n,e,o,r){var i=n.getSnapPoints(t)
return sF(i,e,o,r)},dF=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element)
if(n.repositionTarget){var i=Sn(t.element),u=Be(i),a=hD(r),c=function(t,n,e){return{coord:nF(t.output,t.output,n,e),extra:t.extra}}(o,u,a),s=tF(c.coord,0,a)
Zn(r,s)}}}),mF="data-initial-z-index",gF=function(t,n){t.getSystem().addToGui(n),function(t){_n(t.element).filter(Pt).each((function(n){ee(n,"z-index").each((function(t){jn(n,mF,t)})),$n(n,"z-index",te(t.element,"z-index"))}))}(n)},pF=function(t){(function(t){_n(t.element).filter(Pt).each((function(t){Xn(t,mF).fold((function(){return ie(t,"z-index")}),(function(n){return $n(t,"z-index",n)})),Yn(t,mF)}))})(t),t.getSystem().removeFromGui(t)},hF=function(t,n,e){return t.getSystem().build(jx.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},vF=fr("snaps",[Ko("getSnapPoints"),Ta("onSensor"),Ko("leftAttr"),Ko("topAttr"),lr("lazyViewport",Ne),lr("mustSnap",!1)]),bF=[lr("useFixed",S),Ko("blockerClass"),lr("getTarget",v),lr("onDrag",g),lr("repositionTarget",!0),lr("onDrop",g),vr("getBounds",Ne),vF],yF=function(t){return(n=ee(t,"left"),e=ee(t,"top"),o=ee(t,"position"),r=function(t,n,e){return("fixed"===e?rF:eF)(parseInt(t,10),parseInt(n,10))},n.isSome()&&e.isSome()&&o.isSome()?F.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):F.none()).getOrThunk((function(){var n=ge(t)
return oF(n.left,n.top)}))
var n,e,o,r},xF=function(t,n,e,o,r,i,u){return function(t,n,e,o,r){var i=r.bounds,u=QA(n,e,o),a=Ga(u.left,i.x,i.x+i.width-r.width),c=Ga(u.top,i.y,i.y+i.height-r.height),s=oF(a,c)
return n.fold((function(){var t=ZA(s,e,o)
return eF(t.left,t.top)}),h(s),(function(){var t=$A(s,e,o)
return rF(t.left,t.top)}))}(0,n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return eF(t+n,e+u)}),(function(t,e){return oF(t+n,e+u)}),(function(t,e){return rF(t+n,e+u)}))),c=$A(a,o,r)
return rF(c.left,c.top)}),(function(n){var u=aF(t,n,e,i,o,r)
return u.extra.each((function(e){n.onSensor(t,e)})),u.coord})),o,r,u)},wF=function(t,n){return{bounds:t.getBounds(),height:fe(n.element),width:be(n.element)}},SF=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return wF(n,t)}))
i.each((function(e){(function(t,n,e,o){var r=n.getTarget(t.element)
if(n.repositionTarget){var i=Sn(t.element),u=Be(i),a=hD(r),c=yF(r),s=xF(t,n.snaps,c,u,a,o,e),f=tF(s,0,a)
Zn(r,f)}n.onDrag(t,r,o)})(t,n,u,e)}))},kF=function(t,n,e,o){n.each(pF),e.snaps.each((function(n){cF(t,n)}))
var r=e.getTarget(t.element)
o.reset(),e.onDrop(t,r)},CF=function(t){return function(n,e){var o=function(t){e.setStartData(wF(n,t))}
return Ii(T([Pi(hi(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o),!0))}},OF=Object.freeze({__proto__:null,getData:function(t){return F.from(de(t.x,t.y))},getDelta:function(t,n){return de(n.left-t.left,n.top-t.top)}}),_F=function(t,n,e){return[Pi(zr(),(function(o,r){if(0===r.event.raw.button){r.stop()
var i=function(){return kF(o,F.some(c),t,n)},u=Mx(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),SF(o,t,n,OF,e)}},c=hF(o,t.blockerClass,function(t){return Ii([Pi(zr(),t.forceDrop),Pi(Wr(),t.drop),Pi(Nr(),(function(n,e){t.move(e.event)})),Pi(Lr(),t.delayDrop)])}(a))
e(o),gF(o,c)}}))]},TF=T(T([],bF,!0),[Ma("dragger",{handlers:CF(_F)})],!1),DF=Object.freeze({__proto__:null,getData:function(t){var n=t.raw.touches
return 1===n.length?function(t){var n=t[0]
return F.some(de(n.clientX,n.clientY))}(n):F.none()},getDelta:function(t,n){return de(n.left-t.left,n.top-t.top)}}),EF=function(t,n,e){var o=Qc(),r=function(e){kF(e,o.get(),t,n),o.clear()}
return[Pi(Rr(),(function(i,u){u.stop()
var a=function(){return r(i)},c={drop:a,delayDrop:g,forceDrop:a,move:function(e){SF(i,t,n,DF,e)}},s=hF(i,t.blockerClass,function(t){return Ii([Pi(Rr(),t.forceDrop),Pi(Pr(),t.drop),Pi(Hr(),t.drop),Pi(Vr(),(function(n,e){t.move(e.event)}))])}(c))
o.set(s)
e(i),gF(i,s)})),Pi(Vr(),(function(e,o){o.stop(),SF(e,t,n,DF,o.event)})),Pi(Pr(),(function(t,n){n.stop(),r(t)})),Pi(Hr(),r)]},BF=TF,MF=T(T([],bF,!0),[Ma("dragger",{handlers:CF(EF)})],!1),AF=T(T([],bF,!0),[Ma("dragger",{handlers:CF((function(t,n,e){return T(T([],_F(t,n,e),!0),EF(t,n,e),!0)}))})],!1),FF=Cc({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:BF,touch:MF,mouseOrTouch:AF}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:F.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=F.none(),n=F.none(),e=h({})
return xu({readState:e,reset:function(){t=F.none(),n=F.none()},update:function(n,e){return n.getData(e).bind((function(e){return function(n,e){var o=t.map((function(t){return n.getDelta(t,e)}))
return t=F.some(e),o}(n,e)}))},getStartData:function(){return n},setStartData:function(t){n=F.some(t)}})}}),apis:dF}),IF=function(t,n,e,o,r,i){return t.fold((function(){return FF.snap({sensor:oF(e-20,o-20),range:de(r,i),output:oF(F.some(e),F.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect()
return FF.snap({sensor:oF(r,i),range:de(40,40),output:oF(F.some(e-u.width/2),F.some(o-u.height/2)),extra:{td:n}})}))},RF=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r=o.td;(function(t,n){return t.exists((function(t){return yn(t,n)}))})(n.get(),r)||(n.set(r),e(r))},mustSnap:!0}},VF=function(t){return hh(ph.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:xc([FF.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),uS.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},PF=function(t,n){var e=xr([]),o=xr([]),r=xr(!1),i=Qc(),u=Qc(),a=function(t){var e=ze(t)
return IF(l.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=ze(t)
return IF(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=RF((function(){return W(e.get(),(function(t){return a(t)}))}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),f=RF((function(){return W(o.get(),(function(t){return c(t)}))}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),l=VF(s),d=VF(f),m=ta(l.asSpec()),g=ta(d.asSpec()),p=function(n,e,o,r){var i=o(e)
FF.snapTo(n,i);(function(n,e,o,r){var i=e.dom.getBoundingClientRect()
ie(n.element,"display")
var u=On(Ft.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&$n(n.element,"display","none")})(n,e,(function(t){return t[r]<0}),(function(t,n){return t[r]>n}))},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")}
hn().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(Wf(n,m),Wf(n,g),r.set(!0)),i.set(t.start),u.set(t.finish),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(Gf(m),Gf(g),r.set(!1)),i.clear(),u.clear()})))},HF=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0
if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},zF=function(t,n,e){n.delimiter||(n.delimiter="»")
return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:xc([tp.config({mode:"flow",selector:"div[role=button]"}),Yd.config({disabled:e.isDisabled}),jb(),$x.config({}),ip.config({}),up("elementPathEvents",[Gi((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return tp.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;o-- >0;){var r=n[o]
if(1===r.nodeType&&!HF(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r})
if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents)
a.length>0?ip.set(o,(i=W(a||[],(function(n,o){return ph.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:xc([Xb(e.isDisabled),jb()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},q(i.slice(1),(function(t,n){var e=t
return e.push(u),e.push(n),e}),[i[0]]))):ip.set(o,[])}))}))])]),components:[]}};(function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Vertical=2]="Vertical"})(WB||(WB={}))
var NF=function(t,n,e){var o=Ft.fromDom(t.getContainer()),r=function(t,n,e,o,r){var i={}
return i.height=IM(o+n.top,bb(t),xb(t)),e===WB.Both&&(i.width=IM(r+n.left,vb(t),yb(t))),i}(t,n,e,se(o),ve(o))
lt(r,(function(t,n){return $n(o,n,FM(t))})),function(t){t.fire("ResizeEditor")}(t)},LF=function(t,n,e,o){var r=de(20*e,20*o)
return NF(t,r,n),F.some(!0)},WF=function(t,n){var e=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n)
return!1===e?WB.None:"both"===e?WB.Both:WB.Vertical}(t)
return e===WB.None?F.none():F.some(_h("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[FF.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return NF(t,r,e)},blockerClass:"tox-blocker"}),tp.config({mode:"special",onLeft:function(){return LF(t,e,-1,0)},onRight:function(){return LF(t,e,1,0)},onUp:function(){return LF(t,e,0,-1)},onDown:function(){return LF(t,e,0,1)}}),$x.config({}),lp.config({})]},n.icons))},UF=function(t,n){var e=function(){var e,o=[]
return t.getParam("elementpath",!0,"boolean")&&o.push(zF(t,{},n)),t.hasPlugin("wordcount")&&o.push(function(t,n){var e,o=function(t,e,o){return ip.set(t,[$u(n.translate(["{0} "+o,e[o]]))])}
return ph.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:xc([Xb(n.isDisabled),jb(),$x.config({}),ip.config({}),Ol.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),up("wordcount-events",[Yi((function(t){var n=Ol.getValue(t),e="words"===n.mode?"characters":"words"
Ol.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)})),Gi((function(n){t.on("wordCountUpdate",(function(t){var e=Ol.getValue(n).mode
Ol.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)}))}))])]),eventOrder:(e={},e[ai()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(t,n)),t.getParam("branding",!0,"boolean")&&o.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=vh.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]}
return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=WF(t,n)
return o.concat(r.toArray())}()}},jF=function(t){var n,e,o,r,i=t.inline,u=i?zM:MM,a=Rb(t)?jD:gD,c=F.none(),s=hn(),f=s.browser.isIE()?["tox-platform-ie"]:[],l=s.deviceType.isTouch()?["tox-platform-touch"]:[],d=Bb(t),m=Fb(t),p=vh.isRtl()?{attributes:{dir:"rtl"}}:{},h={attributes:(n={},n[Ss]=d?Wc.BottomToTop:Wc.TopToBottom,n)},v=function(){return c.bind(xB.getHeader)},b=function(){$n(X.element,"width",document.body.clientWidth+"px")},y=ta((e=yn(Ln(),m)&&"grid"===te(m,"display"),o={dom:O({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(f).concat(l)},p),behaviours:xc([Pf.config({useFixed:function(){return a.isDocked(v)}})])},r={dom:{styles:{width:document.body.clientWidth+"px"}},events:Ii([Pi(vi(),b)])},uo(o,e?r:{}))),x=function(){return Ue.value(y)},w=hh({dom:{tag:"div",classes:["tox-anchorbar"]}}),S=function(){return c.bind((function(t){return xB.getThrobber(t)})).getOrDie("Could not find throbber element")},k=tD(y,t,(function(){return c.bind((function(t){return w.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),C=xB.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:k,onEscape:function(){t.focus()}}),_=_b(t),T=xB.parts.toolbar(O({dom:{tag:"div",classes:["tox-toolbar"]},getSink:x,providers:k.shared.providers,onEscape:function(){t.focus()},type:_,lazyToolbar:function(){return c.bind((function(t){return xB.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return v().getOrDie("Could not find header element")}},h)),D=xB.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:k.shared.providers,onEscape:function(){t.focus()},type:_}),E=xB.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),B=xB.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),M=xB.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:k}),A=t.getParam("statusbar",!0,"boolean")&&!i?F.some(UF(t,k.shared.providers)):F.none(),I={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[E,B]},R=Cb(t),V=Sb(t),P=wb(t),H=xB.parts.header({dom:O({tag:"div",classes:["tox-editor-header"]},h),components:J([P?[C]:[],R?[D]:V?[T]:[],Ab(t)?[]:[w.asSpec()]]),sticky:Rb(t),editor:t,sharedBackstage:k.shared}),z=J([d?[]:[H],i?[]:[I],d?[H]:[]]),N=J([[{dom:{tag:"div",classes:["tox-editor-container"]},components:z}],i?[]:A.toArray(),[M]]),L=Ib(t),W=O(O({role:"application"},vh.isRtl()?{dir:"rtl"}:{}),L?{"aria-hidden":"true"}:{}),j=ta(xB.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(i?["tox-tinymce-inline"]:[]).concat(d?["tox-tinymce--toolbar-bottom"]:[]).concat(l).concat(f),styles:O({visibility:"hidden"},L?{opacity:"0",border:"0"}:{}),attributes:W},components:N,behaviours:xc([jb(),Yd.config({disableClass:"tox-tinymce--disabled"}),tp.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}))
c=F.some(j),t.shortcuts.add("alt+F9","focus menubar",(function(){xB.focusMenubar(j)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){xB.focusToolbar(j)})),t.addCommand("ToggleToolbarDrawer",(function(){xB.toggleToolbarDrawer(j)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return xB.isToolbarDrawerToggled(j)}))
var G=Gx(j),X=Gx(y);(function(t,n,e){var o=function(t,o){U([n,e],(function(n){n.broadcastEvent(t,o)}))},r=function(t,o){U([n,e],(function(n){n.broadcastOn([t],o)}))},i=function(t){return r(ul(),{target:t.target})},u=Dc(),a=ts(u,"touchstart",i),c=ts(u,"touchmove",(function(t){return o(gi(),t)})),s=ts(u,"touchend",(function(t){return o(pi(),t)})),f=ts(u,"mousedown",i),l=ts(u,"mouseup",(function(t){0===t.raw.button&&r(cl(),{target:t.target})})),d=function(t){return r(ul(),{target:Ft.fromDom(t.target)})},m=function(t){0===t.button&&r(cl(),{target:Ft.fromDom(t.target)})},g=function(){U(t.editorManager.get(),(function(n){t!==n&&n.fire("DismissPopups",{relatedTarget:t})}))},p=function(t){return o(hi(),es(t))},h=function(t){r(al(),{}),o(vi(),es(t))},v=function(){return r(al(),{})},b=function(n){n.state&&r(ul(),{target:Ft.fromDom(t.getContainer())})},y=function(t){r(ul(),{target:Ft.fromDom(t.relatedTarget.getContainer())})}
t.on("PostRender",(function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("mousedown",g),t.on("ScrollWindow",p),t.on("ResizeWindow",h),t.on("ResizeEditor",v),t.on("AfterProgressState",b),t.on("DismissPopups",y)})),t.on("remove",(function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("mousedown",g),t.off("ScrollWindow",p),t.off("ResizeWindow",h),t.off("ResizeEditor",v),t.off("AfterProgressState",b),t.off("DismissPopups",y),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()})),t.on("detach",(function(){Kf(n),Kf(e),n.destroy(),e.destroy()}))})(t,G,X)
var q=function(){var n=FM(RM(t)),e=FM(function(t){return VM(t).getOr(hb(t))}(t))
return t.inline||(re("div","width",e)&&$n(j.element,"width",e),re("div","height",n)?$n(j.element,"height",n):$n(j.element,"height","200px")),n}
return{mothership:G,uiMothership:X,backstage:k,renderUI:function(){a.setup(t,k.shared,v),OA(t,k),XA(t,x,k),function(t){var n=t.ui.registry.getAll().sidebars
U(st(n),(function(e){var o=n[e],r=function(){return wt(F.from(t.queryCommandValue("ToggleSidebar")),e)}
t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())}
return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})}))}(t),AE(t,S,k.shared),dt(function(t){return t.getParam("toolbar_groups",{},"object")}(t),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}))
var n=t.ui.registry.getAll(),e=n.buttons,o=n.menuItems,r=n.contextToolbars,i=n.sidebars,c=kb(t),s={menuItems:o,menus:Vb(t),menubar:Pb(t),toolbar:c.getOrThunk((function(){return function(t){return t.getParam("toolbar",!0)}(t)})),allowToolbarGroups:_===mv.floating,buttons:e,sidebar:i}
cA(t,r,y,{backstage:k}),PF(t,y)
var f=t.getElement(),l=q(),d={mothership:G,uiMothership:X,outerContainer:j},m={targetNode:f,height:l}
return u.render(t,d,s,k,m)},getUi:function(){return{channels:{broadcastAll:X.broadcast,broadcastOn:X.broadcastOn,register:g}}}}},GF=h([Ko("lazySink"),rr("dragBlockClass"),vr("getBounds",Ne),lr("useTabstopAt",k),lr("eventOrder",{}),_l("modalBehaviours",[tp]),Da("onExecute"),Ba("onEscape")]),XF={sketch:v},qF=h([od({name:"draghandle",overrides:function(t,n){return{behaviours:xc([FF.config({mode:"mouse",getTarget:function(t){return aa(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),nd({schema:[Ko("dom")],name:"title"}),nd({factory:XF,schema:[Ko("dom")],name:"close"}),nd({factory:XF,schema:[Ko("dom")],name:"body"}),od({factory:XF,schema:[Ko("dom")],name:"footer"}),ed({factory:{sketch:function(t,n){return O(O({},t),{dom:n.dom,components:n.components})}},schema:[lr("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),lr("components",[])],name:"blocker"})]),YF=Bd({name:"ModalDialog",configFields:GF(),partFields:qF(),factory:function(t,n,e,o){var r,i=Qc(),u=ou("modal-events"),a=O(O({},t.eventOrder),((r={})[bi()]=[u].concat(t.eventOrder["alloy.system.attached"]||[]),r))
return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){i.set(n)
var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(O(O({},r),{components:r.components.concat([na(n)]),behaviours:xc([lp.config({}),up("dialog-blocker-events",[ji(jr(),(function(){tp.focusIn(n)}))])])}))
Wf(e,u),tp.focusIn(n)},hide:function(t){i.clear(),_n(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){Gf(t)}))}))},getBody:function(n){return hd(n,t,"body")},getFooter:function(n){return hd(n,t,"footer")},setIdle:function(t){DE.unblock(t)},setBusy:function(t,n){DE.block(t,n)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Dl(t.modalBehaviours,[ip.config({}),tp.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),DE.config({getRoot:i.get}),up(u,[Gi((function(n){var e,o,r,i,u,a
e=n.element,o=hd(n,t,"title").element,r=Xn(e,"id").fold((function(){var t=ou("dialog-label")
return jn(o,"id",t),t}),v),jn(e,"aria-labelledby",r),i=n.element,u=hd(n,t,"body").element,a=F.from(Gn(i,"id")).fold((function(){var t=ou("dialog-describe")
return jn(u,"id",t),t}),v),jn(i,"aria-describedby",a)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),KF=Co([Qo("type"),Qo("name")].concat(Xv)),JF=Fo,$F=[Xo("name","name",co((function(){return ou("button-name")})),Ao),ar("icon"),pr("align","end",["start","end"]),hr("primary",!1),hr("disabled",!1)],QF=T(T([],$F,!0),[Qo("text")],!1),ZF=T([Zo("type",["submit","cancel","custom"])],QF,!0),tI=T([Zo("type",["menu"]),ar("text"),ar("tooltip"),ar("icon"),or("items",KF)],$F,!0),nI=Go("type",{submit:ZF,cancel:ZF,custom:ZF,menu:tI}),eI=[Qo("type"),Qo("text"),Zo("level",["info","warn","error","success"]),Qo("icon"),lr("url","")],oI=Co(eI),rI=[Qo("type"),Qo("text"),hr("disabled",!1),hr("primary",!1),Xo("name","name",co((function(){return ou("button-name")})),Ao),ar("icon"),hr("borderless",!1)],iI=Co(rI),uI=[Qo("type"),Qo("name"),Qo("label"),hr("disabled",!1)],aI=Co(uI),cI=Fo,sI=[Qo("type"),Qo("name")],fI=sI.concat([ar("label")]),lI=fI.concat([lr("columns","auto")]),dI=Co(lI),mI=Do([Qo("value"),Qo("text"),Qo("icon")]),gI=Co(fI),pI=Ao,hI=Co(fI),vI=Ao,bI=sI.concat([gr("tag","textarea"),Qo("scriptId"),Qo("scriptUrl"),function(t,n){return dr(t,n,Vo)}("settings",void 0)]),yI=sI.concat([gr("tag","textarea"),tr("init")]),xI=zo((function(t){return Lo("customeditor.old",ko(yI),t).orThunk((function(){return Lo("customeditor.new",ko(bI),t)}))})),wI=Ao,SI=Co(fI),kI=Oo(vo),CI=function(t){return[Qo("type"),$o("columns"),t]},OI=[Qo("type"),Qo("html"),pr("presets","presentation",["presentation","document"])],_I=Co(OI),TI=fI.concat([hr("sandboxed",!0)]),DI=Co(TI),EI=Ao,BI=fI.concat([Jo("currentState",Co([Ko("blob"),Qo("url")]))]),MI=Co(BI),AI=fI.concat([ar("inputMode"),ar("placeholder"),hr("maximized",!1),hr("disabled",!1)]),FI=Co(AI),II=Ao,RI=function(t){return[Qo("type"),Qo("label"),t]},VI=[Qo("text"),Qo("value")],PI=[Qo("text"),or("items",function(t,n){return e=Lt(n),{extract:function(t,n){return e().extract(t,n)},toString:function(){return e().toString()}}
var e}(0,(function(){return HI})))],HI=_o([Co(VI),Co(PI)]),zI=fI.concat([or("items",HI),hr("disabled",!1)]),NI=Co(zI),LI=Ao,WI=fI.concat([er("items",[Qo("text"),Qo("value")]),mr("size",1),hr("disabled",!1)]),UI=Co(WI),jI=Ao,GI=fI.concat([hr("constrain",!0),hr("disabled",!1)]),XI=Co(GI),qI=Co([Qo("width"),Qo("height")]),YI=[Qo("type"),or("header",Ao),or("cells",Oo(Ao))],KI=Co(YI),JI=fI.concat([ar("placeholder"),hr("maximized",!1),hr("disabled",!1)]),$I=Co(JI),QI=Ao,ZI=fI.concat([pr("filetype","file",["image","media","file"]),lr("disabled",!1)]),tR=Co(ZI),nR=Co([Qo("value"),lr("meta",{})]),eR=function(t){return Xo("items","items",{tag:"required",process:{}},Oo(zo((function(n){return Lo("Checking item of "+t,oR,n).fold((function(t){return Ue.error(jo(t))}),(function(t){return Ue.value(t)}))}))))},oR=wo((function(){return Ho("type",{alertbanner:oI,bar:Co((t=eR("bar"),[Qo("type"),t])),button:iI,checkbox:aI,colorinput:gI,colorpicker:hI,dropzone:SI,grid:Co(CI(eR("grid"))),iframe:DI,input:FI,listbox:NI,selectbox:UI,sizeinput:XI,textarea:$I,urlinput:tR,customeditor:xI,htmlpanel:_I,imagetools:MI,collection:dI,label:Co(RI(eR("label"))),table:KI,panel:iR})
var t})),rR=[Qo("type"),lr("classes",[]),or("items",oR)],iR=Co(rR),uR=[Xo("name","name",co((function(){return ou("tab-name")})),Ao),Qo("title"),or("items",oR)],aR=[Qo("type"),er("tabs",uR)],cR=Co(aR),sR=QF,fR=nI,lR=Co([Qo("title"),Jo("body",Ho("type",{panel:iR,tabpanel:cR})),gr("size","normal"),or("buttons",fR),lr("initialData",{}),vr("onAction",g),vr("onChange",g),vr("onSubmit",g),vr("onClose",g),vr("onCancel",g),lr("onTabChange",g)]),dR=Co(T([Zo("type",["cancel","custom"])],sR,!0)),mR=Co([Qo("title"),Qo("url"),ur("height"),ur("width"),sr("buttons",dR),vr("onAction",g),vr("onCancel",g),vr("onClose",g),vr("onMessage",g)]),gR=function(t){return r(t)?[t].concat($(vt(t),gR)):i(t)?$(t,gR):[]},pR=function(t){return o(t.type)&&o(t.name)},hR={checkbox:cI,colorinput:pI,colorpicker:vI,dropzone:kI,input:II,iframe:EI,sizeinput:qI,selectbox:jI,listbox:LI,size:qI,textarea:QI,urlinput:nR,customeditor:wI,collection:mI,togglemenuitem:JF},vR=function(t){var n=function(t){return G(gR(t),pR)}(t),e=$(n,(function(t){return function(t){return F.from(hR[t.type])}(t).fold((function(){return[]}),(function(n){return[Jo(t.name,n)]}))}))
return Co(e)},bR=function(t){return{internalDialog:Wo(Lo("dialog",lR,t)),dataValidator:vR(t),initialData:t.initialData}},yR={open:function(t,n){var e=bR(n)
return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(Wo(Lo("dialog",mR,n)))},redial:function(t){return bR(t)}},xR=function(t){var n=[],e={}
return lt(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),n.length>0?Ue.error(n):Ue.value(e)},wR=function(t,n){var e=hh(rC.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:W(t.items,(function(t){return uT(e,t,n)}))}})))
return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:xc([tp.config({mode:"acyclic",useTabstopAt:x(FC)}),mC(e),SC(e,{postprocess:function(t){return xR(t).fold((function(t){return console.error(t),{}}),v)}})])}},SR=Ed({name:"TabButton",configFields:[lr("uid",void 0),Ko("value"),Xo("dom","dom",fo((function(){return{attributes:{role:"tab",id:ou("aria"),"aria-selected":"false"}}})),Eo()),rr("action"),lr("domModification",{}),_l("tabButtonBehaviours",[lp,tp,Ol]),Ko("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:Op(t.action),behaviours:Dl(t.tabButtonBehaviours,[lp.config({}),tp.config({mode:"execution",useSpace:!0,useEnter:!0}),Ol.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),kR=h([Ko("tabs"),Ko("dom"),lr("clickToDismiss",!1),_l("tabbarBehaviours",[im,tp]),Oa(["tabClass","selectedClass"])]),CR=rd({factory:SR,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){im.dehighlight(t,n),Ei(t,Oi(),{tabbar:t,button:n})},e=function(t,n){im.highlight(t,n),Ei(t,Ci(),{tabbar:t,button:n})}
return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=im.isHighlighted(r,o);(i&&t.clickToDismiss?n:i?g:e)(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),OR=h([CR]),_R=Bd({name:"Tabbar",configFields:kR(),partFields:OR(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Dl(t.tabbarBehaviours,[im.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){jn(n.element,"aria-selected","true")},onDehighlight:function(t,n){jn(n.element,"aria-selected","false")}}),tp.config({mode:"flow",getInitial:function(t){return im.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),TR=Ed({name:"Tabview",configFields:[_l("tabviewBehaviours",[ip])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Dl(t.tabviewBehaviours,[ip.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),DR=h([lr("selectFirst",!0),Ta("onChangeTab"),Ta("onDismissTab"),lr("tabs",[]),_l("tabSectionBehaviours",[])]),ER=nd({factory:_R,schema:[Ko("dom"),nr("markers",[Ko("tabClass"),Ko("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),BR=nd({factory:TR,name:"tabview"}),MR=h([ER,BR]),AR=Bd({name:"TabSection",configFields:DR(),partFields:MR(),factory:function(t,n,e,o){var r=function(n,e){pd(n,t,"tabbar").each((function(t){e(t).each(Bi)}))}
return{uid:t.uid,dom:t.dom,components:n,behaviours:Tl(t.tabSectionBehaviours),events:Ii(J([t.selectFirst?[Gi((function(t,n){r(t,im.getFirst)}))]:[],[Pi(Ci(),(function(n,e){(function(n){var e=Ol.getValue(n)
pd(n,t,"tabview").each((function(o){Y(t.tabs,(function(t){return t.value===e})).each((function(e){var r=e.view()
Xn(n.element,"id").each((function(t){jn(o.element,"aria-labelledby",t)})),ip.set(o,r),t.onChangeTab(o,n,r)}))}))})(e.event.button)})),Pi(Oi(),(function(n,e){var o=e.event.button
t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return pd(n,t,"tabview").map((function(t){return ip.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=im.getCandidates(t)
return Y(e,(function(t){return Ol.getValue(t)===n})).filter((function(n){return!im.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),FR=function(t,n){$n(t,"height",n+"px"),hn().browser.isIE()?ie(t,"flex-basis"):$n(t,"flex-basis",n+"px")},IR=function(t,n,e){aa(t,'[role="dialog"]').each((function(t){sa(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return $n(n,"height","0"),$n(n,"flex-basis","0"),Math.min(e,function(t,n,e){var o,r=Cn(t).dom,i=aa(t,".tox-dialog-wrap").getOr(t)
o="fixed"===te(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight)
var u=se(n),a=n.dom.offsetLeft>=e.dom.offsetLeft+ve(e)?Math.max(se(e),u):u,c=parseInt(te(t,"margin-top"),10)||0,s=parseInt(te(t,"margin-bottom"),10)||0
return o-(se(t)+c+s-a)}(t,n,o))})).each((function(t){FR(n,t)}))}))}))},RR=function(t){return sa(t,'[role="tabpanel"]')},VR=function(t){var n
return{smartTabHeight:(n=Qc(),{extraEvents:[Gi((function(e){var o=e.element
RR(o).each((function(r){$n(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){(function(t){return it(ot(t,(function(t,n){return t>n?-1:t<n?1:0})))})(function(t,n,e){return W(t,(function(o,r){ip.set(e,t[r].view())
var i=n.dom.getBoundingClientRect()
return ip.set(e,[]),i.height}))}(t,r,e)).fold(n.clear,n.set)})),IR(o,r,n),ie(r,"visibility"),function(t,n){it(t).each((function(t){return AR.showTab(n,t.value)}))}(t,e),gh.requestAnimationFrame((function(){IR(o,r,n)}))}))})),Pi(vi(),(function(t){var e=t.element
RR(e).each((function(t){IR(e,t,n)}))})),Pi(lw,(function(t,e){var o=t.element
RR(o).each((function(t){var e=Mc(Rn(t))
$n(t,"visibility","hidden")
var r=ee(t,"height").map((function(t){return parseInt(t,10)}))
ie(t,"height"),ie(t,"flex-basis")
var i=t.dom.getBoundingClientRect().height
r.forall((function(t){return i>t}))?(n.set(i),IR(o,t,n)):r.each((function(n){FR(t,n)})),ie(t,"visibility"),e.each(Ec)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},PR="send-data-to-section",HR="send-data-to-view",zR=function(t,n){var e=xr({}),o=function(t){var n=Ol.getValue(t),o=xR(n).getOr({}),r=e.get(),i=uo(r,o)
e.set(i)},r=function(t){var n=e.get()
Ol.setValue(t,n)},i=xr(null),u=W(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[rC.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:W(t.items,(function(t){return uT(e,t,n)})),formBehaviours:xc([tp.config({mode:"acyclic",useTabstopAt:x(FC)}),up("TabView.form.events",[Gi(r),Xi(o)]),_c.config({channels:Or([{key:PR,value:{onReceive:o}},{key:HR,value:{onReceive:r}}])})])}}))]}}})),a=VR(u).smartTabHeight
return AR.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=Ol.getValue(n)
Ei(t,fw,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[AR.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[_R.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:xc([$x.config({})])}),AR.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:xc([up("tabpanel",a.extraEvents),tp.config({mode:"acyclic"}),Id.config({find:function(t){return it(AR.getViewItems(t))}}),Ol.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([PR],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([HR],{})}}})])})},NR=ou("update-dialog"),LR=ou("update-title"),WR=ou("update-body"),UR=ou("update-footer"),jR=ou("body-send-message"),GR=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:O(O({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:xc([gC(0),uM.config({channel:WR,updateState:function(t,n){return F.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[zR(t.body,e)]
default:return[wR(t.body,e)]}},initialData:t})])}},XR=oy.deviceType.isTouch(),qR=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},YR=function(t,n){return YF.parts.close(ph.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:xc([$x.config({})])}))},KR=function(){return YF.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},JR=function(t,n){return YF.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:EE("<p>"+n.translate(t)+"</p>")}]}]})},$R=function(t){return YF.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},QR=function(t,n){return[jx.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),jx.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},ZR=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll"
return YF.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),F.some(!0)},useTabstopAt:function(t){return!FC(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:O({position:"relative"},t.extraStyles)},components:T([t.header,t.body],t.footer.toArray(),!0),parts:{blocker:{dom:EE('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:XR?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:xc(T([lp.config({}),up("dialog-events",t.dialogEvents.concat([ji(jr(),(function(t,n){tp.focusIn(t)}))])),up("scroll-lock",[Gi((function(){Vu(Ln(),i)})),Xi((function(){Hu(Ln(),i)}))])],t.extraBehaviours,!0)),eventOrder:O((n={},n[ai()]=["dialog-events"],n[bi()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[yi()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},tV=function(t){return ph.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[_h("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){Di(t,iw)}})},nV=function(t,n,e){var o=function(t){return[$u(e.translate(t.title))]}
return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:O({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:xc([uM.config({channel:LR,renderComponents:o})])}},eV=function(){return{dom:EE('<div class="tox-dialog__draghandle"></div>')}},oV=function(t,n){return function(t,n){var e=YF.parts.title(nV(t,F.none(),n)),o=YF.parts.draghandle(eV()),r=YF.parts.close(tV(n)),i=[e].concat(t.draggable?[o]:[]).concat([r])
return jx.sketch({dom:EE('<div class="tox-dialog__header"></div>'),components:i})}({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},rV=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:EE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},iV=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){YF.setBusy(t(),(function(t,o){return rV(e.message,o,n)}))},onUnblock:function(){YF.setIdle(t())}}},uV=function(t,n,e,o){var r
return ta(ZR(O(O({},t),{lazySink:o.shared.getSink,extraBehaviours:T([uM.config({channel:NR,updateState:function(t,n){return F.some(n)},initialData:n}),OC({})],t.extraBehaviours,!0),onEscape:function(t){Di(t,iw)},dialogEvents:e,eventOrder:(r={},r[ui()]=[uM.name(),_c.name()],r[bi()]=["scroll-lock",uM.name(),"messages","dialog-events","alloy.base.behaviour"],r[yi()]=["alloy.base.behaviour","dialog-events","messages",uM.name(),"scroll-lock"],r)})))},aV=function(t){return W(t,(function(t){return"menu"===t.type?function(t){var n=W(t.items,(function(t){var n=xr(!1)
return O(O({},t),{storage:n})}))
return O(O({},t),{items:n})}(t):t}))},cV=function(t){return q(t,(function(t,n){return"menu"===n.type?q(n.items,(function(t,n){return t[n.name]=n.storage,t}),t):t}),{})},sV=function(t,n){return[Li(jr(),AC),t(rw,(function(t,e){n.onClose(),e.onClose()})),t(iw,(function(t,n,e,o){n.onCancel(t),Di(o,rw)})),Pi(sw,(function(t,e){return n.onUnblock()})),Pi(cw,(function(t,e){return n.onBlock(e.event)}))]},fV=function(t,n){var e=function(n,e){return Pi(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){uM.getState(t).get().each((function(e){n(e,t)}))}
return T(T([],sV(e,n),!0),[e(uw,(function(t,n,e){n.onAction(t,{name:e.name})}))],!1)},lV=function(t,n,e){var o=function(n,e){return Pi(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){uM.getState(t).get().each((function(e){n(e.internalDialog,t)}))}
return T(T([],sV(o,n),!0),[o(aw,(function(t,n){return n.onSubmit(t)})),o(ow,(function(t,n,e){n.onChange(t,{name:e.name})})),o(uw,(function(t,n,o,r){var i=function(){return tp.focusIn(r)},u=function(t){return qn(t,"disabled")||Xn(t,"aria-disabled").exists((function(t){return"true"===t}))},a=Rn(r.element),c=Mc(a)
n.onAction(t,{name:o.name,value:o.value}),Mc(a).fold(i,(function(t){u(t)||c.exists((function(n){return wn(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!wn(n.element,t)})).each(i)}))})),o(fw,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),Xi((function(n){var e=t()
Ol.setValue(n,e.getData())}))],!1)},dV=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=j(e,(function(t){return"start"===t.align})),r=function(t,n){return jx.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:W(n,(function(t){return t.memento.asSpec()}))})}
return[r("start",o.pass),r("end",o.fail)]},mV=function(t,n){return{dom:EE('<div class="tox-dialog__footer"></div>'),components:[],behaviours:xc([uM.config({channel:UR,initialData:t,updateState:function(t,e){var o=W(e.buttons,(function(t){var e=hh(function(t,n){return qO(t,t.type,n)}(t,n))
return{name:t.name,align:t.align,memento:e}}))
return F.some({lookupByName:function(t,n){return function(t,n,e){return Y(n,(function(t){return t.name===e})).bind((function(n){return n.memento.getOpt(t)}))}(t,o,n)},footerButtons:o})},renderComponents:dV})])}},gV=function(t,n){return YF.parts.footer(mV(t,n))},pV=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=Id.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper())
return rC.getField(e,n).fold((function(){var o=t.getFooter()
return uM.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return F.some(t)}))}return F.none()},hV=function(t,n,e){var r=function(n){var e=t.getRoot()
e.getSystem().isConnected()&&n(e)},i={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=Ol.getValue(o),i=dt(e,(function(t){return t.get()}))
return O(O({},r),i)},setData:function(n){r((function(o){var r=i.getData(),u=O(O({},r),n),a=function(t,n){var e=t.getRoot()
return uM.getState(e).get().map((function(t){return Wo(Lo("data",t.dataValidator,n))})).getOr(n)}(t,u),c=t.getFormWrapper()
Ol.setValue(c,a),lt(e,(function(t,n){yt(u,n)&&t.set(u[n])}))}))},disable:function(n){pV(t,n).each(Yd.disable)},enable:function(n){pV(t,n).each(Yd.enable)},focus:function(n){pV(t,n).each(lp.focus)},block:function(t){if(!o(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument")
r((function(n){Ei(n,cw,{message:t})}))},unblock:function(){r((function(t){Di(t,sw)}))},showTab:function(n){r((function(e){var o=t.getBody()
uM.getState(o).get().exists((function(t){return t.isTabPanel()}))&&Id.getCurrent(o).each((function(t){AR.showTab(t,n)}))}))},redial:function(t){r((function(e){var o=n(t)
e.getSystem().broadcastOn([NR],o),e.getSystem().broadcastOn([LR],o.internalDialog),e.getSystem().broadcastOn([WR],o.internalDialog),e.getSystem().broadcastOn([UR],o.internalDialog),i.setData(o.initialData)}))},close:function(){r((function(t){Di(t,rw)}))}}
return i},vV=function(t,n,e){var o=oV(t.internalDialog.title,e),r=function(t,n){var e=GR(t,F.none(),n,!1)
return YF.parts.body(e)}({body:t.internalDialog.body},e),i=aV(t.internalDialog.buttons),u=cV(i),a=gV({buttons:i},e),c=lV((function(){return m}),iV((function(){return l}),e.shared.providers,n),e.shared.getSink),s=function(t){switch(t){case"large":return["tox-dialog--width-lg"]
case"medium":return["tox-dialog--width-md"]
default:return[]}}(t.internalDialog.size),f={header:o,body:r,footer:F.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=uV(f,t,c,e),d={getRoot:h(l),getBody:function(){return YF.getBody(l)},getFooter:function(){return YF.getFooter(l)},getFormWrapper:function(){var t=YF.getBody(l)
return Id.getCurrent(t).getOr(t)}},m=hV(d,n.redial,u)
return{dialog:l,instanceApi:m}},bV=function(t,n,e,o){var r,i,u,a,c,s=ou("dialog-label"),f=ou("dialog-content"),l=hh((u={title:t.internalDialog.title,draggable:!0},a=s,c=e.shared.providers,jx.sketch({dom:EE('<div class="tox-dialog__header"></div>'),components:[nV(u,F.some(a),c),eV(),tV(c)],containerBehaviours:xc([FF.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return fa(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=hh(function(t,n,e,o){return GR(t,F.some(n),e,o)}({body:t.internalDialog.body},f,e,o)),m=aV(t.internalDialog.buttons),g=cV(m),p=hh(function(t,n){return mV(t,n)}({buttons:m},e)),v=lV((function(){return y}),{onBlock:function(t){DE.block(b,(function(n,o){return rV(t.message,o,e.shared.providers)}))},onUnblock:function(){DE.unblock(b)},onClose:function(){return n.closeWindow()}},e.shared.getSink),b=ta({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=s,r["aria-describedby"]=f,r)},eventOrder:(i={},i[ui()]=[uM.name(),_c.name()],i[ai()]=["execute-on-form"],i[bi()]=["reflecting","execute-on-form"],i),behaviours:xc([tp.config({mode:"cyclic",onEscape:function(t){return Di(t,rw),F.some(!0)},useTabstopAt:function(t){return!FC(t)&&("button"!==Rt(t)||"disabled"!==Gn(t,"disabled"))}}),uM.config({channel:NR,updateState:function(t,n){return F.some(n)},initialData:t}),lp.config({}),up("execute-on-form",v.concat([ji(jr(),(function(t,n){tp.focusIn(t)}))])),DE.config({getRoot:function(){return F.some(b)}}),ip.config({}),OC({})]),components:[l.asSpec(),d.asSpec(),p.asSpec()]}),y=hV({getRoot:h(b),getFooter:function(){return p.get(b)},getBody:function(){return d.get(b)},getFormWrapper:function(){var t=d.get(b)
return Id.getCurrent(t).getOr(t)}},n.redial,g)
return{dialog:b,instanceApi:y}},yV=tinymce.util.Tools.resolve("tinymce.util.URI"),xV=["insertContent","setContent","execCommand","close","block","unblock"],wV=function(t){return r(t)&&-1!==xV.indexOf(t.mceAction)},SV=function(t,n,e,i){var u,c,s,f=oV(t.title,i),l=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[BC({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:xc([$x.config({}),lp.config({})])})]}],behaviours:xc([tp.config({mode:"acyclic",useTabstopAt:x(FC)})])}
return YF.parts.body(n)}(t),d=t.buttons.bind((function(t){return 0===t.length?F.none():F.some(gV({buttons:t},i))})),m=fV((function(){return S}),iV((function(){return w}),i.shared.providers,n)),g=O(O({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),p=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],h=new yV(t.url,{base_uri:new yV(window.location.href)}),v=h.protocol+"://"+h.host+(h.port?":"+h.port:""),b=$c(),y=[up("messages",[Gi((function(){var n=ts(Ft.fromDom(window),"message",(function(n){if(h.isSameOrigin(new yV(n.raw.origin))){var o=n.raw.data
wV(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content)
break
case"setContent":t.setContent(e.content)
break
case"execCommand":var o=!!a(e.ui)&&e.ui
t.execCommand(e.cmd,o,e.value)
break
case"close":n.close()
break
case"block":n.block(e.message)
break
case"unblock":n.unblock()}}(e,S,o):function(t){return!wV(t)&&r(t)&&yt(t,"mceAction")}(o)&&t.onMessage(S,o)}}))
b.set(n)})),Xi(b.clear)]),_c.config({channels:(u={},u[jR]={onReceive:function(t,n){sa(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,v)}))}},u)})],w=uV({header:f,body:l,footer:d,extraClasses:p,extraBehaviours:y,extraStyles:g},t,m,i),S=(c=w,s=function(t){c.getSystem().isConnected()&&t(c)},{block:function(t){if(!o(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument")
s((function(n){Ei(n,cw,{message:t})}))},unblock:function(){s((function(t){Di(t,sw)}))},close:function(){s((function(t){Di(t,rw)}))},sendMessage:function(t){s((function(n){n.getSystem().broadcastOn([jR],t)}))}})
return{dialog:w,instanceApi:S}},kV=function(t,n,e){return n&&e?[]:[ID.config({contextual:{lazyContext:function(){return F.some(He(Ft.fromDom(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},CV=function(t){var n=t.backstage,e=t.editor,o=Rb(e),r=function(t){var n=t.backstage.shared
return{open:function(e,o){var r=function(){YF.hide(c),o()},i=hh(qO({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:F.none()},"cancel",t.backstage)),u=KR(),a=YR(r,n.providers),c=ta(ZR({lazySink:function(){return n.getSink()},header:qR(u,a),body:JR(e,n.providers),footer:F.some($R(QR([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Pi(iw,r)],eventOrder:{}}))
YF.show(c)
var s=i.get(c)
lp.focus(s)}}}(t),i=function(t){var n=t.backstage.shared
return{open:function(e,o){var r=function(t){YF.hide(s),o(t)},i=hh(qO({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:F.none()},"submit",t.backstage)),u=qO({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:F.none()},"cancel",t.backstage),a=KR(),c=YR((function(){return r(!1)}),n.providers),s=ta(ZR({lazySink:function(){return n.getSink()},header:qR(a,c),body:JR(e,n.providers),footer:F.some($R(QR([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Pi(iw,(function(){return r(!1)})),Pi(aw,(function(){return r(!0)}))],eventOrder:{}}))
YF.show(s)
var f=i.get(s)
lp.focus(f)}}}(t),u=function(t,o){return yR.openUrl((function(t){var r=SV(t,{closeWindow:function(){YF.hide(r.dialog),o(r.instanceApi)}},e,n)
return YF.show(r.dialog),r.instanceApi}),t)},a=function(t,e){return yR.open((function(t,o,r){var i=o,u=vV({dataValidator:r,initialData:i,internalDialog:t},{redial:yR.redial,closeWindow:function(){YF.hide(u.dialog),e(u.instanceApi)}},n)
return YF.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),t)},c=function(t,r,i,u){return yR.open((function(t,a,c){var s=Wo(Lo("data",c,a)),f=Qc(),l=n.shared.header.isPositionedAtTop(),d=function(){return f.on((function(t){Yp.reposition(t),ID.refresh(t)}))},m=bV({dataValidator:c,initialData:s,internalDialog:t},{redial:yR.redial,closeWindow:function(){f.on(Yp.hide),e.off("ResizeEditor",d),f.clear(),i(m.instanceApi)}},n,u),g=ta(Yp.sketch(O(O({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},l?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:xc(T([up("window-manager-inline-events",[Pi(xi(),(function(t,n){Di(m.dialog,iw)}))])],kV(e,o,l),!0)),isExtraPart:function(t,n){return function(t){return Bx(t,".tox-alert-dialog")||Bx(t,".tox-confirm-dialog")}(n)}})))
return f.set(g),Yp.showWithin(g,na(m.dialog),{anchor:r},F.some(Ln())),o&&l||(ID.refresh(g),e.on("ResizeEditor",d)),m.instanceApi.setData(s),tp.focusIn(m.dialog),m.instanceApi}),t)}
return{open:function(t,e,o){return void 0!==e&&"toolbar"===e.inline?c(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?c(t,n.shared.anchors.cursor(),o,e.ariaAttrs):a(t,o)},openUrl:function(t,n){return u(t,n)},alert:function(t,n){r.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){i.open(t,(function(t){n(t)}))}}}
C.add("silver",(function(t){var n=jF(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi
Ex(t,o.shared)
var u=CV({editor:t,backstage:o})
return{renderUI:r,getWindowManagerImpl:h(u),getNotificationManagerImpl:function(){return Eh(t,{backstage:o},e)},ui:i()}}))})()
