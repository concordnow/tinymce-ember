(function(){"use strict"
var n=function(){return(n=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var o in t=arguments[e])Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])
return n}).apply(this,arguments)}
function t(n,t){var e={}
for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r])
if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var o=0
for(r=Object.getOwnPropertySymbols(n);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(e[r[o]]=n[r[o]])}return e}function e(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length
var r=Array(n),o=0
for(t=0;t<e;t++)for(var i=arguments[t],u=0,c=i.length;u<c;u++,o++)r[o]=i[u]
return r}var r=function(){},o=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r]
return n(t.apply(null,e))}},i=function(n){return function(){return n}},u=function(n){return n}
function c(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e]
return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r]
var o=t.concat(e)
return n.apply(null,o)}}var a,f=function(n){return function(t){return!n(t)}},s=function(n){return function(){throw new Error(n)}},l=function(n){return n()},d=i(!1),m=i(!0),g=function(n){var t,e=!1
return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o]
return e||(e=!0,t=n.apply(null,r)),t}},p=function(){return v},v=function(){var n=function(n){return n.isNone()},t=function(n){return n()},e=function(n){return n}
return{fold:function(n,t){return n()},is:d,isSome:d,isNone:m,getOr:e,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:e,orThunk:t,map:p,each:r,bind:p,exists:d,forall:m,filter:p,equals:n,equals_:n,toArray:function(){return[]},toString:i("none()")}}(),h=function(n){var t=i(n),e=function(){return o},r=function(t){return t(n)},o={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:m,isNone:d,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return h(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?o:v},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(d,(function(t){return e(n,t)}))}}
return o},y={some:h,none:p,from:function(n){return null==n?v:h(n)}},b=function(n){return function(t){return function(n){var t=typeof n
return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(t)===n}},x=function(n){return function(t){return typeof t===n}},w=b("string"),S=b("object"),O=b("array"),T=x("boolean"),k=function(n){return!function(n){return null==n}(n)},E=x("function"),C=x("number"),M=Array.prototype.slice,D=Array.prototype.indexOf,_=Array.prototype.push,I=function(n,t){return function(n,t){return D.call(n,t)}(n,t)>-1},F=function(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return!0}return!1},R=function(n,t){for(var e=n.length,r=new Array(e),o=0;o<e;o++){var i=n[o]
r[o]=t(i,o)}return r},V=function(n,t){for(var e=0,r=n.length;e<r;e++){t(n[e],e)}},B=function(n,t){for(var e=[],r=0,o=n.length;r<o;r++){var i=n[r]
t(i,r)&&e.push(i)}return e},A=function(n,t,e){return function(n,t){for(var e=n.length-1;e>=0;e--)t(n[e],e)}(n,(function(n){e=t(e,n)})),e},j=function(n,t,e){return V(n,(function(n){e=t(e,n)})),e},N=function(n,t){return function(n,t,e){for(var r=0,o=n.length;r<o;r++){var i=n[r]
if(t(i,r))return y.some(i)
if(e(i,r))break}return y.none()}(n,t,d)},P=function(n,t){for(var e=0,r=n.length;e<r;e++){if(t(n[e],e))return y.some(e)}return y.none()},H=function(n){for(var t=[],e=0,r=n.length;e<r;++e){if(!O(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n)
_.apply(t,n[e])}return t},z=function(n,t){return H(R(n,t))},L=function(n,t){for(var e=0,r=n.length;e<r;++e){if(!0!==t(n[e],e))return!1}return!0},G=function(n){var t=M.call(n,0)
return t.reverse(),t},$=function(n,t){return B(n,(function(n){return!I(t,n)}))},U=function(n){return[n]},W=function(n){return function(n,t){return t>=0&&t<n.length?y.some(n[t]):y.none()}(n,0)},X=function(n,t){for(var e=0;e<n.length;e++){var r=t(n[e],e)
if(r.isSome())return r}return y.none()},q=function(){return Y(0,0)},Y=function(n,t){return{major:n,minor:t}},K={nu:Y,detect:function(n,t){var e=String(t).toLowerCase()
return 0===n.length?q():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var r=n[e]
if(r.test(t))return r}}(n,t)
if(!e)return{major:0,minor:0}
var r=function(n){return Number(t.replace(e,"$"+n))}
return Y(r(1),r(2))}(n,e)},unknown:q},J=function(n,t){var e=String(t).toLowerCase()
return N(n,(function(n){return n.search(e)}))},Q=function(n,t){return J(n,t).map((function(n){var e=K.detect(n.versionRegexes,t)
return{current:n.name,version:e}}))},Z=function(n,t){return J(n,t).map((function(n){var e=K.detect(n.versionRegexes,t)
return{current:n.name,version:e}}))},nn=function(n,t){return-1!==n.indexOf(t)},tn=function(n){return function(t){return t.replace(n,"")}}(/^\s+|\s+$/g),en=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,rn=function(n){return function(t){return nn(t,n)}},on=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return nn(n,"edge/")&&nn(n,"chrome")&&nn(n,"safari")&&nn(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,en],search:function(n){return nn(n,"chrome")&&!nn(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return nn(n,"msie")||nn(n,"trident")}},{name:"Opera",versionRegexes:[en,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:rn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:rn("firefox")},{name:"Safari",versionRegexes:[en,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(nn(n,"safari")||nn(n,"mobile/"))&&nn(n,"applewebkit")}}],un=[{name:"Windows",search:rn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return nn(n,"iphone")||nn(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:rn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:rn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:rn("linux"),versionRegexes:[]},{name:"Solaris",search:rn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:rn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:rn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],cn={browsers:i(on),oses:i(un)},an="Edge",fn="Chrome",sn="Opera",ln="Firefox",dn="Safari",mn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}}
return{current:t,version:e,isEdge:r(an),isChrome:r(fn),isIE:r("IE"),isOpera:r(sn),isFirefox:r(ln),isSafari:r(dn)}},gn={unknown:function(){return mn({current:void 0,version:K.unknown()})},nu:mn,edge:i(an),chrome:i(fn),ie:i("IE"),opera:i(sn),firefox:i(ln),safari:i(dn)},pn="Windows",vn="Android",hn="Linux",yn="Solaris",bn="FreeBSD",xn="ChromeOS",wn=function(n){var t=n.current,e=n.version,r=function(n){return function(){return t===n}}
return{current:t,version:e,isWindows:r(pn),isiOS:r("iOS"),isAndroid:r(vn),isOSX:r("OSX"),isLinux:r(hn),isSolaris:r(yn),isFreeBSD:r(bn),isChromeOS:r(xn)}},Sn={unknown:function(){return wn({current:void 0,version:K.unknown()})},nu:wn,windows:i(pn),ios:i("iOS"),android:i(vn),linux:i(hn),osx:i("OSX"),solaris:i(yn),freebsd:i(bn),chromeos:i(xn)},On=function(n,t){var e=cn.browsers(),r=cn.oses(),o=Q(e,n).fold(gn.unknown,gn.nu),u=Z(r,n).fold(Sn.unknown,Sn.nu),c=function(n,t,e,r){var o=n.isiOS()&&!0===/ipad/i.test(e),u=n.isiOS()&&!o,c=n.isiOS()||n.isAndroid(),a=c||r("(pointer:coarse)"),f=o||!u&&c&&r("(min-device-width:768px)"),s=u||c&&!f,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!s&&!f&&!l
return{isiPad:i(o),isiPhone:i(u),isTablet:i(f),isPhone:i(s),isTouch:i(a),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:i(l),isDesktop:i(d)}}(u,o,n,t)
return{browser:o,os:u,deviceType:c}},Tn=function(n){return window.matchMedia(n).matches},kn=g((function(){return On(navigator.userAgent,Tn)})),En=function(){return kn()},Cn=i,Mn=Cn("touchstart"),Dn=Cn("touchmove"),_n=Cn("touchend"),In=Cn("mousedown"),Fn=Cn("mousemove"),Rn=Cn("mouseup"),Vn=Cn("mouseover"),Bn=Cn("keydown"),An=Cn("keyup"),jn=Cn("input"),Nn=Cn("change"),Pn=Cn("click"),Hn=Cn("transitionend"),zn=Cn("selectstart"),Ln=function(n){return i("alloy."+n)},Gn={tap:Ln("tap")},$n=Ln("focus"),Un=Ln("blur.post"),Wn=Ln("paste.post"),Xn=Ln("receive"),qn=Ln("execute"),Yn=Ln("focus.item"),Kn=Gn.tap,Jn=Ln("longpress"),Qn=Ln("system.init"),Zn=Ln("system.attached"),nt=Ln("system.detached"),tt=Ln("focusmanager.shifted"),et=Ln("highlight"),rt=Ln("dehighlight"),ot=function(n,t){at(n,n.element,t,{})},it=function(n,t,e){at(n,n.element,t,e)},ut=function(n){ot(n,qn())},ct=function(n,t,e){at(n,t,e,{})},at=function(t,e,r,o){var i=n({target:e},o)
t.getSystem().triggerEvent(r,e,i)},ft=function(n){if(null==n)throw new Error("Node cannot be null or undefined")
return{dom:n}},st={fromHtml:function(n,t){var e=(t||document).createElement("div")
if(e.innerHTML=n,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node")
return ft(e.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n)
return ft(e)},fromText:function(n,t){var e=(t||document).createTextNode(n)
return ft(e)},fromDom:ft,fromPoint:function(n,t,e){return y.from(n.dom.elementFromPoint(t,e)).map(ft)}},lt=function(n,t){var e=n.dom
if(1!==e.nodeType)return!1
var r=e
if(void 0!==r.matches)return r.matches(t)
if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(t)
if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(t)
if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(t)
throw new Error("Browser lacks native selectors")},dt=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},mt=function(n,t){var e=void 0===t?document:t.dom
return dt(e)?[]:R(e.querySelectorAll(n),st.fromDom)},gt=function(n,t){var e=void 0===t?document:t.dom
return dt(e)?y.none():y.from(e.querySelector(n)).map(st.fromDom)},pt=function(n,t){return n.dom===t.dom},vt=("undefined"!=typeof window?window:Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),ht=function(n){return function(t){return function(n){return n.dom.nodeType}(t)===n}},yt=ht(1),bt=ht(3),xt=ht(9),wt=ht(11),St=function(n){return st.fromDom(n.dom.ownerDocument)},Ot=function(n){return xt(n)?n:St(n)},Tt=function(n){return y.from(n.dom.parentNode).map(st.fromDom)},kt=function(n){return R(n.dom.childNodes,st.fromDom)},Et=function(n,t){var e=n.dom.childNodes
return y.from(e[t]).map(st.fromDom)},Ct=function(n,t){Tt(n).each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},Mt=function(n,t){(function(n){return y.from(n.dom.nextSibling).map(st.fromDom)})(n).fold((function(){Tt(n).each((function(n){_t(n,t)}))}),(function(n){Ct(n,t)}))},Dt=function(n,t){(function(n){return Et(n,0)})(n).fold((function(){_t(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},_t=function(n,t){n.dom.appendChild(t.dom)},It=function(n,t){V(t,(function(t){_t(n,t)}))},Ft=function(n){n.dom.textContent="",V(kt(n),(function(n){Rt(n)}))},Rt=function(n){var t=n.dom
null!==t.parentNode&&t.parentNode.removeChild(t)},Vt=E(Element.prototype.attachShadow)&&E(Node.prototype.getRootNode),Bt=i(Vt),At=Vt?function(n){return st.fromDom(n.dom.getRootNode())}:Ot,jt=function(n){var t=At(n)
return wt(t)?y.some(t):y.none()},Nt=function(n){return st.fromDom(n.dom.host)},Pt=function(n){return k(n.dom.shadowRoot)},Ht=function(n){var t=bt(n)?n.dom.parentNode:n.dom
if(null==t||null===t.ownerDocument)return!1
var e,r,o=t.ownerDocument
return jt(st.fromDom(t)).fold((function(){return o.body.contains(t)}),(e=Ht,r=Nt,function(n){return e(r(n))}))},zt=function(){return Lt(st.fromDom(document))},Lt=function(n){var t=n.dom.body
if(null==t)throw new Error("Body is not available yet")
return st.fromDom(t)},Gt=function(n){ot(n,nt())
var t=n.components()
V(t,Gt)},$t=function(n){var t=n.components()
V(t,$t),ot(n,Zn())},Ut=function(n,t){_t(n.element,t.element)},Wt=function(n,t){var e=n.components();(function(n){V(n.components(),(function(n){return Rt(n.element)})),Ft(n.element),n.syncComponents()})(n)
var r=$(e,t)
V(r,(function(t){Gt(t),n.getSystem().removeFromWorld(t)})),V(t,(function(t){t.getSystem().isConnected()?Ut(n,t):(n.getSystem().addToWorld(t),Ut(n,t),Ht(n.element)&&$t(t)),n.syncComponents()}))},Xt=function(n,t,e){n.getSystem().addToWorld(t),e(n.element,t.element),Ht(n.element)&&$t(t),n.syncComponents()},qt=function(n){var t=Tt(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}));(function(n){Gt(n),Rt(n.element),n.getSystem().removeFromWorld(n)})(n),t.each((function(n){n.syncComponents()}))},Yt=function(n,t,e){e(n,t.element)
var r=kt(t.element)
V(r,(function(n){t.getByDom(n).each($t)}))},Kt=Object.keys,Jt=Object.hasOwnProperty,Qt=function(n,t){for(var e=Kt(n),r=0,o=e.length;r<o;r++){var i=e[r]
t(n[i],i)}},Zt=function(n,t){return ne(n,(function(n,e){return{k:e,v:t(n,e)}}))},ne=function(n,t){var e={}
return Qt(n,(function(n,r){var o=t(n,r)
e[o.k]=o.v})),e},te=function(n,t){var e={}
return function(n,t,e,r){Qt(n,(function(n,o){(t(n,o)?e:r)(n,o)}))}(n,t,function(n){return function(t,e){n[e]=t}}(e),r),e},ee=function(n,t){var e=[]
return Qt(n,(function(n,r){e.push(t(n,r))})),e},re=function(n,t){return oe(n,t)?y.from(n[t]):y.none()},oe=function(n,t){return Jt.call(n,t)},ie=function(n,t){return oe(n,t)&&void 0!==n[t]&&null!==n[t]},ue=function(n,t,e){if(!(w(e)||T(e)||C(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple")
n.setAttribute(t,e+"")},ce=function(n,t,e){ue(n.dom,t,e)},ae=function(n,t){var e=n.dom
Qt(t,(function(n,t){ue(e,t,n)}))},fe=function(n,t){var e=n.dom.getAttribute(t)
return null===e?void 0:e},se=function(n,t){return y.from(fe(n,t))},le=function(n,t){var e=n.dom
return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},de=function(n,t){n.dom.removeAttribute(t)},me=function(n,t){var e=fe(n,t)
return void 0===e||""===e?[]:e.split(" ")},ge=function(n){return void 0!==n.dom.classList},pe=function(n,t){return function(n,t,e){var r=me(n,t).concat([e])
return ce(n,t,r.join(" ")),!0}(n,"class",t)},ve=function(n,t){return function(n,t,e){var r=B(me(n,t),(function(n){return n!==e}))
return r.length>0?ce(n,t,r.join(" ")):de(n,t),!1}(n,"class",t)},he=function(n,t){ge(n)?n.dom.classList.add(t):pe(n,t)},ye=function(n){0===(ge(n)?n.dom.classList:function(n){return me(n,"class")}(n)).length&&de(n,"class")},be=function(n,t){ge(n)?n.dom.classList.remove(t):ve(n,t)
ye(n)},xe=function(n,t){return ge(n)&&n.dom.classList.contains(t)},we=function(n,t,e){be(n,e),he(n,t)},Se=Object.freeze({__proto__:null,toAlpha:function(n,t,e){we(n.element,t.alpha,t.omega)},toOmega:function(n,t,e){we(n.element,t.omega,t.alpha)},isAlpha:function(n,t,e){return xe(n.element,t.alpha)},isOmega:function(n,t,e){return xe(n.element,t.omega)},clear:function(n,t,e){be(n.element,t.alpha),be(n.element,t.omega)}}),Oe=function(n){return{is:function(t){return n===t},isValue:m,isError:d,getOr:i(n),getOrThunk:i(n),getOrDie:i(n),or:function(t){return Oe(n)},orThunk:function(t){return Oe(n)},fold:function(t,e){return e(n)},map:function(t){return Oe(t(n))},mapError:function(t){return Oe(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return y.some(n)}}},Te=function(n){return{is:d,isValue:d,isError:m,getOr:u,getOrThunk:function(n){return n()},getOrDie:function(){return s(String(n))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return Te(n)},mapError:function(t){return Te(t(n))},each:r,bind:function(t){return Te(n)},exists:d,forall:m,toOptional:y.none}},ke={value:Oe,error:Te,fromOption:function(n,t){return n.fold((function(){return Te(t)}),Oe)}};(function(n){n[n.Error=0]="Error",n[n.Value=1]="Value"})(a||(a={}))
var Ee,Ce,Me,De=function(n,t,e){return n.stype===a.Error?t(n.serror):e(n.svalue)},_e=function(n){return{stype:a.Value,svalue:n}},Ie=function(n){return{stype:a.Error,serror:n}},Fe=function(n){return n.fold(Ie,_e)},Re=function(n){return De(n,ke.error,ke.value)},Ve=_e,Be=function(n){var t=[],e=[]
return V(n,(function(n){De(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},Ae=Ie,je=function(n,t){return n.stype===a.Value?t(n.svalue):n},Ne=function(n,t){return n.stype===a.Error?t(n.serror):n},Pe=function(n,t){return n.stype===a.Value?{stype:a.Value,svalue:t(n.svalue)}:n},He=function(n,t){return n.stype===a.Error?{stype:a.Error,serror:t(n.serror)}:n},ze=function(n){if(!O(n))throw new Error("cases must be an array")
if(0===n.length)throw new Error("there must be at least one case")
var t=[],e={}
return V(n,(function(r,o){var i=Kt(r)
if(1!==i.length)throw new Error("one and only one name per case")
var u=i[0],c=r[u]
if(void 0!==e[u])throw new Error("duplicate key detected:"+u)
if("cata"===u)throw new Error("cannot have a case named cata (sorry)")
if(!O(c))throw new Error("case arguments must be an array")
t.push(u),e[u]=function(){var e=arguments.length
if(e!==c.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+c.length+" ("+c+"), got "+e)
for(var r=new Array(e),i=0;i<r.length;i++)r[i]=arguments[i]
var a=function(n){var e=Kt(n)
if(t.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+e.join(","))
if(!L(t,(function(n){return I(e,n)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+t.join(", "))
return n[u].apply(null,r)}
return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length)
var t=arguments[o]
return t.apply(null,r)},match:a,log:function(n){console.log(n,{constructors:t,constructor:u,params:r})}}}})),e},Le=Object.prototype.hasOwnProperty,Ge=function(n){return function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e]
if(0===t.length)throw new Error("Can't merge zero objects")
for(var r={},o=0;o<t.length;o++){var i=t[o]
for(var u in i)Le.call(i,u)&&(r[u]=n(r[u],i[u]))}return r}},$e=Ge((function(n,t){return S(n)&&S(t)?$e(n,t):t})),Ue=Ge((function(n,t){return t})),We=ze([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Xe=function(n){return We.defaultedThunk(i(n))},qe=function(n){return We.mergeWithThunk(i(n))},Ye=We.strict,Ke=We.asOption,Je=We.defaultedThunk,Qe=(We.asDefaultedOptionThunk,We.mergeWithThunk),Ze=(ze([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,t){var e
return(e={})[n]=t,e}),nr=function(n,t){return function(n,t){var e={}
return Qt(n,(function(n,r){I(t,r)||(e[r]=n)})),e}(n,t)},tr=function(n,t){return Ze(n,t)},er=function(n){return function(n){var t={}
return V(n,(function(n){t[n.key]=n.value})),t}(n)},rr=function(n,t){var e,r=function(n){var t=[],e=[]
return V(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}(n)
return r.errors.length>0?(e=r.errors,ke.error(H(e))):function(n,t){return 0===n.length?ke.value(t):ke.value($e(t,Ue.apply(void 0,n)))}(r.values,t)},or=function(n){return o(Ae,H)(n)},ir=function(n,t){var e=Be(n)
return e.errors.length>0?or(e.errors):function(n,t){return n.length>0?Ve($e(t,Ue.apply(void 0,n))):Ve(t)}(e.values,t)},ur=function(n){var t=Be(n)
return t.errors.length>0?or(t.errors):Ve(t.values)},cr=function(n){return S(n)&&Kt(n).length>100?" removed due to size":JSON.stringify(n,null,2)},ar=function(n,t){return Ae([{path:n,getErrorInfo:t}])},fr=ze([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),sr=function(n,t,e){return re(t,e).fold((function(){return function(n,t,e){return ar(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+cr(e)}))}(n,e,t)}),Ve)},lr=function(n,t,e){var r=re(n,t).fold((function(){return e(n)}),u)
return Ve(r)},dr=function(n,t,e,r){return e.fold((function(e,o,u,c){var a=function(t){var i=c.extract(n.concat([e]),r,t)
return Pe(i,(function(n){return Ze(o,r(n))}))},f=function(t){return t.fold((function(){var n=Ze(o,r(y.none()))
return Ve(n)}),(function(t){var i=c.extract(n.concat([e]),r,t)
return Pe(i,(function(n){return Ze(o,r(y.some(n)))}))}))}
return u.fold((function(){return je(sr(n,t,e),a)}),(function(n){return je(lr(t,e,n),a)}),(function(){return je(function(n,t){return Ve(re(n,t))}(t,e),f)}),(function(n){return je(function(n,t,e){var r=re(n,t).map((function(t){return!0===t?e(n):t}))
return Ve(r)}(t,e,n),f)}),(function(n){var r=n(t),o=Pe(lr(t,e,i({})),(function(n){return $e(r,n)}))
return je(o,a)}))}),(function(n,e){var o=e(t)
return Ve(Ze(n,r(o)))}))},mr=function(n){return{extract:function(t,e,r){return Ne(n(r,e),(function(n){return function(n,t){return ar(n,(function(){return t}))}(t,n)}))},toString:function(){return"val"}}},gr=function(n){return Kt(te(n,(function(n){return null!=n})))},pr=function(n){var t=vr(n),e=A(n,(function(n,t){return t.fold((function(t){return $e(n,tr(t,!0))}),i(n))}),{})
return{extract:function(n,r,o){var i=T(o)?[]:gr(o),u=B(i,(function(n){return!ie(e,n)}))
return 0===u.length?t.extract(n,r,o):function(n,t){return ar(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))}(n,u)},toString:t.toString}},vr=function(n){return{extract:function(t,e,r){return function(n,t,e,r){var o=R(e,(function(e){return dr(n,t,e,r)}))
return ir(o,{})}(t,r,n,e)},toString:function(){return"obj{\n"+R(n,(function(n){return n.fold((function(n,t,e,r){return n+" -> "+r.toString()}),(function(n,t){return"state("+n+")"}))})).join("\n")+"}"}}},hr=function(n,t){var e=function(t,e){return function(n){return{extract:function(t,e,r){var o=R(r,(function(r,o){return n.extract(t.concat(["["+o+"]"]),e,r)}))
return ur(o)},toString:function(){return"array("+n.toString()+")"}}}(mr(n)).extract(t,u,e)}
return{extract:function(n,r,o){var i=Kt(o),u=e(n,i)
return je(u,(function(e){var i=R(e,(function(n){return fr.field(n,n,Ye(),t)}))
return vr(i).extract(n,r,o)}))},toString:function(){return"setOf("+t.toString()+")"}}},yr=i(mr(Ve)),br=fr.state,xr=fr.field,wr=function(n,t,e,r,o){return re(r,o).fold((function(){return function(n,t,e){return ar(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+cr(t)}))}(n,r,o)}),(function(r){return r.extract(n.concat(["branch: "+o]),t,e)}))},Sr=function(n,t){return{extract:function(e,r,o){return re(o,n).fold((function(){return function(n,t){return ar(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))}(e,n)}),(function(n){return wr(e,r,o,t,n)}))},toString:function(){return"chooseOn("+n+"). Possible values: "+Kt(t)}}},Or=mr(Ve),Tr=function(n){return mr((function(t){return n(t).fold(Ae,Ve)}))},kr=function(n,t){return hr((function(t){return Fe(n(t))}),t)},Er=function(n,t,e){return Re(function(n,t,e,r){var o=t.extract([n],e,r)
return He(o,(function(n){return{input:r,errors:n}}))}(n,t,u,e))},Cr=function(n){return n.fold((function(n){throw new Error(Dr(n))}),u)},Mr=function(n,t,e){return Cr(Er(n,t,e))},Dr=function(n){return"Errors: \n"+(t=n.errors,e=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,R(e,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))).join("\n")+"\n\nInput object: "+cr(n.input)
var t,e},_r=function(n,t){return Sr(n,Zt(t,vr))},Ir=i(Or),Fr=(Ee=E,Ce="function",mr((function(n){var t=typeof n
return Ee(n)?Ve(n):Ae("Expected type: "+Ce+" but got: "+t)}))),Rr=function(n){return xr(n,n,Ye(),yr())},Vr=function(n,t){return xr(n,n,Ye(),t)},Br=function(n,t){return xr(n,n,Ye(),vr(t))},Ar=function(n){return xr(n,n,Ke(),yr())},jr=function(n,t){return xr(n,n,Ke(),t)},Nr=function(n,t){return jr(n,vr(t))},Pr=function(n,t){return jr(n,pr(t))},Hr=function(n,t){return xr(n,n,Xe(t),yr())},zr=function(n,t,e){return xr(n,n,Xe(t),e)},Lr=function(n,t){return br(n,t)},Gr=[Rr("alpha"),Rr("omega")],$r=function(n){return E(n)?n:d},Ur=function(n,t,e){var r=t(n),o=$r(e)
return r.orThunk((function(){return o(n)?y.none():function(n,t,e){for(var r=n.dom,o=$r(e);r.parentNode;){r=r.parentNode
var i=st.fromDom(r),u=t(i)
if(u.isSome())return u
if(o(i))break}return y.none()}(n,t,o)}))},Wr=function(n,t){return pt(n.element,t.event.target)},Xr=function(n){if(!ie(n,"can")&&!ie(n,"abort")&&!ie(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!")
return Mr("Extracting event.handler",pr([Hr("can",m),Hr("abort",d),Hr("run",r)]),n)},qr=function(n){var t=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r]
return j(n,(function(n,r){return n&&t(r).apply(void 0,e)}),!0)}}(n,(function(n){return n.can})),e=function(n,t){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r]
return j(n,(function(n,r){return n||t(r).apply(void 0,e)}),!1)}}(n,(function(n){return n.abort}))
return Xr({can:t,abort:e,run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]
V(n,(function(n){n.run.apply(void 0,t)}))}})},Yr=function(n){return er(n)},Kr=function(n,t){return{key:n,value:Xr({abort:t})}},Jr=function(n,t){return{key:n,value:Xr({run:t})}},Qr=function(n,t,e){return{key:n,value:Xr({run:function(n,r){t.apply(void 0,[n,r].concat(e))}})}},Zr=function(n){return function(t){return{key:n,value:Xr({run:function(n,e){Wr(n,e)&&t(n,e)}})}}},no=function(n,t,e){return function(n,t){return Jr(n,(function(e,r){e.getSystem().getByUid(t).each((function(t){(function(n,t,e,r){n.getSystem().triggerEvent(e,t,r.event)})(t,t.element,n,r)}))}))}(n,t.partUids[e])},to=function(n){return Jr(n,(function(n,t){t.cut()}))},eo=function(n){return Jr(n,(function(n,t){t.stop()}))},ro=function(n,t){return Zr(n)(t)},oo=Zr(Zn()),io=Zr(nt()),uo=Zr(Qn()),co=function(n){return function(t){return Jr(n,t)}}(qn()),ao=function(n){return R(n,(function(n){return function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t}(t=n,e="/*",t.length-e.length)?n.substring(0,n.length-"/*".length):n
var t,e}))},fo=function(n,t){var e=n.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/)
return n.toFunctionAnnotation=function(){return{name:t,parameters:ao(i)}},n},so=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},lo=function(n,t,e){return uo((function(r,o){e(r,n,t)}))},mo=function(n,t,e){return function(n,t,e){var r=e.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/)
return n.toFunctionAnnotation=function(){return{name:t,parameters:ao(u.slice(0,1).concat(u.slice(3)))}},n}((function(r){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u]
var c=[r].concat(o)
return r.config({name:i(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(c,1)
return t.apply(void 0,[r,n.config,n.state].concat(e))}))}),e,t)},go=function(n){return{key:n,value:void 0}},po=function(t,e,r,o,i,u,a){var f=function(n){return ie(n,r)?n[r]():y.none()},s=Zt(i,(function(n,t){return mo(r,n,t)})),l=Zt(u,(function(n,t){return fo(n,t)})),d=n(n(n({},l),s),{revoke:c(go,r),config:function(n){var e=Mr(r+"-config",t,n)
return{key:r,value:{config:e,me:d,configAsRaw:g((function(){return Mr(r+"-config",t,n)})),initialConfig:n,state:a}}},schema:function(){return e},exhibit:function(n,t){return f(n).bind((function(n){return re(o,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(so({}))},name:function(){return r},handlers:function(n){return f(n).map((function(n){return re(o,"events").getOr((function(){return{}}))(n.config,n.state)})).getOr({})}})
return d},vo={init:function(){return ho({readState:function(){return"No State required"}})}},ho=function(n){return n},yo=function(n){return er(n)},bo=pr([Rr("fields"),Rr("name"),Hr("active",{}),Hr("apis",{}),Hr("state",vo),Hr("extra",{})]),xo=function(n){var t=Mr("Creating behaviour: "+n.name,bo,n)
return function(n,t,e,r,o,i){var u=pr(n),c=Nr(t,[Pr("config",n)])
return po(u,c,t,e,r,o,i)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)},wo=pr([Rr("branchKey"),Rr("branches"),Rr("name"),Hr("active",{}),Hr("apis",{}),Hr("state",vo),Hr("extra",{})]),So=i(void 0),Oo=xo({fields:Gr,name:"swapping",apis:Se}),To=function(n){var t=n
return{get:function(){return t},set:function(n){t=n}}},ko=function(n){return n.dom.focus()},Eo=function(n){return n.dom.blur()},Co=function(n){return void 0===n&&(n=st.fromDom(document)),y.from(n.dom.activeElement).map(st.fromDom)},Mo=function(n){return Co(At(n)).filter((function(t){return n.dom.contains(t.dom)}))},Do=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),_o=tinymce.util.Tools.resolve("tinymce.ThemeManager"),Io=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}],Fo=["undo","bold","italic","link","image","bullist","styleselect"],Ro="formatChanged",Vo="orientationChanged",Bo="dropupDismissed",Ao=function(n){return n.dom.innerHTML},jo=function(n,t){var e,r,o=St(n).dom,i=st.fromDom(o.createDocumentFragment()),u=(e=t,(r=(o||document).createElement("div")).innerHTML=e,kt(st.fromDom(r)))
It(i,u),Ft(n),_t(n,i)},No=function(n){return function(n,t){return st.fromDom(n.dom.cloneNode(t))}(n,!1)},Po=function(n){return function(n){var t=st.fromTag("div"),e=st.fromDom(n.dom.cloneNode(!0))
return _t(t,e),Ao(t)}(No(n))},Ho=function(n){return Po(n)},zo=Object.freeze({__proto__:null,events:function(n){return Yr([Jr(Xn(),(function(t,e){var r=n.channels,o=Kt(r),i=e,u=function(n,t){return t.universal?n:B(n,(function(n){return I(t.channels,n)}))}(o,i)
V(u,(function(n){var e=r[n],o=e.schema,u=Mr("channel["+n+"] data\nReceiver: "+Ho(t.element),o,i.data)
e.onReceive(t,u)}))}))])}}),Lo="unknown";(function(n){n[n.STOP=0]="STOP",n[n.NORMAL=1]="NORMAL",n[n.LOGGING=2]="LOGGING"})(Me||(Me={}))
var Go,$o=To({}),Uo=function(n,t,e){switch(re($o.get(),n).orThunk((function(){var t=Kt($o.get())
return X(t,(function(t){return n.indexOf(t)>-1?y.some($o.get()[t]):y.none()}))})).getOr(Me.NORMAL)){case Me.NORMAL:return e(qo())
case Me.LOGGING:var r=function(n,t){var e=[],r=(new Date).getTime()
return{logEventCut:function(n,t,r){e.push({outcome:"cut",target:t,purpose:r})},logEventStopped:function(n,t,r){e.push({outcome:"stopped",target:t,purpose:r})},logNoParent:function(n,t,r){e.push({outcome:"no-parent",target:t,purpose:r})},logEventNoHandlers:function(n,t){e.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,r){e.push({outcome:"response",purpose:r,target:t})},write:function(){var o=(new Date).getTime()
I(["mousemove","mouseover","mouseout",Qn()],n)||console.log(n,{event:n,time:o-r,target:t.dom,sequence:R(e,(function(n){return I(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Ho(n.target)+")":n.outcome}))})}}}(n,t),o=e(r)
return r.write(),o
case Me.STOP:return!0}},Wo=["alloy/data/Fields","alloy/debugging/Debugging"],Xo=function(n,t,e){return Uo(n,t,e)},qo=i({logEventCut:r,logEventStopped:r,logNoParent:r,logEventNoHandlers:r,logEventResponse:r,write:r}),Yo=i([Rr("menu"),Rr("selectedMenu")]),Ko=i([Rr("item"),Rr("selectedItem")]),Jo=(i(vr(Ko().concat(Yo()))),i(vr(Ko()))),Qo=Br("initSize",[Rr("numColumns"),Rr("numRows")]),Zo=function(n,t,e){(function(){var n=new Error
if(void 0!==n.stack){var t=n.stack.split("\n")
return N(t,(function(n){return n.indexOf("alloy")>0&&!F(Wo,(function(t){return n.indexOf(t)>-1}))})).getOr(Lo)}})()
return xr(t,t,e,Tr((function(n){return ke.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]
return n.apply(void 0,t)}))})))},ni=function(n){return Zo(0,n,Xe(r))},ti=function(n){return Zo(0,n,Xe(y.none))},ei=function(n){return Zo(0,n,Ye())},ri=function(n){return Zo(0,n,Ye())},oi=function(n,t){return Lr(n,i(t))},ii=function(n){return Lr(n,u)},ui=i(Qo),ci=[Vr("channels",kr(ke.value,pr([ei("onReceive"),Hr("schema",Ir())])))],ai=xo({fields:ci,name:"receiving",active:zo}),fi=function(n,t,e){var r=t.aria
r.update(n,r,e.get())},si=function(n,t,e){t.toggleClass.each((function(t){e.get()?he(n.element,t):be(n.element,t)}))},li=function(n,t,e){gi(n,t,e,!e.get())},di=function(n,t,e){e.set(!0),si(n,t,e),fi(n,t,e)},mi=function(n,t,e){e.set(!1),si(n,t,e),fi(n,t,e)},gi=function(n,t,e,r){(r?di:mi)(n,t,e)},pi=function(n,t,e){gi(n,t,e,t.selected)},vi=Object.freeze({__proto__:null,onLoad:pi,toggle:li,isOn:function(n,t,e){return e.get()},on:di,off:mi,set:gi}),hi=Object.freeze({__proto__:null,exhibit:function(){return so({})},events:function(n,t){var e,r,o,i=(e=n,r=t,o=li,co((function(n){o(n,e,r)}))),u=lo(n,t,pi)
return Yr(H([n.toggleOnExecute?[i]:[],[u]]))}}),yi=function(n,t,e){ce(n.element,"aria-expanded",e)},bi=[Hr("selected",!1),Ar("toggleClass"),Hr("toggleOnExecute",!0),zr("aria",{mode:"none"},_r("mode",{pressed:[Hr("syncWithExpanded",!1),oi("update",(function(n,t,e){ce(n.element,"aria-pressed",e),t.syncWithExpanded&&yi(n,t,e)}))],checked:[oi("update",(function(n,t,e){ce(n.element,"aria-checked",e)}))],expanded:[oi("update",yi)],selected:[oi("update",(function(n,t,e){ce(n.element,"aria-selected",e)}))],none:[oi("update",r)]}))],xi=xo({fields:bi,name:"toggling",active:hi,apis:vi,state:(Go=!1,{init:function(){var n=To(Go)
return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(Go)},readState:function(){return n.get()}}}})}),wi=function(n,t){return ai.config({channels:tr(Ro,{onReceive:function(e,r){r.command===n&&t(e,r.state)}})})},Si=function(n){return ai.config({channels:tr(Vo,{onReceive:n})})},Oi=function(n,t){return{key:n,value:{onReceive:t}}},Ti="tinymce-mobile",ki=function(n){return Ti+"-"+n},Ei=function(){var n=function(n,t){t.stop(),ut(n)}
return[Jr(Pn(),n),Jr(Kn(),n),to(Mn()),to(In())]},Ci=function(n,t){t.ignore||(ko(n.element),t.onFocus(n))},Mi=Object.freeze({__proto__:null,focus:Ci,blur:function(n,t){t.ignore||Eo(n.element)},isFocused:function(n){return function(n){var t=At(n).dom
return n.dom===t.activeElement}(n.element)}}),Di=Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}}
return so(e)},events:function(n){return Yr([Jr($n(),(function(t,e){Ci(t,n),e.stop()}))].concat(n.stopMousedown?[Jr(In(),(function(n,t){t.event.prevent()}))]:[]))}}),_i=[ni("onFocus"),Hr("stopMousedown",!1),Hr("ignore",!1)],Ii=xo({fields:_i,name:"focusing",active:Di,apis:Mi}),Fi=function(n){return void 0!==n.style&&E(n.style.getPropertyValue)},Ri=function(n,t,e){if(!w(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e)
Fi(n)&&n.style.setProperty(t,e)},Vi=function(n,t,e){var r=n.dom
Ri(r,t,e)},Bi=function(n,t){var e=n.dom
Qt(t,(function(n,t){Ri(e,t,n)}))},Ai=function(n,t){var e=n.dom,r=window.getComputedStyle(e).getPropertyValue(t)
return""!==r||Ht(n)?r:ji(e,t)},ji=function(n,t){return Fi(n)?n.style.getPropertyValue(t):""},Ni=function(n,t){var e=n.dom,r=ji(e,t)
return y.from(r).filter((function(n){return n.length>0}))},Pi=function(n,t){(function(n,t){Fi(n)&&n.style.removeProperty(t)})(n.dom,t),se(n,"style").map(tn).is("")&&de(n,"style")},Hi=function(n){return n.dom.offsetWidth}
function zi(n,t){var e=function(e){var r=t(e)
if(r<=0||null===r){var o=Ai(e,n)
return parseFloat(o)||0}return r},r=function(n,t){return j(t,(function(t,e){var r=Ai(n,e),o=void 0===r?0:parseInt(r,10)
return isNaN(o)?t:t+o}),0)}
return{set:function(t,e){if(!C(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e)
var r=t.dom
Fi(r)&&(r.style[n]=e+"px")},get:e,getOuter:e,aggregate:r,max:function(n,t,e){var o=r(n,e)
return t>o?t-o:0}}}var Li=zi("height",(function(n){var t=n.dom
return Ht(n)?t.getBoundingClientRect().height:t.offsetHeight})),Gi=function(n){return Li.get(n)},$i=function(n,t,e){return B(function(n,t){for(var e=E(t)?t:d,r=n.dom,o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=st.fromDom(i)
if(o.push(u),!0===e(u))break
r=i}return o}(n,e),t)},Ui=function(n,t){return B(function(n){return Tt(n).map(kt).map((function(t){return B(t,(function(t){return!pt(n,t)}))})).getOr([])}(n),t)},Wi=function(n,t,e){return $i(n,(function(n){return lt(n,t)}),e)},Xi=function(n,t){return mt(t,n)}
function qi(n,t,e,r,o){return n(e,r)?y.some(e):E(o)&&o(e)?y.none():t(e,r,o)}var Yi,Ki=function(n,t,e){for(var r=n.dom,o=E(e)?e:d;r.parentNode;){r=r.parentNode
var i=st.fromDom(r)
if(t(i))return y.some(i)
if(o(i))break}return y.none()},Ji=function(n){return gt(n)},Qi=function(n,t,e){return Ki(n,(function(n){return lt(n,t)}),e)},Zi=function(n,t){return gt(t,n)},nu=function(n,t,e){return qi((function(n,t){return lt(n,t)}),Qi,n,t,e)},tu=[8],eu=[9],ru=[13],ou=[27],iu=[32],uu=[37],cu=[38],au=[39],fu=[40],su=function(n,t,e){var r=G(n.slice(0,t)),o=G(n.slice(t+1))
return N(r.concat(o),e)},lu=function(n,t,e){var r=G(n.slice(0,t))
return N(r,e)},du=function(n,t,e){var r=n.slice(0,t),o=n.slice(t+1)
return N(o.concat(r),e)},mu=function(n,t,e){var r=n.slice(t+1)
return N(r,e)},gu=function(n){return function(t){var e=t.raw
return I(n,e.which)}},pu=function(n){return function(t){return L(n,(function(n){return n(t)}))}},vu=function(n){return!0===n.raw.shiftKey},hu=function(n){return!0===n.raw.ctrlKey},yu=f(vu),bu=function(n,t){return{matches:n,classification:t}},xu=function(n,t,e,r){var o=n+t
return o>r?e:o<e?r:o},wu=function(n,t,e){return Math.min(Math.max(n,t),e)},Su=function(n){for(var t=[],e=function(n){t.push(n)},r=0;r<n.length;r++)n[r].each(e)
return t},Ou=function(n,t,e,r){var o=Xi(n.element,"."+t.highlightClass)
V(o,(function(e){F(r,(function(n){return n.element===e}))||(be(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),ot(e,rt())})))}))},Tu=function(n,t,e,r){Ou(n,t,0,[r]),ku(n,t,e,r)||(he(r.element,t.highlightClass),t.onHighlight(n,r),ot(r,et()))},ku=function(n,t,e,r){return xe(r.element,t.highlightClass)},Eu=function(n,t,e,r){var o=Xi(n.element,"."+t.itemClass)
return y.from(o[r]).fold((function(){return ke.error("No element found with index "+r)}),n.getSystem().getByDom)},Cu=function(n,t,e){return Zi(n.element,"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Mu=function(n,t,e){var r=Xi(n.element,"."+t.itemClass)
return(r.length>0?y.some(r[r.length-1]):y.none()).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Du=function(n,t,e,r){var o=Xi(n.element,"."+t.itemClass)
return P(o,(function(n){return xe(n,t.highlightClass)})).bind((function(t){var e=xu(t,r,0,o.length-1)
return n.getSystem().getByDom(o[e]).toOptional()}))},_u=function(n,t,e){var r=Xi(n.element,"."+t.itemClass)
return Su(R(r,(function(t){return n.getSystem().getByDom(t).toOptional()})))},Iu=Object.freeze({__proto__:null,dehighlightAll:function(n,t,e){return Ou(n,t,0,[])},dehighlight:function(n,t,e,r){ku(n,t,e,r)&&(be(r.element,t.highlightClass),t.onDehighlight(n,r),ot(r,rt()))},highlight:Tu,highlightFirst:function(n,t,e){Cu(n,t).each((function(r){Tu(n,t,e,r)}))},highlightLast:function(n,t,e){Mu(n,t).each((function(r){Tu(n,t,e,r)}))},highlightAt:function(n,t,e,r){Eu(n,t,e,r).fold((function(n){throw new Error(n)}),(function(r){Tu(n,t,e,r)}))},highlightBy:function(n,t,e,r){var o=_u(n,t)
N(o,r).each((function(r){Tu(n,t,e,r)}))},isHighlighted:ku,getHighlighted:function(n,t,e){return Zi(n.element,"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},getFirst:Cu,getLast:Mu,getPrevious:function(n,t,e){return Du(n,t,0,-1)},getNext:function(n,t,e){return Du(n,t,0,1)},getCandidates:_u}),Fu=[Rr("highlightClass"),Rr("itemClass"),ni("onHighlight"),ni("onDehighlight")],Ru=xo({fields:Fu,name:"highlighting",apis:Iu}),Vu=function(n,t,e){t.exists((function(n){return e.exists((function(t){return pt(t,n)}))}))||it(n,tt(),{prevFocus:t,newFocus:e})},Bu=function(){var n=function(n){return Mo(n.element)}
return{get:n,set:function(t,e){var r=n(t)
t.getSystem().triggerFocus(e,t.element)
var o=n(t)
Vu(t,r,o)}}},Au=function(){var n=function(n){return Ru.getHighlighted(n).map((function(n){return n.element}))}
return{get:n,set:function(t,e){var o=n(t)
t.getSystem().getByDom(e).fold(r,(function(n){Ru.highlight(t,n)}))
var i=n(t)
Vu(t,o,i)}}};(function(n){n.OnFocusMode="onFocus",n.OnEnterOrSpaceMode="onEnterOrSpace",n.OnApiMode="onApi"})(Yi||(Yi={}))
var ju=function(n,t,e,r,o){var i=function(n,t,e,r,o){var i,u,c=e(n,t,r,o)
return(i=c,u=t.event,N(i,(function(n){return n.matches(u)})).map((function(n){return n.classification}))).bind((function(e){return e(n,t,r,o)}))},u={schema:function(){return n.concat([Hr("focusManager",Bu()),zr("focusInside","onFocus",Tr((function(n){return I(["onFocus","onEnterOrSpace","onApi"],n)?ke.value(n):ke.error("Invalid value for focusInside")}))),oi("handler",u),oi("state",t),oi("sendFocusIn",o)])},processKey:i,toEvents:function(n,t){var u=n.focusInside!==Yi.OnFocusMode?y.none():o(n).map((function(e){return Jr($n(),(function(r,o){e(r,n,t),o.stop()}))})),c=[Jr(Bn(),(function(r,u){i(r,u,e,n,t).fold((function(){(function(e,r){var i=gu(iu.concat(ru))(r.event)
n.focusInside===Yi.OnEnterOrSpaceMode&&i&&Wr(e,r)&&o(n).each((function(o){o(e,n,t),r.stop()}))})(r,u)}),(function(n){u.stop()}))})),Jr(An(),(function(e,o){i(e,o,r,n,t).each((function(n){o.stop()}))}))]
return Yr(u.toArray().concat(c))}}
return u},Nu=function(n){var t=[Ar("onEscape"),Ar("onEnter"),Hr("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Hr("firstTabstop",0),Hr("useTabstopAt",m),Ar("visibilitySelector")].concat([n]),e=function(n,t){var e=n.visibilitySelector.bind((function(n){return nu(t,n)})).getOr(t)
return Gi(e)>0},r=function(n,t,r){(function(n,t){var r=Xi(n.element,t.selector),o=B(r,(function(n){return e(t,n)}))
return y.from(o[t.firstTabstop])})(n,t).each((function(e){t.focusManager.set(n,e)}))},o=function(n,t,r,o,i){return i(t,r,(function(n){return function(n,t){return e(n,t)&&n.useTabstopAt(t)}(o,n)})).fold((function(){return o.cyclic?y.some(!0):y.none()}),(function(t){return o.focusManager.set(n,t),y.some(!0)}))},u=function(n,t,e,r){var i=Xi(n.element,e.selector)
return function(n,t){return t.focusManager.get(n).bind((function(n){return nu(n,t.selector)}))}(n,e).bind((function(t){return P(i,c(pt,t)).bind((function(t){return o(n,i,t,e,r)}))}))},a=i([bu(pu([vu,gu(eu)]),(function(n,t,e){var r=e.cyclic?su:lu
return u(n,0,e,r)})),bu(gu(eu),(function(n,t,e){var r=e.cyclic?du:mu
return u(n,0,e,r)})),bu(gu(ou),(function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))})),bu(pu([yu,gu(ru)]),(function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))}))]),f=i([])
return ju(t,vo.init,a,f,(function(){return y.some(r)}))},Pu=Nu(Lr("cyclic",d)),Hu=Nu(Lr("cyclic",m)),zu=function(n){return"input"===vt(n)&&"radio"!==fe(n,"type")||"textarea"===vt(n)},Lu=function(n,t,e){return zu(e)&&gu(iu)(t.event)?y.none():function(n,t,e){return ct(n,e,qn()),y.some(!0)}(n,0,e)},Gu=function(n,t){return y.some(!0)},$u=[Hr("execute",Lu),Hr("useSpace",!1),Hr("useEnter",!0),Hr("useControlEnter",!1),Hr("useDown",!1)],Uu=function(n,t,e){return e.execute(n,t,n.element)},Wu=ju($u,vo.init,(function(n,t,e,r){var o=e.useSpace&&!zu(n.element)?iu:[],i=e.useEnter?ru:[],u=e.useDown?fu:[],c=o.concat(i).concat(u)
return[bu(gu(c),Uu)].concat(e.useControlEnter?[bu(pu([hu,gu(ru)]),Uu)]:[])}),(function(n,t,e,r){return e.useSpace&&!zu(n.element)?[bu(gu(iu),Gu)]:[]}),(function(){return y.none()})),Xu=function(){var n=To(y.none())
return ho({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(y.some({numRows:t,numColumns:e}))},getNumRows:function(){return n.get().map((function(n){return n.numRows}))},getNumColumns:function(){return n.get().map((function(n){return n.numColumns}))}})},qu=Object.freeze({__proto__:null,flatgrid:Xu,init:function(n){return n.state(n)}}),Yu=function(n,t){return function(e){return"rtl"===Ku(e)?t:n}},Ku=function(n){return"rtl"===Ai(n,"direction")?"rtl":"ltr"},Ju=function(n){return function(t,e,r,o){var i=n(t.element)
return tc(i,t,e,r,o)}},Qu=function(n,t){var e=Yu(n,t)
return Ju(e)},Zu=function(n,t){var e=Yu(t,n)
return Ju(e)},nc=function(n){return function(t,e,r,o){return tc(n,t,e,r,o)}},tc=function(n,t,e,r,o){return r.focusManager.get(t).bind((function(e){return n(t.element,e,r,o)})).map((function(n){return r.focusManager.set(t,n),!0}))},ec=nc,rc=nc,oc=nc,ic=function(n){return!function(n){return n.offsetWidth<=0&&n.offsetHeight<=0}(n.dom)},uc=function(n,t,e){var r=Xi(n,e)
return function(n,t){return P(n,t).map((function(t){return{index:t,candidates:n}}))}(B(r,ic),(function(n){return pt(n,t)}))},cc=function(n,t){return P(n,(function(n){return pt(t,n)}))},ac=function(n,t,e,r){return r(Math.floor(t/e),t%e).bind((function(t){var r=t.row*e+t.column
return r>=0&&r<n.length?y.some(n[r]):y.none()}))},fc=function(n,t,e,r,o){return ac(n,t,r,(function(t,i){var u=t===e-1?n.length-t*r:r,c=xu(i,o,0,u-1)
return y.some({row:t,column:c})}))},sc=function(n,t,e,r,o){return ac(n,t,r,(function(t,i){var u=xu(t,o,0,e-1),c=u===e-1?n.length-u*r:r,a=wu(i,0,c-1)
return y.some({row:u,column:a})}))},lc=[Rr("selector"),Hr("execute",Lu),ti("onEscape"),Hr("captureTab",!1),ui()],dc=function(n,t,e){Zi(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},mc=function(n){return function(t,e,r,o){return uc(t,e,r.selector).bind((function(t){return n(t.candidates,t.index,o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))}))}},gc=function(n,t,e){return e.captureTab?y.some(!0):y.none()},pc=mc((function(n,t,e,r){return fc(n,t,e,r,-1)})),vc=mc((function(n,t,e,r){return fc(n,t,e,r,1)})),hc=mc((function(n,t,e,r){return sc(n,t,e,r,-1)})),yc=mc((function(n,t,e,r){return sc(n,t,e,r,1)})),bc=i([bu(gu(uu),Qu(pc,vc)),bu(gu(au),Zu(pc,vc)),bu(gu(cu),ec(hc)),bu(gu(fu),rc(yc)),bu(pu([vu,gu(eu)]),gc),bu(pu([yu,gu(eu)]),gc),bu(gu(ou),(function(n,t,e){return e.onEscape(n,t)})),bu(gu(iu.concat(ru)),(function(n,t,e,r){return function(n,t){return t.focusManager.get(n).bind((function(n){return nu(n,t.selector)}))}(n,e).bind((function(r){return e.execute(n,t,r)}))}))]),xc=i([bu(gu(iu),Gu)]),wc=ju(lc,Xu,bc,xc,(function(){return y.some(dc)})),Sc=function(n,t,e,r){var o=function(n,t,e){var i,u=xu(t,r,0,e.length-1)
return u===n?y.none():(i=e[u],"button"===vt(i)&&"disabled"===fe(i,"disabled")?o(n,u,e):y.from(e[u]))}
return uc(n,e,t).bind((function(n){var t=n.index,e=n.candidates
return o(t,t,e)}))},Oc=[Rr("selector"),Hr("getInitial",y.none),Hr("execute",Lu),ti("onEscape"),Hr("executeOnMove",!1),Hr("allowVertical",!0)],Tc=function(n,t,e){return function(n,t){return t.focusManager.get(n).bind((function(n){return nu(n,t.selector)}))}(n,e).bind((function(r){return e.execute(n,t,r)}))},kc=function(n,t,e){t.getInitial(n).orThunk((function(){return Zi(n.element,t.selector)})).each((function(e){t.focusManager.set(n,e)}))},Ec=function(n,t,e){return Sc(n,e.selector,t,-1)},Cc=function(n,t,e){return Sc(n,e.selector,t,1)},Mc=function(n){return function(t,e,r,o){return n(t,e,r,o).bind((function(){return r.executeOnMove?Tc(t,e,r):y.some(!0)}))}},Dc=function(n,t,e){return e.onEscape(n,t)},_c=i([bu(gu(iu),Gu)]),Ic=ju(Oc,vo.init,(function(n,t,e,r){var o=uu.concat(e.allowVertical?cu:[]),i=au.concat(e.allowVertical?fu:[])
return[bu(gu(o),Mc(Qu(Ec,Cc))),bu(gu(i),Mc(Zu(Ec,Cc))),bu(gu(ru),Tc),bu(gu(iu),Tc),bu(gu(ou),Dc)]}),_c,(function(){return y.some(kc)})),Fc=function(n,t,e){return y.from(n[t]).bind((function(n){return y.from(n[e]).map((function(n){return{rowIndex:t,columnIndex:e,cell:n}}))}))},Rc=function(n,t,e,r){var o=n[t].length,i=xu(e,r,0,o-1)
return Fc(n,t,i)},Vc=function(n,t,e,r){var o=xu(e,r,0,n.length-1),i=n[o].length,u=wu(t,0,i-1)
return Fc(n,o,u)},Bc=function(n,t,e,r){var o=n[t].length,i=wu(e+r,0,o-1)
return Fc(n,t,i)},Ac=function(n,t,e,r){var o=wu(e+r,0,n.length-1),i=n[o].length,u=wu(t,0,i-1)
return Fc(n,o,u)},jc=[Br("selectors",[Rr("row"),Rr("cell")]),Hr("cycles",!0),Hr("previousSelector",y.none),Hr("execute",Lu)],Nc=function(n,t,e){t.previousSelector(n).orThunk((function(){var e=t.selectors
return Zi(n.element,e.cell)})).each((function(e){t.focusManager.set(n,e)}))},Pc=function(n,t){return function(e,r,o){var i=o.cycles?n:t
return nu(r,o.selectors.row).bind((function(n){var t=Xi(n,o.selectors.cell)
return cc(t,r).bind((function(t){var r=Xi(e,o.selectors.row)
return cc(r,n).bind((function(n){var e=function(n,t){return R(n,(function(n){return Xi(n,t.selectors.cell)}))}(r,o)
return i(e,n,t).map((function(n){return n.cell}))}))}))}))}},Hc=Pc((function(n,t,e){return Rc(n,t,e,-1)}),(function(n,t,e){return Bc(n,t,e,-1)})),zc=Pc((function(n,t,e){return Rc(n,t,e,1)}),(function(n,t,e){return Bc(n,t,e,1)})),Lc=Pc((function(n,t,e){return Vc(n,e,t,-1)}),(function(n,t,e){return Ac(n,e,t,-1)})),Gc=Pc((function(n,t,e){return Vc(n,e,t,1)}),(function(n,t,e){return Ac(n,e,t,1)})),$c=i([bu(gu(uu),Qu(Hc,zc)),bu(gu(au),Zu(Hc,zc)),bu(gu(cu),ec(Lc)),bu(gu(fu),rc(Gc)),bu(gu(iu.concat(ru)),(function(n,t,e){return Mo(n.element).bind((function(r){return e.execute(n,t,r)}))}))]),Uc=i([bu(gu(iu),Gu)]),Wc=ju(jc,vo.init,$c,Uc,(function(){return y.some(Nc)})),Xc=[Rr("selector"),Hr("execute",Lu),Hr("moveOnTab",!1)],qc=function(n,t,e){return e.focusManager.get(n).bind((function(r){return e.execute(n,t,r)}))},Yc=function(n,t,e){Zi(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},Kc=function(n,t,e){return Sc(n,e.selector,t,-1)},Jc=function(n,t,e){return Sc(n,e.selector,t,1)},Qc=i([bu(gu(cu),oc(Kc)),bu(gu(fu),oc(Jc)),bu(pu([vu,gu(eu)]),(function(n,t,e,r){return e.moveOnTab?oc(Kc)(n,t,e,r):y.none()})),bu(pu([yu,gu(eu)]),(function(n,t,e,r){return e.moveOnTab?oc(Jc)(n,t,e,r):y.none()})),bu(gu(ru),qc),bu(gu(iu),qc)]),Zc=i([bu(gu(iu),Gu)]),na=ju(Xc,vo.init,Qc,Zc,(function(){return y.some(Yc)})),ta=[ti("onSpace"),ti("onEnter"),ti("onShiftEnter"),ti("onLeft"),ti("onRight"),ti("onTab"),ti("onShiftTab"),ti("onUp"),ti("onDown"),ti("onEscape"),Hr("stopSpaceKeyup",!1),Ar("focusIn")],ea=ju(ta,vo.init,(function(n,t,e){return[bu(gu(iu),e.onSpace),bu(pu([yu,gu(ru)]),e.onEnter),bu(pu([vu,gu(ru)]),e.onShiftEnter),bu(pu([vu,gu(eu)]),e.onShiftTab),bu(pu([yu,gu(eu)]),e.onTab),bu(gu(cu),e.onUp),bu(gu(fu),e.onDown),bu(gu(uu),e.onLeft),bu(gu(au),e.onRight),bu(gu(iu),e.onSpace),bu(gu(ou),e.onEscape)]}),(function(n,t,e){return e.stopSpaceKeyup?[bu(gu(iu),Gu)]:[]}),(function(n){return n.focusIn})),ra=Pu.schema(),oa=Hu.schema(),ia=Ic.schema(),ua=wc.schema(),ca=Wc.schema(),aa=Wu.schema(),fa=na.schema(),sa=ea.schema(),la=function(n){var t=Mr("Creating behaviour: "+n.name,wo,n)
return function(n,t,e,r,o,i){var u=n,c=Nr(t,[jr("config",n)])
return po(u,c,t,e,r,o,i)}(_r(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)}({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:ra,cyclic:oa,flow:ia,flatgrid:ua,matrix:ca,execution:aa,menu:fa,special:sa}),name:"keying",active:{events:function(n,t){return n.handler.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element,n.element)}),(function(r){r(n,t,e)}))},setGridSize:function(n,t,e,r,o){!function(n){return ie(n,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(r,o)}},state:qu}),da=function(n,t){return e=n,r={},o=R(t,(function(t){return e=t.name(),r="Cannot configure "+t.name()+" for "+n,xr(e,e,Ke(),mr((function(n){return Ae("The field: "+e+" is forbidden. "+r)})))
var e,r})).concat([Lr("dump",u)]),zr(e,r,vr(o))
var e,r,o},ma=function(n){return n.dump},ga=function(t,e){return n(n({},t.dump),yo(e))},pa=da,va=ga,ha="placeholder",ya=ze([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),ba=function(n){return oe(n,"uiType")},xa=function(n,t,e,r){return ba(e)&&e.uiType===ha?function(n,t,e,r){return n.exists((function(n){return n!==e.owner}))?ya.single(!0,i(e)):re(r,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+Kt(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))}(n,0,e,r):ya.single(!1,i(e))},wa=function(t,e,r,o){return xa(t,0,r,o).fold((function(i,u){var c=ba(r)?u(e,r.config,r.validated):u(e),a=re(c,"components").getOr([]),f=z(a,(function(n){return wa(t,e,n,o)}))
return[n(n({},c),{components:f})]}),(function(n,t){if(ba(r)){var o=t(e,r.config,r.validated)
return r.validated.preprocess.getOr(u)(o)}return t(e)}))},Sa=function(n,t,e,r){var o=Zt(r,(function(n,t){return r=n,o=!1,{name:i(e=t),required:function(){return r.fold((function(n,t){return n}),(function(n,t){return n}))},used:function(){return o},replace:function(){if(o)throw new Error("Trying to use the same placeholder more than once: "+e)
return o=!0,r}}
var e,r,o})),u=function(n,t,e,r){return z(e,(function(e){return wa(n,t,e,r)}))}(n,t,e,o)
return Qt(o,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),u},Oa=ya.single,Ta=ya.multiple,ka=i(ha),Ea=0,Ca=function(n){var t=(new Date).getTime()
return n+"_"+Math.floor(1e9*Math.random())+ ++Ea+String(t)},Ma=ze([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Da=Hr("factory",{sketch:u}),_a=Hr("schema",[]),Ia=Rr("name"),Fa=xr("pname","pname",Je((function(n){return"<alloy."+Ca(n.name)+">"})),Ir()),Ra=Lr("schema",(function(){return[Ar("preprocess")]})),Va=Hr("defaults",i({})),Ba=Hr("overrides",i({})),Aa=vr([Da,_a,Ia,Fa,Va,Ba]),ja=vr([Da,_a,Ia,Va,Ba]),Na=vr([Da,_a,Ia,Fa,Va,Ba]),Pa=vr([Da,Ra,Ia,Rr("unit"),Fa,Va,Ba]),Ha=function(n){var t=function(n){return n.name}
return n.fold(t,t,t,t)},za=function(n,t){return function(e){var r=Mr("Converting part type",t,e)
return n(r)}},La=za(Ma.required,Aa),Ga=(za(Ma.external,ja),za(Ma.optional,Na)),$a=za(Ma.group,Pa),Ua=i("entirety"),Wa=function(n,t,e,r){return $e(t.defaults(n,e,r),e,{uid:n.partUids[t.name]},t.overrides(n,e,r))},Xa=function(t,e){var r={}
return V(e,(function(e){(function(n){return n.fold(y.some,y.none,y.some,y.some)})(e).each((function(e){var o=qa(t,e.pname)
r[e.name]=function(r){var i=Mr("Part: "+e.name+" in "+t,vr(e.schema),r)
return n(n({},o),{config:r,validated:i})}}))})),r},qa=function(n,t){return{uiType:ka(),owner:n,name:t}},Ya=function(n,t,e){return function(n,t,e){var r={},o={}
return V(e,(function(n){n.fold((function(n){r[n.pname]=Oa(!0,(function(t,e,r){return n.factory.sketch(Wa(t,n,e,r))}))}),(function(n){var e=t.parts[n.name]
o[n.name]=i(n.factory.sketch(Wa(t,n,e[Ua()]),e))}),(function(n){r[n.pname]=Oa(!1,(function(t,e,r){return n.factory.sketch(Wa(t,n,e,r))}))}),(function(n){r[n.pname]=Ta(!0,(function(t,e,r){var o=t[n.name]
return R(o,(function(e){return n.factory.sketch($e(n.defaults(t,e,r),e,n.overrides(t,e)))}))}))}))})),{internals:i(r),externals:i(o)}}(0,t,e)},Ka=function(n,t,e){return Sa(y.some(n),t,t.components,e)},Ja=function(n,t,e){var r=t.partUids[e]
return n.getSystem().getByUid(r).toOptional()},Qa=function(n,t,e){return Ja(n,t,e).getOrDie("Could not find part: "+e)},Za=function(n,t){var e=function(n){return R(n,Ha)}(t)
return er(R(e,(function(t){return{key:t,value:n+"-"+t}})))},nf=function(n){return xr("partUids","partUids",Qe((function(t){return Za(t.uid,n)})),Ir())},tf=Ca("alloy-premade"),ef=function(n){return tr(tf,n)},rf=function(n){return function(n,t){var e=t.toString(),r=e.indexOf(")")+1,o=e.indexOf("("),i=e.substring(o+1,r-1).split(/,\s*/)
return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ao(i.slice(1))}},n}((function(t){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o]
return n.apply(void 0,e([t.getApis(),t],r))}),n)},of=i("alloy-id-"),uf=i("data-alloy-id"),cf=of(),af=uf(),ff=function(n,t){Object.defineProperty(n.dom,af,{value:t,writable:!0})},sf=function(n){var t=yt(n)?n.dom[af]:null
return y.from(t)},lf=function(n){return Ca(n)},df=function(n,t,e,r,o){var i=function(n,t){return(n.length>0?[Br("parts",n)]:[]).concat([Rr("uid"),Hr("dom",{}),Hr("components",[]),ii("originalSpec"),Hr("debug.sketcher",{})]).concat(t)}(r,o)
return Mr(n+" [SpecSchema]",pr(i.concat(t)),e)},mf=function(n,t,e,r,o){var i=gf(o),u=function(n){return z(n,(function(n){return n.fold(y.none,y.some,y.none,y.none).map((function(n){return Br(n.name,n.schema.concat([ii(Ua())]))})).toArray()}))}(e),c=nf(e),a=df(n,t,i,u,[c]),f=Ya(0,a,e)
return r(a,Ka(n,a,f.internals()),i,f.externals())},gf=function(t){return function(n){return oe(n,"uid")}(t)?t:n(n({},t),{uid:lf("uid")})}
var pf=pr([Rr("name"),Rr("factory"),Rr("configFields"),Hr("apis",{}),Hr("extraApis",{})]),vf=pr([Rr("name"),Rr("factory"),Rr("configFields"),Rr("partFields"),Hr("apis",{}),Hr("extraApis",{})]),hf=function(t){var e=Mr("Sketcher for "+t.name,pf,t),r=Zt(e.apis,rf),o=Zt(e.extraApis,(function(n,t){return fo(n,t)}))
return n(n({name:e.name,configFields:e.configFields,sketch:function(n){return function(n,t,e,r){var o=gf(r)
return e(df(n,t,o,[],[]),o)}(e.name,e.configFields,e.factory,n)}},r),o)},yf=function(t){var e=Mr("Sketcher for "+t.name,vf,t),r=Xa(e.name,e.partFields),o=Zt(e.apis,rf),i=Zt(e.extraApis,(function(n,t){return fo(n,t)}))
return n(n({name:e.name,partFields:e.partFields,configFields:e.configFields,sketch:function(n){return mf(e.name,e.configFields,e.partFields,e.factory,n)},parts:r},o),i)},bf=hf({name:"Button",factory:function(t){var e,r=(e=t.action,Yr(H([e.map((function(n){return co((function(t,e){n(t),e.stop()}))})).toArray(),Ei()]))),o=t.dom.tag,i=function(n){return re(t.dom,"attributes").bind((function(t){return re(t,n)}))}
return{uid:t.uid,dom:t.dom,components:t.components,events:r,behaviours:va(t.buttonBehaviours,[Ii.config({}),la.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===o){var t=i("type").getOr("button"),e=i("role").map((function(n){return{role:n}})).getOr({})
return n({type:t},e)}return{role:i("role").getOr("button")}}()},eventOrder:t.eventOrder}},configFields:[Hr("uid",void 0),Rr("dom"),Hr("components",[]),pa("buttonBehaviours",[Ii,la]),Ar("action"),Ar("role"),Hr("eventOrder",{})]}),xf=Object.freeze({__proto__:null,events:function(){return Yr([Kr(zn(),m)])},exhibit:function(){return so({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),wf=xo({fields:[],name:"unselecting",active:xf}),Sf=function(t){var e=st.fromHtml(t),r=kt(e),o=function(t){var e=void 0!==t.dom.attributes?t.dom.attributes:[]
return j(e,(function(t,e){var r
return"class"===e.name?t:n(n({},t),((r={})[e.name]=e.value,r))}),{})}(e),i=function(n){return Array.prototype.slice.call(n.dom.classList,0)}(e),u=0===r.length?{}:{innerHtml:Ao(e)}
return n({tag:vt(e),classes:i,attributes:o},u)},Of=function(n){var t,e=(t={prefix:Ti},n.replace(/\$\{([^{}]*)\}/g,(function(n,e){var r=t[e]
return function(n){var t=typeof n
return"string"===t||"number"===t}(r)?r.toString():n})))
return Sf(e)},Tf=function(n){return{dom:Of(n)}},kf=function(n){return yo([xi.config({toggleClass:ki("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),wi(n,(function(n,t){(t?xi.on:xi.off)(n)}))])},Ef=function(n,t,e,r){var o=kf(e)
return Mf(t,r,o,n)},Cf=function(n,t){var e=t.ui.registry.getAll().icons
return y.from(e[n]).fold((function(){return Of('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item ${prefix}-icon-'+n+' ${prefix}-icon"></span>')}),(function(n){return Of('<span class="${prefix}-toolbar-button ${prefix}-toolbar-group-item">'+n+"</span>")}))},Mf=function(n,t,e,r){return bf.sketch({dom:Cf(n,r),action:t,buttonBehaviours:$e(yo([wf.config({})]),e)})},Df=Ga({schema:[Rr("dom")],name:"label"}),_f=function(n){return Ga({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold((function(){return{}}),(function(n){return{events:Yr([Qr(Mn(),(function(t,e,r){return n(t,r)}),[t]),Qr(In(),(function(t,e,r){return n(t,r)}),[t]),Qr(Fn(),(function(t,e,r){r.mouseIsDown.get()&&n(t,r)}),[t])])}}))}})},If=_f("top-left"),Ff=_f("top"),Rf=_f("top-right"),Vf=_f("right"),Bf=_f("bottom-right"),Af=_f("bottom"),jf=_f("bottom-left"),Nf=[Df,_f("left"),Vf,Ff,Af,If,Rf,jf,Bf,La({name:"thumb",defaults:i({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Yr([no(Mn(),n,"spectrum"),no(Dn(),n,"spectrum"),no(_n(),n,"spectrum"),no(In(),n,"spectrum"),no(Fn(),n,"spectrum"),no(Rn(),n,"spectrum")])}}}),La({schema:[Lr("mouseIsDown",(function(){return To(!1)}))],name:"spectrum",overrides:function(n){var t=n.model.manager,e=function(e,r){return t.getValueFromEvent(r).map((function(r){return t.setValueFrom(e,n,r)}))}
return{behaviours:yo([la.config({mode:"special",onLeft:function(e){return t.onLeft(e,n)},onRight:function(e){return t.onRight(e,n)},onUp:function(e){return t.onUp(e,n)},onDown:function(e){return t.onDown(e,n)}}),Ii.config({})]),events:Yr([Jr(Mn(),e),Jr(Dn(),e),Jr(In(),e),Jr(Fn(),(function(t,r){n.mouseIsDown.get()&&e(t,r)}))])}}})],Pf=function(n,t,e){t.store.manager.onLoad(n,t,e)},Hf=function(n,t,e){t.store.manager.onUnload(n,t,e)},zf=Object.freeze({__proto__:null,onLoad:Pf,onUnload:Hf,setValue:function(n,t,e,r){t.store.manager.setValue(n,t,e,r)},getValue:function(n,t,e){return t.store.manager.getValue(n,t,e)},getState:function(n,t,e){return e}}),Lf=Object.freeze({__proto__:null,events:function(n,t){var e=n.resetOnDom?[oo((function(e,r){Pf(e,n,t)})),io((function(e,r){Hf(e,n,t)}))]:[lo(n,t,Pf)]
return Yr(e)}}),Gf=function(){var n=To(null)
return ho({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},$f=function(){var t=To({}),e=To({})
return ho({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:e.get()}},lookup:function(n){return re(t.get(),n).orThunk((function(){return re(e.get(),n)}))},update:function(r){var o=t.get(),i=e.get(),u={},c={}
V(r,(function(n){u[n.value]=n,re(n,"meta").each((function(t){re(t,"text").each((function(t){c[t]=n}))}))})),t.set(n(n({},o),u)),e.set(n(n({},i),c))},clear:function(){t.set({}),e.set({})}})},Uf=Object.freeze({__proto__:null,memory:Gf,dataset:$f,manual:function(){return ho({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),Wf=function(n,t,e,r){var o=t.store
e.update([r]),o.setValue(n,r),t.onSetValue(n,r)},Xf=[Ar("initialValue"),Rr("getFallbackEntry"),Rr("getDataKey"),Rr("setValue"),oi("manager",{setValue:Wf,getValue:function(n,t,e){var r=t.store,o=r.getDataKey(n)
return e.lookup(o).fold((function(){return r.getFallbackEntry(o)}),(function(n){return n}))},onLoad:function(n,t,e){t.store.initialValue.each((function(r){Wf(n,t,e,r)}))},onUnload:function(n,t,e){e.clear()},state:$f})],qf=[Rr("getValue"),Hr("setValue",r),Ar("initialValue"),oi("manager",{setValue:function(n,t,e,r){t.store.setValue(n,r),t.onSetValue(n,r)},getValue:function(n,t,e){return t.store.getValue(n)},onLoad:function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},onUnload:r,state:vo.init})],Yf=[Ar("initialValue"),oi("manager",{setValue:function(n,t,e,r){e.set(r),t.onSetValue(n,r)},getValue:function(n,t,e){return e.get()},onLoad:function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},onUnload:function(n,t,e){e.clear()},state:Gf})],Kf=[zr("store",{mode:"memory"},_r("mode",{memory:Yf,manual:qf,dataset:Xf})),ni("onSetValue"),Hr("resetOnDom",!1)],Jf=xo({fields:Kf,name:"representing",active:Lf,apis:zf,extra:{setValueFrom:function(n,t){var e=Jf.getValue(t)
Jf.setValue(n,e)}},state:Uf}),Qf=zi("width",(function(n){return n.dom.offsetWidth})),Zf=function(n,t){return Qf.set(n,t)},ns=function(n){return Qf.get(n)},ts=function(n,t){return{left:n,top:t,translate:function(e,r){return ts(n+e,t+r)}}},es=ts,rs=i("slider.change.value"),os=function(n){var t=n.event.raw
if(function(n){return-1!==n.type.indexOf("touch")}(t)){var e=t
return void 0!==e.touches&&1===e.touches.length?y.some(e.touches[0]).map((function(n){return es(n.clientX,n.clientY)})):y.none()}var r=t
return void 0!==r.clientX?y.some(r).map((function(n){return es(n.clientX,n.clientY)})):y.none()},is=function(n){return n.model.minX},us=function(n){return n.model.minY},cs=function(n){return n.model.minX-1},as=function(n){return n.model.minY-1},fs=function(n){return n.model.maxX},ss=function(n){return n.model.maxY},ls=function(n){return n.model.maxX+1},ds=function(n){return n.model.maxY+1},ms=function(n,t,e){return t(n)-e(n)},gs=function(n){return ms(n,fs,is)},ps=function(n){return ms(n,ss,us)},vs=function(n){return gs(n)/2},hs=function(n){return ps(n)/2},ys=function(n){return n.stepSize},bs=function(n){return n.snapToGrid},xs=function(n){return n.snapStart},ws=function(n){return n.rounded},Ss=function(n,t){return void 0!==n[t+"-edge"]},Os=function(n){return Ss(n,"left")},Ts=function(n){return Ss(n,"right")},ks=function(n){return Ss(n,"top")},Es=function(n){return Ss(n,"bottom")},Cs=function(n){return n.model.value.get()},Ms=function(n){return{x:n}},Ds=function(n){return{y:n}},_s=function(n,t){return{x:n,y:t}},Is=function(n,t){it(n,rs(),{value:t})},Fs=function(n,t,e,r){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-r)},Rs=function(n,t,e,r){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+r)},Vs=function(n,t,e){return Math.max(t,Math.min(e,n))},Bs=function(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.step,u=n.snap,c=n.snapStart,a=n.rounded,f=n.hasMinEdge,s=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=f?t-1:t,p=s?e+1:e
if(o<l)return g
if(o>d)return p
var v=function(n,t,e){return Math.min(e,Math.max(n,t))-t}(o,l,d),h=Vs(v/m*r+t,g,p)
return u&&h>=t&&h<=e?function(n,t,e,r,o){return o.fold((function(){var o=n-t,i=Math.round(o/r)*r
return Vs(t+i,t-1,e+1)}),(function(t){var o=(n-t)%r,i=Math.round(o/r),u=Math.floor((n-t)/r),c=Math.floor((e-t)/r),a=t+Math.min(c,u+i)*r
return Math.max(t,a)}))}(h,t,e,i,c):a?Math.round(h):h},As=function(n){var t=n.min,e=n.max,r=n.range,o=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,c=n.maxBound,a=n.maxOffset,f=n.centerMinEdge,s=n.centerMaxEdge
return o<t?i?0:f:o>e?u?c:s:(o-t)/r*a},js="top",Ns="right",Ps="bottom",Hs="left",zs=function(n){return n.element.dom.getBoundingClientRect()},Ls=function(n,t){return n[t]},Gs=function(n){var t=zs(n)
return Ls(t,Hs)},$s=function(n){var t=zs(n)
return Ls(t,Ns)},Us=function(n){var t=zs(n)
return Ls(t,js)},Ws=function(n){var t=zs(n)
return Ls(t,Ps)},Xs=function(n){var t=zs(n)
return Ls(t,"width")},qs=function(n){var t=zs(n)
return Ls(t,"height")},Ys=function(n,t,e){return(n+t)/2-e},Ks=function(n,t){var e=zs(n),r=zs(t),o=Ls(e,Hs),i=Ls(e,Ns),u=Ls(r,Hs)
return Ys(o,i,u)},Js=function(n,t){var e=zs(n),r=zs(t),o=Ls(e,js),i=Ls(e,Ps),u=Ls(r,js)
return Ys(o,i,u)},Qs=function(n,t){it(n,rs(),{value:t})},Zs=function(n){return{x:n}},nl=function(n,t,e){var r={min:is(t),max:fs(t),range:gs(t),value:e,step:ys(t),snap:bs(t),snapStart:xs(t),rounded:ws(t),hasMinEdge:Os(t),hasMaxEdge:Ts(t),minBound:Gs(n),maxBound:$s(n),screenRange:Xs(n)}
return Bs(r)},tl=function(n){return function(t,e){return function(n,t,e){var r=(n>0?Rs:Fs)(Cs(e).x,is(e),fs(e),ys(e))
return Qs(t,Zs(r)),y.some(r)}(n,t,e).map((function(){return!0}))}},el=function(n,t,e,r,o,i){var u=function(n,t,e,r,o){var i=Xs(n),u=r.bind((function(t){return y.some(Ks(t,n))})).getOr(0),c=o.bind((function(t){return y.some(Ks(t,n))})).getOr(i),a={min:is(t),max:fs(t),range:gs(t),value:e,hasMinEdge:Os(t),hasMaxEdge:Ts(t),minBound:Gs(n),minOffset:0,maxBound:$s(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c}
return As(a)}(t,i,e,r,o)
return Gs(t)-Gs(n)+u},rl=tl(-1),ol=tl(1),il=y.none,ul=y.none,cl={"top-left":y.none(),top:y.none(),"top-right":y.none(),right:y.some((function(n,t){Is(n,Ms(ls(t)))})),"bottom-right":y.none(),bottom:y.none(),"bottom-left":y.none(),left:y.some((function(n,t){Is(n,Ms(cs(t)))}))},al=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=nl(n,t,e),o=Zs(r)
return Qs(n,o),r},setToMin:function(n,t){var e=is(t)
Qs(n,Zs(e))},setToMax:function(n,t){var e=fs(t)
Qs(n,Zs(e))},findValueOfOffset:nl,getValueFromEvent:function(n){return os(n).map((function(n){return n.left}))},findPositionOfValue:el,setPositionFromValue:function(n,t,e,r){var o=Cs(e),i=el(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),e),u=ns(t.element)/2
Vi(t.element,"left",i-u+"px")},onLeft:rl,onRight:ol,onUp:il,onDown:ul,edgeActions:cl}),fl=function(n,t){it(n,rs(),{value:t})},sl=function(n){return{y:n}},ll=function(n,t,e){var r={min:us(t),max:ss(t),range:ps(t),value:e,step:ys(t),snap:bs(t),snapStart:xs(t),rounded:ws(t),hasMinEdge:ks(t),hasMaxEdge:Es(t),minBound:Us(n),maxBound:Ws(n),screenRange:qs(n)}
return Bs(r)},dl=function(n){return function(t,e){return function(n,t,e){var r=(n>0?Rs:Fs)(Cs(e).y,us(e),ss(e),ys(e))
return fl(t,sl(r)),y.some(r)}(n,t,e).map((function(){return!0}))}},ml=function(n,t,e,r,o,i){var u=function(n,t,e,r,o){var i=qs(n),u=r.bind((function(t){return y.some(Js(t,n))})).getOr(0),c=o.bind((function(t){return y.some(Js(t,n))})).getOr(i),a={min:us(t),max:ss(t),range:ps(t),value:e,hasMinEdge:ks(t),hasMaxEdge:Es(t),minBound:Us(n),minOffset:0,maxBound:Ws(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:c}
return As(a)}(t,i,e,r,o)
return Us(t)-Us(n)+u},gl=y.none,pl=y.none,vl=dl(-1),hl=dl(1),yl={"top-left":y.none(),top:y.some((function(n,t){Is(n,Ds(as(t)))})),"top-right":y.none(),right:y.none(),"bottom-right":y.none(),bottom:y.some((function(n,t){Is(n,Ds(ds(t)))})),"bottom-left":y.none(),left:y.none()},bl=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=ll(n,t,e),o=sl(r)
return fl(n,o),r},setToMin:function(n,t){var e=us(t)
fl(n,sl(e))},setToMax:function(n,t){var e=ss(t)
fl(n,sl(e))},findValueOfOffset:ll,getValueFromEvent:function(n){return os(n).map((function(n){return n.top}))},findPositionOfValue:ml,setPositionFromValue:function(n,t,e,r){var o=Cs(e),i=ml(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),e),u=Gi(t.element)/2
Vi(t.element,"top",i-u+"px")},onLeft:gl,onRight:pl,onUp:vl,onDown:hl,edgeActions:yl}),xl=function(n,t){it(n,rs(),{value:t})},wl=function(n,t){return{x:n,y:t}},Sl=function(n,t){return function(e,r){return function(n,t,e,r){var o=n>0?Rs:Fs,i=t?Cs(r).x:o(Cs(r).x,is(r),fs(r),ys(r)),u=t?o(Cs(r).y,us(r),ss(r),ys(r)):Cs(r).y
return xl(e,wl(i,u)),y.some(i)}(n,t,e,r).map((function(){return!0}))}},Ol=Sl(-1,!1),Tl=Sl(1,!1),kl=Sl(-1,!0),El=Sl(1,!0),Cl={"top-left":y.some((function(n,t){Is(n,_s(cs(t),as(t)))})),top:y.some((function(n,t){Is(n,_s(vs(t),as(t)))})),"top-right":y.some((function(n,t){Is(n,_s(ls(t),as(t)))})),right:y.some((function(n,t){Is(n,_s(ls(t),hs(t)))})),"bottom-right":y.some((function(n,t){Is(n,_s(ls(t),ds(t)))})),bottom:y.some((function(n,t){Is(n,_s(vs(t),ds(t)))})),"bottom-left":y.some((function(n,t){Is(n,_s(cs(t),ds(t)))})),left:y.some((function(n,t){Is(n,_s(cs(t),hs(t)))}))},Ml=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var r=nl(n,t,e.left),o=ll(n,t,e.top),i=wl(r,o)
return xl(n,i),i},setToMin:function(n,t){var e=is(t),r=us(t)
xl(n,wl(e,r))},setToMax:function(n,t){var e=fs(t),r=ss(t)
xl(n,wl(e,r))},getValueFromEvent:function(n){return os(n)},setPositionFromValue:function(n,t,e,r){var o=Cs(e),i=el(n,r.getSpectrum(n),o.x,r.getLeftEdge(n),r.getRightEdge(n),e),u=ml(n,r.getSpectrum(n),o.y,r.getTopEdge(n),r.getBottomEdge(n),e),c=ns(t.element)/2,a=Gi(t.element)/2
Vi(t.element,"left",i-c+"px"),Vi(t.element,"top",u-a+"px")},onLeft:Ol,onRight:Tl,onUp:kl,onDown:El,edgeActions:Cl}),Dl=[Hr("stepSize",1),Hr("onChange",r),Hr("onChoose",r),Hr("onInit",r),Hr("onDragStart",r),Hr("onDragEnd",r),Hr("snapToGrid",!1),Hr("rounded",!0),Ar("snapStart"),Vr("model",_r("mode",{x:[Hr("minX",0),Hr("maxX",100),Lr("value",(function(n){return To(n.mode.minX)})),Rr("getInitialValue"),oi("manager",al)],y:[Hr("minY",0),Hr("maxY",100),Lr("value",(function(n){return To(n.mode.minY)})),Rr("getInitialValue"),oi("manager",bl)],xy:[Hr("minX",0),Hr("maxX",100),Hr("minY",0),Hr("maxY",100),Lr("value",(function(n){return To({x:n.mode.minX,y:n.mode.minY})})),Rr("getInitialValue"),oi("manager",Ml)]})),da("sliderBehaviours",[la,Jf]),Lr("mouseIsDown",(function(){return To(!1)}))],_l=i("mouse.released"),Il=yf({name:"Slider",configFields:Dl,partFields:Nf,factory:function(n,t,e,r){var o,i=function(t){return Qa(t,n,"thumb")},u=function(t){return Qa(t,n,"spectrum")},c=function(t){return Ja(t,n,"left-edge")},a=function(t){return Ja(t,n,"right-edge")},f=function(t){return Ja(t,n,"top-edge")},s=function(t){return Ja(t,n,"bottom-edge")},l=n.model,d=l.manager,g=function(t,e){d.setPositionFromValue(t,e,n,{getLeftEdge:c,getRightEdge:a,getTopEdge:f,getBottomEdge:s,getSpectrum:u})},p=function(t,e){l.value.set(e)
var r=i(t)
return g(t,r),n.onChange(t,r,e),y.some(!0)},v=function(t){var e=n.mouseIsDown.get()
n.mouseIsDown.set(!1),e&&Ja(t,n,"thumb").each((function(e){var r=l.value.get()
n.onChoose(t,e,r)}))},h=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,i(t))},b=function(t,e){e.stop(),n.onDragEnd(t,i(t)),v(t)}
return{uid:n.uid,dom:n.dom,components:t,behaviours:ga(n.sliderBehaviours,[la.config({mode:"special",focusIn:function(t){return Ja(t,n,"spectrum").map(la.focusIn).map(m)}}),Jf.config({store:{mode:"manual",getValue:function(n){return l.value.get()}}}),ai.config({channels:(o={},o[_l()]={onReceive:v},o)})]),events:Yr([Jr(rs(),(function(n,t){p(n,t.event.value)})),oo((function(t,e){var r=l.getInitialValue()
l.value.set(r)
var o=i(t)
g(t,o)
var c=u(t)
n.onInit(t,o,c,l.value.get())})),Jr(Mn(),h),Jr(_n(),b),Jr(In(),h),Jr(Rn(),b)]),apis:{resetToMin:function(t){d.setToMin(t,n)},resetToMax:function(t){d.setToMax(t,n)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),Fl=function(n,t,e,r){return Mf(t,(function(){var r=e()
n.setContextToolbar([{label:t+" group",items:r}])}),{},r)},Rl=function(n){var t=function(n){return n<0?"black":n>360?"white":"hsl("+n+", 100%, 50%)"}
return Il.sketch({dom:Of('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'),components:[Il.parts["left-edge"](Tf('<div class="${prefix}-hue-slider-black"></div>')),Il.parts.spectrum({dom:Of('<div class="${prefix}-slider-gradient-container"></div>'),components:[Tf('<div class="${prefix}-slider-gradient"></div>')],behaviours:yo([xi.config({toggleClass:ki("thumb-active")})])}),Il.parts["right-edge"](Tf('<div class="${prefix}-hue-slider-white"></div>')),Il.parts.thumb({dom:Of('<div class="${prefix}-slider-thumb"></div>'),behaviours:yo([xi.config({toggleClass:ki("thumb-active")})])})],onChange:function(e,r,o){var i=t(o.x())
Vi(r.element,"background-color",i),n.onChange(e,r,i)},onDragStart:function(n,t){xi.on(t)},onDragEnd:function(n,t){xi.off(t)},onInit:function(n,e,r,o){var i=t(o.x())
Vi(e.element,"background-color",i)},stepSize:10,model:{mode:"x",minX:0,maxX:360,getInitialValue:function(){return{x:n.getInitialValue()}}},sliderBehaviours:yo([Si(Il.refresh)])})},Vl=function(n,t){var e={onChange:function(n,e,r){t.undoManager.transact((function(){t.formatter.apply("forecolor",{value:r}),t.nodeChanged()}))},getInitialValue:function(){return-1}}
return Fl(n,"color-levels",(function(){return function(n){return[Rl(n)]}(e)}),t)},Bl=["9px","10px","11px","12px","14px","16px","18px","20px","24px","32px","36px"],Al=function(n,t){return(yt(t)?y.some(t):Tt(t).filter(yt)).map((function(t){return function(n,t,e){return qi((function(n,t){return t(n)}),Ki,n,t,e)}(t,(function(n){return Ni(n,"font-size").isSome()}),n).bind((function(n){return Ni(n,"font-size")})).getOrThunk((function(){return Ai(t,"font-size")}))})).getOr("")},jl=function(n){var t=n.selection.getStart(),e=st.fromDom(t),r=st.fromDom(n.getBody()),o=Al((function(n){return pt(r,n)}),e)
return N(Bl,(function(n){return o===n})).getOr("medium")},Nl=function(n){return function(n){return P(Bl,(function(t){return t===n}))}(jl(n)).getOr(2)},Pl=function(n,t){(function(n){return y.from(Bl[n])})(t).each((function(t){(function(n,t){jl(n)!==t&&n.execCommand("fontSize",!1,t)})(n,t)}))},Hl=i(Bl),zl=pr([Rr("getInitialValue"),Rr("onChange"),Rr("category"),Rr("sizes")]),Ll=function(n){var t=Mr("SizeSlider",zl,n)
return Il.sketch({dom:{tag:"div",classes:[ki("slider-"+t.category+"-size-container"),ki("slider"),ki("slider-size-container")]},onChange:function(n,e,r){var o=r.x();(function(n){return n>=0&&n<t.sizes.length})(o)&&t.onChange(o)},onDragStart:function(n,t){xi.on(t)},onDragEnd:function(n,t){xi.off(t)},model:{mode:"x",minX:0,maxX:t.sizes.length-1,getInitialValue:function(){return{x:t.getInitialValue()}}},stepSize:1,snapToGrid:!0,sliderBehaviours:yo([Si(Il.refresh)]),components:[Il.parts.spectrum({dom:Of('<div class="${prefix}-slider-size-container"></div>'),components:[Tf('<div class="${prefix}-slider-size-line"></div>')]}),Il.parts.thumb({dom:Of('<div class="${prefix}-slider-thumb"></div>'),behaviours:yo([xi.config({toggleClass:ki("thumb-active")})])})]})},Gl=Hl(),$l=function(n){return Ll({onChange:n.onChange,sizes:Gl,category:"font",getInitialValue:n.getInitialValue})},Ul=function(n){return[Tf('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'),$l(n),Tf('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]},Wl=function(t){var e=function(n){return void 0!==n.uid}(t)&&ie(t,"uid")?t.uid:lf("memento")
return{get:function(n){return n.getSystem().getByUid(e).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(e).toOptional()},asSpec:function(){return n(n({},t),{uid:e})}}},Xl=window.Promise?window.Promise:function(){var n=function(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new")
if("function"!=typeof n)throw new TypeError("not a function")
this._state=null,this._value=null,this._deferreds=[],s(n,r(u,this),r(c,this))},t=window,e=n.immediateFn||"function"==typeof t.setImmediate&&t.setImmediate||function(n){setTimeout(n,1)}
function r(n,t){return function(){return n.apply(t,arguments)}}var o=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)}
function i(n){var t=this
null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected
if(null!==e){var r
try{r=e(t._value)}catch(o){return void n.reject(o)}n.resolve(r)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.")
if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then
if("function"==typeof t)return void s(r(t,n),r(u,this),r(c,this))}this._state=!0,this._value=n,a.call(this)}catch(e){c.call(this,e)}}function c(n){this._state=!1,this._value=n,a.call(this)}function a(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n]
i.call(this,e)}this._deferreds=[]}function f(n,t,e,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=r}function s(n,t,e){var r=!1
try{n((function(n){r||(r=!0,t(n))}),(function(n){r||(r=!0,e(n))}))}catch(o){if(r)return
r=!0,e(o)}}return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var r=this
return new n((function(n,o){i.call(r,new f(t,e,n,o))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]
var r=Array.prototype.slice.call(1===t.length&&o(t[0])?t[0]:t)
return new n((function(n,t){if(0===r.length)return n([])
var e=r.length
function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then
if("function"==typeof c)return void c.call(u,(function(n){o(i,n)}),t)}r[i]=u,0==--e&&n(r)}catch(a){t(a)}}for(var i=0;i<r.length;i++)o(i,r[i])}))},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var r=0,o=t;r<o.length;r++){o[r].then(n,e)}}))},n}()
function ql(n){return function(n){return new Xl((function(t){var e=new FileReader
e.onloadend=function(){t(e.result)},e.readAsDataURL(n)}))}(n).then((function(n){return n.split(",")[1]}))}var Yl,Kl,Jl=function(n,t){(function(n){return ql(n)})(t).then((function(e){n.undoManager.transact((function(){var r=n.editorUpload.blobCache,o=r.create(Ca("mceu"),t,e)
r.add(o)
var i=n.dom.createHTML("img",{src:o.blobUri()})
n.insertContent(i)}))}))},Ql=function(n){var t=Wl({dom:{tag:"input",attributes:{accept:"image/*",type:"file",title:""},styles:{visibility:"hidden",position:"absolute"}},events:Yr([to(Pn()),Jr(Nn(),(function(t,e){(function(n){var t=n.event.raw,e=t.target.files||t.dataTransfer.files
return y.from(e[0])})(e).each((function(t){Jl(n,t)}))}))])})
return bf.sketch({dom:Cf("image",n),components:[t.asSpec()],action:function(n){t.get(n).element.dom.click()}})},Zl=function(n){return n.dom.textContent},nd=function(n){return n.length>0},td=function(n){return null==n?"":n},ed=function(n){return id(n).fold((function(){return function(n){return{url:"",text:n.selection.getContent({format:"text"}),title:"",target:"",link:y.none()}}(n)}),(function(n){return function(n){var t=Zl(n),e=fe(n,"href"),r=fe(n,"title"),o=fe(n,"target")
return{url:td(e),text:t!==e?td(t):"",title:td(r),target:td(o),link:y.some(n)}}(n)}))},rd=function(n,t,e){return e.text.toOptional().filter(nd).fold((function(){return function(n){return fe(n,"href")===Zl(n)}(n)?y.some(t):y.none()}),y.some)},od=function(n,t){t.url.toOptional().filter(nd).fold((function(){(function(n,t){t.link.bind(u).each((function(t){n.execCommand("unlink")}))})(n,t)}),(function(e){var r=function(n,t){var e={}
return e.href=n,t.title.toOptional().filter(nd).each((function(n){e.title=n})),t.target.toOptional().filter(nd).each((function(n){e.target=n})),e}(e,t)
t.link.bind(u).fold((function(){var o=t.text.toOptional().filter(nd).getOr(e)
n.insertContent(n.dom.createHTML("a",r,n.dom.encode(o)))}),(function(n){var o=rd(n,e,t)
ae(n,r),o.each((function(t){(function(n,t){n.dom.textContent=t})(n,t)}))}))}))},id=function(n){var t=st.fromDom(n.selection.getStart())
return nu(t,"a")},ud=En(),cd=function(n,t){var e=t.selection.getRng()
n(),t.selection.setRng(e)},ad=function(n,t){return{key:n,value:{config:{},me:function(n,t){var e=Yr(t)
return xo({fields:[Rr("enabled")],name:n,active:{events:i(e)}})}(n,t),configAsRaw:i({}),initialConfig:{},state:vo}}},fd=Object.freeze({__proto__:null,getCurrent:function(n,t,e){return t.find(n)}}),sd=[Rr("find")],ld=xo({fields:sd,name:"composing",apis:fd}),dd=hf({name:"Container",factory:function(e){var r=e.dom,o=r.attributes,i=t(r,["attributes"])
return{uid:e.uid,dom:n({tag:"div",attributes:n({role:"presentation"},o)},i),components:e.components,behaviours:ma(e.containerBehaviours),events:e.events,domModification:e.domModification,eventOrder:e.eventOrder}},configFields:[Hr("components",[]),da("containerBehaviours",[]),Hr("events",{}),Hr("domModification",{}),Hr("eventOrder",{})]}),md=hf({name:"DataField",factory:function(n){return{uid:n.uid,dom:n.dom,behaviours:va(n.dataBehaviours,[Jf.config({store:{mode:"memory",initialValue:n.getInitialValue()}}),ld.config({find:y.some})]),events:Yr([oo((function(t,e){Jf.setValue(t,n.getInitialValue())}))])}},configFields:[Rr("uid"),Rr("dom"),Rr("getInitialValue"),pa("dataBehaviours",[Jf,ld])]}),gd=function(n){return n.dom.value},pd=function(n,t){if(void 0===t)throw new Error("Value.set was undefined")
n.dom.value=t},vd=i([Ar("data"),Hr("inputAttributes",{}),Hr("inputStyles",{}),Hr("tag","input"),Hr("inputClasses",[]),ni("onSetValue"),Hr("styles",{}),Hr("eventOrder",{}),da("inputBehaviours",[Jf,Ii]),Hr("selectOnFocus",!0)]),hd=function(t){return n(n({},function(n){return yo([Ii.config({onFocus:n.selectOnFocus?function(n){var t=n.element,e=gd(t)
t.dom.setSelectionRange(0,e.length)}:r})])}(t)),ga(t.inputBehaviours,[Jf.config({store:n(n({mode:"manual"},t.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return gd(n.element)},setValue:function(n,t){gd(n.element)!==t&&pd(n.element,t)}}),onSetValue:t.onSetValue})]))},yd=function(t){return{tag:t.tag,attributes:n({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},bd=hf({name:"Input",configFields:vd(),factory:function(n,t){return{uid:n.uid,dom:yd(n),components:[],behaviours:hd(n),eventOrder:n.eventOrder}}}),xd=Object.freeze({__proto__:null,exhibit:function(n,t){return so({attributes:er([{key:t.tabAttr,value:"true"}])})}}),wd=[Hr("tabAttr","data-alloy-tabstop")],Sd=xo({fields:wd,name:"tabstopping",active:xd}),Od=tinymce.util.Tools.resolve("tinymce.util.I18n"),Td=function(n,t){var e=Wl(bd.sketch({inputAttributes:{placeholder:Od.translate(t)},onSetValue:function(n,t){ot(n,jn())},inputBehaviours:yo([ld.config({find:y.some}),Sd.config({}),la.config({mode:"execution"})]),selectOnFocus:!1})),r=Wl(bf.sketch({dom:Of('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'),action:function(n){var t=e.get(n)
Jf.setValue(t,"")}}))
return{name:n,spec:dd.sketch({dom:Of('<div class="${prefix}-input-container"></div>'),components:[e.asSpec(),r.asSpec()],containerBehaviours:yo([xi.config({toggleClass:ki("input-container-empty")}),ld.config({find:function(n){return y.some(e.get(n))}}),ad("input-clearing",[Jr(jn(),(function(n){var t=e.get(n);(Jf.getValue(t).length>0?xi.off:xi.on)(n)}))])])})}},kd=function(n){return{name:n,spec:md.sketch({dom:{tag:"span",styles:{display:"none"}},getInitialValue:function(){return y.none()}})}},Ed=["input","button","textarea","select"],Cd=function(n,t,e){(t.disabled()?Rd:Vd)(n,t)},Md=function(n,t){return!0===t.useNative&&I(Ed,vt(n.element))},Dd=function(n){ce(n.element,"disabled","disabled")},_d=function(n){de(n.element,"disabled")},Id=function(n){ce(n.element,"aria-disabled","true")},Fd=function(n){ce(n.element,"aria-disabled","false")},Rd=function(n,t,e){t.disableClass.each((function(t){he(n.element,t)})),(Md(n,t)?Dd:Id)(n),t.onDisabled(n)},Vd=function(n,t,e){t.disableClass.each((function(t){be(n.element,t)})),(Md(n,t)?_d:Fd)(n),t.onEnabled(n)},Bd=function(n,t){return Md(n,t)?function(n){return le(n.element,"disabled")}(n):function(n){return"true"===fe(n.element,"aria-disabled")}(n)},Ad=Object.freeze({__proto__:null,enable:Vd,disable:Rd,isDisabled:Bd,onLoad:Cd,set:function(n,t,e,r){(r?Rd:Vd)(n,t)}}),jd=Object.freeze({__proto__:null,exhibit:function(n,t){return so({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(n,t){return Yr([Kr(qn(),(function(t,e){return Bd(t,n)})),lo(n,t,Cd)])}}),Nd=[(Yl="disabled",Kl=d,zr(Yl,Kl,Fr)),Hr("useNative",!0),Ar("disableClass"),ni("onDisabled"),ni("onEnabled")],Pd=xo({fields:Nd,name:"disabling",active:jd,apis:Ad}),Hd="form",zd=[da("formBehaviours",[Jf])],Ld=function(n){return"<alloy.field."+n+">"},Gd=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:ga(n.formBehaviours,[Jf.config({store:{mode:"manual",getValue:function(t){var e=function(n,t){var e=n.getSystem()
return Zt(t.partUids,(function(n,t){return i(e.getByUid(n))}))}(t,n)
return Zt(e,(function(n,t){return n().bind((function(n){var e,r,o=ld.getCurrent(n)
return e=o,r=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Ho(n.element)),e.fold((function(){return ke.error(r)}),ke.value)})).map(Jf.getValue)}))},setValue:function(t,e){Qt(e,(function(e,r){Ja(t,n,r).each((function(n){ld.getCurrent(n).each((function(n){Jf.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return Ja(t,n,e).bind(ld.getCurrent)}}}},$d=(rf((function(n,t,e){return n.getField(t,e)})),function(n){var t=function(){var n=[]
return{field:function(t,e){return n.push(t),function(n,t,e){return{uiType:ka(),owner:n,name:t,config:e,validated:{}}}(Hd,Ld(t),e)},record:function(){return n}}}(),e=n(t),r=t.record(),o=R(r,(function(n){return La({name:n,pname:Ld(n)})}))
return mf(Hd,zd,o,Gd,e)}),Ud=function(){var n=To(y.none()),t=function(){return n.get().each((function(n){return n.destroy()}))}
return{clear:function(){t(),n.set(y.none())},isSet:function(){return n.get().isSome()},set:function(e){t(),n.set(y.some(e))},run:function(t){return n.get().each(t)}}},Wd=function(){var n=To(y.none())
return{clear:function(){return n.set(y.none())},set:function(t){return n.set(y.some(t))},isSet:function(){return n.get().isSome()},on:function(t){return n.get().each(t)}}},Xd=function(n){var t="navigateEvent",e=vr([Rr("fields"),Hr("maxFieldIndex",n.fields.length-1),Rr("onExecute"),Rr("getInitialValue"),Lr("state",(function(){return{dialogSwipeState:Wd(),currentScreen:To(0)}}))]),r=Mr("SerialisedDialog",e,n),o=function(n,e,r){return bf.sketch({dom:Of('<span class="${prefix}-icon-'+e+' ${prefix}-icon"></span>'),action:function(e){it(e,t,{direction:n})},buttonBehaviours:yo([Pd.config({disableClass:ki("toolbar-navigation-disabled"),disabled:function(){return!r}})])})},i=function(n,t){var e=Xi(n.element,"."+ki("serialised-dialog-screen"))
Zi(n.element,"."+ki("serialised-dialog-chain")).each((function(n){r.state.currentScreen.get()+t>=0&&r.state.currentScreen.get()+t<e.length&&(Ni(n,"left").each((function(r){var o=parseInt(r,10),i=ns(e[0])
Vi(n,"left",o-t*i+"px")})),r.state.currentScreen.set(r.state.currentScreen.get()+t))}))},u=function(n){var t=Xi(n.element,"input")
y.from(t[r.state.currentScreen.get()]).each((function(t){n.getSystem().getByDom(t).each((function(t){var e,r
e=n,r=t.element,e.getSystem().triggerFocus(r,e.element)}))}))
var e=a.get(n)
Ru.highlightAt(e,r.state.currentScreen.get())},c=Wl($d((function(n){return{dom:Of('<div class="${prefix}-serialised-dialog"></div>'),components:[dd.sketch({dom:Of('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'),components:R(r.fields,(function(t,e){return e<=r.maxFieldIndex?dd.sketch({dom:Of('<div class="${prefix}-serialised-dialog-screen"></div>'),components:[o(-1,"previous",e>0),n.field(t.name,t.spec),o(1,"next",e<r.maxFieldIndex)]}):n.field(t.name,t.spec)}))})],formBehaviours:yo([Si((function(n,t){(function(n,t){Zi(n.element,"."+ki("serialised-dialog-chain")).each((function(n){Vi(n,"left",-r.state.currentScreen.get()*t.width+"px")}))})(n,t)})),la.config({mode:"special",focusIn:function(n,t){u(n)},onTab:function(n,t){return i(n,1),y.some(!0)},onShiftTab:function(n,t){return i(n,-1),y.some(!0)}}),ad("form-events",[oo((function(n,t){r.state.currentScreen.set(0),r.state.dialogSwipeState.clear()
var e=a.get(n)
Ru.highlightFirst(e),r.getInitialValue(n).each((function(t){Jf.setValue(n,t)}))})),co(r.onExecute),Jr(Hn(),(function(n,t){"left"===t.event.raw.propertyName&&u(n)})),Jr(t,(function(n,t){var e=t.event.direction
i(n,e)}))])])}}))),a=Wl({dom:Of('<div class="${prefix}-dot-container"></div>'),behaviours:yo([Ru.config({highlightClass:ki("dot-active"),itemClass:ki("dot-item")})]),components:z(r.fields,(function(n,t){return t<=r.maxFieldIndex?[Tf('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')]:[]}))})
return{dom:Of('<div class="${prefix}-serializer-wrapper"></div>'),components:[c.asSpec(),a.asSpec()],behaviours:yo([la.config({mode:"special",focusIn:function(n){var t=c.get(n)
la.focusIn(t)}}),ad("serializer-wrapper-events",[Jr(Mn(),(function(n,t){var e=t.event
r.state.dialogSwipeState.set(function(n){return{xValue:n,points:[]}}(e.raw.touches[0].clientX))})),Jr(Dn(),(function(n,t){var e=t.event
r.state.dialogSwipeState.on((function(n){t.event.prevent(),r.state.dialogSwipeState.set(function(n,t){if(t===n.xValue)return n
var e=t-n.xValue>0?1:-1,r={direction:e,xValue:t}
return{xValue:t,points:(0===n.points.length?[]:n.points[n.points.length-1].direction===e?n.points.slice(0,n.points.length-1):n.points).concat([r])}}(n,e.raw.touches[0].clientX))}))})),Jr(_n(),(function(n,t){r.state.dialogSwipeState.on((function(t){var e=c.get(n),r=-1*function(n){if(0===n.points.length)return 0
var t=n.points[0].direction,e=n.points[n.points.length-1].direction
return-1===t&&-1===e?-1:1===t&&1===e?1:0}(t)
i(e,r)}))}))])])}},qd=g((function(n,t){return[{label:"the link group",items:[Xd({fields:[Td("url","Type or paste URL"),Td("text","Link text"),Td("title","Link title"),Td("target","Link target"),kd("link")],maxFieldIndex:["url","text","title","target"].length-1,getInitialValue:function(){return y.some(ed(t))},onExecute:function(e,r){var o=Jf.getValue(e)
od(t,o),n.restoreToolbar(),t.focus()}})]}]})),Yd=function(n,t){return Ef(t,"link","link",(function(){var e=qd(n,t)
n.setContextToolbar(e),function(n,t){(ud.os.isAndroid()?cd:l)(t,n)}(t,(function(){n.focusToolbar()})),id(t).each((function(n){t.selection.select(n.dom)}))}))},Kd=Yr([function(n,t){return{key:n,value:Xr({can:t})}}($n(),(function(n,t){var e=t.event,r=e.originator,o=e.target
return!function(n,t,e){return pt(t,n.element)&&!pt(t,e)}(n,r,o)||(console.warn($n()+" did not get interpreted by the desired target. \nOriginator: "+Ho(r)+"\nTarget: "+Ho(o)+"\nCheck the "+$n()+" event handlers"),!1)}))]),Jd=Object.freeze({__proto__:null,events:Kd}),Qd=u,Zd=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+Ho(n().element)+" is not in context.":""))}}
return{debugInfo:i("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:d}},nm=Zd(),tm=function(n,t){var e={}
return Qt(n,(function(n,r){Qt(n,(function(n,o){var i=re(e,o).getOr([])
e[o]=i.concat([t(r,n)])}))})),e},em=function(n,t,e,r){try{var o=(i=e,u=function(e,o){var i=e[t],u=o[t],c=r.indexOf(i),a=r.indexOf(u)
if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2))
if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2))
return c<a?-1:a<c?1:0},(c=M.call(i,0)).sort(u),c)
return ke.value(o)}catch(a){return ke.error([a])}var i,u,c},rm=function(n){return n.cHandler},om=function(n,t){return{name:n,handler:t}},im=function(t,e,r){var o=n(n({},r),function(n,t){var e={}
return V(n,(function(n){e[n.name()]=n.handlers(t)})),e}(e,t))
return tm(o,om)},um=function(n){var t=function(n){return E(n)?{can:i(!0),abort:i(!1),run:n}:n}(n)
return function(n,e){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o]
var i=[n,e].concat(r)
t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},cm=function(n,t,e){var r=t[e]
return r?em("Event: "+e,"name",n,r).map((function(n){var t=R(n,(function(n){return n.handler}))
return qr(t)})):function(n,t){return ke.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(R(t,(function(n){return n.name})),null,2)])}(e,n)},am=function(n,t){var e=ee(n,(function(n,e){return(1===n.length?ke.value(n[0].handler):cm(n,t,e)).map((function(r){var o=um(r),i=n.length>1?B(t[e],(function(t){return F(n,(function(n){return n.name===t}))})).join(" > "):n[0].name
return tr(e,function(n,t){return{handler:n,purpose:t}}(o,i))}))}))
return rr(e,{})},fm="alloy.base.behaviour",sm=function(n){return n.events},lm=function(n,t){V(t,(function(t){he(n,t)}))},dm=function(n,t){V(t,(function(t){be(n,t)}))},mm=function(n,t){return function(n,t){var e=R(t,(function(n){return Nr(n.name(),[Rr("config"),Hr("state",vo)])})),r=Er("component.behaviours",vr(e),n.behaviours).fold((function(t){throw new Error(Dr(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}))
return{list:t,data:Zt(r,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}))
return function(){return t}}))}}(n,t)},gm=function(n){var t=function(n){var t=re(n,"behaviours").getOr({}),e=B(Kt(t),(function(n){return void 0!==t[n]}))
return R(e,(function(n){return t[n].me}))}(n)
return mm(n,t)},pm=function(t,e,r){var o,i,u,c=n(n({},(o=t).dom),{uid:o.uid,domChildren:R(o.components,(function(n){return n.element}))}),a=function(n){return n.domModification.fold((function(){return so({})}),so)}(t),f={"alloy.base.modification":a},s=e.length>0?function(t,e,r,o){var i=n({},e)
V(r,(function(n){i[n.name()]=n.exhibit(t,o)}))
var u=tm(i,(function(n,t){return{name:n,modification:t}})),c=function(t){return A(t,(function(t,e){return n(n({},e.modification),t)}),{})},a=A(u.classes,(function(n,t){return t.modification.concat(n)}),[]),f=c(u.attributes),s=c(u.styles)
return so({classes:a,attributes:f,styles:s})}(r,f,e,c):a
return u=s,n(n({},i=c),{attributes:n(n({},i.attributes),u.attributes),styles:n(n({},i.styles),u.styles),classes:i.classes.concat(u.classes)})},vm=function(n,t,e){var r={"alloy.base.behaviour":sm(n)}
return function(n,t,e,r){var o=im(n,e,r)
return am(o,t)}(e,n.eventOrder,t,r).getOrDie()},hm=function(n){var t=function(){return s},e=To(nm),r=Cr(function(n){var t
return Er("custom.definition",vr([xr("dom","dom",Ye(),vr([Rr("tag"),Hr("styles",{}),Hr("classes",[]),Hr("attributes",{}),Ar("value"),Ar("innerHtml")])),Rr("components"),Rr("uid"),Hr("events",{}),Hr("apis",{}),xr("eventOrder","eventOrder",qe((t={},t[qn()]=["disabling",fm,"toggling","typeaheadevents"],t[$n()]=[fm,"focusing","keying"],t[Qn()]=[fm,"disabling","toggling","representing"],t[jn()]=[fm,"representing","streaming","invalidating"],t[nt()]=[fm,"representing","item-events","tooltipping"],t[In()]=["focusing",fm,"item-type-events"],t[Mn()]=["focusing",fm,"item-type-events"],t[Vn()]=["item-type-events","tooltipping"],t[Xn()]=["receiving","reflecting","tooltipping"],t)),Ir()),Ar("domModification")]),n)}(n)),o=gm(n),i=function(n){return n.list}(o),u=function(n){return n.data}(o),c=function(n){var t=st.fromTag(n.tag)
ae(t,n.attributes),lm(t,n.classes),Bi(t,n.styles),n.innerHtml.each((function(n){return jo(t,n)}))
var e=n.domChildren
return It(t,e),n.value.each((function(n){pd(t,n)})),n.uid,ff(t,n.uid),t}(pm(r,i,u)),a=vm(r,i,u),f=To(r.components),s={getSystem:e.get,config:function(t){var e=u
return(E(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return E(u[n.name()])},spec:n,readState:function(n){return u[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},getApis:function(){return r.apis},connect:function(n){e.set(n)},disconnect:function(){e.set(Zd(t))},element:c,syncComponents:function(){var n=kt(c),t=z(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}))
f.set(t)},components:f.get,events:a}
return s},ym=function(e){var r=Qd(e),o=r.events,i=t(r,["events"]),u=function(n){var t=re(n,"components").getOr([])
return R(t,Sm)}(i),c=n(n({},i),{events:n(n({},Jd),o),components:u})
return ke.value(hm(c))},bm=function(n){var t=st.fromText(n)
return xm({element:t})},xm=function(n){var t=Mr("external.component",pr([Rr("element"),Ar("uid")]),n),e=To(Zd())
t.uid.each((function(n){ff(t.element,n)}))
var o={getSystem:e.get,config:y.none,hasConfigured:d,connect:function(n){e.set(n)},disconnect:function(){e.set(Zd((function(){return o})))},getApis:function(){return{}},element:t.element,spec:n,readState:i("No state"),syncComponents:r,components:i([]),events:{}}
return ef(o)},wm=lf,Sm=function(t){return function(n){return re(n,tf)}(t).fold((function(){var e=t.hasOwnProperty("uid")?t:n({uid:wm("")},t)
return ym(e).getOrDie()}),(function(n){return n}))},Om=ef,Tm="alloy.item-hover",km="alloy.item-focus",Em=function(n){(Mo(n.element).isNone()||Ii.isFocused(n))&&(Ii.isFocused(n)||Ii.focus(n),it(n,Tm,{item:n}))},Cm=function(n){it(n,km,{item:n})},Mm=i(Tm),Dm=i(km),_m=[Rr("data"),Rr("components"),Rr("dom"),Hr("hasSubmenu",!1),Ar("toggling"),pa("itemBehaviours",[xi,Ii,la,Jf]),Hr("ignoreFocus",!1),Hr("domModification",{}),oi("builder",(function(t){return{dom:t.dom,domModification:n(n({},t.domModification),{attributes:n(n(n({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:va(t.itemBehaviours,[t.toggling.fold(xi.revoke,(function(t){return xi.config(n({aria:{mode:"checked"}},t))})),Ii.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(n){Cm(n)}}),la.config({mode:"execution"}),Jf.config({store:{mode:"memory",initialValue:t.data}}),ad("item-type-events",e(Ei(),[Jr(Vn(),Em),Jr(Yn(),Ii.focus)]))]),components:t.components,eventOrder:t.eventOrder}})),Hr("eventOrder",{})],Im=[Rr("dom"),Rr("components"),oi("builder",(function(n){return{dom:n.dom,components:n.components,events:Yr([eo(Yn())])}}))],Fm=i([La({name:"widget",overrides:function(n){return{behaviours:yo([Jf.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),Rm=[Rr("uid"),Rr("data"),Rr("components"),Rr("dom"),Hr("autofocus",!1),Hr("ignoreFocus",!1),pa("widgetBehaviours",[Jf,Ii,la]),Hr("domModification",{}),nf(Fm()),oi("builder",(function(n){var t=Ya(0,n,Fm()),e=Ka("item-widget",n,t.internals()),r=function(t){return Ja(t,n,"widget").map((function(n){return la.focusIn(n),n}))},o=function(t,e){return zu(e.event.target)?y.none():n.autofocus?(e.setSource(t.element),y.none()):y.none()}
return{dom:n.dom,components:e,domModification:n.domModification,events:Yr([co((function(n,t){r(n).each((function(n){t.stop()}))})),Jr(Vn(),Em),Jr(Yn(),(function(t,e){n.autofocus?r(t):Ii.focus(t)}))]),behaviours:va(n.widgetBehaviours,[Jf.config({store:{mode:"memory",initialValue:n.data}}),Ii.config({ignore:n.ignoreFocus,onFocus:function(n){Cm(n)}}),la.config({mode:"special",focusIn:n.autofocus?function(n){r(n)}:So(),onLeft:o,onRight:o,onEscape:function(t,e){return Ii.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element),y.none()):y.none():(Ii.focus(t),y.some(!0))}})])}}))],Vm=_r("type",{widget:Rm,item:_m,separator:Im}),Bm=i([$a({factory:{sketch:function(n){var t=Mr("menu.spec item",Vm,n)
return t.builder(t)}},name:"items",unit:"item",defaults:function(t,e){return e.hasOwnProperty("uid")?e:n(n({},e),{uid:lf("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Am=i([Rr("value"),Rr("items"),Rr("dom"),Rr("components"),Hr("eventOrder",{}),da("menuBehaviours",[Ru,Jf,ld,la]),zr("movement",{mode:"menu",moveOnTab:!0},_r("mode",{grid:[ui(),oi("config",(function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}}))],matrix:[oi("config",(function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),Rr("rowSelector")],menu:[Hr("moveOnTab",!0),oi("config",(function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}}))]})),Vr("markers",Jo()),Hr("fakeFocus",!1),Hr("focusManager",Bu()),ni("onHighlight")]),jm=i("alloy.menu-focus"),Nm=yf({name:"Menu",configFields:Am(),partFields:Bm(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:ga(n.menuBehaviours,[Ru.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Jf.config({store:{mode:"memory",initialValue:n.value}}),ld.config({find:y.some}),la.config(n.movement.config(n,n.movement))]),events:Yr([Jr(Dm(),(function(n,t){var e=t.event
n.getSystem().getByDom(e.target).each((function(e){Ru.highlight(n,e),t.stop(),it(n,jm(),{menu:n,item:e})}))})),Jr(Mm(),(function(n,t){var e=t.event.item
Ru.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Pm=function(n,t){var e=At(t),o=Co(e).bind((function(n){var e,r,o=function(t){return pt(n,t)}
return o(t)?y.some(t):(e=o,(r=function(n){for(var t=0;t<n.childNodes.length;t++){var o=st.fromDom(n.childNodes[t])
if(e(o))return y.some(o)
var i=r(n.childNodes[t])
if(i.isSome())return i}return y.none()})(t.dom))})),i=n(t)
return o.each((function(n){Co(e).filter((function(t){return pt(t,n)})).fold((function(){ko(n)}),r)})),i},Hm=function(n,t,e,r){var o=n.getSystem().build(r)
Xt(n,o,e)},zm=function(n,t,e,r){var o=Lm(n)
N(o,(function(n){return pt(r.element,n.element)})).each(qt)},Lm=function(n,t){return n.components()},Gm=function(n,t,e,r,o){var i=Lm(n)
return y.from(i[r]).map((function(t){return zm(n,0,0,t),o.each((function(t){Hm(n,0,(function(n,t){(function(n,t,e){Et(n,e).fold((function(){_t(n,t)}),(function(n){Ct(n,t)}))})(n,t,r)}),t)})),t}))},$m=xo({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,t,e,r){Hm(n,0,_t,r)},prepend:function(n,t,e,r){Hm(n,0,Dt,r)},remove:zm,replaceAt:Gm,replaceBy:function(n,t,e,r,o){var i=Lm(n)
return P(i,r).bind((function(t){return Gm(n,0,0,t,o)}))},set:function(n,t,e,r){Pm((function(){var t=R(r,n.getSystem().build)
Wt(n,t)}),n.element)},contents:Lm})}),Um=function(n,t,e,r){return re(e,r).bind((function(r){return re(n,r).bind((function(r){var o=Um(n,t,e,r)
return y.some([r].concat(o))}))})).getOr([])},Wm=function(n,t){var e={}
Qt(n,(function(n,t){V(n,(function(n){e[n]=t}))}))
var r=t,o=ne(t,(function(n,t){return{k:n,v:t}})),i=Zt(o,(function(n,t){return[t].concat(Um(e,r,o,t))}))
return Zt(e,(function(n){return re(i,n).getOr([n])}))},Xm=function(n){return"prepared"===n.type?y.some(n.menu):y.none()},qm={init:function(){var t=To({}),e=To({}),r=To({}),o=To(y.none()),i=To({}),u=function(n){return function(n,t){for(var e=Kt(n),r=0,o=e.length;r<o;r++){var i=e[r],u=n[i]
if(t(u,i,n))return y.some(u)}return y.none()}(t.get(),(function(t,e){return t===n}))},c=function(n){return a(n).bind(Xm)},a=function(n){return re(e.get(),n)},f=function(n){return re(t.get(),n)}
return{setMenuBuilt:function(t,r){var o
e.set(n(n({},e.get()),((o={})[t]={type:"prepared",menu:r},o)))},setContents:function(n,u,c,a){o.set(y.some(n)),t.set(c),e.set(u),i.set(a)
var f=Wm(a,c)
r.set(f)},expand:function(n){return re(t.get(),n).map((function(t){var e=re(r.get(),n).getOr([])
return[t].concat(e)}))},refresh:function(n){return re(r.get(),n)},collapse:function(n){return re(r.get(),n).bind((function(n){return n.length>1?y.some(n.slice(1)):y.none()}))},lookupMenu:a,lookupItem:f,otherMenus:function(n){var t=i.get()
return $(Kt(t),n)},getPrimary:function(){return o.get().bind(c)},getMenus:function(){return e.get()},clear:function(){t.set({}),e.set({}),r.set({}),o.set(y.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,t){var e=B(f(n).toArray(),(function(n){return c(n).isSome()}))
return re(r.get(),n).bind((function(n){var r=G(e.concat(n))
return function(n){for(var t=[],e=0;e<n.length;e++){var r=n[e]
if(!r.isSome())return y.none()
t.push(r.getOrDie())}return y.some(t)}(z(r,(function(n,e){return function(n,t,e){return c(n).bind((function(r){return u(n).bind((function(n){return t(n).map((function(n){return{triggeredMenu:r,triggeringItem:n,triggeringPath:e}}))}))}))}(n,t,r.slice(0,e+1)).fold((function(){return o.get().is(n)?[]:[y.none()]}),(function(n){return[y.some(n)]}))})))}))}}},extractPreparedMenu:Xm},Ym=i("collapse-item"),Km=hf({name:"TieredMenu",configFields:[ri("onExecute"),ri("onEscape"),ei("onOpenMenu"),ei("onOpenSubmenu"),ni("onRepositionMenu"),ni("onCollapseMenu"),Hr("highlightImmediately",!0),Br("data",[Rr("primary"),Rr("menus"),Rr("expansions")]),Hr("fakeFocus",!1),ni("onHighlight"),ni("onHover"),Br("markers",[Rr("backgroundMenu")].concat(Yo()).concat(Ko())),Rr("dom"),Hr("navigateOnHover",!0),Hr("stayInDom",!1),da("tmenuBehaviours",[la,Ru,ld,$m]),Hr("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:function(t,e){var r,o=To(y.none()),i=qm.init(),u=function(e){var r=function(e,r,o){return Zt(o,(function(o,i){var u=function(){return Nm.sketch(n(n({},o),{value:i,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Au():Bu()}))}
return i===r?{type:"prepared",menu:e.getSystem().build(u())}:{type:"notbuilt",nbMenu:u}}))}(e,t.data.primary,t.data.menus),o=a()
return i.setContents(t.data.primary,r,t.data.expansions,o),i.getPrimary()},c=function(n){return Jf.getValue(n).value},a=function(n){return Zt(t.data.menus,(function(n,t){return z(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},f=function(n,t){Ru.highlight(n,t),Ru.getHighlighted(t).orThunk((function(){return Ru.getFirst(t)})).each((function(t){ct(n,t.element,Yn())}))},s=function(n,t){return Su(R(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?y.some(n.menu):y.none()}))})))},l=function(n,e,r){var o=s(e,e.otherMenus(r))
V(o,(function(e){dm(e.element,[t.markers.backgroundMenu]),t.stayInDom||$m.remove(n,e)}))},d=function(n,e){var r=function(n){return o.get().getOrThunk((function(){var e={},r=Xi(n.element,"."+t.markers.item),i=B(r,(function(n){return"true"===fe(n,"aria-haspopup")}))
return V(i,(function(t){n.getSystem().getByDom(t).each((function(n){var t=c(n)
e[t]=n}))})),o.set(y.some(e)),e}))}(n)
Qt(r,(function(n,t){var r=I(e,t)
ce(n.element,"aria-expanded",r)}))},m=function(n,e,r){return y.from(r[0]).bind((function(o){return e.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return y.none()
var i=o.menu,u=s(e,r.slice(1))
return V(u,(function(n){he(n.element,t.markers.backgroundMenu)})),Ht(i.element)||$m.append(n,Om(i)),dm(i.element,[t.markers.backgroundMenu]),f(n,i),l(n,e,r),y.some(i)}))}))};(function(n){n[n.HighlightSubmenu=0]="HighlightSubmenu",n[n.HighlightParent=1]="HighlightParent"})(r||(r={}))
var g=function(n,e,o){void 0===o&&(o=r.HighlightSubmenu)
var u=c(e)
return i.expand(u).bind((function(u){return d(n,u),y.from(u[0]).bind((function(c){return i.lookupMenu(c).bind((function(a){var f=function(n,t,e){if("notbuilt"===e.type){var r=n.getSystem().build(e.nbMenu())
return i.setMenuBuilt(t,r),r}return e.menu}(n,c,a)
return Ht(f.element)||$m.append(n,Om(f)),t.onOpenSubmenu(n,e,f,G(u)),o===r.HighlightSubmenu?(Ru.highlightFirst(f),m(n,i,u)):(Ru.dehighlightAll(f),y.some(e))}))}))}))},p=function(n,e){var r=c(e)
return i.collapse(r).bind((function(r){return d(n,r),m(n,i,r).map((function(r){return t.onCollapseMenu(n,e,r),r}))}))},v=function(n){return function(e,r){return nu(r.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map((function(){return!0}))}))}))}},h=Yr([Jr(jm(),(function(n,t){var e=t.event.item
i.lookupItem(c(e)).each((function(){var e=t.event.menu
Ru.highlight(n,e)
var r=c(t.event.item)
i.refresh(r).each((function(t){return l(n,i,t)}))}))})),co((function(n,e){var o=e.event.target
n.getSystem().getByDom(o).each((function(e){0===c(e).indexOf("collapse-item")&&p(n,e),g(n,e,r.HighlightSubmenu).fold((function(){t.onExecute(n,e)}),(function(){}))}))})),oo((function(n,e){u(n).each((function(e){$m.append(n,Om(e)),t.onOpenMenu(n,e),t.highlightImmediately&&f(n,e)}))}))].concat(t.navigateOnHover?[Jr(Mm(),(function(n,e){var o=e.event.item;(function(n,t){var e=c(t)
i.refresh(e).bind((function(t){return d(n,t),m(n,i,t)}))})(n,o),g(n,o,r.HighlightParent),t.onHover(n,o)}))]:[])),b=function(n){return Ru.getHighlighted(n).bind(Ru.getHighlighted)},x={collapseMenu:function(n){b(n).each((function(t){p(n,t)}))},highlightPrimary:function(n){i.getPrimary().each((function(t){f(n,t)}))},repositionMenus:function(n){i.getPrimary().bind((function(t){return b(n).bind((function(n){var t,e=c(n),r=(t=i.getMenus(),ee(t,(function(n){return n}))),o=Su(R(r,qm.extractPreparedMenu))
return i.getTriggeringPath(e,(function(n){return function(n,t,e){return X(t,(function(n){if(!n.getSystem().isConnected())return y.none()
var t=Ru.getCandidates(n)
return N(t,(function(n){return c(n)===e}))}))}(0,o,n)}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){(function(n){return y.from(n.components()[0]).filter((function(n){return"menu"===fe(n.element,"role")}))})(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var r=e.primary,o=e.triggeringPath
t.onRepositionMenu(n,r,o)}))}}
return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:ga(t.tmenuBehaviours,[la.config({mode:"special",onRight:v((function(n,t){return zu(t.element)?y.none():g(n,t,r.HighlightSubmenu)})),onLeft:v((function(n,t){return zu(t.element)?y.none():p(n,t)})),onEscape:v((function(n,e){return p(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(n,t){i.getPrimary().each((function(t){ct(n,t.element,Yn())}))}}),Ru.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),ld.config({find:function(n){return Ru.getHighlighted(n)}}),$m.config({})]),eventOrder:t.eventOrder,apis:x,events:h}},extraApis:{tieredData:function(n,t,e){return{primary:n,menus:t,expansions:e}},singleData:function(n,t){return{primary:n,menus:tr(n,t),expansions:{}}},collapseItem:function(n){return{value:Ca(Ym()),meta:{text:n}}}}}),Jm=function(n,t,e,r){return re(t.routes,r.start).bind((function(n){return re(n,r.destination)}))},Qm=function(n,t,e,r){return Jm(0,t,0,r).bind((function(n){return n.transition.map((function(t){return{transition:t,route:n}}))}))},Zm=function(n,t,e){(function(n,t,e){return ng(n,t).bind((function(r){return Qm(n,t,e,r)}))})(n,t,e).each((function(e){var r=e.transition
be(n.element,r.transitionClass),de(n.element,t.destinationAttr)}))},ng=function(n,t,e){var r=n.element
return se(r,t.destinationAttr).map((function(e){return{start:fe(n.element,t.stateAttr),destination:e}}))},tg=function(n,t,e,r){Zm(n,t,e),le(n.element,t.stateAttr)&&fe(n.element,t.stateAttr)!==r&&t.onFinish(n,r),ce(n.element,t.stateAttr,r)},eg=Object.freeze({__proto__:null,findRoute:Jm,disableTransition:Zm,getCurrentRoute:ng,jumpTo:tg,progressTo:function(n,t,e,r){(function(n,t,e,r){le(n.element,t.destinationAttr)&&(se(n.element,t.destinationAttr).each((function(e){ce(n.element,t.stateAttr,e)})),de(n.element,t.destinationAttr))})(n,t)
var o=function(n,t,e,r){return{start:fe(n.element,t.stateAttr),destination:r}}(n,t,0,r)
Qm(n,t,e,o).fold((function(){tg(n,t,e,r)}),(function(o){Zm(n,t,e)
var i=o.transition
he(n.element,i.transitionClass),ce(n.element,t.destinationAttr,r)}))},getState:function(n,t,e){return se(n.element,t.stateAttr)}}),rg=Object.freeze({__proto__:null,events:function(n,t){return Yr([Jr(Hn(),(function(e,r){var o=r.event.raw
ng(e,n).each((function(r){Jm(0,n,0,r).each((function(i){i.transition.each((function(i){o.propertyName===i.property&&(tg(e,n,t,r.destination),n.onTransition(e,r))}))}))}))})),oo((function(e,r){tg(e,n,t,n.initialState)}))])}}),og=[Hr("destinationAttr","data-transitioning-destination"),Hr("stateAttr","data-transitioning-state"),Rr("initialState"),ni("onTransition"),ni("onFinish"),Vr("routes",kr(ke.value,kr(ke.value,pr([Pr("transition",[Rr("property"),Rr("transitionClass")])]))))],ig=xo({fields:og,name:"transitioning",active:rg,apis:eg,extra:{createRoutes:function(n){var t={}
return Qt(n,(function(n,e){var r=e.split("<->")
t[r[0]]=tr(r[1],n),t[r[1]]=tr(r[0],n)})),t},createBistate:function(n,t,e){return er([{key:n,value:tr(t,e)},{key:t,value:tr(n,e)}])},createTristate:function(n,t,e,r){return er([{key:n,value:er([{key:t,value:r},{key:e,value:r}])},{key:t,value:er([{key:n,value:r},{key:e,value:r}])},{key:e,value:er([{key:n,value:r},{key:t,value:r}])}])}}}),ug=ki("scrollable"),cg=function(n){he(n,ug)},ag=function(n){be(n,ug)},fg=ug,sg=function(n){return re(n,"format").getOr(n.title)},lg=function(n,t,e,r,o){return{data:{value:n,text:t},type:"item",dom:{tag:"div",classes:o?[ki("styles-item-is-menu")]:[]},toggling:{toggleOnExecute:!1,toggleClass:ki("format-matches"),selected:e},itemBehaviours:yo(o?[]:[wi(n,(function(n,t){(t?xi.on:xi.off)(n)}))]),components:[{dom:{tag:"div",attributes:{style:r},innerHtml:t}}]}},dg=function(n,t,e,r){return{value:n,dom:{tag:"div"},components:[bf.sketch({dom:{tag:"div",classes:[ki("styles-collapser")]},components:r?[{dom:{tag:"span",classes:[ki("styles-collapse-icon")]}},bm(n)]:[bm(n)],action:function(n){if(r){var t=e().get(n)
Km.collapseMenu(t)}}}),{dom:{tag:"div",classes:[ki("styles-menu-items-container")]},components:[Nm.parts.items({})],behaviours:yo([ad("adhoc-scrollable-menu",[oo((function(n,t){Vi(n.element,"overflow-y","auto"),Vi(n.element,"-webkit-overflow-scrolling","touch"),cg(n.element)})),io((function(n){Pi(n.element,"overflow-y"),Pi(n.element,"-webkit-overflow-scrolling"),ag(n.element)}))])])}],items:t,menuBehaviours:yo([ig.config({initialState:"after",routes:ig.createTristate("before","current","after",{transition:{property:"transform",transitionClass:"transitioning"}})})])}},mg=function(n){var t,e,r,o,i,u=(t=n.formats,e=function(){return c},r=dg("Styles",[].concat(R(t.items,(function(n){return lg(sg(n),n.title,n.isSelected(),n.getPreview(),ie(t.expansions,sg(n)))}))),e,!1),o=Zt(t.menus,(function(n,r){var o=R(n,(function(n){return lg(sg(n),n.title,void 0!==n.isSelected&&n.isSelected(),void 0!==n.getPreview?n.getPreview():"",ie(t.expansions,sg(n)))}))
return dg(r,o,e,!0)})),i=$e(o,tr("styles",r)),{tmenu:Km.tieredData("styles",i,t.expansions)}),c=Wl(Km.sketch({dom:{tag:"div",classes:[ki("styles-menu")]},components:[],fakeFocus:!0,stayInDom:!0,onExecute:function(t,e){var r=Jf.getValue(e)
return n.handle(e,r.value),y.none()},onEscape:function(){return y.none()},onOpenMenu:function(n,t){var e=ns(n.element)
Zf(t.element,e),ig.jumpTo(t,"current")},onOpenSubmenu:function(n,t,e){var r=ns(n.element),o=Qi(t.element,'[role="menu"]').getOrDie("hacky"),i=n.getSystem().getByDom(o).getOrDie()
Zf(e.element,r),ig.progressTo(i,"before"),ig.jumpTo(e,"after"),ig.progressTo(e,"current")},onCollapseMenu:function(n,t,e){var r=Qi(t.element,'[role="menu"]').getOrDie("hacky"),o=n.getSystem().getByDom(r).getOrDie()
ig.progressTo(o,"after"),ig.progressTo(e,"current")},navigateOnHover:!1,highlightImmediately:!0,data:u.tmenu,markers:{backgroundMenu:ki("styles-background-menu"),menu:ki("styles-menu"),selectedMenu:ki("styles-selected-menu"),item:ki("styles-item"),selectedItem:ki("styles-selected-item")}}))
return c.asSpec()},gg=function(n){return ie(n,"items")?function(n){var t=$e(nr(n,["items"]),{menu:!0}),e=pg(n.items)
return{item:t,menus:$e(e.menus,tr(n.title,e.items)),expansions:$e(e.expansions,tr(n.title,n.title))}}(n):{item:n,menus:{},expansions:{}}},pg=function(n){return A(n,(function(n,t){var e=gg(t)
return{menus:$e(n.menus,e.menus),items:[e.item].concat(n.items),expansions:$e(n.expansions,e.expansions)}}),{menus:{},expansions:{},items:[]})},vg=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){return n.formatter.getCssText(t)}},r=function(o){return R(o,(function(o){if(ie(o,"items")){var u=r(o.items)
return $e(function(n){return $e(n,{isSelected:d,getPreview:i("")})}(o),{items:u})}return ie(o,"format")?function(n){return $e(n,{isSelected:t(n.format),getPreview:e(n.format)})}(o):function(r){var o=Ca(r.title),i=$e(r,{format:o,isSelected:t(o),getPreview:e(o)})
return n.formatter.register(o,i),i}(o)}))}
return r(function(n){return n.getParam("style_formats",Io,"array")}(n))},hg=function(n,t,e){var r=function(n,t){var e=function(t){return z(t,(function(t){return void 0!==t.items?e(t.items).length>0?[t]:[]:!ie(t,"format")||n.formatter.canApply(t.format)?[t]:[]}))},r=e(t)
return pg(r)}(n,t)
return mg({formats:r,handle:function(t,r){n.undoManager.transact((function(){xi.isOn(t)?n.formatter.remove(r):n.formatter.apply(r)})),e()}})},yg=function(n){var t=n.replace(/\|/g," ").trim()
return t.length>0?t.split(/\s+/):[]},bg=function(n){return z(n,(function(n){return O(n)?bg(n):yg(n)}))},xg=function(n){var t=function(n){return n.getParam("toolbar",Fo,"array")}(n)
return O(t)?bg(t):yg(t)},wg=function(n,t){var e=function(n){return function(){return function(n,t){return Mf(t,(function(){n.execCommand(t)}),{},n)}(t,n)}},r=function(n){return function(){return function(n,t){var e=kf(t)
return Mf(t,(function(){n.execCommand(t)}),e,n)}(t,n)}},o=function(n,e,r){return function(){return Ef(t,n,e,r)}},i=e("undo"),u=e("redo"),c=r("bold"),a=r("italic"),f=r("underline"),s=e("removeformat"),l=o("unlink","link",(function(){t.execCommand("unlink",null,!1)})),d=o("unordered-list","ul",(function(){t.execCommand("InsertUnorderedList",null,!1)})),m=o("ordered-list","ol",(function(){t.execCommand("InsertOrderedList",null,!1)})),g=vg(t),p=function(){return hg(t,g,(function(){t.fire("scrollIntoView")}))},v=function(n,e){return{isSupported:function(){var e=t.ui.registry.getAll().buttons
return n.forall((function(n){return ie(e,n)}))},sketch:e}}
return{undo:v(y.none(),i),redo:v(y.none(),u),bold:v(y.none(),c),italic:v(y.none(),a),underline:v(y.none(),f),removeformat:v(y.none(),s),link:v(y.none(),(function(){return Yd(n,t)})),unlink:v(y.none(),l),image:v(y.none(),(function(){return Ql(t)})),bullist:v(y.some("bullist"),d),numlist:v(y.some("numlist"),m),fontsizeselect:v(y.none(),(function(){return function(n,t){var e={onChange:function(n){Pl(t,n)},getInitialValue:function(){return Nl(t)}}
return Fl(n,"font-size",(function(){return Ul(e)}),t)}(n,t)})),forecolor:v(y.none(),(function(){return Vl(n,t)})),styleselect:v(y.none(),(function(){return Mf("style-formats",(function(e){t.fire("toReading"),n.dropup.appear(p,xi.on,e)}),yo([xi.config({toggleClass:ki("toolbar-button-selected"),toggleOnExecute:!1,aria:{mode:"pressed"}}),ai.config({channels:er([Oi(Vo,xi.off),Oi(Bo,xi.off)])})]),t)}))}},Sg=function(n){var t=st.fromDom(function(n){if(Bt()&&k(n.target)){var t=st.fromDom(n.target)
if(yt(t)&&Pt(t)&&n.composed&&n.composedPath){var e=n.composedPath()
if(e)return W(e)}}return y.from(n.target)}(n).getOr(n.target)),e=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},i=o(r,e)
return function(n,t,e,r,o,i,u){return{target:n,x:t,y:e,stop:r,prevent:o,kill:i,raw:u}}(t,n.clientX,n.clientY,e,r,i,n)},Og=function(n,t,e,r,o){var i=function(n,t){return function(e){n(e)&&t(Sg(e))}}(e,r)
return n.dom.addEventListener(t,i,o),{unbind:c(Tg,n,t,i,o)}},Tg=function(n,t,e,r){n.dom.removeEventListener(t,e,r)},kg=m,Eg=function(n,t,e){return function(n,t,e,r){return Og(n,t,e,r,!1)}(n,t,kg,e)},Cg=function(n,t,e){return function(n,t,e,r){return Og(n,t,e,r,!0)}(n,t,kg,e)},Mg=tinymce.util.Tools.resolve("tinymce.util.Delay"),Dg=function(n){var t=n.matchMedia("(orientation: portrait)").matches
return{isPortrait:i(t)}},_g=function(n){var t=En().os.isiOS(),e=Dg(n).isPortrait()
return t&&!e?n.screen.height:n.screen.width},Ig=function(n,t){var e=st.fromDom(n),r=null,o=Eg(e,"orientationchange",(function(){Mg.clearInterval(r)
var e=Dg(n)
t.onChange(e),i((function(){t.onReady(e)}))})),i=function(t){Mg.clearInterval(r)
var e=n.innerHeight,o=0
r=Mg.setInterval((function(){e!==n.innerHeight?(Mg.clearInterval(r),t(y.some(n.innerHeight))):o>20&&(Mg.clearInterval(r),t(y.none())),o++}),50)}
return{onAdjustment:i,destroy:function(){o.unbind()}}},Fg=function(n,t,e){var r,o=n.document.createRange()
return r=o,t.fold((function(n){r.setStartBefore(n.dom)}),(function(n,t){r.setStart(n.dom,t)}),(function(n){r.setStartAfter(n.dom)})),function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))}(o,e),o},Rg=function(n,t,e,r,o){var i=n.document.createRange()
return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},Vg=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Bg=ze([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ag=function(n,t,e){return t(st.fromDom(e.startContainer),e.startOffset,st.fromDom(e.endContainer),e.endOffset)},jg=function(n,t){return function(n,t){var e=t.ltr()
return e.collapsed?t.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Bg.rtl(st.fromDom(n.endContainer),n.endOffset,st.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return Ag(0,Bg.ltr,e)})):Ag(0,Bg.ltr,e)}(0,function(n,t){return t.match({domRange:function(n){return{ltr:i(n),rtl:y.none}},relative:function(t,e){return{ltr:g((function(){return Fg(n,t,e)})),rtl:g((function(){return y.some(Fg(n,e,t))}))}},exact:function(t,e,r,o){return{ltr:g((function(){return Rg(n,t,e,r,o)})),rtl:g((function(){return y.some(Rg(n,r,o,t,e))}))}}})}(n,t))},Ng=(Bg.ltr,Bg.rtl,function(n,t,e,r){return{start:n,soffset:t,finish:e,foffset:r}})
var Pg=function(n,t){var e=function(t){return n(t)?y.from(t.dom.nodeValue):y.none()}
return{get:function(r){if(!n(r))throw new Error("Can only get "+t+" value of a "+t+" node")
return e(r).getOr("")},getOption:e,set:function(e,r){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node")
e.dom.nodeValue=r}}}(bt,"text"),Hg=function(n){return"img"===vt(n)?1:function(n){return Pg.getOption(n)}(n).fold((function(){return kt(n).length}),(function(n){return n.length}))},zg=ze([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Lg={before:zg.before,on:zg.on,after:zg.after,cata:function(n,t,e,r){return n.fold(t,e,r)},getStart:function(n){return n.fold(u,u,u)}},Gg=ze([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),$g={domRange:Gg.domRange,relative:Gg.relative,exact:Gg.exact,exactFromRange:function(n){return Gg.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){return function(n){return st.fromDom(Ot(n).dom.defaultView)}(function(n){return n.match({domRange:function(n){return st.fromDom(n.startContainer)},relative:function(n,t){return Lg.getStart(n)},exact:function(n,t,e,r){return n}})}(n))},range:Ng},Ug=function(n,t){var e=vt(n)
return"input"===e?Lg.after(n):I(["br","img"],e)?0===t?Lg.before(n):Lg.after(n):Lg.on(n,t)},Wg=function(n,t,e,r){var o=function(n,t,e,r){var o=St(n).dom.createRange()
return o.setStart(n.dom,t),o.setEnd(e.dom,r),o}(n,t,e,r),i=pt(n,e)&&t===r
return o.collapsed&&!i},Xg=function(n){return y.from(n.getSelection())},qg=function(n,t,e,r,o){(function(n,t){Xg(n).each((function(n){n.removeAllRanges(),n.addRange(t)}))})(n,Rg(n,t,e,r,o))},Yg=function(n,t,e,r,o){(function(n,t){jg(n,t).match({ltr:function(t,e,r,o){qg(n,t,e,r,o)},rtl:function(t,e,r,o){Xg(n).each((function(i){if(i.setBaseAndExtent)i.setBaseAndExtent(t.dom,e,r.dom,o)
else if(i.extend)try{(function(n,t,e,r,o,i){t.collapse(e.dom,r),t.extend(o.dom,i)})(0,i,t,e,r,o)}catch(u){qg(n,r,o,t,e)}else qg(n,r,o,t,e)}))}})})(n,function(n,t,e,r){var o=Ug(n,t),i=Ug(e,r)
return $g.relative(o,i)}(t,e,r,o))},Kg=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1)
return y.some(Ng(st.fromDom(t.startContainer),t.startOffset,st.fromDom(e.endContainer),e.endOffset))}return y.none()},Jg=function(n){if(null===n.anchorNode||null===n.focusNode)return Kg(n)
var t=st.fromDom(n.anchorNode),e=st.fromDom(n.focusNode)
return Wg(t,n.anchorOffset,e,n.focusOffset)?y.some(Ng(t,n.anchorOffset,e,n.focusOffset)):Kg(n)},Qg=function(n){return Xg(n).filter((function(n){return n.rangeCount>0})).bind(Jg)},Zg=function(n,t){return function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect()
return e.width>0||e.height>0?y.some(e).map(Vg):y.none()}(function(n,t){return jg(n,t).match({ltr:function(t,e,r,o){var i=n.document.createRange()
return i.setStart(t.dom,e),i.setEnd(r.dom,o),i},rtl:function(t,e,r,o){var i=n.document.createRange()
return i.setStart(r.dom,o),i.setEnd(t.dom,e),i}})}(n,t))},np=function(n){return y.from(n.dom.contentWindow)},tp=function(n){return np(n).bind(Qg)},ep=function(n){return n.getFrame()},rp=function(n,t,e,r){return n[e].getOrThunk((function(){return function(n){return Eg(t,r,n)}}))},op=function(n){var t=ep(n)
return function(n){return y.some(st.fromDom(n.dom.contentWindow.document.body))}(t).bind((function(e){return function(n){return y.some(st.fromDom(n.dom.contentWindow.document))}(t).bind((function(r){return np(t).map((function(o){var i=st.fromDom(r.dom.documentElement),u=n.getCursorBox.getOrThunk((function(){return function(){return function(n){return Qg(n).map((function(n){return $g.exact(n.start,n.soffset,n.finish,n.foffset)}))}(o).bind((function(n){return Zg(o,n).orThunk((function(){return function(n){return Qg(n).filter((function(n){return pt(n.start,n.finish)&&n.soffset===n.foffset})).bind((function(n){var t=n.start.dom.getBoundingClientRect()
return t.width>0||t.height>0?y.some(t):y.none()}))}(o)}))}))}})),a=n.setSelection.getOrThunk((function(){return function(n,t,e,r){Yg(o,n,t,e,r)}})),f=n.clearSelection.getOrThunk((function(){return function(){(function(n){Xg(n).each((function(n){return n.removeAllRanges()}))})(o)}}))
return{body:e,doc:r,win:o,html:i,getSelection:c(tp,t),setSelection:a,clearSelection:f,frame:t,onKeyup:rp(n,r,"onKeyup","keyup"),onNodeChanged:rp(n,r,"onNodeChanged","SelectionChange"),onDomChanged:n.onDomChanged,onScrollToCursor:n.onScrollToCursor,onScrollToElement:n.onScrollToElement,onToReading:n.onToReading,onToEditing:n.onToEditing,onToolbarScrollStart:n.onToolbarScrollStart,onTouchContent:n.onTouchContent,onTapContent:n.onTapContent,onTouchToolstrip:n.onTouchToolstrip,getCursorBox:u}}))}))}))},ip=function(n,t){return function(e){return e[n].getOrThunk((function(){var n=ep(e)
return function(){return t(n)}}))()}}("getWin",np),up=function(){var n=Ji("head").getOrDie(),t=Ji('meta[name="viewport"]').getOrThunk((function(){var t=st.fromTag("meta")
return ce(t,"name","viewport"),_t(n,t),t})),e=fe(t,"content")
return{maximize:function(){ce(t,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){null!=e&&e.length>0?ce(t,"content",e):ce(t,"content","user-scalable=yes")}}},cp="data-ephox-mobile-fullscreen-style",ap="position:absolute!important;",fp="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",sp=En().os.isAndroid(),lp=function(n,t){var e=function(n){return function(t){var e=fe(t,"style"),r=void 0===e?"no-styles":e.trim()
r!==n&&(ce(t,cp,r),ce(t,"style",n))}},r=Wi(n,"*"),o=z(r,(function(n){return t="*",Ui(n,(function(n){return lt(n,t)}))
var t})),i=function(n){var t=Ai(n,"background-color")
return void 0!==t&&""!==t?"background-color:"+t+"!important":"background-color:rgb(255,255,255)!important;"}(t)
V(o,e("display:none!important;")),V(r,e(ap+fp+i)),e((!0===sp?"":ap)+fp+i)(n)},dp=function(){var n=mt("["+cp+"]")
V(n,(function(n){var t=fe(n,cp)
"no-styles"!==t?ce(n,"style",t):de(n,"style"),de(n,cp)}))}
var mp=function(n){var t=n.raw
return void 0===t.touches||1!==t.touches.length?y.none():y.some(t.touches[0])},gp=function(n){var t,e,r,o=To(y.none()),i=To(!1),u=(t=function(t){n.triggerEvent(Jn(),t),i.set(!0)},e=400,r=null,{cancel:function(){null!==r&&(clearTimeout(r),r=null)},schedule:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o]
r=setTimeout((function(){t.apply(null,n),r=null}),e)}}),c=er([{key:Mn(),value:function(n){return mp(n).each((function(t){u.cancel()
var e={x:t.clientX,y:t.clientY,target:n.target}
u.schedule(n),i.set(!1),o.set(y.some(e))})),y.none()}},{key:Dn(),value:function(n){return u.cancel(),mp(n).each((function(n){o.get().each((function(t){(function(n,t){var e=Math.abs(n.clientX-t.x),r=Math.abs(n.clientY-t.y)
return e>5||r>5})(n,t)&&o.set(y.none())}))})),y.none()}},{key:_n(),value:function(t){u.cancel()
return o.get().filter((function(n){return pt(n.target,t.target)})).map((function(e){return i.get()?(t.prevent(),!1):n.triggerEvent(Kn(),t)}))}}])
return{fireIfReady:function(n,t){return re(c,t).bind((function(t){return t(n)}))}}},pp=function(n){var t=gp({triggerEvent:function(t,e){n.onTapContent(e)}})
return{fireTouchstart:function(n){t.fireIfReady(n,"touchstart")},onTouchend:function(){return Eg(n.body,"touchend",(function(n){t.fireIfReady(n,"touchend")}))},onTouchmove:function(){return Eg(n.body,"touchmove",(function(n){t.fireIfReady(n,"touchmove")}))}}},vp=En().os.version.major>=6,hp=function(n,t,e){var o=pp(n),i=St(t),u=function(n){return!pt(n.start,n.finish)||n.soffset!==n.foffset},c=function(){var r=n.doc.dom.hasFocus()&&n.getSelection().exists(u)
e.getByDom(t).each(!0===(r||Co(i).filter((function(n){return"input"===vt(n)})).exists((function(n){return n.dom.selectionStart!==n.dom.selectionEnd})))?xi.on:xi.off)},a=[Eg(n.body,"touchstart",(function(t){n.onTouchContent(),o.fireTouchstart(t)})),o.onTouchmove(),o.onTouchend(),Eg(t,"touchstart",(function(t){n.onTouchToolstrip()})),n.onToReading((function(){Eo(n.body)})),n.onToEditing(r),n.onScrollToCursor((function(t){t.preventDefault(),n.getCursorBox().each((function(t){var e=n.win,r=t.top>e.innerHeight||t.bottom>e.innerHeight?t.bottom-e.innerHeight+50:0
0!==r&&e.scrollTo(e.pageXOffset,e.pageYOffset+r)}))}))].concat(!0===vp?[]:[Eg(st.fromDom(n.win),"blur",(function(){e.getByDom(t).each(xi.off)})),Eg(i,"select",c),Eg(n.doc,"selectionchange",c)])
return{destroy:function(){V(a,(function(n){n.unbind()}))}}},yp=function(n,t){var e=parseInt(fe(n,t),10)
return isNaN(e)?0:e},bp=function(t){return n(n({},t),{width:2})},xp=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},wp=function(n){var t=n.getSelection()
return void 0!==t&&t.rangeCount>0?function(n){if(n.collapsed){var t=st.fromDom(n.startContainer)
return Tt(t).bind((function(e){var r=$g.exact(t,n.startOffset,e,Hg(e))
return Zg(n.startContainer.ownerDocument.defaultView,r).map(bp).map(U)})).getOr([])}return R(n.getClientRects(),xp)}(t.getRangeAt(0)):[]},Sp=function(n){n.focus()
var t=st.fromDom(n.document.body);(Co().exists((function(n){return I(["input","textarea"],vt(n))}))?function(n){Mg.setTimeout((function(){n()}),0)}:l)((function(){Co().each(Eo),ko(t)}))},Op="data-"+ki("last-outer-height"),Tp=function(n,t){ce(n,Op,t)},kp=function(n){return{top:n.top,bottom:n.top+n.height}},Ep=function(n,t){var e=function(n){return yp(n,Op)}(t),r=n.innerHeight
return e>r?y.some(e-r):y.none()},Cp=function(n,t){var e=st.fromDom(t.document.body),r=Eg(st.fromDom(n),"resize",(function(){Ep(n,e).each((function(n){(function(n){var t=wp(n)
return t.length>0?y.some(t[0]).map(kp):y.none()})(t).each((function(e){var r=function(n,t,e){return t.top>n.innerHeight||t.bottom>n.innerHeight?Math.min(e,t.bottom-n.innerHeight+50):0}(t,e,n)
0!==r&&t.scrollTo(t.pageXOffset,t.pageYOffset+r)}))})),Tp(e,n.innerHeight)}))
Tp(e,n.innerHeight)
return{toEditing:function(){Sp(t)},destroy:function(){r.unbind()}}},Mp=function(n,t){var e=null
return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o]
null!==e&&clearTimeout(e),e=setTimeout((function(){n.apply(null,r),e=null}),t)}}},Dp=function(n,t){var e,r,o,i=Wl(dd.sketch({dom:Of('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'),containerBehaviours:yo([xi.config({toggleClass:ki("mask-tap-icon-selected"),toggleOnExecute:!1})])})),u=(e=n,r=200,o=null,{cancel:function(){null!==o&&(clearTimeout(o),o=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t]
null===o&&(o=setTimeout((function(){e.apply(null,n),o=null}),r))}})
return dd.sketch({dom:Of('<div class="${prefix}-disabled-mask"></div>'),components:[dd.sketch({dom:Of('<div class="${prefix}-content-container"></div>'),components:[bf.sketch({dom:Of('<div class="${prefix}-content-tap-section"></div>'),components:[i.asSpec()],action:function(n){u.throttle()},buttonBehaviours:yo([xi.config({toggleClass:ki("mask-tap-icon-selected")})])})]})]})},_p=i({unbind:r}),Ip=vr([Br("editor",[Rr("getFrame"),Ar("getBody"),Ar("getDoc"),Ar("getWin"),Ar("getSelection"),Ar("setSelection"),Ar("clearSelection"),Ar("cursorSaver"),Ar("onKeyup"),Ar("onNodeChanged"),Ar("getCursorBox"),Rr("onDomChanged"),Hr("onTouchContent",r),Hr("onTapContent",r),Hr("onTouchToolstrip",r),Hr("onScrollToCursor",_p),Hr("onScrollToElement",_p),Hr("onToEditing",_p),Hr("onToReading",_p),Hr("onToolbarScrollStart",u)]),Rr("socket"),Rr("toolstrip"),Rr("dropup"),Rr("toolbar"),Rr("container"),Rr("alloy"),Lr("win",(function(n){return St(n.socket).dom.defaultView})),Lr("body",(function(n){return st.fromDom(n.socket.dom.ownerDocument.body)})),Hr("translate",u),Hr("setReadOnly",r),Hr("readOnlyOnInit",m)]),Fp=function(n){var t=Mr("Getting AndroidWebapp schema",Ip,n)
Vi(t.toolstrip,"width","100%")
var e=Sm(Dp((function(){t.setReadOnly(t.readOnlyOnInit()),i.enter()}),t.translate))
t.alloy.add(e)
var o={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}}
_t(t.container,e.element)
var i=function(n,t){var e=up(),r=Ud(),o=Ud()
return{enter:function(){t.hide(),he(n.container,ki("fullscreen-maximized")),he(n.container,ki("android-maximized")),e.maximize(),he(n.body,ki("android-scroll-reload")),r.set(Cp(n.win,ip(n.editor).getOrDie("no"))),op(n.editor).each((function(t){lp(n.container,t.body),o.set(hp(t,n.toolstrip,n.alloy))}))},exit:function(){e.restore(),t.show(),be(n.container,ki("fullscreen-maximized")),be(n.container,ki("android-maximized")),dp(),be(n.body,ki("android-scroll-reload")),o.clear(),r.clear()}}}(t,o)
return{setReadOnly:t.setReadOnly,refreshStructure:r,enter:i.enter,exit:i.exit,destroy:r}},Rp=i([Rr("dom"),Hr("shell",!0),da("toolbarBehaviours",[$m])]),Vp=i([Ga({name:"groups",overrides:function(){return{behaviours:yo([$m.config({})])}}})]),Bp=yf({name:"Toolbar",configFields:Rp(),partFields:Vp(),factory:function(n,t,e,r){var o=function(t){return n.shell?y.some(t):Ja(t,n,"groups")},i=n.shell?{behaviours:[$m.config({})],components:[]}:{behaviours:[],components:t}
return{uid:n.uid,dom:n.dom,components:i.components,behaviours:ga(n.toolbarBehaviours,i.behaviours),apis:{setGroups:function(n,t){o(n).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){$m.set(n,t)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),Ap=i([Rr("items"),function(n){return Br("markers",R(n,Rr))}(["itemSelector"]),da("tgroupBehaviours",[la])]),jp=i([$a({name:"items",unit:"item"})]),Np=yf({name:"ToolbarGroup",configFields:Ap(),partFields:jp(),factory:function(n,t,e,r){return{uid:n.uid,dom:n.dom,components:t,behaviours:ga(n.tgroupBehaviours,[la.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Pp="data-"+ki("horizontal-scroll"),Hp=function(n){return"true"===fe(n,Pp)?function(n){return n.dom.scrollLeft>0||function(n){n.dom.scrollLeft=1
var t=0!==n.dom.scrollLeft
return n.dom.scrollLeft=0,t}(n)}(n):function(n){return n.dom.scrollTop>0||function(n){n.dom.scrollTop=1
var t=0!==n.dom.scrollTop
return n.dom.scrollTop=0,t}(n)}(n)},zp=function(){var n=function(n){var t=!0===n.scrollable?"${prefix}-toolbar-scrollable-group":""
return{dom:Of('<div aria-label="'+n.label+'" class="${prefix}-toolbar-group '+t+'"></div>'),tgroupBehaviours:yo([ad("adhoc-scrollable-toolbar",!0===n.scrollable?[uo((function(n,t){var e
Vi(n.element,"overflow-x","auto"),e=n.element,ce(e,Pp,"true"),cg(n.element)}))]:[])]),components:[dd.sketch({components:[Np.parts.items({})]})],markers:{itemSelector:"."+ki("toolbar-group-item")},items:n.items}},t=Sm(Bp.sketch({dom:Of('<div class="${prefix}-toolbar"></div>'),components:[Bp.parts.groups({})],toolbarBehaviours:yo([xi.config({toggleClass:ki("context-toolbar"),toggleOnExecute:!1,aria:{mode:"none"}}),la.config({mode:"cyclic"})]),shell:!0})),e=Sm(dd.sketch({dom:{classes:[ki("toolstrip")]},components:[Om(t)],containerBehaviours:yo([xi.config({toggleClass:ki("android-selection-context-toolbar"),toggleOnExecute:!1})])})),r=function(){Bp.setGroups(t,i.get()),xi.off(t)},i=To([])
return{wrapper:e,toolbar:t,createGroups:function(t){return R(t,o(Np.sketch,n))},setGroups:function(n){i.set(n),r()},setContextToolbar:function(n){xi.on(t),Bp.setGroups(t,n)},restoreToolbar:function(){xi.isOn(t)&&r()},refresh:function(){},focus:function(){la.focusIn(t)}}},Lp=function(n){return Sm(bf.sketch({dom:Of('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'),action:function(){n.run((function(n){n.setReadOnly(!1)}))}}))},Gp=function(){return Sm(dd.sketch({dom:Of('<div class="${prefix}-editor-socket"></div>'),components:[],containerBehaviours:yo([$m.config({})])}))},$p=function(n,t){$m.append(n,Om(t))},Up=function(n,t){$m.remove(n,t)},Wp=function(n,t,e,r){(!0===e?Oo.toAlpha:Oo.toOmega)(r),(e?$p:Up)(n,t)},Xp=function(n,t){return t.getAnimationRoot.fold((function(){return n.element}),(function(t){return t(n)}))},qp=function(n){return n.dimension.property},Yp=function(n,t){return n.dimension.getDimension(t)},Kp=function(n,t){var e=Xp(n,t)
dm(e,[t.shrinkingClass,t.growingClass])},Jp=function(n,t){be(n.element,t.openClass),he(n.element,t.closedClass),Vi(n.element,qp(t),"0px"),Hi(n.element)},Qp=function(n,t){be(n.element,t.closedClass),he(n.element,t.openClass),Pi(n.element,qp(t))},Zp=function(n,t,e,r){e.setCollapsed(),Vi(n.element,qp(t),Yp(t,n.element)),Hi(n.element),Kp(n,t),Jp(n,t),t.onStartShrink(n),t.onShrunk(n)},nv=function(n,t,e,r){var o=r.getOrThunk((function(){return Yp(t,n.element)}))
e.setCollapsed(),Vi(n.element,qp(t),o),Hi(n.element)
var i=Xp(n,t)
be(i,t.growingClass),he(i,t.shrinkingClass),Jp(n,t),t.onStartShrink(n)},tv=function(n,t,e){var r=Yp(t,n.element);("0px"===r?Zp:nv)(n,t,e,y.some(r))},ev=function(n,t,e){var r=Xp(n,t),o=xe(r,t.shrinkingClass),i=Yp(t,n.element)
Qp(n,t)
var u=Yp(t,n.element);(o?function(){Vi(n.element,qp(t),i),Hi(n.element)}:function(){Jp(n,t)})(),be(r,t.shrinkingClass),he(r,t.growingClass),Qp(n,t),Vi(n.element,qp(t),u),e.setExpanded(),t.onStartGrow(n)},rv=function(n,t,e){var r=Xp(n,t)
return!0===xe(r,t.growingClass)},ov=function(n,t,e){var r=Xp(n,t)
return!0===xe(r,t.shrinkingClass)},iv=Object.freeze({__proto__:null,refresh:function(n,t,e){if(e.isExpanded()){Pi(n.element,qp(t))
var r=Yp(t,n.element)
Vi(n.element,qp(t),r)}},grow:function(n,t,e){e.isExpanded()||ev(n,t,e)},shrink:function(n,t,e){e.isExpanded()&&tv(n,t,e)},immediateShrink:function(n,t,e){e.isExpanded()&&Zp(n,t,e,y.none())},hasGrown:function(n,t,e){return e.isExpanded()},hasShrunk:function(n,t,e){return e.isCollapsed()},isGrowing:rv,isShrinking:ov,isTransitioning:function(n,t,e){return!0===rv(n,t)||!0===ov(n,t)},toggleGrow:function(n,t,e){(e.isExpanded()?tv:ev)(n,t,e)},disableTransitions:Kp}),uv=Object.freeze({__proto__:null,exhibit:function(n,t,e){var r=t.expanded
return so(r?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:tr(t.dimension.property,"0px")})},events:function(n,t){return Yr([ro(Hn(),(function(e,r){r.event.raw.propertyName===n.dimension.property&&(Kp(e,n),t.isExpanded()&&Pi(e.element,n.dimension.property),(t.isExpanded()?n.onGrown:n.onShrunk)(e))}))])}}),cv=[Rr("closedClass"),Rr("openClass"),Rr("shrinkingClass"),Rr("growingClass"),Ar("getAnimationRoot"),ni("onShrunk"),ni("onStartShrink"),ni("onGrown"),ni("onStartGrow"),Hr("expanded",!1),Vr("dimension",_r("property",{width:[oi("property","width"),oi("getDimension",(function(n){return ns(n)+"px"}))],height:[oi("property","height"),oi("getDimension",(function(n){return Gi(n)+"px"}))]}))],av=xo({fields:cv,name:"sliding",active:uv,apis:iv,state:Object.freeze({__proto__:null,init:function(n){var t=To(n.expanded)
return ho({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:c(t.set,!1),setExpanded:c(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),fv=function(n,t){var e=Sm(dd.sketch({dom:{tag:"div",classes:[ki("dropup")]},components:[],containerBehaviours:yo([$m.config({}),av.config({closedClass:ki("dropup-closed"),openClass:ki("dropup-open"),shrinkingClass:ki("dropup-shrinking"),growingClass:ki("dropup-growing"),dimension:{property:"height"},onShrunk:function(e){n(),t(),$m.set(e,[])},onGrown:function(e){n(),t()}}),Si((function(n,t){o(r)}))])})),o=function(n){window.requestAnimationFrame((function(){n(),av.shrink(e)}))}
return{appear:function(n,t,r){!0===av.hasShrunk(e)&&!1===av.isTransitioning(e)&&window.requestAnimationFrame((function(){t(r),$m.set(e,[n()]),av.grow(e)}))},disappear:o,component:e,element:e.element}},sv=function(n){var t,e
return n.raw.which===tu[0]&&!I(["input","textarea"],vt(n.target))&&(t=n.target,!nu(t,'[contenteditable="true"]',e).isSome())},lv=function(){return En().browser.isFirefox()},dv=pr([function(n){return Vr(n,Fr)}("triggerEvent"),Hr("stopBackspace",!0)]),mv=function(n,t){var e=Mr("Getting GUI events settings",dv,t),r=gp(e),o=R(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return Eg(n,t,(function(n){r.fireIfReady(n,t).each((function(t){t&&n.kill()})),e.triggerEvent(t,n)&&n.kill()}))})),i=To(y.none()),u=Eg(n,"paste",(function(n){r.fireIfReady(n,"paste").each((function(t){t&&n.kill()})),e.triggerEvent("paste",n)&&n.kill(),i.set(y.some(setTimeout((function(){e.triggerEvent(Wn(),n)}),0)))})),c=Eg(n,"keydown",(function(n){e.triggerEvent("keydown",n)?n.kill():!0===e.stopBackspace&&sv(n)&&n.prevent()})),a=function(n,t){return lv()?Cg(n,"focus",t):Eg(n,"focusin",t)}(n,(function(n){e.triggerEvent("focusin",n)&&n.kill()})),f=To(y.none()),s=function(n,t){return lv()?Cg(n,"blur",t):Eg(n,"focusout",t)}(n,(function(n){e.triggerEvent("focusout",n)&&n.kill(),f.set(y.some(setTimeout((function(){e.triggerEvent(Un(),n)}),0)))}))
return{unbind:function(){V(o,(function(n){n.unbind()})),c.unbind(),a.unbind(),s.unbind(),u.unbind(),i.get().each(clearTimeout),f.get().each(clearTimeout)}}},gv=function(n,t){var e=re(n,"target").getOr(t)
return To(e)},pv=ze([{stopped:[]},{resume:["element"]},{complete:[]}]),vv=function(n,t,e,r,o,i){var u=n(t,r),c=function(n,t){var e=To(!1),r=To(!1)
return{stop:function(){e.set(!0)},cut:function(){r.set(!0)},isStopped:e.get,isCut:r.get,event:n,setSource:t.set,getSource:t.get}}(e,o)
return u.fold((function(){return i.logEventNoHandlers(t,r),pv.complete()}),(function(n){var e=n.descHandler
return rm(e)(c),c.isStopped()?(i.logEventStopped(t,n.element,e.purpose),pv.stopped()):c.isCut()?(i.logEventCut(t,n.element,e.purpose),pv.complete()):Tt(n.element).fold((function(){return i.logNoParent(t,n.element,e.purpose),pv.complete()}),(function(r){return i.logEventResponse(t,n.element,e.purpose),pv.resume(r)}))}))},hv=function(n,t,e,r,o,i){return vv(n,t,e,r,o,i).fold((function(){return!0}),(function(r){return hv(n,t,e,r,o,i)}),(function(){return!1}))},yv=function(n,t,e){var o=function(n){var t=To(!1)
return{stop:function(){t.set(!0)},cut:r,isStopped:t.get,isCut:d,event:n,setSource:s("Cannot set source of a broadcasted event"),getSource:s("Cannot get source of a broadcasted event")}}(t)
return V(n,(function(n){var t=n.descHandler
rm(t)(o)})),o.isStopped()},bv=function(n,t,e,r,o){var i=gv(e,r)
return hv(n,t,e,r,i,o)}
function xv(){var n={}
return{registerId:function(t,e,r){Qt(r,(function(r,o){var i=void 0!==n[o]?n[o]:{}
i[e]=function(n,t){return e=c.apply(void 0,[n.handler].concat(t)),r=n.purpose,{cHandler:e,purpose:r}
var e,r}(r,t),n[o]=i}))},unregisterId:function(t){Qt(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))},filterByType:function(t){return re(n,t).map((function(n){return ee(n,(function(n,t){return function(n,t){return{id:n,descHandler:t}}(t,n)}))})).getOr([])},find:function(t,e,r){var o=re(n,e)
return Ur(r,(function(n){return function(n,t){return sf(t).fold((function(){return y.none()}),(function(e){return n.bind((function(n){return re(n,e)})).map((function(n){return function(n,t){return{element:n,descHandler:t}}(t,n)}))}))}(o,n)}),t)}}}function wv(){var n=xv(),t={},e=function(n){var t=n.element
return sf(t).fold((function(){return function(n,t){var e=Ca(cf+n)
return ff(t,e),e}("uid-",n.element)}),(function(n){return n}))},r=function(e){sf(e.element).each((function(e){delete t[e],n.unregisterId(e)}))}
return{find:function(t,e,r){return n.find(t,e,r)},filter:function(t){return n.filterByType(t)},register:function(o){var i=e(o)
ie(t,i)&&function(n,e){var o=t[e]
if(o!==n)throw new Error('The tagId "'+e+'" is already used by: '+Ho(o.element)+"\nCannot use it for: "+Ho(n.element)+"\nThe conflicting element is"+(Ht(o.element)?" ":" not ")+"already in the DOM")
r(n)}(o,i)
var u=[o]
n.registerId(u,i,o.events),t[i]=o},unregister:r,getById:function(n){return re(t,n)}}}var Sv=function(n){var t=function(t){return Tt(n.element).fold((function(){return!0}),(function(n){return pt(t,n)}))},e=wv(),o=function(n,r){return e.find(t,n,r)},u=mv(n.element,{triggerEvent:function(n,t){return Xo(n,t.target,(function(e){return function(n,t,e,r){return bv(n,t,e,e.target,r)}(o,n,t,e)}))}}),c={debugInfo:i("real"),triggerEvent:function(n,t,e){Xo(n,t,(function(r){return bv(o,n,e,t,r)}))},triggerFocus:function(n,t){sf(n).fold((function(){ko(n)}),(function(e){Xo($n(),n,(function(e){return function(n,t,e,r,o){var i=gv(e,r)
vv(n,t,e,r,i,o)}(o,$n(),{originator:t,kill:r,prevent:r,target:n},n,e),!1}))}))},triggerEscape:function(n,t){c.triggerEvent("keydown",n.element,t.event)},getByUid:function(n){return h(n)},getByDom:function(n){return y(n)},build:Sm,addToGui:function(n){s(n)},removeFromGui:function(n){l(n)},addToWorld:function(n){a(n)},removeFromWorld:function(n){f(n)},broadcast:function(n){g(n)},broadcastOn:function(n,t){p(n,t)},broadcastEvent:function(n,t){v(n,t)},isConnected:m},a=function(n){n.connect(c),bt(n.element)||(e.register(n),V(n.components(),a),c.triggerEvent(Qn(),n.element,{target:n.element}))},f=function(n){bt(n.element)||(V(n.components(),f),e.unregister(n)),n.disconnect()},s=function(t){(function(n,t){Xt(n,t,_t)})(n,t)},l=function(n){qt(n)},d=function(n){var t=e.filter(Xn())
V(t,(function(t){var e=t.descHandler
rm(e)(n)}))},g=function(n){d({universal:!0,data:n})},p=function(n,t){d({universal:!1,channels:n,data:t})},v=function(n,t){var r=e.filter(n)
return yv(r,t)},h=function(n){return e.getById(n).fold((function(){return ke.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),ke.value)},y=function(n){var t=sf(n).getOr("not found")
return h(t)}
return a(n),{root:n,element:n.element,destroy:function(){u.unbind(),Rt(n.element)},add:s,remove:l,getByUid:h,getByDom:y,addToWorld:a,removeFromWorld:f,broadcast:g,broadcastOn:p,broadcastEvent:v}},Ov=ki("readonly-mode"),Tv=ki("edit-mode")
function kv(n){var t=Sm(dd.sketch({dom:{classes:[ki("outer-container")].concat(n.classes)},containerBehaviours:yo([Oo.config({alpha:Ov,omega:Tv})])}))
return Sv(t)}var Ev=function(n,t){var e=st.fromTag("input")
Bi(e,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"}),_t(n,e),ko(e),t(e),Rt(e)},Cv=function(n){var t=n.getSelection()
if(t.rangeCount>0){var e=t.getRangeAt(0),r=n.document.createRange()
r.setStart(e.startContainer,e.startOffset),r.setEnd(e.endContainer,e.endOffset),t.removeAllRanges(),t.addRange(r)}},Mv=function(n,t){Co().each((function(n){pt(n,t)||Eo(n)})),n.focus(),ko(st.fromDom(n.document.body)),Cv(n)},Dv=function(n,t,e,r){var o=function(){Mv(t,r)},i=Eg(e,"keydown",(function(n){I(["input","textarea"],vt(n.target))||o()}))
return{toReading:function(){Ev(n,Eo)},toEditing:o,onToolbarTouch:function(){},destroy:function(){i.unbind()}}},_v=function(n,t,e,r,o){var i=function(){t.run((function(n){n.refreshSelection()}))},u=function(n,e){var o=n-r.dom.scrollTop
t.run((function(n){n.scrollIntoView(o,o+e)}))},c=function(){t.run((function(n){n.clearSelection()}))},a=function(){n.getCursorBox().each((function(n){u(n.top,n.height)})),t.run((function(n){n.syncHeight()}))},f=pp(n),s=Mp(a,300),l=[n.onKeyup((function(){c(),s.throttle()})),n.onNodeChanged(i),n.onDomChanged(s.throttle),n.onDomChanged(i),n.onScrollToCursor((function(n){n.preventDefault(),s.throttle()})),n.onScrollToElement((function(n){n.element,u(t,r)})),n.onToEditing((function(){t.run((function(n){n.toEditing()}))})),n.onToReading((function(){t.run((function(n){n.toReading()}))})),Eg(n.doc,"touchend",(function(t){pt(n.html,t.target)||pt(n.body,t.target)})),Eg(e,"transitionend",(function(n){var r
"height"===n.raw.propertyName&&(r=Gi(e),t.run((function(n){n.setViewportOffset(r)})),i(),a())})),Cg(e,"touchstart",(function(e){var r
t.run((function(n){n.highlightSelection()})),r=e,t.run((function(n){n.onToolbarTouch(r)})),n.onTouchToolstrip()})),Eg(n.body,"touchstart",(function(t){c(),n.onTouchContent(),f.fireTouchstart(t)})),f.onTouchmove(),f.onTouchend(),Eg(n.body,"click",(function(n){n.kill()})),Eg(e,"touchmove",(function(){n.onToolbarScrollStart()}))]
return{destroy:function(){V(l,(function(n){n.unbind()}))}}}
var Iv={},Fv={exports:Iv};(function(n,t,e,r){(function(r){if("object"==typeof t&&void 0!==e)e.exports=r()
else if("function"==typeof n&&n.amd)n([],r)
else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=r()}})((function(){return function n(t,e,o){function i(c,a){if(!e[c]){if(!t[c]){var f="function"==typeof r&&r
if(!a&&f)return f(c,!0)
if(u)return u(c,!0)
var s=new Error("Cannot find module '"+c+"'")
throw s.code="MODULE_NOT_FOUND",s}var l=e[c]={exports:{}}
t[c][0].call(l.exports,(function(n){return i(t[c][1][n]||n)}),l,l.exports,n,t,e,o)}return e[c].exports}for(var u="function"==typeof r&&r,c=0;c<o.length;c++)i(o[c])
return i}({1:[function(n,t,e){var r,o,i=t.exports={}
function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(n){if(r===setTimeout)return setTimeout(n,0)
if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(n,0)
try{return r(n,0)}catch(t){try{return r.call(null,n,0)}catch(t){return r.call(this,n,0)}}}(function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(n){r=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(n){o=c}})()
var f,s=[],l=!1,d=-1
function m(){l&&f&&(l=!1,f.length?s=f.concat(s):d=-1,s.length&&g())}function g(){if(!l){var n=a(m)
l=!0
for(var t=s.length;t;){for(f=s,s=[];++d<t;)f&&f[d].run()
d=-1,t=s.length}f=null,l=!1,function(n){if(o===clearTimeout)return clearTimeout(n)
if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(n)
try{o(n)}catch(t){try{return o.call(null,n)}catch(t){return o.call(this,n)}}}(n)}}function p(n,t){this.fun=n,this.array=t}function v(){}i.nextTick=function(n){var t=new Array(arguments.length-1)
if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e]
s.push(new p(n,t)),1!==s.length||l||a(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){(function(e){var r=setTimeout
function o(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new")
if("function"!=typeof n)throw new TypeError("not a function")
this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(n,this)}function u(n,t){for(;3===n._state;)n=n._value
0!==n._state?(n._handled=!0,i._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected
if(null!==e){var r
try{r=e(n._value)}catch(o){return void a(t.promise,o)}c(t.promise,r)}else(1===n._state?c:a)(t.promise,n._value)}))):n._deferreds.push(t)}function c(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.")
if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then
if(t instanceof i)return n._state=3,n._value=t,void f(n)
if("function"==typeof e)return void l((r=e,o=t,function(){r.apply(o,arguments)}),n)}n._state=1,n._value=t,f(n)}catch(u){a(n,u)}var r,o}function a(n,t){n._state=2,n._value=t,f(n)}function f(n){2===n._state&&0===n._deferreds.length&&i._immediateFn((function(){n._handled||i._unhandledRejectionFn(n._value)}))
for(var t=0,e=n._deferreds.length;t<e;t++)u(n,n._deferreds[t])
n._deferreds=null}function s(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function l(n,t){var e=!1
try{n((function(n){e||(e=!0,c(t,n))}),(function(n){e||(e=!0,a(t,n))}))}catch(r){if(e)return
e=!0,a(t,r)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,t){var e=new this.constructor(o)
return u(this,new s(n,t,e)),e},i.all=function(n){var t=Array.prototype.slice.call(n)
return new i((function(n,e){if(0===t.length)return n([])
var r=t.length
function o(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then
if("function"==typeof c)return void c.call(u,(function(n){o(i,n)}),e)}t[i]=u,0==--r&&n(t)}catch(a){e(a)}}for(var i=0;i<t.length;i++)o(i,t[i])}))},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i((function(t){t(n)}))},i.reject=function(n){return new i((function(t,e){e(n)}))},i.race=function(n){return new i((function(t,e){for(var r=0,o=n.length;r<o;r++)n[r].then(t,e)}))},i._immediateFn="function"==typeof n?function(t){n(t)}:function(n){r(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==t&&t.exports?t.exports=i:e.Promise||(e.Promise=i)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,r){var o=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,c={},a=0
function f(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new f(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new f(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId)
var t=n._idleTimeout
t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"==typeof t?t:function(n){var t=a++,r=!(arguments.length<2)&&u.call(arguments,1)
return c[t]=!0,o((function(){c[t]&&(r?n.apply(null,r):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"==typeof r?r:function(n){delete c[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var r=n("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")()
t.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,Iv,Fv,void 0)
var Rv,Vv=Fv.exports.boltExport,Bv=function(n){var t=y.none(),e=[],r=function(n){o()?u(n):e.push(n)},o=function(){return t.isSome()},i=function(n){V(n,u)},u=function(n){t.each((function(t){setTimeout((function(){n(t)}),0)}))}
return n((function(n){o()||(t=y.some(n),i(e),e=[])})),{get:r,map:function(n){return Bv((function(t){r((function(e){t(n(e))}))}))},isReady:o}},Av={nu:Bv,pure:function(n){return Bv((function(t){t(n)}))}},jv=function(n){setTimeout((function(){throw n}),0)},Nv=function(n){var t=function(t){n().then(t,jv)}
return{map:function(t){return Nv((function(){return n().then(t)}))},bind:function(t){return Nv((function(){return n().then((function(n){return t(n).toPromise()}))}))},anonBind:function(t){return Nv((function(){return n().then((function(){return t.toPromise()}))}))},toLazy:function(){return Av.nu(t)},toCached:function(){var t=null
return Nv((function(){return null===t&&(t=n()),t}))},toPromise:n,get:t}},Pv=function(n){return Nv((function(){return new Vv(n)}))},Hv=function(n){return Nv((function(){return Vv.resolve(n)}))},zv=function(n,t){return X([{width:320,height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],(function(e){return function(n,t){return n?y.some(t):y.none()}(n<=e.width&&t<=e.height,e.keyboard)})).getOr({portrait:t/5,landscape:n/4})},Lv=function(n){var t=Dg(n).isPortrait(),e=function(n){return zv(n.screen.width,n.screen.height)}(n),r=t?e.portrait:e.landscape
return(t?n.screen.height:n.screen.width)-n.innerHeight>r?0:r},Gv=function(n,t){var e=St(n).dom.defaultView
return Gi(n)+Gi(t)-Lv(e)},$v=function(n,t,e){var r=Gv(t,e),o=Gi(t)+Gi(e)-r
Vi(n,"padding-bottom",o+"px")},Uv=ze([{fixed:["element","property","offsetY"]},{scroller:["element","offsetY"]}]),Wv="data-"+ki("position-y-fixed"),Xv="data-"+ki("y-property"),qv="data-"+ki("scrolling"),Yv="data-"+ki("last-window-height"),Kv=function(n){return yp(n,Wv)},Jv=function(n,t){var e=function(n){return fe(n,Xv)}(n)
return Uv.fixed(n,e,t)},Qv=function(n,t){return Uv.scroller(n,t)},Zv=function(n){var t=Kv(n)
return("true"===fe(n,qv)?Qv:Jv)(n,t)},nh=function(n,t,e){var r=St(n).dom.defaultView.innerHeight
return ce(n,Yv,r+"px"),r-t-e},th=function(n,t,e,r){var o=St(n).dom.defaultView,i=function(n){var t=fe(n,"style")
return Bi(n,{position:"absolute",top:"0px"}),ce(n,Wv,"0px"),ce(n,Xv,"top"),{restore:function(){ce(n,"style",t||""),de(n,Wv),de(n,Xv)}}}(e),u=Gi(e),c=Gi(r),a=function(n,t,e){var r=fe(e,"style")
return cg(e),Bi(e,{position:"absolute",height:t+"px",width:"100%",top:n+"px"}),ce(e,Wv,n+"px"),ce(e,qv,"true"),ce(e,Xv,"top"),{restore:function(){ag(e),ce(e,"style",r||""),de(e,Wv),de(e,qv),de(e,Xv)}}}(u,nh(n,u,c),n),s=function(n){var t=fe(n,"style")
return Bi(n,{position:"absolute",bottom:"0px"}),ce(n,Wv,"0px"),ce(n,Xv,"bottom"),{restore:function(){ce(n,"style",t||""),de(n,Wv),de(n,Xv)}}}(r),l=!0,d=function(){return o.innerHeight>function(n){return yp(n,Yv)}(n)},m=function(){if(l){var o=Gi(e),i=Gi(r),u=nh(n,o,i)
ce(n,Wv,o+"px"),Vi(n,"height",u+"px"),$v(t,n,r)}}
return $v(t,n,r),{setViewportOffset:function(t){ce(n,Wv,t+"px"),m()},isExpanding:d,isShrinking:f(d),refresh:m,restore:function(){l=!1,i.restore(),a.restore(),s.restore()}}},eh=(Rv=null,{animate:function(n,t,e,r,o,i){var u=!1,c=function(n){u=!0,o(n)}
Mg.clearInterval(Rv)
var a=function(n){Mg.clearInterval(Rv),c(n)}
Rv=Mg.setInterval((function(){var o=n();(function(n,t,e){return Math.abs(n-t)<=e?y.none():n<t?y.some(n+e):y.some(n-e)})(o,t,e).fold((function(){Mg.clearInterval(Rv),c(t)}),(function(e){if(r(e,a),!u){var i=n();(i!==e||Math.abs(i-t)>Math.abs(o-t))&&(Mg.clearInterval(Rv),c(t))}}))}),i)}}),rh="data-"+ki("last-scroll-top"),oh=function(n){var t=Ni(n,"top").getOr("0")
return parseInt(t,10)},ih=function(n){return parseInt(n.dom.scrollTop,10)},uh=function(n,t){return Pv((function(e){var r=c(ih,n)
ce(n,rh,r())
var o=Math.abs(t-r()),i=Math.ceil(o/10)
eh.animate(r,t,i,(function(t,e){yp(n,rh)!==n.dom.scrollTop?e(n.dom.scrollTop):(n.dom.scrollTop=t,ce(n,rh,t))}),(function(){n.dom.scrollTop=t,ce(n,rh,t),e(t)}),10)}))},ch=function(n,t){var e=t+Kv(n)+"px"
Vi(n,"top",e)}
var ah=function(n,t){return t((function(t){var e=[],r=0
0===n.length?t([]):V(n,(function(o,i){o.get(function(o){return function(i){e[o]=i,++r>=n.length&&t(e)}}(i))}))}))},fh=function(n,t,e){var r=t+e,o=Ni(n,"top").getOr(e),i=r-parseInt(o,10)
return function(n,t,e){return Pv((function(r){var o=c(ih,n)
eh.animate(o,t,15,(function(t){n.dom.scrollTop=t,Vi(n,"top",oh(n)+15+"px")}),(function(){n.dom.scrollTop=t,Vi(n,"top",e+"px"),r(t)}),10)}))}(n,n.dom.scrollTop+i,r)},sh=function(n,t){return n.fold((function(n,e,r){return function(n,t,e,r){return Vi(n,t,e+r+"px"),Hv(r)}(n,e,t,r)}),(function(n,e){return fh(n,t,e)}))},lh=function(n,t){var e=function(n){var t=Xi(n,"["+Wv+"]")
return R(t,Zv)}(n),r=R(e,(function(n){return sh(n,t)}))
return ah(r,Pv)},dh=function(n,t,e,r,o,i){var c,a,f=(c=function(e){return function(n,t,e){var r=St(n).dom.defaultView
return Pv((function(o){ch(n,e),ch(t,e),r.scrollTo(0,e),o(e)}))}(n,t,e)},a=To(Av.pure({})),{start:function(n){var t=Av.nu((function(t){return c(n).get(t)}))
a.set(t)},idle:function(n){a.get().get((function(){n()}))}}),s=Mp((function(){f.idle((function(){lh(e,r.pageYOffset).get((function(){var n;(n=wp(i),y.from(n[0]).bind((function(n){var e=n.top-t.dom.scrollTop
return e>r.innerHeight+5||e<-5?y.some({top:e,bottom:e+n.height}):y.none()}))).each((function(n){t.dom.scrollTop=t.dom.scrollTop+n.top})),f.start(0),o.refresh()}))}))}),1e3),l=Eg(st.fromDom(r),"scroll",(function(){r.pageYOffset<0||s.throttle()}))
return lh(e,r.pageYOffset).get(u),{unbind:l.unbind}},mh=function(n){var t=n.cWin,e=n.ceBody,o=n.socket,i=n.toolstrip,a=n.contentElement,f=n.keyboardType,s=n.outerWindow,l=n.dropup,d=n.outerBody,m=th(o,e,i,l),g=f(d,t,zt(),a),p=Ig(s,{onChange:r,onReady:m.refresh})
p.onAdjustment((function(){m.refresh()}))
var v=Eg(st.fromDom(s),"resize",(function(){m.isExpanding()&&m.refresh()})),h=dh(i,o,d,s,m,t),y=function(n,t){var e=n.document,r=st.fromTag("div")
he(r,ki("unfocused-selections")),_t(st.fromDom(e.documentElement),r)
var o=Eg(r,"touchstart",(function(e){e.prevent(),Mv(n,t),u()})),i=function(n){var t=st.fromTag("span")
return lm(t,[ki("layer-editor"),ki("unfocused-selection")]),Bi(t,{left:n.left+"px",top:n.top+"px",width:n.width+"px",height:n.height+"px"}),t},u=function(){Ft(r)}
return{update:function(){u()
var t=wp(n),e=R(t,i)
It(r,e)},isActive:function(){return kt(r).length>0},destroy:function(){o.unbind(),Rt(r)},clear:u}}(t,a),b=function(){y.clear()}
return{toEditing:function(){g.toEditing(),b()},toReading:function(){g.toReading()},onToolbarTouch:function(n){g.onToolbarTouch()},refreshSelection:function(){y.isActive()&&y.update()},clearSelection:b,highlightSelection:function(){y.update()},scrollIntoView:function(n,e){(function(n,t,e,r,o){var i=Gv(t,e),u=c(Cv,n)
r>i||o>i?uh(t,t.dom.scrollTop-i+o).get(u):r<0&&uh(t,t.dom.scrollTop+r).get(u)})(t,o,l,n,e)},updateToolbarPadding:r,setViewportOffset:function(n){m.setViewportOffset(n),function(n,t){return Pv((function(e){var r=c(oh,n),o=function(t){Vi(n,"top",t+"px")},i=Math.abs(t-r()),u=Math.ceil(i/10)
eh.animate(r,t,u,o,(function(){o(t),e(t)}),10)}))}(o,n).get(u)},syncHeight:function(){Vi(a,"height",a.dom.contentWindow.document.body.scrollHeight+"px")},refreshStructure:m.refresh,destroy:function(){m.restore(),p.destroy(),h.unbind(),v.unbind(),g.destroy(),y.destroy(),Ev(zt(),Eo)}}},gh=function(n){var t=Mr("Getting IosWebapp schema",Ip,n)
Vi(t.toolstrip,"width","100%"),Vi(t.container,"position","relative")
var e=Sm(Dp((function(){t.setReadOnly(t.readOnlyOnInit()),i.enter()}),t.translate))
t.alloy.add(e)
var o={show:function(){t.alloy.add(e)},hide:function(){t.alloy.remove(e)}},i=function(n,t){var e=up(),o=Wd(),i=Wd(),u=Ud(),c=Ud()
return{enter:function(){t.hide()
var a=st.fromDom(document)
op(n.editor).each((function(t){var f,s
o.set({socketHeight:Ni(n.socket,"height"),iframeHeight:Ni(t.frame,"height"),outerScroll:document.body.scrollTop}),i.set({exclusives:(f=a,s="."+fg,Eg(f,"touchmove",(function(n){nu(n.target,s).filter(Hp).fold((function(){n.prevent()}),r)})))}),he(n.container,ki("fullscreen-maximized")),lp(n.container,t.body),e.maximize(),Vi(n.socket,"overflow","scroll"),Vi(n.socket,"-webkit-overflow-scrolling","touch"),ko(t.body),u.set(mh({cWin:t.win,ceBody:t.body,socket:n.socket,toolstrip:n.toolstrip,dropup:n.dropup.element,contentElement:t.frame,outerBody:n.body,outerWindow:n.win,keyboardType:Dv})),u.run((function(n){n.syncHeight()})),c.set(_v(t,u,n.toolstrip,n.socket,n.dropup))}))},refreshStructure:function(){u.run((function(n){n.refreshStructure()}))},exit:function(){e.restore(),c.clear(),u.clear(),t.show(),o.on((function(t){t.socketHeight.each((function(t){Vi(n.socket,"height",t)})),t.iframeHeight.each((function(t){Vi(n.editor.getFrame(),"height",t)})),document.body.scrollTop=t.scrollTop})),o.clear(),i.on((function(n){n.exclusives.unbind()})),i.clear(),be(n.container,ki("fullscreen-maximized")),dp(),ag(n.toolbar),Pi(n.socket,"overflow"),Pi(n.socket,"-webkit-overflow-scrolling"),Eo(n.editor.getFrame()),op(n.editor).each((function(n){n.clearSelection()}))}}}(t,o)
return{setReadOnly:t.setReadOnly,refreshStructure:i.refreshStructure,enter:i.enter,exit:i.exit,destroy:r}}
var ph=tinymce.util.Tools.resolve("tinymce.EditorManager"),vh=function(n,t,e){n.system.broadcastOn([Ro],{command:t,state:e})},hh=function(n){return function(){var t=function(){n._skinLoaded=!0,n.fire("SkinLoaded")}
n.initialized?t():n.on("init",t)}},yh="toReading",bh="toEditing",xh=function(n){return{getNotificationManagerImpl:function(){return{open:i({progressBar:{value:r},close:r,text:r,getEl:i(null),moveTo:r,moveRel:r,settings:{}}),close:r,reposition:r,getArgs:i({})}},renderUI:function(){var t=n.getElement(),e=function(n){var t=y.from(function(n){return n.getParam("skin_url")}(n)).fold((function(){return ph.baseURL+"/skins/ui/oxide"}),(function(n){return n}))
return{content:t+"/content.mobile.min.css",ui:t+"/skin.mobile.min.css"}}(n)
if(!1===function(n){return!1===n.getParam("skin")}(n)){var o=Do.DOM.styleSheetLoader
n.contentCSS.push(e.content),o.load(e.ui,hh(n)),n.on("remove",(function(){return o.unload(e.ui)}))}else hh(n)()
var i=function(){n.fire("ScrollIntoView")},u=En().os.isAndroid()?function(n){var t=kv({classes:[ki("android-container")]}),e=zp(),o=Ud(),i=Lp(o),u=Gp(),c=fv(r,n)
return t.add(e.wrapper),t.add(u),t.add(c.component),{system:t,element:t.element,init:function(n){o.set(Fp(n))},exit:function(){o.run((function(n){n.exit(),$m.remove(u,i)}))},setToolbarGroups:function(n){var t=e.createGroups(n)
e.setGroups(t)},setContextToolbar:function(n){var t=e.createGroups(n)
e.setContextToolbar(t)},focusToolbar:function(){e.focus()},restoreToolbar:function(){e.restoreToolbar()},updateMode:function(n){Wp(u,i,n,t.root)},socket:u,dropup:c}}(i):function(n){var t=kv({classes:[ki("ios-container")]}),e=zp(),r=Ud(),o=Lp(r),i=Gp(),u=fv((function(){r.run((function(n){n.refreshStructure()}))}),n)
return t.add(e.wrapper),t.add(i),t.add(u.component),{system:t,element:t.element,init:function(n){r.set(gh(n))},exit:function(){r.run((function(n){$m.remove(i,o),n.exit()}))},setToolbarGroups:function(n){var t=e.createGroups(n)
e.setGroups(t)},setContextToolbar:function(n){var t=e.createGroups(n)
e.setContextToolbar(t)},focusToolbar:function(){e.focus()},restoreToolbar:function(){e.restoreToolbar()},updateMode:function(n){Wp(i,o,n,t.root)},socket:i,dropup:u}}(i);(function(n,t){Yt(n,t,Mt)})(st.fromDom(t),u.system)
var c=t.ownerDocument.defaultView,a=Ig(c,{onChange:function(){u.system.broadcastOn([Vo],{width:_g(c)})},onReady:r}),f=function(t,e,r,o){!1===o&&n.selection.collapse()
var i=s(t,e,r)
u.setToolbarGroups(!0===o?i.readOnly:i.main),n.setMode(!0===o?"readonly":"design"),n.fire(!0===o?yh:bh),u.updateMode(o)},s=function(n,t,e){var r=n.get()
return{readOnly:r.backToMask.concat(t.get()),main:r.backToMask.concat(e.get())}},l=function(t,e){return n.on(t,e),{unbind:function(){n.off(t)}}}
return n.on("init",(function(){u.init({editor:{getFrame:function(){return st.fromDom(n.contentAreaContainer.querySelector("iframe"))},onDomChanged:function(){return{unbind:r}},onToReading:function(n){return l(yh,n)},onToEditing:function(n){return l(bh,n)},onScrollToCursor:function(t){n.on("ScrollIntoView",(function(n){t(n)}))
return{unbind:function(){n.off("ScrollIntoView"),a.destroy()}}},onTouchToolstrip:function(){t()},onTouchContent:function(){var e,r=st.fromDom(n.editorContainer.querySelector("."+ki("toolbar")));(e=r,Mo(e).bind((function(n){return u.system.getByDom(n).toOptional()}))).each(ut),u.restoreToolbar(),t()},onTapContent:function(t){var e=t.target
if("img"===vt(e))n.selection.select(e.dom),t.kill()
else if("a"===vt(e)){u.system.getByDom(st.fromDom(n.editorContainer)).each((function(n){Oo.isAlpha(n)&&function(n){var t=document.createElement("a")
t.target="_blank",t.href=n.href,t.rel="noreferrer noopener"
var e=document.createEvent("MouseEvents")
e.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),document.body.appendChild(t),t.dispatchEvent(e),document.body.removeChild(t)}(e.dom)}))}}},container:st.fromDom(n.editorContainer),socket:st.fromDom(n.contentAreaContainer),toolstrip:st.fromDom(n.editorContainer.querySelector("."+ki("toolstrip"))),toolbar:st.fromDom(n.editorContainer.querySelector("."+ki("toolbar"))),dropup:u.dropup,alloy:u.system,translate:r,setReadOnly:function(n){f(g,m,d,n)},readOnlyOnInit:function(){return!1}})
var t=function(){u.dropup.disappear((function(){u.system.broadcastOn([Bo],{})}))},e={label:"The first group",scrollable:!1,items:[Mf("back",(function(){n.selection.collapse(),u.exit()}),{},n)]},o={label:"Back to read only",scrollable:!1,items:[Mf("readonly-back",(function(){f(g,m,d,!0)}),{},n)]},i=wg(u,n),c=function(n,t){var e=xg(n),r={}
return z(e,(function(n){var e=!ie(r,n)&&ie(t,n)&&t[n].isSupported()?[t[n].sketch()]:[]
return r[n]=!0,e}))}(n,i),s={label:"The extra group",scrollable:!1,items:[]},d=To([{label:"the action group",scrollable:!0,items:c},s]),m=To([{label:"The read only mode group",scrollable:!0,items:[]},s]),g=To({backToMask:[e],backToReadOnly:[o]});(function(n,t){var e=Kt(t.formatter.get())
V(e,(function(e){t.formatter.formatChanged(e,(function(t){vh(n,e,t)}))})),V(["ul","ol"],(function(e){t.selection.selectorChanged(e,(function(t,r){vh(n,e,t)}))}))})(u,n)})),n.on("remove",(function(){u.exit()})),n.on("detach",(function(){var n,t
n=u.system,t=kt(n.element),V(t,(function(t){n.getByDom(t).each(Gt)})),Rt(n.element),u.system.destroy()})),{iframeContainer:u.socket.element.dom,editorContainer:u.element.dom}}}}
_o.add("mobile",xh)})()
