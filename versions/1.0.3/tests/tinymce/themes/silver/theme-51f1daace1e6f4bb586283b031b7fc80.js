(function(){"use strict"
var n=function(){},t=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
return n(t.apply(null,e))}},e=function(n){return function(){return n}},o=function(n){return n}
function r(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e]
return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
var r=t.concat(e)
return n.apply(null,r)}}var i=function(n){return function(t){return!n(t)}},u=function(n){return function(){throw new Error(n)}},a=e(!1),c=e(!0),s=tinymce.util.Tools.resolve("tinymce.ThemeManager"),f=function(){return(f=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var r in t=arguments[e])Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])
return n}).apply(this,arguments)}
function l(n,t){var e={}
for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o])
if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0
for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(e[o[r]]=n[o[r]])}return e}function d(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length
var o=Array(n),r=0
for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u]
return o}var m,g=function(){return p},p=function(){var t=function(n){return n.isNone()},o=function(n){return n()},r=function(n){return n}
return{fold:function(n,t){return n()},is:a,isSome:a,isNone:c,getOr:r,getOrThunk:o,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:e(null),getOrUndefined:e(void 0),or:r,orThunk:o,map:g,each:n,bind:g,exists:a,forall:c,filter:g,equals:t,equals_:t,toArray:function(){return[]},toString:e("none()")}}(),h=function(n){var t=e(n),o=function(){return i},r=function(t){return t(n)},i={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:c,isNone:a,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:o,orThunk:o,map:function(t){return h(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?i:p},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(a,(function(t){return e(n,t)}))}}
return i},v={some:h,none:g,from:function(n){return null==n?p:h(n)}},b=function(n){return function(t){return function(n){var t=typeof n
return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(t)===n}},y=function(n){return function(t){return typeof t===n}},x=b("string"),w=b("object"),S=b("array"),k=y("boolean"),C=function(n){return function(t){return n===t}}(void 0),O=function(n){return!function(n){return null==n}(n)},_=y("function"),T=y("number"),E=function(n,t){if(S(n)){for(var e=0,o=n.length;e<o;++e)if(!t(n[e]))return!1
return!0}return!1},B=Array.prototype.slice,D=Array.prototype.indexOf,A=Array.prototype.push,M=function(n,t){return D.call(n,t)},F=function(n,t){return M(n,t)>-1},I=function(n,t){for(var e=0,o=n.length;e<o;e++){if(t(n[e],e))return!0}return!1},R=function(n,t){for(var e=[],o=0;o<n;o++)e.push(t(o))
return e},V=function(n,t){for(var e=[],o=0;o<n.length;o+=t){var r=B.call(n,o,o+t)
e.push(r)}return e},P=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;r++){var i=n[r]
o[r]=t(i,r)}return o},H=function(n,t){for(var e=0,o=n.length;e<o;e++){t(n[e],e)}},z=function(n,t){for(var e=[],o=[],r=0,i=n.length;r<i;r++){var u=n[r];(t(u,r)?e:o).push(u)}return{pass:e,fail:o}},N=function(n,t){for(var e=[],o=0,r=n.length;o<r;o++){var i=n[o]
t(i,o)&&e.push(i)}return e},L=function(n,t,e){return function(n,t){for(var e=n.length-1;e>=0;e--)t(n[e],e)}(n,(function(n){e=t(e,n)})),e},j=function(n,t,e){return H(n,(function(n){e=t(e,n)})),e},U=function(n,t){return function(n,t,e){for(var o=0,r=n.length;o<r;o++){var i=n[o]
if(t(i,o))return v.some(i)
if(e(i,o))break}return v.none()}(n,t,a)},W=function(n,t){for(var e=0,o=n.length;e<o;e++){if(t(n[e],e))return v.some(e)}return v.none()},G=function(n){for(var t=[],e=0,o=n.length;e<o;++e){if(!S(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n)
A.apply(t,n[e])}return t},X=function(n,t){return G(P(n,t))},Y=function(n,t){for(var e=0,o=n.length;e<o;++e){if(!0!==t(n[e],e))return!1}return!0},q=function(n){var t=B.call(n,0)
return t.reverse(),t},K=function(n,t){return N(n,(function(n){return!F(t,n)}))},J=function(n,t){var e=B.call(n,0)
return e.sort(t),e},$=function(n){return 0===n.length?v.none():v.some(n[0])},Q=function(n){return 0===n.length?v.none():v.some(n[n.length-1])},Z=_(Array.from)?Array.from:function(n){return B.call(n)},nn=function(n,t){for(var e=0;e<n.length;e++){var o=t(n[e],e)
if(o.isSome())return o}return v.none()},tn=function(n){return{is:function(t){return n===t},isValue:c,isError:a,getOr:e(n),getOrThunk:e(n),getOrDie:e(n),or:function(t){return tn(n)},orThunk:function(t){return tn(n)},fold:function(t,e){return e(n)},map:function(t){return tn(t(n))},mapError:function(t){return tn(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return v.some(n)}}},en=function(t){return{is:a,isValue:a,isError:c,getOr:o,getOrThunk:function(n){return n()},getOrDie:function(){return u(String(t))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return en(t)},mapError:function(n){return en(n(t))},each:n,bind:function(n){return en(t)},exists:a,forall:c,toOptional:v.none}},on={value:tn,error:en,fromOption:function(n,t){return n.fold((function(){return en(t)}),tn)}};(function(n){n[n.Error=0]="Error",n[n.Value=1]="Value"})(m||(m={}))
var rn=function(n,t,e){return n.stype===m.Error?t(n.serror):e(n.svalue)},un=function(n){return{stype:m.Value,svalue:n}},an=function(n){return{stype:m.Error,serror:n}},cn=function(n){return n.fold(an,un)},sn=function(n){return rn(n,on.error,on.value)},fn=un,ln=function(n){var t=[],e=[]
return H(n,(function(n){rn(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},dn=an,mn=function(n,t){return n.stype===m.Value?t(n.svalue):n},gn=function(n,t){return n.stype===m.Error?t(n.serror):n},pn=function(n,t){return n.stype===m.Value?{stype:m.Value,svalue:t(n.svalue)}:n},hn=function(n,t){return n.stype===m.Error?{stype:m.Error,serror:t(n.serror)}:n},vn=Object.keys,bn=Object.hasOwnProperty,yn=function(n,t){for(var e=vn(n),o=0,r=e.length;o<r;o++){var i=e[o]
t(n[i],i)}},xn=function(n,t){return wn(n,(function(n,e){return{k:e,v:t(n,e)}}))},wn=function(n,t){var e={}
return yn(n,(function(n,o){var r=t(n,o)
e[r.k]=r.v})),e},Sn=function(t,e){var o={}
return function(n,t,e,o){yn(n,(function(n,r){(t(n,r)?e:o)(n,r)}))}(t,e,function(n){return function(t,e){n[e]=t}}(o),n),o},kn=function(n,t){var e=[]
return yn(n,(function(n,o){e.push(t(n,o))})),e},Cn=function(n,t){for(var e=vn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i]
if(t(u,i,n))return v.some(u)}return v.none()},On=function(n){return kn(n,(function(n){return n}))},_n=function(n,t){return Tn(n,t)?v.from(n[t]):v.none()},Tn=function(n,t){return bn.call(n,t)},En=function(n,t){return Tn(n,t)&&void 0!==n[t]&&null!==n[t]},Bn=function(n){if(!S(n))throw new Error("cases must be an array")
if(0===n.length)throw new Error("there must be at least one case")
var t=[],e={}
return H(n,(function(o,r){var i=vn(o)
if(1!==i.length)throw new Error("one and only one name per case")
var u=i[0],a=o[u]
if(void 0!==e[u])throw new Error("duplicate key detected:"+u)
if("cata"===u)throw new Error("cannot have a case named cata (sorry)")
if(!S(a))throw new Error("case arguments must be an array")
t.push(u),e[u]=function(){var e=arguments.length
if(e!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+e)
for(var o=new Array(e),i=0;i<o.length;i++)o[i]=arguments[i]
var c=function(n){var e=vn(n)
if(t.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+e.join(","))
if(!Y(t,(function(n){return F(e,n)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+t.join(", "))
return n[u].apply(null,o)}
return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length)
var t=arguments[r]
return t.apply(null,o)},match:c,log:function(n){console.log(n,{constructors:t,constructor:u,params:o})}}}})),e},Dn=Object.prototype.hasOwnProperty,An=function(n){return function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e]
if(0===t.length)throw new Error("Can't merge zero objects")
for(var o={},r=0;r<t.length;r++){var i=t[r]
for(var u in i)Dn.call(i,u)&&(o[u]=n(o[u],i[u]))}return o}},Mn=An((function(n,t){return w(n)&&w(t)?Mn(n,t):t})),Fn=An((function(n,t){return t})),In=function(n){var t,e=!1
return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
return e||(e=!0,t=n.apply(null,o)),t}},Rn=Bn([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Vn=function(n){return Rn.defaultedThunk(e(n))},Pn=function(n){return Rn.mergeWithThunk(e(n))},Hn=Rn.strict,zn=Rn.asOption,Nn=Rn.defaultedThunk,Ln=(Rn.asDefaultedOptionThunk,Rn.mergeWithThunk),jn=(Bn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,t){var e
return(e={})[n]=t,e}),Un=function(n,t){return function(n,t){var e={}
return yn(n,(function(n,o){F(t,o)||(e[o]=n)})),e}(n,t)},Wn=function(n,t){return jn(n,t)},Gn=function(n){return function(n){var t={}
return H(n,(function(n){t[n.key]=n.value})),t}(n)},Xn=function(n,t){var e,o=function(n){var t=[],e=[]
return H(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}(n)
return o.errors.length>0?(e=o.errors,on.error(G(e))):function(n,t){return 0===n.length?on.value(t):on.value(Mn(t,Fn.apply(void 0,n)))}(o.values,t)},Yn=function(n){return t(dn,G)(n)},qn=function(n,t){var e=ln(n)
return e.errors.length>0?Yn(e.errors):function(n,t){return n.length>0?fn(Mn(t,Fn.apply(void 0,n))):fn(t)}(e.values,t)},Kn=function(n){var t=ln(n)
return t.errors.length>0?Yn(t.errors):fn(t.values)},Jn=function(n){return w(n)&&vn(n).length>100?" removed due to size":JSON.stringify(n,null,2)},$n=function(n,t){return dn([{path:n,getErrorInfo:t}])},Qn=Bn([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Zn=function(n,t,e){return _n(t,e).fold((function(){return function(n,t,e){return $n(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+Jn(e)}))}(n,e,t)}),fn)},nt=function(n,t,e){var r=_n(n,t).fold((function(){return e(n)}),o)
return fn(r)},tt=function(n,t,o,r){return o.fold((function(o,i,u,a){var c=function(t){var e=a.extract(n.concat([o]),r,t)
return pn(e,(function(n){return jn(i,r(n))}))},s=function(t){return t.fold((function(){var n=jn(i,r(v.none()))
return fn(n)}),(function(t){var e=a.extract(n.concat([o]),r,t)
return pn(e,(function(n){return jn(i,r(v.some(n)))}))}))}
return u.fold((function(){return mn(Zn(n,t,o),c)}),(function(n){return mn(nt(t,o,n),c)}),(function(){return mn(function(n,t){return fn(_n(n,t))}(t,o),s)}),(function(n){return mn(function(n,t,e){var o=_n(n,t).map((function(t){return!0===t?e(n):t}))
return fn(o)}(t,o,n),s)}),(function(n){var r=n(t),i=pn(nt(t,o,e({})),(function(n){return Mn(r,n)}))
return mn(i,c)}))}),(function(n,e){var o=e(t)
return fn(jn(n,r(o)))}))},et=function(n){return{extract:function(t,e,o){return gn(n(o,e),(function(n){return function(n,t){return $n(n,(function(){return t}))}(t,n)}))},toString:function(){return"val"}}},ot=function(n){return vn(Sn(n,(function(n){return null!=n})))},rt=function(n){var t=it(n),o=L(n,(function(n,t){return t.fold((function(t){return Mn(n,Wn(t,!0))}),e(n))}),{})
return{extract:function(n,e,r){var i=k(r)?[]:ot(r),u=N(i,(function(n){return!En(o,n)}))
return 0===u.length?t.extract(n,e,r):function(n,t){return $n(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))}(n,u)},toString:t.toString}},it=function(n){return{extract:function(t,e,o){return function(n,t,e,o){var r=P(e,(function(e){return tt(n,t,e,o)}))
return qn(r,{})}(t,o,n,e)},toString:function(){return"obj{\n"+P(n,(function(n){return n.fold((function(n,t,e,o){return n+" -> "+o.toString()}),(function(n,t){return"state("+n+")"}))})).join("\n")+"}"}}},ut=function(n){return{extract:function(t,e,o){var r=P(o,(function(o,r){return n.extract(t.concat(["["+r+"]"]),e,o)}))
return Kn(r)},toString:function(){return"array("+n.toString()+")"}}},at=function(n){return{extract:function(t,e,o){for(var r=[],i=0,u=n;i<u.length;i++){var a=u[i].extract(t,e,o)
if(a.stype===m.Value)return a
r.push(a)}return Kn(r)},toString:function(){return"oneOf("+P(n,(function(n){return n.toString()})).join(", ")+")"}}},ct=function(n,t){return{extract:function(e,r,i){var u=vn(i),a=function(t,e){return ut(et(n)).extract(t,o,e)}(e,u)
return mn(a,(function(n){var o=P(n,(function(n){return Qn.field(n,n,Hn(),t)}))
return it(o).extract(e,r,i)}))},toString:function(){return"setOf("+t.toString()+")"}}},st=e(et(fn)),ft=t(ut,it),lt=Qn.state,dt=Qn.field,mt=function(n,t,e,o,r){return _n(o,r).fold((function(){return function(n,t,e){return $n(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Jn(t)}))}(n,o,r)}),(function(o){return o.extract(n.concat(["branch: "+r]),t,e)}))},gt=function(n,t){return{extract:function(e,o,r){return _n(r,n).fold((function(){return function(n,t){return $n(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))}(e,n)}),(function(n){return mt(e,o,r,t,n)}))},toString:function(){return"chooseOn("+n+"). Possible values: "+vn(t)}}},pt=et(fn),ht=function(n){return ft(n)},vt=function(n){return{extract:function(t,e,o){return n().extract(t,e,o)},toString:function(){return n().toString()}}},bt=function(n){return et((function(t){return n(t).fold(dn,fn)}))},yt=function(n,t){return ct((function(t){return cn(n(t))}),t)},xt=function(n,t,e){return sn(function(n,t,e,o){var r=t.extract([n],e,o)
return hn(r,(function(n){return{input:o,errors:n}}))}(n,t,o,e))},wt=function(n){return n.fold((function(n){throw new Error(kt(n))}),o)},St=function(n,t,e){return wt(xt(n,t,e))},kt=function(n){return"Errors: \n"+(t=n.errors,e=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,P(e,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))).join("\n")+"\n\nInput object: "+Jn(n.input)
var t,e},Ct=function(n,t){return gt(n,t)},Ot=function(n,t){return gt(n,xn(t,it))},_t=e(pt),Tt=function(n,t){return et((function(e){var o=typeof e
return n(e)?fn(e):dn("Expected type: "+t+" but got: "+o)}))},Et=Tt(T,"number"),Bt=Tt(x,"string"),Dt=Tt(k,"boolean"),At=Tt(_,"function"),Mt=function(n){var t=function(n,t){for(var e=n.next();!e.done;){if(!t(e.value))return!1
e=n.next()}return!0}
if(Object(n)!==n)return!0
switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0
case"Array":case"Object":return Object.keys(n).every((function(t){return Mt(n[t])}))
case"Map":return t(n.keys(),Mt)&&t(n.values(),Mt)
case"Set":return t(n.keys(),Mt)
default:return!1}},Ft=et((function(n){return Mt(n)?fn(n):dn("Expected value to be acceptable for sending via postMessage")})),It=function(n){return bt((function(t){return F(n,t)?on.value(t):on.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')}))},Rt=function(n){return dt(n,n,Hn(),st())},Vt=function(n,t){return dt(n,n,Hn(),t)},Pt=function(n){return Vt(n,Et)},Ht=function(n){return Vt(n,Bt)},zt=function(n,t){return dt(n,n,Hn(),It(t))},Nt=function(n){return Vt(n,At)},Lt=function(n,t){return dt(n,n,Hn(),it(t))},jt=function(n,t){return dt(n,n,Hn(),ft(t))},Ut=function(n,t){return dt(n,n,Hn(),ut(t))},Wt=function(n){return dt(n,n,zn(),st())},Gt=function(n,t){return dt(n,n,zn(),t)},Xt=function(n){return Gt(n,Et)},Yt=function(n){return Gt(n,Bt)},qt=function(n){return Gt(n,At)},Kt=function(n,t){return Gt(n,it(t))},Jt=function(n,t){return dt(n,n,Vn(t),st())},$t=function(n,t,e){return dt(n,n,Vn(t),e)},Qt=function(n,t){return $t(n,t,Et)},Zt=function(n,t){return $t(n,t,Bt)},ne=function(n,t,e){return $t(n,t,It(e))},te=function(n,t){return $t(n,t,Dt)},ee=function(n,t){return $t(n,t,At)},oe=function(n,t,e){return $t(n,t,it(e))},re=function(n,t){return lt(n,t)},ie=function(n){var t=n
return{get:function(){return t},set:function(n){t=n}}},ue=function(n){if(null==n)throw new Error("Node cannot be null or undefined")
return{dom:n}},ae={fromHtml:function(n,t){var e=(t||document).createElement("div")
if(e.innerHTML=n,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node")
return ue(e.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n)
return ue(e)},fromText:function(n,t){var e=(t||document).createTextNode(n)
return ue(e)},fromDom:ue,fromPoint:function(n,t,e){return v.from(n.dom.elementFromPoint(t,e)).map(ue)}},ce=function(){return se(0,0)},se=function(n,t){return{major:n,minor:t}},fe={nu:se,detect:function(n,t){var e=String(t).toLowerCase()
return 0===n.length?ce():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var o=n[e]
if(o.test(t))return o}}(n,t)
if(!e)return{major:0,minor:0}
var o=function(n){return Number(t.replace(e,"$"+n))}
return se(o(1),o(2))}(n,e)},unknown:ce},le=function(n,t){var e=String(t).toLowerCase()
return U(n,(function(n){return n.search(e)}))},de=function(n,t){return le(n,t).map((function(n){var e=fe.detect(n.versionRegexes,t)
return{current:n.name,version:e}}))},me=function(n,t){return le(n,t).map((function(n){var e=fe.detect(n.versionRegexes,t)
return{current:n.name,version:e}}))},ge=function(n,t){return-1!==n.indexOf(t)},pe=function(n){return function(t){return t.replace(n,"")}}(/^\s+|\s+$/g),he=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ve=function(n){return function(t){return ge(t,n)}},be=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return ge(n,"edge/")&&ge(n,"chrome")&&ge(n,"safari")&&ge(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,he],search:function(n){return ge(n,"chrome")&&!ge(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return ge(n,"msie")||ge(n,"trident")}},{name:"Opera",versionRegexes:[he,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ve("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ve("firefox")},{name:"Safari",versionRegexes:[he,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(ge(n,"safari")||ge(n,"mobile/"))&&ge(n,"applewebkit")}}],ye=[{name:"Windows",search:ve("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return ge(n,"iphone")||ge(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ve("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ve("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ve("linux"),versionRegexes:[]},{name:"Solaris",search:ve("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ve("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ve("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],xe={browsers:e(be),oses:e(ye)},we="Edge",Se="Chrome",ke="Opera",Ce="Firefox",Oe="Safari",_e=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}}
return{current:t,version:e,isEdge:o(we),isChrome:o(Se),isIE:o("IE"),isOpera:o(ke),isFirefox:o(Ce),isSafari:o(Oe)}},Te={unknown:function(){return _e({current:void 0,version:fe.unknown()})},nu:_e,edge:e(we),chrome:e(Se),ie:e("IE"),opera:e(ke),firefox:e(Ce),safari:e(Oe)},Ee="Windows",Be="Android",De="Linux",Ae="Solaris",Me="FreeBSD",Fe="ChromeOS",Ie=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}}
return{current:t,version:e,isWindows:o(Ee),isiOS:o("iOS"),isAndroid:o(Be),isOSX:o("OSX"),isLinux:o(De),isSolaris:o(Ae),isFreeBSD:o(Me),isChromeOS:o(Fe)}},Re={unknown:function(){return Ie({current:void 0,version:fe.unknown()})},nu:Ie,windows:e(Ee),ios:e("iOS"),android:e(Be),linux:e(De),osx:e("OSX"),solaris:e(Ae),freebsd:e(Me),chromeos:e(Fe)},Ve=function(n,t){var o=xe.browsers(),r=xe.oses(),i=de(o,n).fold(Te.unknown,Te.nu),u=me(r,n).fold(Re.unknown,Re.nu),a=function(n,t,o,r){var i=n.isiOS()&&!0===/ipad/i.test(o),u=n.isiOS()&&!i,a=n.isiOS()||n.isAndroid(),c=a||r("(pointer:coarse)"),s=i||!u&&a&&r("(min-device-width:768px)"),f=u||a&&!s,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(o),d=!f&&!s&&!l
return{isiPad:e(i),isiPhone:e(u),isTablet:e(s),isPhone:e(f),isTouch:e(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:e(l),isDesktop:e(d)}}(u,i,n,t)
return{browser:i,os:u,deviceType:a}},Pe=function(n){return window.matchMedia(n).matches},He=In((function(){return Ve(navigator.userAgent,Pe)})),ze=function(){return He()},Ne=function(n,t){var e=n.dom
if(1!==e.nodeType)return!1
var o=e
if(void 0!==o.matches)return o.matches(t)
if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t)
if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t)
if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t)
throw new Error("Browser lacks native selectors")},Le=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},je=function(n,t){return n.dom===t.dom},Ue=function(n,t){return function(n,t){return function(n,t,e){return 0!=(n.compareDocumentPosition(t)&e)}(n,t,Node.DOCUMENT_POSITION_CONTAINED_BY)}(n.dom,t.dom)},We=function(n,t){return ze().browser.isIE()?Ue(n,t):function(n,t){var e=n.dom,o=t.dom
return e!==o&&e.contains(o)}(n,t)},Ge=function(n){return _(n)?n:a},Xe=function(n,t,e){for(var o=n.dom,r=Ge(e);o.parentNode;){o=o.parentNode
var i=ae.fromDom(o),u=t(i)
if(u.isSome())return u
if(r(i))break}return v.none()},Ye=function(n,t,e){var o=t(n),r=Ge(e)
return o.orThunk((function(){return r(n)?v.none():Xe(n,t,r)}))},qe=function(n,t){return je(n.element,t.event.target)},Ke=function(t){if(!En(t,"can")&&!En(t,"abort")&&!En(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!")
return St("Extracting event.handler",rt([Jt("can",c),Jt("abort",a),Jt("run",n)]),t)},Je=function(n){var t=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
return j(n,(function(n,o){return n&&t(o).apply(void 0,e)}),!0)}}(n,(function(n){return n.can})),e=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
return j(n,(function(n,o){return n||t(o).apply(void 0,e)}),!1)}}(n,(function(n){return n.abort}))
return Ke({can:t,abort:e,run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]
H(n,(function(n){n.run.apply(void 0,t)}))}})},$e=e,Qe=$e("touchstart"),Ze=$e("touchmove"),no=$e("touchend"),to=$e("touchcancel"),eo=$e("mousedown"),oo=$e("mousemove"),ro=$e("mouseout"),io=$e("mouseup"),uo=$e("mouseover"),ao=$e("focusin"),co=$e("focusout"),so=$e("keydown"),fo=$e("keyup"),lo=$e("input"),mo=$e("change"),go=$e("click"),po=$e("transitionend"),ho=$e("selectstart"),vo=function(n){return e("alloy."+n)},bo={tap:vo("tap")},yo=vo("focus"),xo=vo("blur.post"),wo=vo("paste.post"),So=vo("receive"),ko=vo("execute"),Co=vo("focus.item"),Oo=bo.tap,_o=vo("longpress"),To=vo("sandbox.close"),Eo=vo("typeahead.cancel"),Bo=vo("system.init"),Do=vo("system.touchmove"),Ao=vo("system.touchend"),Mo=vo("system.scroll"),Fo=vo("system.resize"),Io=vo("system.attached"),Ro=vo("system.detached"),Vo=vo("system.dismissRequested"),Po=vo("system.repositionRequested"),Ho=vo("focusmanager.shifted"),zo=vo("slotcontainer.visibility"),No=vo("change.tab"),Lo=vo("dismiss.tab"),jo=vo("highlight"),Uo=vo("dehighlight"),Wo=function(n,t){qo(n,n.element,t,{})},Go=function(n,t,e){qo(n,n.element,t,e)},Xo=function(n){Wo(n,ko())},Yo=function(n,t,e){qo(n,t,e,{})},qo=function(n,t,e,o){var r=f({target:t},o)
n.getSystem().triggerEvent(e,t,r)},Ko=function(n,t,e,o){n.getSystem().triggerEvent(e,t,o.event)},Jo=function(n){return Gn(n)},$o=function(n,t){return{key:n,value:Ke({abort:t})}},Qo=function(n){return{key:n,value:Ke({run:function(n,t){t.event.prevent()}})}},Zo=function(n,t){return{key:n,value:Ke({run:t})}},nr=function(n,t,e){return{key:n,value:Ke({run:function(n,o){t.apply(void 0,[n,o].concat(e))}})}},tr=function(n){return function(t){return{key:n,value:Ke({run:function(n,e){qe(n,e)&&t(n,e)}})}}},er=function(n,t,e){return function(n,t){return Zo(n,(function(e,o){e.getSystem().getByUid(t).each((function(t){Ko(t,t.element,n,o)}))}))}(n,t.partUids[e])},or=function(n,t){return Zo(n,(function(n,e){var o=e.event,r=n.getSystem().getByDom(o.target).fold((function(){return Ye(o.target,(function(t){return n.getSystem().getByDom(t).toOptional()}),a).getOr(n)}),(function(n){return n}))
t(n,r,e)}))},rr=function(n){return Zo(n,(function(n,t){t.cut()}))},ir=function(n){return Zo(n,(function(n,t){t.stop()}))},ur=function(n,t){return tr(n)(t)},ar=tr(Io()),cr=tr(Ro()),sr=tr(Bo()),fr=function(n){return function(t){return Zo(n,t)}}(ko()),lr=("undefined"!=typeof window?window:Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),dr=function(n){return function(t){return function(n){return n.dom.nodeType}(t)===n}},mr=dr(1),gr=dr(3),pr=dr(9),hr=dr(11),vr=function(n){return ae.fromDom(n.dom.ownerDocument)},br=function(n){return pr(n)?n:vr(n)},yr=function(n){return ae.fromDom(br(n).dom.documentElement)},xr=function(n){return ae.fromDom(br(n).dom.defaultView)},wr=function(n){return v.from(n.dom.parentNode).map(ae.fromDom)},Sr=function(n){return v.from(n.dom.offsetParent).map(ae.fromDom)},kr=function(n){return P(n.dom.childNodes,ae.fromDom)},Cr=function(n,t){var e=n.dom.childNodes
return v.from(e[t]).map(ae.fromDom)},Or=function(n,t){wr(n).each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},_r=function(n,t){(function(n){return v.from(n.dom.nextSibling).map(ae.fromDom)})(n).fold((function(){wr(n).each((function(n){Er(n,t)}))}),(function(n){Or(n,t)}))},Tr=function(n,t){(function(n){return Cr(n,0)})(n).fold((function(){Er(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},Er=function(n,t){n.dom.appendChild(t.dom)},Br=function(n,t){H(t,(function(t){Er(n,t)}))},Dr=function(n){n.dom.textContent="",H(kr(n),(function(n){Ar(n)}))},Ar=function(n){var t=n.dom
null!==t.parentNode&&t.parentNode.removeChild(t)},Mr=function(n){var t,e=kr(n)
e.length>0&&(t=n,H(e,(function(n){Or(t,n)}))),Ar(n)},Fr=function(n){return n.dom.innerHTML},Ir=function(n,t){var e,o,r=vr(n).dom,i=ae.fromDom(r.createDocumentFragment()),u=(e=t,(o=(r||document).createElement("div")).innerHTML=e,kr(ae.fromDom(o)))
Br(i,u),Dr(n),Er(n,i)},Rr=function(n,t,e){if(!(x(e)||k(e)||T(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple")
n.setAttribute(t,e+"")},Vr=function(n,t,e){Rr(n.dom,t,e)},Pr=function(n,t){var e=n.dom.getAttribute(t)
return null===e?void 0:e},Hr=function(n,t){return v.from(Pr(n,t))},zr=function(n,t){var e=n.dom
return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},Nr=function(n,t){n.dom.removeAttribute(t)},Lr=function(n){return function(n,t){return ae.fromDom(n.dom.cloneNode(t))}(n,!1)},jr=function(n){return function(n){var t=ae.fromTag("div"),e=ae.fromDom(n.dom.cloneNode(!0))
return Er(t,e),Fr(t)}(Lr(n))},Ur=function(n){return jr(n)},Wr=Jo([function(n,t){return{key:n,value:Ke({can:t})}}(yo(),(function(n,t){var e=t.event,o=e.originator,r=e.target
return!function(n,t,e){return je(t,n.element)&&!je(t,e)}(n,o,r)||(console.warn(yo()+" did not get interpreted by the desired target. \nOriginator: "+Ur(o)+"\nTarget: "+Ur(r)+"\nCheck the "+yo()+" event handlers"),!1)}))]),Gr=Object.freeze({__proto__:null,events:Wr}),Xr=0,Yr=function(n){var t=(new Date).getTime()
return n+"_"+Math.floor(1e9*Math.random())+ ++Xr+String(t)},qr=e("alloy-id-"),Kr=e("data-alloy-id"),Jr=qr(),$r=Kr(),Qr=function(n,t){Object.defineProperty(n.dom,$r,{value:t,writable:!0})},Zr=function(n){var t=mr(n)?n.dom[$r]:null
return v.from(t)},ni=function(n){return Yr(n)},ti=o,ei=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+Ur(n().element)+" is not in context.":""))}}
return{debugInfo:e("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:a}},oi=ei(),ri=function(n){return P(n,(function(n){return function(n,t){return function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t}(n,t,n.length-t.length)}(n,"/*")?n.substring(0,n.length-"/*".length):n}))},ii=function(n,t){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/)
return n.toFunctionAnnotation=function(){return{name:t,parameters:ri(i)}},n},ui=Yr("alloy-premade"),ai=function(n){return Wn(ui,n)},ci=function(n){return function(n,t){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/)
return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ri(i.slice(1))}},n}((function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o]
return n.apply(void 0,d([t.getApis(),t],e))}),n)},si={init:function(){return fi({readState:function(){return"No State required"}})}},fi=function(n){return n},li=function(n,t){var e={}
return yn(n,(function(n,o){yn(n,(function(n,r){var i=_n(e,r).getOr([])
e[r]=i.concat([t(o,n)])}))})),e},di=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},mi=function(n){return n.cHandler},gi=function(n,t){return{name:n,handler:t}},pi=function(n,t,e){var o=f(f({},e),function(n,t){var e={}
return H(n,(function(n){e[n.name()]=n.handlers(t)})),e}(t,n))
return li(o,gi)},hi=function(n){var t=function(n){return _(n)?{can:e(!0),abort:e(!1),run:n}:n}(n)
return function(n,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r]
var i=[n,e].concat(o)
t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},vi=function(n,t,e){var o=t[e]
return o?function(n,t,e,o){try{var r=J(e,(function(e,r){var i=e[t],u=r[t],a=o.indexOf(i),c=o.indexOf(u)
if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2))
if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2))
return a<c?-1:c<a?1:0}))
return on.value(r)}catch(i){return on.error([i])}}("Event: "+e,"name",n,o).map((function(n){var t=P(n,(function(n){return n.handler}))
return Je(t)})):function(n,t){return on.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(P(t,(function(n){return n.name})),null,2)])}(e,n)},bi=function(n,t){var e=kn(n,(function(n,e){return(1===n.length?on.value(n[0].handler):vi(n,t,e)).map((function(o){var r=hi(o),i=n.length>1?N(t[e],(function(t){return I(n,(function(n){return n.name===t}))})).join(" > "):n[0].name
return Wn(e,function(n,t){return{handler:n,purpose:t}}(r,i))}))}))
return Xn(e,{})},yi="alloy.base.behaviour",xi=function(n){return n.events},wi=function(n,t){var e=Pr(n,t)
return void 0===e||""===e?[]:e.split(" ")},Si=function(n){return void 0!==n.dom.classList},ki=function(n,t){return function(n,t,e){var o=wi(n,t).concat([e])
return Vr(n,t,o.join(" ")),!0}(n,"class",t)},Ci=function(n,t){return function(n,t,e){var o=N(wi(n,t),(function(n){return n!==e}))
return o.length>0?Vr(n,t,o.join(" ")):Nr(n,t),!1}(n,"class",t)},Oi=function(n,t){Si(n)?n.dom.classList.add(t):ki(n,t)},_i=function(n){0===(Si(n)?n.dom.classList:function(n){return wi(n,"class")}(n)).length&&Nr(n,"class")},Ti=function(n,t){Si(n)?n.dom.classList.remove(t):Ci(n,t)
_i(n)},Ei=function(n,t){return Si(n)&&n.dom.classList.contains(t)},Bi=function(n,t){H(t,(function(t){Oi(n,t)}))},Di=function(n,t){H(t,(function(t){Ti(n,t)}))},Ai=function(n){return void 0!==n.style&&_(n.style.getPropertyValue)},Mi=function(n){return hr(n)},Fi=_(Element.prototype.attachShadow)&&_(Node.prototype.getRootNode),Ii=e(Fi),Ri=Fi?function(n){return ae.fromDom(n.dom.getRootNode())}:br,Vi=function(n){return Mi(n)?n:ae.fromDom(br(n).dom.body)},Pi=function(n){return ae.fromDom(n.dom.host)},Hi=function(n){return O(n.dom.shadowRoot)},zi=function(n){var t=gr(n)?n.dom.parentNode:n.dom
if(null==t||null===t.ownerDocument)return!1
var e,o,r=t.ownerDocument
return function(n){var t=Ri(n)
return Mi(t)?v.some(t):v.none()}(ae.fromDom(t)).fold((function(){return r.body.contains(t)}),(e=zi,o=Pi,function(n){return e(o(n))}))},Ni=function(){return Li(ae.fromDom(document))},Li=function(n){var t=n.dom.body
if(null==t)throw new Error("Body is not available yet")
return ae.fromDom(t)},ji=function(n,t,e){if(!x(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e)
Ai(n)&&n.style.setProperty(t,e)},Ui=function(n,t){Ai(n)&&n.style.removeProperty(t)},Wi=function(n,t,e){var o=n.dom
ji(o,t,e)},Gi=function(n,t){var e=n.dom
yn(t,(function(n,t){ji(e,t,n)}))},Xi=function(n,t){var e=n.dom
yn(t,(function(n,t){n.fold((function(){Ui(e,t)}),(function(n){ji(e,t,n)}))}))},Yi=function(n,t){var e=n.dom,o=window.getComputedStyle(e).getPropertyValue(t)
return""!==o||zi(n)?o:qi(e,t)},qi=function(n,t){return Ai(n)?n.style.getPropertyValue(t):""},Ki=function(n,t){var e=n.dom,o=qi(e,t)
return v.from(o).filter((function(n){return n.length>0}))},Ji=function(n){var t={},e=n.dom
if(Ai(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o)
t[r]=e.style[r]}return t},$i=function(n,t,e){var o=ae.fromTag(n)
return Wi(o,t,e),Ki(o,t).isSome()},Qi=function(n,t){var e=n.dom
Ui(e,t),Hr(n,"style").map(pe).is("")&&Nr(n,"style")},Zi=function(n){return n.dom.offsetWidth},nu=function(n){return n.dom.value},tu=function(n,t){if(void 0===t)throw new Error("Value.set was undefined")
n.dom.value=t},eu=function(n){var t=ae.fromTag(n.tag);(function(n,t){var e=n.dom
yn(t,(function(n,t){Rr(e,t,n)}))})(t,n.attributes),Bi(t,n.classes),Gi(t,n.styles),n.innerHtml.each((function(n){return Ir(t,n)}))
var e=n.domChildren
return Br(t,e),n.value.each((function(n){tu(t,n)})),n.uid,Qr(t,n.uid),t},ou=function(n,t){return function(n,t){var e=P(t,(function(n){return Kt(n.name(),[Rt("config"),Jt("state",si)])})),o=xt("component.behaviours",it(e),n.behaviours).fold((function(t){throw new Error(kt(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}))
return{list:t,data:xn(o,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}))
return function(){return t}}))}}(n,t)},ru=function(n){var t=function(n){var t=_n(n,"behaviours").getOr({}),e=N(vn(t),(function(n){return void 0!==t[n]}))
return P(e,(function(n){return t[n].me}))}(n)
return ou(n,t)},iu=function(n,t,e){var o,r,i,u=f(f({},(o=n).dom),{uid:o.uid,domChildren:P(o.components,(function(n){return n.element}))}),a=function(n){return n.domModification.fold((function(){return di({})}),di)}(n),c={"alloy.base.modification":a},s=t.length>0?function(n,t,e,o){var r=f({},t)
H(e,(function(t){r[t.name()]=t.exhibit(n,o)}))
var i=li(r,(function(n,t){return{name:n,modification:t}})),u=function(n){return L(n,(function(n,t){return f(f({},t.modification),n)}),{})},a=L(i.classes,(function(n,t){return t.modification.concat(n)}),[]),c=u(i.attributes),s=u(i.styles)
return di({classes:a,attributes:c,styles:s})}(e,c,t,u):a
return i=s,f(f({},r=u),{attributes:f(f({},r.attributes),i.attributes),styles:f(f({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},uu=function(n,t,e){var o={"alloy.base.behaviour":xi(n)}
return function(n,t,e,o){var r=pi(n,e,o)
return bi(r,t)}(e,n.eventOrder,t,o).getOrDie()},au=function(n){var t=function(){return l},e=ie(oi),o=wt(function(n){var t
return xt("custom.definition",it([dt("dom","dom",Hn(),it([Rt("tag"),Jt("styles",{}),Jt("classes",[]),Jt("attributes",{}),Wt("value"),Wt("innerHtml")])),Rt("components"),Rt("uid"),Jt("events",{}),Jt("apis",{}),dt("eventOrder","eventOrder",Pn((t={},t[ko()]=["disabling",yi,"toggling","typeaheadevents"],t[yo()]=[yi,"focusing","keying"],t[Bo()]=[yi,"disabling","toggling","representing"],t[lo()]=[yi,"representing","streaming","invalidating"],t[Ro()]=[yi,"representing","item-events","tooltipping"],t[eo()]=["focusing",yi,"item-type-events"],t[Qe()]=["focusing",yi,"item-type-events"],t[uo()]=["item-type-events","tooltipping"],t[So()]=["receiving","reflecting","tooltipping"],t)),_t()),Wt("domModification")]),n)}(n)),r=ru(n),i=function(n){return n.list}(r),u=function(n){return n.data}(r),a=iu(o,i,u),c=eu(a),s=uu(o,i,u),f=ie(o.components),l={getSystem:e.get,config:function(t){var e=u
return(_(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return _(u[n.name()])},spec:n,readState:function(n){return u[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(n){e.set(n)},disconnect:function(){e.set(ei(t))},element:c,syncComponents:function(){var n=kr(c),t=X(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}))
f.set(t)},components:f.get,events:s}
return l},cu=function(n){var t=ti(n),e=t.events,o=l(t,["events"]),r=function(n){var t=_n(n,"components").getOr([])
return P(t,du)}(o),i=f(f({},o),{events:f(f({},Gr),e),components:r})
return on.value(au(i))},su=function(n){var t=ae.fromText(n)
return fu({element:t})},fu=function(t){var o=St("external.component",rt([Rt("element"),Wt("uid")]),t),r=ie(ei())
o.uid.each((function(n){Qr(o.element,n)}))
var i={getSystem:r.get,config:v.none,hasConfigured:a,connect:function(n){r.set(n)},disconnect:function(){r.set(ei((function(){return i})))},getApis:function(){return{}},element:o.element,spec:t,readState:e("No state"),syncComponents:n,components:e([]),events:{}}
return ai(i)},lu=ni,du=function(n){return function(n){return _n(n,ui)}(n).fold((function(){var t=n.hasOwnProperty("uid")?n:f({uid:lu("")},n)
return cu(t).getOrDie()}),(function(n){return n}))},mu=ai
function gu(n,t){var e=function(e){var o=t(e)
if(o<=0||null===o){var r=Yi(e,n)
return parseFloat(r)||0}return o},o=function(n,t){return j(t,(function(t,e){var o=Yi(n,e),r=void 0===o?0:parseInt(o,10)
return isNaN(r)?t:t+r}),0)}
return{set:function(t,e){if(!T(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e)
var o=t.dom
Ai(o)&&(o.style[n]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(n,t,e){var r=o(n,e)
return t>r?t-r:0}}}var pu=gu("height",(function(n){var t=n.dom
return zi(n)?t.getBoundingClientRect().height:t.offsetHeight})),hu=function(n){return pu.get(n)},vu=function(n){return pu.getOuter(n)},bu=function(n,t){return{left:n,top:t,translate:function(e,o){return bu(n+e,t+o)}}},yu=bu,xu=function(n,t){return void 0!==n?n:void 0!==t?t:0},wu=function(n){var t=n.dom.ownerDocument,e=t.body,o=t.defaultView,r=t.documentElement
if(e===n.dom)return yu(e.offsetLeft,e.offsetTop)
var i=xu(null==o?void 0:o.pageYOffset,r.scrollTop),u=xu(null==o?void 0:o.pageXOffset,r.scrollLeft),a=xu(r.clientTop,e.clientTop),c=xu(r.clientLeft,e.clientLeft)
return Su(n).translate(u-c,i-a)},Su=function(n){var t=n.dom,e=t.ownerDocument.body
return e===t?yu(e.offsetLeft,e.offsetTop):zi(n)?function(n){var t=n.getBoundingClientRect()
return yu(t.left,t.top)}(t):yu(0,0)},ku=gu("width",(function(n){return n.dom.offsetWidth})),Cu=function(n){return ku.get(n)},Ou=function(n){return ku.getOuter(n)},_u=function(n){var e=ae.fromDom(function(n){if(Ii()&&O(n.target)){var t=ae.fromDom(n.target)
if(mr(t)&&Hi(t)&&n.composed&&n.composedPath){var e=n.composedPath()
if(e)return $(e)}}return v.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},i=t(r,o)
return function(n,t,e,o,r,i,u){return{target:n,x:t,y:e,stop:o,prevent:r,kill:i,raw:u}}(e,n.clientX,n.clientY,o,r,i,n)},Tu=function(n,t,e,o,i){var u=function(n,t){return function(e){n(e)&&t(_u(e))}}(e,o)
return n.dom.addEventListener(t,u,i),{unbind:r(Eu,n,t,u,i)}},Eu=function(n,t,e,o){n.dom.removeEventListener(t,e,o)},Bu=function(n){var t=void 0!==n?n.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop
return yu(e,o)},Du=function(n,t,e){var o=(void 0!==e?e.dom:document).defaultView
o&&o.scrollTo(n,t)},Au=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},Mu=function(n){var t=void 0===n?window:n,e=t.document,o=Bu(ae.fromDom(e))
return function(n){var t=void 0===n?window:n
return v.from(t.visualViewport)}(t).fold((function(){var n=t.document.documentElement,e=n.clientWidth,r=n.clientHeight
return Au(o.left,o.top,e,r)}),(function(n){return Au(Math.max(n.pageLeft,o.left),Math.max(n.pageTop,o.top),n.width,n.height)}))},Fu=function(n,t){return n.view(t).fold(e([]),(function(t){var e=n.owner(t),o=Fu(n,e)
return[t].concat(o)}))},Iu=Object.freeze({__proto__:null,view:function(n){var t
return(n.dom===document?v.none():v.from(null===(t=n.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(ae.fromDom)},owner:function(n){return vr(n)}}),Ru=function(n){var t=ae.fromDom(document),e=Bu(t)
return function(n,t){var e=t.owner(n),o=Fu(t,e)
return v.some(o)}(n,Iu).fold(r(wu,n),(function(t){var o=Su(n),r=L(t,(function(n,t){var e=Su(t)
return{left:n.left+e.left,top:n.top+e.top}}),{left:0,top:0})
return yu(r.left+o.left+e.left,r.top+o.top+e.top)}))},Vu=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},Pu=function(n){var t=wu(n),e=Ou(n),o=vu(n)
return Vu(t.left,t.top,e,o)},Hu=function(n){var t=Ru(n),e=Ou(n),o=vu(n)
return Vu(t.left,t.top,e,o)},zu=function(){return Mu(window)}
function Nu(n,t,e,o,r){return n(e,o)?v.some(e):_(r)&&r(e)?v.none():t(e,o,r)}var Lu,ju=function(n,t,e){for(var o=n.dom,r=_(e)?e:a;o.parentNode;){o=o.parentNode
var i=ae.fromDom(o)
if(t(i))return v.some(i)
if(r(i))break}return v.none()},Uu=function(n,t,e){return Nu((function(n,t){return t(n)}),ju,n,t,e)},Wu=function(n,t,e){return Uu(n,t,e).isSome()},Gu=function(n,t,e){return ju(n,(function(n){return Ne(n,t)}),e)},Xu=function(n,t){return function(n,t){var e=void 0===t?document:t.dom
return Le(e)?v.none():v.from(e.querySelector(n)).map(ae.fromDom)}(t,n)},Yu=function(n,t,e){return Nu((function(n,t){return Ne(n,t)}),Gu,n,t,e)},qu=function(){var n=Yr("aria-owns")
return{id:n,link:function(t){Vr(t,"aria-owns",n)},unlink:function(n){Nr(n,"aria-owns")}}},Ku=function(n,t){return function(n){return Uu(n,(function(n){if(!mr(n))return!1
var t=Pr(n,"id")
return void 0!==t&&t.indexOf("aria-owns")>-1})).bind((function(n){var t=Pr(n,"id"),e=Ri(n)
return Xu(e,'[aria-owns="'+t+'"]')}))}(t).exists((function(t){return Ju(n,t)}))},Ju=function(n,t){return Wu(t,(function(t){return je(t,n.element)}),a)||Ku(n,t)},$u="unknown";(function(n){n[n.STOP=0]="STOP",n[n.NORMAL=1]="NORMAL",n[n.LOGGING=2]="LOGGING"})(Lu||(Lu={}))
var Qu,Zu=ie({}),na=function(n,t,e){switch(_n(Zu.get(),n).orThunk((function(){var t=vn(Zu.get())
return nn(t,(function(t){return n.indexOf(t)>-1?v.some(Zu.get()[t]):v.none()}))})).getOr(Lu.NORMAL)){case Lu.NORMAL:return e(oa())
case Lu.LOGGING:var o=function(n,t){var e=[],o=(new Date).getTime()
return{logEventCut:function(n,t,o){e.push({outcome:"cut",target:t,purpose:o})},logEventStopped:function(n,t,o){e.push({outcome:"stopped",target:t,purpose:o})},logNoParent:function(n,t,o){e.push({outcome:"no-parent",target:t,purpose:o})},logEventNoHandlers:function(n,t){e.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,o){e.push({outcome:"response",purpose:o,target:t})},write:function(){var r=(new Date).getTime()
F(["mousemove","mouseover","mouseout",Bo()],n)||console.log(n,{event:n,time:r-o,target:t.dom,sequence:P(e,(function(n){return F(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Ur(n.target)+")":n.outcome}))})}}}(n,t),r=e(o)
return o.write(),r
case Lu.STOP:return!0}},ta=["alloy/data/Fields","alloy/debugging/Debugging"],ea=function(n,t,e){return na(n,t,e)},oa=e({logEventCut:n,logEventStopped:n,logNoParent:n,logEventNoHandlers:n,logEventResponse:n,write:n}),ra=e([Rt("menu"),Rt("selectedMenu")]),ia=e([Rt("item"),Rt("selectedItem")]),ua=(e(it(ia().concat(ra()))),e(it(ia()))),aa=Lt("initSize",[Rt("numColumns"),Rt("numRows")]),ca=function(){return Lt("markers",[Rt("backgroundMenu")].concat(ra()).concat(ia()))},sa=function(n){return Lt("markers",P(n,Rt))},fa=function(n,t,e){(function(){var n=new Error
if(void 0!==n.stack){var t=n.stack.split("\n")
return U(t,(function(n){return n.indexOf("alloy")>0&&!I(ta,(function(t){return n.indexOf(t)>-1}))})).getOr($u)}})()
return dt(t,t,e,bt((function(n){return on.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]
return n.apply(void 0,t)}))})))},la=function(t){return fa(0,t,Vn(n))},da=function(n){return fa(0,n,Vn(v.none))},ma=function(n){return fa(0,n,Hn())},ga=function(n){return fa(0,n,Hn())},pa=function(n,t){return re(n,e(t))},ha=function(n){return re(n,o)},va=e(aa),ba=function(n,t,e,o,r,i){return{x:n,y:t,bubble:e,direction:o,boundsRestriction:r,label:i}},ya=Bn([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),xa=ya.southeast,wa=ya.southwest,Sa=ya.northeast,ka=ya.northwest,Ca=ya.south,Oa=ya.north,_a=ya.east,Ta=ya.west,Ea=function(n,t){return function(n,t){for(var e={},o=0,r=n.length;o<r;o++){var i=n[o]
e[String(i)]=t(i,o)}return e}(["left","right","top","bottom"],(function(e){return _n(t,e).map((function(t){return function(n,t){switch(t){case 1:return n.x
case 0:return n.x+n.width
case 2:return n.y
case 3:return n.y+n.height}}(n,t)}))}))},Ba=function(n){return n.x},Da=function(n,t){return n.x+n.width/2-t.width/2},Aa=function(n,t){return n.x+n.width-t.width},Ma=function(n,t){return n.y-t.height},Fa=function(n){return n.y+n.height},Ia=function(n,t){return n.y+n.height/2-t.height/2},Ra=function(n,t,e){return ba(Ba(n),Fa(n),e.southeast(),xa(),Ea(n,{left:1,top:3}),"layout-se")},Va=function(n,t,e){return ba(Aa(n,t),Fa(n),e.southwest(),wa(),Ea(n,{right:0,top:3}),"layout-sw")},Pa=function(n,t,e){return ba(Ba(n),Ma(n,t),e.northeast(),Sa(),Ea(n,{left:1,bottom:2}),"layout-ne")},Ha=function(n,t,e){return ba(Aa(n,t),Ma(n,t),e.northwest(),ka(),Ea(n,{right:0,bottom:2}),"layout-nw")},za=function(n,t,e){return ba(Da(n,t),Ma(n,t),e.north(),Oa(),Ea(n,{bottom:2}),"layout-n")},Na=function(n,t,e){return ba(Da(n,t),Fa(n),e.south(),Ca(),Ea(n,{top:3}),"layout-s")},La=function(n,t,e){return ba(function(n){return n.x+n.width}(n),Ia(n,t),e.east(),_a(),Ea(n,{left:0}),"layout-e")},ja=function(n,t,e){return ba(function(n,t){return n.x-t.width}(n,t),Ia(n,t),e.west(),Ta(),Ea(n,{right:1}),"layout-w")},Ua=function(){return[Ra,Va,Pa,Ha,Na,za,La,ja]},Wa=function(){return[Va,Ra,Ha,Pa,Na,za,La,ja]},Ga=function(){return[Pa,Ha,Ra,Va,za,Na]},Xa=function(){return[Ha,Pa,Va,Ra,za,Na]},Ya=function(){return[Ra,Va,Pa,Ha,Na,za]},qa=function(){return[Va,Ra,Ha,Pa,Na,za]},Ka=Object.freeze({__proto__:null,events:function(n){return Jo([Zo(So(),(function(t,e){var o=n.channels,r=vn(o),i=e,u=function(n,t){return t.universal?n:N(n,(function(n){return F(t.channels,n)}))}(r,i)
H(u,(function(n){var e=o[n],r=e.schema,u=St("channel["+n+"] data\nReceiver: "+Ur(t.element),r,i.data)
e.onReceive(t,u)}))}))])}}),Ja=[Vt("channels",yt(on.value,rt([ma("onReceive"),Jt("schema",_t())])))],$a=function(n,t,e){return sr((function(o,r){e(o,n,t)}))},Qa=function(n,t,o){return function(n,t,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/)
return n.toFunctionAnnotation=function(){return{name:t,parameters:ri(u.slice(0,1).concat(u.slice(3)))}},n}((function(r){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u]
var a=[r].concat(i)
return r.config({name:e(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+o)}),(function(n){var e=Array.prototype.slice.call(a,1)
return t.apply(void 0,[r,n.config,n.state].concat(e))}))}),o,t)},Za=function(n){return{key:n,value:void 0}},nc=function(n,t,e,o,i,u,a){var c=function(n){return En(n,e)?n[e]():v.none()},s=xn(i,(function(n,t){return Qa(e,n,t)})),l=xn(u,(function(n,t){return ii(n,t)})),d=f(f(f({},l),s),{revoke:r(Za,e),config:function(t){var o=St(e+"-config",n,t)
return{key:e,value:{config:o,me:d,configAsRaw:In((function(){return St(e+"-config",n,t)})),initialConfig:t,state:a}}},schema:function(){return t},exhibit:function(n,t){return c(n).bind((function(n){return _n(o,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(di({}))},name:function(){return e},handlers:function(n){return c(n).map((function(n){return _n(o,"events").getOr((function(){return{}}))(n.config,n.state)})).getOr({})}})
return d},tc=function(n){return Gn(n)},ec=rt([Rt("fields"),Rt("name"),Jt("active",{}),Jt("apis",{}),Jt("state",si),Jt("extra",{})]),oc=function(n){var t=St("Creating behaviour: "+n.name,ec,n)
return function(n,t,e,o,r,i){var u,a,c=rt(n),s=Kt(t,[(u="config",a=n,Gt(u,rt(a)))])
return nc(c,s,t,e,o,r,i)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)},rc=rt([Rt("branchKey"),Rt("branches"),Rt("name"),Jt("active",{}),Jt("apis",{}),Jt("state",si),Jt("extra",{})]),ic=function(n){var t=St("Creating behaviour: "+n.name,rc,n)
return function(n,t,e,o,r,i){var u=n,a=Kt(t,[Gt("config",n)])
return nc(u,a,t,e,o,r,i)}(Ot(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},uc=e(void 0),ac=oc({fields:Ja,name:"receiving",active:Ka}),cc=Object.freeze({__proto__:null,exhibit:function(n,t){return di({classes:[],styles:t.useFixed()?{}:{position:"relative"}})}}),sc=function(n){return n.dom.focus()},fc=function(n){return void 0===n&&(n=ae.fromDom(document)),v.from(n.dom.activeElement).map(ae.fromDom)},lc=function(n){return fc(Ri(n)).filter((function(t){return n.dom.contains(t.dom)}))},dc=function(t,e){var o=Ri(e),r=fc(o).bind((function(n){var t,o,r=function(t){return je(n,t)}
return r(e)?v.some(e):(t=r,(o=function(n){for(var e=0;e<n.childNodes.length;e++){var r=ae.fromDom(n.childNodes[e])
if(t(r))return v.some(r)
var i=o(n.childNodes[e])
if(i.isSome())return i}return v.none()})(e.dom))})),i=t(e)
return r.each((function(t){fc(o).filter((function(n){return je(n,t)})).fold((function(){sc(t)}),n)})),i},mc=function(n,t,e,o,r){return{position:n,left:t,top:e,right:o,bottom:r}},gc=function(n,t){var e=function(n){return n+"px"}
Xi(n,{position:v.some(t.position),left:t.left.map(e),top:t.top.map(e),right:t.right.map(e),bottom:t.bottom.map(e)})},pc=Bn([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),hc=function(n,t,e,o,r,i){var u=t.x-e,a=t.y-o,c=r-(u+t.width),s=i-(a+t.height),f=v.some(u),l=v.some(a),d=v.some(c),m=v.some(s),g=v.none()
return function(n,t,e,o,r,i,u,a,c){return n.fold(t,e,o,r,i,u,a,c)}(t.direction,(function(){return mc(n,f,l,g,g)}),(function(){return mc(n,g,l,d,g)}),(function(){return mc(n,f,g,g,m)}),(function(){return mc(n,g,g,d,m)}),(function(){return mc(n,f,l,g,g)}),(function(){return mc(n,f,g,g,m)}),(function(){return mc(n,f,l,g,g)}),(function(){return mc(n,g,l,d,g)}))},vc=function(n,t){var e=r(Ru,t),o=n.fold(e,e,(function(){var n=Bu()
return Ru(t).translate(-n.left,-n.top)})),i=Ou(t),u=vu(t)
return Vu(o.left,o.top,i,u)},bc=function(n,t){return t.fold((function(){return n.fold(zu,zu,Vu)}),(function(t){return n.fold(t,t,(function(){var e=t(),o=yc(n,e.x,e.y)
return Vu(o.left,o.top,e.width,e.height)}))}))},yc=function(n,t,o){var r=yu(t,o)
return n.fold(e(r),e(r),(function(){var n=Bu()
return r.translate(-n.left,-n.top)}))},xc=(pc.none,pc.relative),wc=pc.fixed,Sc=function(n,t){return function(n,t){return{anchorBox:n,origin:t}}(n,t)},kc=function(n,t,e,o){var r=n+t
return r>o?e:r<e?o:r},Cc=function(n,t,e){return Math.min(Math.max(n,t),e)},Oc=Bn([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),_c=function(n,t,r,i){var u=n.x,a=n.y,c=n.bubble.offset,s=c.left,f=c.top,l=function(n,t,e){var r=function(n,r){var i="top"===n||"bottom"===n?e.top:e.left
return _n(t,n).bind(o).bind((function(t){return"left"===n||"top"===n?t>=r?v.some(t):v.none():t<=r?v.some(t):v.none()})).map((function(n){return n+i})).getOr(r)},i=r("left",n.x),u=r("top",n.y),a=r("right",n.right),c=r("bottom",n.bottom)
return Vu(i,u,a-i,c-u)}(i,n.boundsRestriction,c),d=l.y,m=l.bottom,g=l.x,p=l.right,h=a+f,b=function(n,t,e,o,r){var i=r.x,u=r.y,a=r.width,c=r.height,s=n>=i,f=t>=u,l=s&&f,d=n+e<=i+a&&t+o<=u+c,m=Math.abs(Math.min(e,s?i+a-n:i-(n+e))),g=Math.abs(Math.min(o,f?u+c-t:u-(t+o))),p=Math.max(r.x,r.right-e),h=Math.max(r.y,r.bottom-o)
return{originInBounds:l,sizeInBounds:d,limitX:Cc(n,r.x,p),limitY:Cc(t,r.y,h),deltaW:m,deltaH:g}}(u+s,h,t,r,l),y=b.originInBounds,x=b.sizeInBounds,w=b.limitX,S=b.limitY,k=b.deltaW,C=b.deltaH,O=e(S+C-d),_=e(m-S),T=function(n,t,e,o){return n.fold(t,t,o,o,t,o,e,e)}(n.direction,_,_,O),E=e(w+k-g),B=e(p-w),D={x:w,y:S,width:k,height:C,maxHeight:T,maxWidth:function(n,t,e,o){return n.fold(t,o,t,o,e,e,t,o)}(n.direction,B,B,E),direction:n.direction,classes:{on:n.bubble.classesOn,off:n.bubble.classesOff},label:n.label,candidateYforTest:h}
return y&&x?Oc.fit(D):Oc.nofit(D,k,C)},Tc=function(n,t,e,i){Qi(t,"max-height"),Qi(t,"max-width")
var u,a={width:Ou(u=t),height:vu(u)}
return function(n,t,e,i,u){var a=e.width,c=e.height,s=function(n,o,r,s){var f=n(t,e,i)
return _c(f,a,c,u).fold(Oc.fit,(function(n,t,e){return e>s||t>r?Oc.nofit(n,t,e):Oc.nofit(o,r,s)}))}
return j(n,(function(n,t){var e=r(s,t)
return n.fold(Oc.fit,e)}),Oc.nofit({x:t.x,y:t.y,width:e.width,height:e.height,maxHeight:e.height,maxWidth:e.width,direction:xa(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y},-1,-1)).fold(o,o)}(i.preference,n,a,e,i.bounds)},Ec=function(n,t,e){gc(n,function(n,t){return n.fold((function(){return mc("absolute",v.some(t.x),v.some(t.y),v.none(),v.none())}),(function(n,e,o,r){return hc("absolute",t,n,e,o,r)}),(function(n,e,o,r){return hc("fixed",t,n,e,o,r)}))}(e.origin,t))},Bc=function(n,t){(function(n,t){var e=pu.max(n,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"])
Wi(n,"max-height",e+"px")})(n,Math.floor(t))},Dc=e((function(n,t){Bc(n,t),Gi(n,{"overflow-x":"hidden","overflow-y":"auto"})})),Ac=e((function(n,t){Bc(n,t)})),Mc=function(n,t,e){return void 0===n[t]?e:n[t]},Fc=function(n,t,e,o){var r=Tc(n,t,e,o)
Ec(t,r,o),function(n,t){var e=t.classes
Di(n,e.off),Bi(n,e.on)}(t,r),function(n,t,e){(0,e.maxHeightFunction)(n,t.maxHeight)}(t,r,o),function(n,t,e){(0,e.maxWidthFunction)(n,t.maxWidth)}(t,r,o)},Ic=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Rc=function(n,t,e){var o=function(n){return _n(e,n).getOr([])},r=function(n,t,e){var r=K(Ic,e)
return{offset:yu(n,t),classesOn:X(e,o),classesOff:X(r,o)}}
return{southeast:function(){return r(-n,t,["top","alignLeft"])},southwest:function(){return r(n,t,["top","alignRight"])},south:function(){return r(-n/2,t,["top","alignCentre"])},northeast:function(){return r(-n,-t,["bottom","alignLeft"])},northwest:function(){return r(n,-t,["bottom","alignRight"])},north:function(){return r(-n/2,-t,["bottom","alignCentre"])},east:function(){return r(n,-t/2,["valignCentre","left"])},west:function(){return r(-n,-t/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,t,["top","alignRight"])},innerNortheast:function(){return r(n,t,["top","alignLeft"])},innerNorth:function(){return r(-n/2,t,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-t,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-t,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-t,["bottom","alignCentre"])},innerWest:function(){return r(n,-t/2,["valignCentre","right"])},innerEast:function(){return r(-n,-t/2,["valignCentre","left"])}}},Vc=function(){return Rc(0,0,{})},Pc=function(n,t){return function(e){return"rtl"===Hc(e)?t:n}},Hc=function(n){return"rtl"===Yi(n,"direction")?"rtl":"ltr"};(function(n){n.TopToBottom="toptobottom",n.BottomToTop="bottomtotop"})(Qu||(Qu={}))
var zc="data-alloy-vertical-dir",Nc=function(n){return Wu(n,(function(n){return mr(n)&&Pr(n,"data-alloy-vertical-dir")===Qu.BottomToTop}))},Lc=function(){return Kt("layouts",[Rt("onLtr"),Rt("onRtl"),Wt("onBottomLtr"),Wt("onBottomRtl")])},jc=function(n,t,e,o,r,i,u){var a=u.map(Nc).getOr(!1),c=t.layouts.map((function(t){return t.onLtr(n)})),s=t.layouts.map((function(t){return t.onRtl(n)})),f=a?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(n)}))})).or(c).getOr(r):c.getOr(e),l=a?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(n)}))})).or(s).getOr(i):s.getOr(o)
return Pc(f,l)(n)},Uc=[Rt("hotspot"),Wt("bubble"),Jt("overrides",{}),Lc(),pa("placement",(function(n,t,e){var o=t.hotspot,r=vc(e,o.element),i=jc(n.element,t,Ya(),qa(),Ga(),Xa(),v.some(t.hotspot.element))
return v.some({anchorBox:r,bubble:t.bubble.getOr(Vc()),overrides:t.overrides,layouts:i,placer:v.none()})}))],Wc=[Rt("x"),Rt("y"),Jt("height",0),Jt("width",0),Jt("bubble",Vc()),Jt("overrides",{}),Lc(),pa("placement",(function(n,t,e){var o=yc(e,t.x,t.y),r=Vu(o.left,o.top,t.width,t.height),i=jc(n.element,t,Ua(),Wa(),Ua(),Wa(),v.none())
return v.some({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:i,placer:v.none()})}))],Gc=function(n,t,e,o){return{start:n,soffset:t,finish:e,foffset:o}},Xc=Bn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Yc=(Xc.before,Xc.on,Xc.after,function(n){return n.fold(o,o,o)}),qc=Bn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Kc={domRange:qc.domRange,relative:qc.relative,exact:qc.exact,exactFromRange:function(n){return qc.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var t=function(n){return n.match({domRange:function(n){return ae.fromDom(n.startContainer)},relative:function(n,t){return Yc(n)},exact:function(n,t,e,o){return n}})}(n)
return xr(t)},range:Gc},Jc=function(n,t,e){var o,r=n.document.createRange()
return o=r,t.fold((function(n){o.setStartBefore(n.dom)}),(function(n,t){o.setStart(n.dom,t)}),(function(n){o.setStartAfter(n.dom)})),function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))}(r,e),r},$c=function(n,t,e,o,r){var i=n.document.createRange()
return i.setStart(t.dom,e),i.setEnd(o.dom,r),i},Qc=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},Zc=Bn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ns=function(n,t,e){return t(ae.fromDom(e.startContainer),e.startOffset,ae.fromDom(e.endContainer),e.endOffset)},ts=function(n,t){return function(n,t){var e=t.ltr()
return e.collapsed?t.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return Zc.rtl(ae.fromDom(n.endContainer),n.endOffset,ae.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return ns(0,Zc.ltr,e)})):ns(0,Zc.ltr,e)}(0,function(n,t){return t.match({domRange:function(n){return{ltr:e(n),rtl:v.none}},relative:function(t,e){return{ltr:In((function(){return Jc(n,t,e)})),rtl:In((function(){return v.some(Jc(n,e,t))}))}},exact:function(t,e,o,r){return{ltr:In((function(){return $c(n,t,e,o,r)})),rtl:In((function(){return v.some($c(n,o,r,t,e))}))}}})}(n,t))}
Zc.ltr,Zc.rtl
var es=function(n,t){var e=function(t){return n(t)?v.from(t.dom.nodeValue):v.none()}
return{get:function(o){if(!n(o))throw new Error("Can only get "+t+" value of a "+t+" node")
return e(o).getOr("")},getOption:e,set:function(e,o){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node")
e.dom.nodeValue=o}}}(gr,"text"),os=function(n){return es.getOption(n)},rs=["img","br"],is=function(n){return os(n).filter((function(n){return 0!==n.trim().length||n.indexOf("")>-1})).isSome()||F(rs,lr(n))},us=function(n,t){var e=function(n){for(var o=kr(n),r=o.length-1;r>=0;r--){var i=o[r]
if(t(i))return v.some(i)
var u=e(i)
if(u.isSome())return u}return v.none()}
return e(n)},as=function(n,t){return function(n,t){var e=void 0===t?document:t.dom
return Le(e)?[]:P(e.querySelectorAll(n),ae.fromDom)}(t,n)},cs=function(n,t,e,o){var r=function(n,t,e,o){var r=vr(n).dom.createRange()
return r.setStart(n.dom,t),r.setEnd(e.dom,o),r}(n,t,e,o),i=je(n,e)&&t===o
return r.collapsed&&!i},ss=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1)
return v.some(Gc(ae.fromDom(t.startContainer),t.startOffset,ae.fromDom(e.endContainer),e.endOffset))}return v.none()},fs=function(n){if(null===n.anchorNode||null===n.focusNode)return ss(n)
var t=ae.fromDom(n.anchorNode),e=ae.fromDom(n.focusNode)
return cs(t,n.anchorOffset,e,n.focusOffset)?v.some(Gc(t,n.anchorOffset,e,n.focusOffset)):ss(n)},ls=function(n){return function(n){return v.from(n.getSelection())}(n).filter((function(n){return n.rangeCount>0})).bind(fs)},ds=function(n,t){return function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect()
return e.width>0||e.height>0?v.some(e).map(Qc):v.none()}(function(n,t){return ts(n,t).match({ltr:function(t,e,o,r){var i=n.document.createRange()
return i.setStart(t.dom,e),i.setEnd(o.dom,r),i},rtl:function(t,e,o,r){var i=n.document.createRange()
return i.setStart(o.dom,r),i.setEnd(t.dom,e),i}})}(n,t))},ms=function(n,t){return{element:n,offset:t}},gs=function(n,t){var e=kr(n)
if(0===e.length)return ms(n,t)
if(t<e.length)return ms(e[t],0)
var o=e[e.length-1],r=gr(o)?function(n){return es.get(n)}(o).length:kr(o).length
return ms(o,r)},ps=Bn([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),hs=function(n){return n.fold(o,(function(n,t,e){return n.translate(-t,-e)}))},vs=function(n){return n.fold(o,o)},bs=function(n){return j(n,(function(n,t){return n.translate(t.left,t.top)}),yu(0,0))},ys=function(n){var t=P(n,vs)
return bs(t)},xs=ps.screen,ws=ps.absolute,Ss=function(n,t,e){var o=vr(n.element),r=Bu(o),i=function(n,t,e){var o=xr(e.root).dom
return v.from(o.frameElement).map(ae.fromDom).filter((function(t){var e=vr(t),o=vr(n.element)
return je(e,o)})).map(wu)}(n,0,e).getOr(r)
return ws(i,r.left,r.top)},ks=function(n,t,e,o){var r=n,i=t,u=e,a=o
n<0&&(r=0,u=e+n),t<0&&(i=0,a=o+t)
var c=xs(yu(r,i))
return v.some(function(n,t,e){return{point:n,width:t,height:e}}(c,u,a))},Cs=function(n,t,e,o,r){return n.map((function(n){var i,u,a,c=[t,n.point],s=(i=function(){return ys(c)},u=function(){return ys(c)},a=function(){return function(n){var t=P(n,hs)
return bs(t)}(c)},o.fold(i,u,a)),f=function(n,t,e,o){return{x:n,y:t,width:e,height:o}}(s.left,s.top,n.width,n.height),l=e.showAbove?Ga():Ya(),d=e.showAbove?Xa():qa(),m=jc(r,e,l,d,l,d,v.none())
return{anchorBox:f,bubble:e.bubble.getOr(Vc()),overrides:e.overrides,layouts:m,placer:v.none()}}))},Os=function(n,t){return gr(n)?function(n,t){return{element:n,offset:t}}(n,t):gs(n,t)},_s=function(n,t){return t.getSelection.getOrThunk((function(){return function(){return ls(n)}}))().map((function(n){var t=Os(n.start,n.soffset),e=Os(n.finish,n.foffset)
return Kc.range(t.element,t.offset,e.element,e.offset)}))},Ts=[Wt("getSelection"),Rt("root"),Wt("bubble"),Lc(),Jt("overrides",{}),Jt("showAbove",!1),pa("placement",(function(n,t,e){var o=xr(t.root).dom,r=Ss(n,0,t),i=_s(o,t).bind((function(n){return ds(o,Kc.exactFromRange(n)).orThunk((function(){var t=ae.fromText("\ufeff")
return Or(n.start,t),ds(o,Kc.exact(t,0,t,1)).map((function(n){return Ar(t),n}))})).bind((function(n){return ks(n.left,n.top,n.width,n.height)}))})),u=_s(o,t).bind((function(n){return mr(n.start)?v.some(n.start):function(n){return wr(n)}(n.start)})).getOr(n.element)
return Cs(i,r,t,e,u)}))],Es=[Rt("node"),Rt("root"),Wt("bubble"),Lc(),Jt("overrides",{}),Jt("showAbove",!1),pa("placement",(function(n,t,e){var o=Ss(n,0,t)
return t.node.bind((function(r){var i=r.dom.getBoundingClientRect(),u=ks(i.left,i.top,i.width,i.height),a=t.node.getOr(n.element)
return Cs(u,o,t,e,a)}))}))],Bs=function(n){return n.x+n.width},Ds=function(n,t){return n.x-t.width},As=function(n,t){return n.y-t.height+n.height},Ms=function(n){return n.y},Fs=function(n,t,e){return ba(Bs(n),Ms(n),e.southeast(),xa(),Ea(n,{left:0,top:2}),"link-layout-se")},Is=function(n,t,e){return ba(Ds(n,t),Ms(n),e.southwest(),wa(),Ea(n,{right:1,top:2}),"link-layout-sw")},Rs=function(n,t,e){return ba(Bs(n),As(n,t),e.northeast(),Sa(),Ea(n,{left:0,bottom:3}),"link-layout-ne")},Vs=function(n,t,e){return ba(Ds(n,t),As(n,t),e.northwest(),ka(),Ea(n,{right:1,bottom:3}),"link-layout-nw")},Ps=function(){return[Fs,Is,Rs,Vs]},Hs=function(){return[Is,Fs,Vs,Rs]},zs=[Rt("item"),Lc(),Jt("overrides",{}),pa("placement",(function(n,t,e){var o=vc(e,t.item.element),r=jc(n.element,t,Ps(),Hs(),Ps(),Hs(),v.none())
return v.some({anchorBox:o,bubble:Vc(),overrides:t.overrides,layouts:r,placer:v.none()})}))],Ns=Ot("anchor",{selection:Ts,node:Es,hotspot:Uc,submenu:zs,makeshift:Wc}),Ls=function(t,e,o,r,i){(function(t,e,o,r,i,u){var a=Mc(u,"maxHeightFunction",Dc()),c=Mc(u,"maxWidthFunction",n),s=t.anchorBox,f=t.origin,l={bounds:bc(f,i),origin:f,preference:r,maxHeightFunction:a,maxWidthFunction:c}
Fc(s,e,o,l)})(Sc(o.anchorBox,e),i.element,o.bubble,o.layouts,r,o.overrides)},js=function(n,t,e,o,r,i){var u=i.map(Pu)
return Us(n,t,e,o,r,u)},Us=function(n,t,o,r,i,u){var a=St("positioning anchor.info",Ns,r)
dc((function(){Wi(i.element,"position","fixed")
var o=Ki(i.element,"visibility")
Wi(i.element,"visibility","hidden")
var r,c=t.useFixed()?(r=document.documentElement,wc(0,0,r.clientWidth,r.clientHeight)):function(n){var t=wu(n.element),e=n.element.dom.getBoundingClientRect()
return xc(t.left,t.top,e.width,e.height)}(n),s=a.placement,f=u.map(e).or(t.getBounds)
s(n,a,c).each((function(t){t.placer.getOr(Ls)(n,c,t,f,i)})),o.fold((function(){Qi(i.element,"visibility")}),(function(n){Wi(i.element,"visibility",n)})),Ki(i.element,"left").isNone()&&Ki(i.element,"top").isNone()&&Ki(i.element,"right").isNone()&&Ki(i.element,"bottom").isNone()&&Ki(i.element,"position").is("fixed")&&Qi(i.element,"position")}),i.element)},Ws=Object.freeze({__proto__:null,position:function(n,t,e,o,r){js(n,t,e,o,r,v.none())},positionWithin:js,positionWithinBounds:Us,getMode:function(n,t,e){return t.useFixed()?"fixed":"absolute"}}),Gs=[Jt("useFixed",a),Wt("getBounds")],Xs=oc({fields:Gs,name:"positioning",active:cc,apis:Ws}),Ys=function(n){Wo(n,Ro())
var t=n.components()
H(t,Ys)},qs=function(n){var t=n.components()
H(t,qs),Wo(n,Io())},Ks=function(n,t){Er(n.element,t.element)},Js=function(n,t){var e=n.components();(function(n){H(n.components(),(function(n){return Ar(n.element)})),Dr(n.element),n.syncComponents()})(n)
var o=K(e,t)
H(o,(function(t){Ys(t),n.getSystem().removeFromWorld(t)})),H(t,(function(t){t.getSystem().isConnected()?Ks(n,t):(n.getSystem().addToWorld(t),Ks(n,t),zi(n.element)&&qs(t)),n.syncComponents()}))},$s=function(n,t){Qs(n,t,Er)},Qs=function(n,t,e){n.getSystem().addToWorld(t),e(n.element,t.element),zi(n.element)&&qs(t),n.syncComponents()},Zs=function(n){Ys(n),Ar(n.element),n.getSystem().removeFromWorld(n)},nf=function(n){var t=wr(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))
Zs(n),t.each((function(n){n.syncComponents()}))},tf=function(n){var t=n.components()
H(t,Zs),Dr(n.element),n.syncComponents()},ef=function(n,t){of(n,t,Er)},of=function(n,t,e){e(n,t.element)
var o=kr(t.element)
H(o,(function(n){t.getByDom(n).each(qs)}))},rf=function(n){var t=kr(n.element)
H(t,(function(t){n.getByDom(t).each(Ys)})),Ar(n.element)},uf=function(n,t,e,o){e.get().each((function(t){tf(n)}))
var r=t.getAttachPoint(n)
$s(r,n)
var i=n.getSystem().build(o)
return $s(n,i),e.set(i),i},af=function(n,t,e,o){var r=uf(n,t,e,o)
return t.onOpen(n,r),r},cf=function(n,t,e){e.get().each((function(o){tf(n),nf(n),t.onClose(n,o),e.clear()}))},sf=function(n,t,e){return e.isOpen()},ff=function(n,t,e){var o=t.getAttachPoint(n)
Wi(n.element,"position",Xs.getMode(o)),function(n,t,e,o){Ki(n.element,t).fold((function(){Nr(n.element,e)}),(function(t){Vr(n.element,e,t)})),Wi(n.element,t,o)}(n,"visibility",t.cloakVisibilityAttr,"hidden")},lf=function(n,t,e){(function(n){return I(["top","left","right","bottom"],(function(t){return Ki(n,t).isSome()}))})(n.element)||Qi(n.element,"position"),function(n,t,e){Hr(n.element,e).fold((function(){return Qi(n.element,t)}),(function(e){return Wi(n.element,t,e)}))}(n,"visibility",t.cloakVisibilityAttr)},df=Object.freeze({__proto__:null,cloak:ff,decloak:lf,open:af,openWhileCloaked:function(n,t,e,o,r){ff(n,t),af(n,t,e,o),r(),lf(n,t)},close:cf,isOpen:sf,isPartOf:function(n,t,e,o){return sf(0,0,e)&&e.get().exists((function(e){return t.isPartOf(n,e,o)}))},getState:function(n,t,e){return e.get()},setContent:function(n,t,e,o){return e.get().map((function(){return uf(n,t,e,o)}))}}),mf=Object.freeze({__proto__:null,events:function(n,t){return Jo([Zo(To(),(function(e,o){cf(e,n,t)}))])}}),gf=[la("onOpen"),la("onClose"),Rt("isPartOf"),Rt("getAttachPoint"),Jt("cloakVisibilityAttr","data-precloak-visibility")],pf=oc({fields:gf,name:"sandboxing",active:mf,apis:df,state:Object.freeze({__proto__:null,init:function(){var n=ie(v.none()),t=e("not-implemented")
return fi({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set(v.none())},set:function(t){n.set(v.some(t))},get:function(){return n.get()}})}})}),hf=e("dismiss.popups"),vf=e("reposition.popups"),bf=e("mouse.released"),yf=rt([Jt("isExtraPart",a),Kt("fireEventInstead",[Jt("event",Vo())])]),xf=function(n){var t,e=St("Dismissal",yf,n)
return(t={})[hf()]={schema:rt([Rt("target")]),onReceive:function(n,t){pf.isOpen(n)&&(pf.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold((function(){return pf.close(n)}),(function(t){return Wo(n,t.event)})))}},t},wf=rt([Kt("fireEventInstead",[Jt("event",Po())]),Nt("doReposition")]),Sf=function(n){var t,e=St("Reposition",wf,n)
return(t={})[vf()]={onReceive:function(n){pf.isOpen(n)&&e.fireEventInstead.fold((function(){return e.doReposition(n)}),(function(t){return Wo(n,t.event)}))}},t},kf=function(n,t,e){t.store.manager.onLoad(n,t,e)},Cf=function(n,t,e){t.store.manager.onUnload(n,t,e)},Of=Object.freeze({__proto__:null,onLoad:kf,onUnload:Cf,setValue:function(n,t,e,o){t.store.manager.setValue(n,t,e,o)},getValue:function(n,t,e){return t.store.manager.getValue(n,t,e)},getState:function(n,t,e){return e}}),_f=Object.freeze({__proto__:null,events:function(n,t){var e=n.resetOnDom?[ar((function(e,o){kf(e,n,t)})),cr((function(e,o){Cf(e,n,t)}))]:[$a(n,t,kf)]
return Jo(e)}}),Tf=function(){var n=ie(null)
return fi({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},Ef=function(){var n=ie({}),t=ie({})
return fi({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},lookup:function(e){return _n(n.get(),e).orThunk((function(){return _n(t.get(),e)}))},update:function(e){var o=n.get(),r=t.get(),i={},u={}
H(e,(function(n){i[n.value]=n,_n(n,"meta").each((function(t){_n(t,"text").each((function(t){u[t]=n}))}))})),n.set(f(f({},o),i)),t.set(f(f({},r),u))},clear:function(){n.set({}),t.set({})}})},Bf=Object.freeze({__proto__:null,memory:Tf,dataset:Ef,manual:function(){return fi({readState:function(){}})},init:function(n){return n.store.manager.state(n)}}),Df=function(n,t,e,o){var r=t.store
e.update([o]),r.setValue(n,o),t.onSetValue(n,o)},Af=[Wt("initialValue"),Rt("getFallbackEntry"),Rt("getDataKey"),Rt("setValue"),pa("manager",{setValue:Df,getValue:function(n,t,e){var o=t.store,r=o.getDataKey(n)
return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(n){return n}))},onLoad:function(n,t,e){t.store.initialValue.each((function(o){Df(n,t,e,o)}))},onUnload:function(n,t,e){e.clear()},state:Ef})],Mf=[Rt("getValue"),Jt("setValue",n),Wt("initialValue"),pa("manager",{setValue:function(n,t,e,o){t.store.setValue(n,o),t.onSetValue(n,o)},getValue:function(n,t,e){return t.store.getValue(n)},onLoad:function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},onUnload:n,state:si.init})],Ff=[Wt("initialValue"),pa("manager",{setValue:function(n,t,e,o){e.set(o),t.onSetValue(n,o)},getValue:function(n,t,e){return e.get()},onLoad:function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},onUnload:function(n,t,e){e.clear()},state:Tf})],If=[$t("store",{mode:"memory"},Ot("mode",{memory:Ff,manual:Mf,dataset:Af})),la("onSetValue"),Jt("resetOnDom",!1)],Rf=oc({fields:If,name:"representing",active:_f,apis:Of,extra:{setValueFrom:function(n,t){var e=Rf.getValue(t)
Rf.setValue(n,e)}},state:Bf}),Vf=function(n,t){return oe(n,{},P(t,(function(t){return e=t.name(),o="Cannot configure "+t.name()+" for "+n,dt(e,e,zn(),et((function(n){return dn("The field: "+e+" is forbidden. "+o)})))
var e,o})).concat([re("dump",o)]))},Pf=function(n){return n.dump},Hf=function(n,t){return f(f({},n.dump),tc(t))},zf=Vf,Nf=Hf,Lf="placeholder",jf=Bn([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Uf=function(n){return Tn(n,"uiType")},Wf=function(n,t,o,r){return Uf(o)&&o.uiType===Lf?function(n,t,o,r){return n.exists((function(n){return n!==o.owner}))?jf.single(!0,e(o)):_n(r,o.name).fold((function(){throw new Error("Unknown placeholder component: "+o.name+"\nKnown: ["+vn(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(o,null,2))}),(function(n){return n.replace()}))}(n,0,o,r):jf.single(!1,e(o))},Gf=function(n,t,e,r){return Wf(n,0,e,r).fold((function(o,i){var u=Uf(e)?i(t,e.config,e.validated):i(t),a=_n(u,"components").getOr([]),c=X(a,(function(e){return Gf(n,t,e,r)}))
return[f(f({},u),{components:c})]}),(function(n,r){if(Uf(e)){var i=r(t,e.config,e.validated)
return e.validated.preprocess.getOr(o)(i)}return r(t)}))},Xf=function(n,t,o,r){var i=xn(r,(function(n,t){return r=n,i=!1,{name:e(o=t),required:function(){return r.fold((function(n,t){return n}),(function(n,t){return n}))},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+o)
return i=!0,r}}
var o,r,i})),u=function(n,t,e,o){return X(e,(function(e){return Gf(n,t,e,o)}))}(n,t,o,i)
return yn(i,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),u},Yf=jf.single,qf=jf.multiple,Kf=e(Lf),Jf=Bn([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),$f=Jt("factory",{sketch:o}),Qf=Jt("schema",[]),Zf=Rt("name"),nl=dt("pname","pname",Nn((function(n){return"<alloy."+Yr(n.name)+">"})),_t()),tl=re("schema",(function(){return[Wt("preprocess")]})),el=Jt("defaults",e({})),ol=Jt("overrides",e({})),rl=it([$f,Qf,Zf,nl,el,ol]),il=it([$f,Qf,Zf,el,ol]),ul=it([$f,Qf,Zf,nl,el,ol]),al=it([$f,tl,Zf,Rt("unit"),nl,el,ol]),cl=function(n){return n.fold(v.some,v.none,v.some,v.some)},sl=function(n){var t=function(n){return n.name}
return n.fold(t,t,t,t)},fl=function(n,t){return function(e){var o=St("Converting part type",t,e)
return n(o)}},ll=fl(Jf.required,rl),dl=fl(Jf.external,il),ml=fl(Jf.optional,ul),gl=fl(Jf.group,al),pl=e("entirety"),hl=Object.freeze({__proto__:null,required:ll,external:dl,optional:ml,group:gl,asNamedPart:cl,name:sl,asCommon:function(n){return n.fold(o,o,o,o)},original:pl}),vl=function(n,t,e,o){return Mn(t.defaults(n,e,o),e,{uid:n.partUids[t.name]},t.overrides(n,e,o))},bl=function(n,t){var e={}
return H(t,(function(t){cl(t).each((function(t){var o=yl(n,t.pname)
e[t.name]=function(e){var r=St("Part: "+t.name+" in "+n,it(t.schema),e)
return f(f({},o),{config:e,validated:r})}}))})),e},yl=function(n,t){return{uiType:Kf(),owner:n,name:t}},xl=function(n,t,e){return{uiType:Kf(),owner:n,name:t,config:e,validated:{}}},wl=function(n){return X(n,(function(n){return n.fold(v.none,v.some,v.none,v.none).map((function(n){return Lt(n.name,n.schema.concat([ha(pl())]))})).toArray()}))},Sl=function(n){return P(n,sl)},kl=function(n,t,o){return function(n,t,o){var r={},i={}
return H(o,(function(n){n.fold((function(n){r[n.pname]=Yf(!0,(function(t,e,o){return n.factory.sketch(vl(t,n,e,o))}))}),(function(n){var o=t.parts[n.name]
i[n.name]=e(n.factory.sketch(vl(t,n,o[pl()]),o))}),(function(n){r[n.pname]=Yf(!1,(function(t,e,o){return n.factory.sketch(vl(t,n,e,o))}))}),(function(n){r[n.pname]=qf(!0,(function(t,e,o){var r=t[n.name]
return P(r,(function(e){return n.factory.sketch(Mn(n.defaults(t,e,o),e,n.overrides(t,e)))}))}))}))})),{internals:e(r),externals:e(i)}}(0,t,o)},Cl=function(n,t,e){return Xf(v.some(n),t,t.components,e)},Ol=function(n,t,e){var o=t.partUids[e]
return n.getSystem().getByUid(o).toOptional()},_l=function(n,t,e){return Ol(n,t,e).getOrDie("Could not find part: "+e)},Tl=function(n,t,o){var r={},i=t.partUids,u=n.getSystem()
return H(o,(function(n){r[n]=e(u.getByUid(i[n]))})),r},El=function(n,t){var o=n.getSystem()
return xn(t.partUids,(function(n,t){return e(o.getByUid(n))}))},Bl=function(n){return vn(n.partUids)},Dl=function(n,t,o){var r={},i=t.partUids,u=n.getSystem()
return H(o,(function(n){r[n]=e(u.getByUid(i[n]).getOrDie())})),r},Al=function(n,t){var e=Sl(t)
return Gn(P(e,(function(t){return{key:t,value:n+"-"+t}})))},Ml=function(n){return dt("partUids","partUids",Ln((function(t){return Al(t.uid,n)})),_t())},Fl=Object.freeze({__proto__:null,generate:bl,generateOne:xl,schemas:wl,names:Sl,substitutes:kl,components:Cl,defaultUids:Al,defaultUidsSchema:Ml,getAllParts:El,getAllPartNames:Bl,getPart:Ol,getPartOrDie:_l,getParts:Tl,getPartsOrDie:Dl}),Il=function(n,t,e,o,r){var i=function(n,t){return(n.length>0?[Lt("parts",n)]:[]).concat([Rt("uid"),Jt("dom",{}),Jt("components",[]),ha("originalSpec"),Jt("debug.sketcher",{})]).concat(t)}(o,r)
return St(n+" [SpecSchema]",rt(i.concat(t)),e)},Rl=function(n,t,e,o,r){var i=Vl(r),u=wl(e),a=Ml(e),c=Il(n,t,i,u,[a]),s=kl(0,c,e)
return o(c,Cl(n,c,s.internals()),i,s.externals())},Vl=function(n){return function(n){return Tn(n,"uid")}(n)?n:f(f({},n),{uid:ni("uid")})}
var Pl,Hl=rt([Rt("name"),Rt("factory"),Rt("configFields"),Jt("apis",{}),Jt("extraApis",{})]),zl=rt([Rt("name"),Rt("factory"),Rt("configFields"),Rt("partFields"),Jt("apis",{}),Jt("extraApis",{})]),Nl=function(n){var t=St("Sketcher for "+n.name,Hl,n),e=xn(t.apis,ci),o=xn(t.extraApis,(function(n,t){return ii(n,t)}))
return f(f({name:t.name,configFields:t.configFields,sketch:function(n){return function(n,t,e,o){var r=Vl(o)
return e(Il(n,t,r,[],[]),r)}(t.name,t.configFields,t.factory,n)}},e),o)},Ll=function(n){var t=St("Sketcher for "+n.name,zl,n),e=bl(t.name,t.partFields),o=xn(t.apis,ci),r=xn(t.extraApis,(function(n,t){return ii(n,t)}))
return f(f({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(n){return Rl(t.name,t.configFields,t.partFields,t.factory,n)},parts:e},o),r)},jl=function(n){for(var t=[],e=function(n){t.push(n)},o=0;o<n.length;o++)n[o].each(e)
return t},Ul=function(n){return"input"===lr(n)&&"radio"!==Pr(n,"type")||"textarea"===lr(n)},Wl=Object.freeze({__proto__:null,getCurrent:function(n,t,e){return t.find(n)}}),Gl=[Rt("find")],Xl=oc({fields:Gl,name:"composing",apis:Wl}),Yl=function(n,t,e,o){var r=as(n.element,"."+t.highlightClass)
H(r,(function(e){I(o,(function(n){return n.element===e}))||(Ti(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),Wo(e,Uo())})))}))},ql=function(n,t,e,o){Yl(n,t,0,[o]),Kl(n,t,e,o)||(Oi(o.element,t.highlightClass),t.onHighlight(n,o),Wo(o,jo()))},Kl=function(n,t,e,o){return Ei(o.element,t.highlightClass)},Jl=function(n,t,e,o){var r=as(n.element,"."+t.itemClass)
return v.from(r[o]).fold((function(){return on.error("No element found with index "+o)}),n.getSystem().getByDom)},$l=function(n,t,e){return Xu(n.element,"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Ql=function(n,t,e){var o=as(n.element,"."+t.itemClass)
return(o.length>0?v.some(o[o.length-1]):v.none()).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Zl=function(n,t,e,o){var r=as(n.element,"."+t.itemClass)
return W(r,(function(n){return Ei(n,t.highlightClass)})).bind((function(t){var e=kc(t,o,0,r.length-1)
return n.getSystem().getByDom(r[e]).toOptional()}))},nd=function(n,t,e){var o=as(n.element,"."+t.itemClass)
return jl(P(o,(function(t){return n.getSystem().getByDom(t).toOptional()})))},td=Object.freeze({__proto__:null,dehighlightAll:function(n,t,e){return Yl(n,t,0,[])},dehighlight:function(n,t,e,o){Kl(n,t,e,o)&&(Ti(o.element,t.highlightClass),t.onDehighlight(n,o),Wo(o,Uo()))},highlight:ql,highlightFirst:function(n,t,e){$l(n,t).each((function(o){ql(n,t,e,o)}))},highlightLast:function(n,t,e){Ql(n,t).each((function(o){ql(n,t,e,o)}))},highlightAt:function(n,t,e,o){Jl(n,t,e,o).fold((function(n){throw new Error(n)}),(function(o){ql(n,t,e,o)}))},highlightBy:function(n,t,e,o){var r=nd(n,t)
U(r,o).each((function(o){ql(n,t,e,o)}))},isHighlighted:Kl,getHighlighted:function(n,t,e){return Xu(n.element,"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},getFirst:$l,getLast:Ql,getPrevious:function(n,t,e){return Zl(n,t,0,-1)},getNext:function(n,t,e){return Zl(n,t,0,1)},getCandidates:nd}),ed=[Rt("highlightClass"),Rt("itemClass"),la("onHighlight"),la("onDehighlight")],od=oc({fields:ed,name:"highlighting",apis:td}),rd=[8],id=[9],ud=[13],ad=[27],cd=[32],sd=[37],fd=[38],ld=[39],dd=[40],md=function(n,t,e){var o=q(n.slice(0,t)),r=q(n.slice(t+1))
return U(o.concat(r),e)},gd=function(n,t,e){var o=q(n.slice(0,t))
return U(o,e)},pd=function(n,t,e){var o=n.slice(0,t),r=n.slice(t+1)
return U(r.concat(o),e)},hd=function(n,t,e){var o=n.slice(t+1)
return U(o,e)},vd=function(n){return function(t){var e=t.raw
return F(n,e.which)}},bd=function(n){return function(t){return Y(n,(function(n){return n(t)}))}},yd=function(n){return!0===n.raw.shiftKey},xd=function(n){return!0===n.raw.ctrlKey},wd=i(yd),Sd=function(n,t){return{matches:n,classification:t}},kd=function(n,t,e){t.exists((function(n){return e.exists((function(t){return je(t,n)}))}))||Go(n,Ho(),{prevFocus:t,newFocus:e})},Cd=function(){var n=function(n){return lc(n.element)}
return{get:n,set:function(t,e){var o=n(t)
t.getSystem().triggerFocus(e,t.element)
var r=n(t)
kd(t,o,r)}}},Od=function(){var t=function(n){return od.getHighlighted(n).map((function(n){return n.element}))}
return{get:t,set:function(e,o){var r=t(e)
e.getSystem().getByDom(o).fold(n,(function(n){od.highlight(e,n)}))
var i=t(e)
kd(e,r,i)}}};(function(n){n.OnFocusMode="onFocus",n.OnEnterOrSpaceMode="onEnterOrSpace",n.OnApiMode="onApi"})(Pl||(Pl={}))
var _d,Td=function(n,t,e,o,r){var i=function(n,t,e,o,r){var i,u,a=e(n,t,o,r)
return(i=a,u=t.event,U(i,(function(n){return n.matches(u)})).map((function(n){return n.classification}))).bind((function(e){return e(n,t,o,r)}))},u={schema:function(){return n.concat([Jt("focusManager",Cd()),$t("focusInside","onFocus",bt((function(n){return F(["onFocus","onEnterOrSpace","onApi"],n)?on.value(n):on.error("Invalid value for focusInside")}))),pa("handler",u),pa("state",t),pa("sendFocusIn",r)])},processKey:i,toEvents:function(n,t){var u=n.focusInside!==Pl.OnFocusMode?v.none():r(n).map((function(e){return Zo(yo(),(function(o,r){e(o,n,t),r.stop()}))})),a=[Zo(so(),(function(o,u){i(o,u,e,n,t).fold((function(){(function(e,o){var i=vd(cd.concat(ud))(o.event)
n.focusInside===Pl.OnEnterOrSpaceMode&&i&&qe(e,o)&&r(n).each((function(r){r(e,n,t),o.stop()}))})(o,u)}),(function(n){u.stop()}))})),Zo(fo(),(function(e,r){i(e,r,o,n,t).each((function(n){r.stop()}))}))]
return Jo(u.toArray().concat(a))}}
return u},Ed=function(n){var t=[Wt("onEscape"),Wt("onEnter"),Jt("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Jt("firstTabstop",0),Jt("useTabstopAt",c),Wt("visibilitySelector")].concat([n]),o=function(n,t){var e=n.visibilitySelector.bind((function(n){return Yu(t,n)})).getOr(t)
return hu(e)>0},i=function(n,t,e){(function(n,t){var e=as(n.element,t.selector),r=N(e,(function(n){return o(t,n)}))
return v.from(r[t.firstTabstop])})(n,t).each((function(e){t.focusManager.set(n,e)}))},u=function(n,t,e,r,i){return i(t,e,(function(n){return function(n,t){return o(n,t)&&n.useTabstopAt(t)}(r,n)})).fold((function(){return r.cyclic?v.some(!0):v.none()}),(function(t){return r.focusManager.set(n,t),v.some(!0)}))},a=function(n,t,e,o){var i=as(n.element,e.selector)
return function(n,t){return t.focusManager.get(n).bind((function(n){return Yu(n,t.selector)}))}(n,e).bind((function(t){return W(i,r(je,t)).bind((function(t){return u(n,i,t,e,o)}))}))},s=e([Sd(bd([yd,vd(id)]),(function(n,t,e){var o=e.cyclic?md:gd
return a(n,0,e,o)})),Sd(vd(id),(function(n,t,e){var o=e.cyclic?pd:hd
return a(n,0,e,o)})),Sd(vd(ad),(function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))})),Sd(bd([wd,vd(ud)]),(function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))}))]),f=e([])
return Td(t,si.init,s,f,(function(){return v.some(i)}))},Bd=Ed(re("cyclic",a)),Dd=Ed(re("cyclic",c)),Ad=function(n,t,e){return Ul(e)&&vd(cd)(t.event)?v.none():function(n,t,e){return Yo(n,e,ko()),v.some(!0)}(n,0,e)},Md=function(n,t){return v.some(!0)},Fd=[Jt("execute",Ad),Jt("useSpace",!1),Jt("useEnter",!0),Jt("useControlEnter",!1),Jt("useDown",!1)],Id=function(n,t,e){return e.execute(n,t,n.element)},Rd=Td(Fd,si.init,(function(n,t,e,o){var r=e.useSpace&&!Ul(n.element)?cd:[],i=e.useEnter?ud:[],u=e.useDown?dd:[],a=r.concat(i).concat(u)
return[Sd(vd(a),Id)].concat(e.useControlEnter?[Sd(bd([xd,vd(ud)]),Id)]:[])}),(function(n,t,e,o){return e.useSpace&&!Ul(n.element)?[Sd(vd(cd),Md)]:[]}),(function(){return v.none()})),Vd=function(){var n=ie(v.none())
return fi({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(v.some({numRows:t,numColumns:e}))},getNumRows:function(){return n.get().map((function(n){return n.numRows}))},getNumColumns:function(){return n.get().map((function(n){return n.numColumns}))}})},Pd=Object.freeze({__proto__:null,flatgrid:Vd,init:function(n){return n.state(n)}}),Hd=function(n){return function(t,e,o,r){var i=n(t.element)
return jd(i,t,e,o,r)}},zd=function(n,t){var e=Pc(n,t)
return Hd(e)},Nd=function(n,t){var e=Pc(t,n)
return Hd(e)},Ld=function(n){return function(t,e,o,r){return jd(n,t,e,o,r)}},jd=function(n,t,e,o,r){return o.focusManager.get(t).bind((function(e){return n(t.element,e,o,r)})).map((function(n){return o.focusManager.set(t,n),!0}))},Ud=Ld,Wd=Ld,Gd=Ld,Xd=function(n){return!function(n){return n.offsetWidth<=0&&n.offsetHeight<=0}(n.dom)},Yd=function(n,t,e){var o=as(n,e)
return function(n,t){return W(n,t).map((function(t){return{index:t,candidates:n}}))}(N(o,Xd),(function(n){return je(n,t)}))},qd=function(n,t){return W(n,(function(n){return je(t,n)}))},Kd=function(n,t,e,o){return o(Math.floor(t/e),t%e).bind((function(t){var o=t.row*e+t.column
return o>=0&&o<n.length?v.some(n[o]):v.none()}))},Jd=function(n,t,e,o,r){return Kd(n,t,o,(function(t,i){var u=t===e-1?n.length-t*o:o,a=kc(i,r,0,u-1)
return v.some({row:t,column:a})}))},$d=function(n,t,e,o,r){return Kd(n,t,o,(function(t,i){var u=kc(t,r,0,e-1),a=u===e-1?n.length-u*o:o,c=Cc(i,0,a-1)
return v.some({row:u,column:c})}))},Qd=[Rt("selector"),Jt("execute",Ad),da("onEscape"),Jt("captureTab",!1),va()],Zd=function(n,t,e){Xu(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},nm=function(n){return function(t,e,o,r){return Yd(t,e,o.selector).bind((function(t){return n(t.candidates,t.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},tm=function(n,t,e){return e.captureTab?v.some(!0):v.none()},em=nm((function(n,t,e,o){return Jd(n,t,e,o,-1)})),om=nm((function(n,t,e,o){return Jd(n,t,e,o,1)})),rm=nm((function(n,t,e,o){return $d(n,t,e,o,-1)})),im=nm((function(n,t,e,o){return $d(n,t,e,o,1)})),um=e([Sd(vd(sd),zd(em,om)),Sd(vd(ld),Nd(em,om)),Sd(vd(fd),Ud(rm)),Sd(vd(dd),Wd(im)),Sd(bd([yd,vd(id)]),tm),Sd(bd([wd,vd(id)]),tm),Sd(vd(ad),(function(n,t,e){return e.onEscape(n,t)})),Sd(vd(cd.concat(ud)),(function(n,t,e,o){return function(n,t){return t.focusManager.get(n).bind((function(n){return Yu(n,t.selector)}))}(n,e).bind((function(o){return e.execute(n,t,o)}))}))]),am=e([Sd(vd(cd),Md)]),cm=Td(Qd,Vd,um,am,(function(){return v.some(Zd)})),sm=function(n,t,e,o){var r=function(n,t,e){var i,u=kc(t,o,0,e.length-1)
return u===n?v.none():(i=e[u],"button"===lr(i)&&"disabled"===Pr(i,"disabled")?r(n,u,e):v.from(e[u]))}
return Yd(n,e,t).bind((function(n){var t=n.index,e=n.candidates
return r(t,t,e)}))},fm=[Rt("selector"),Jt("getInitial",v.none),Jt("execute",Ad),da("onEscape"),Jt("executeOnMove",!1),Jt("allowVertical",!0)],lm=function(n,t,e){return function(n,t){return t.focusManager.get(n).bind((function(n){return Yu(n,t.selector)}))}(n,e).bind((function(o){return e.execute(n,t,o)}))},dm=function(n,t,e){t.getInitial(n).orThunk((function(){return Xu(n.element,t.selector)})).each((function(e){t.focusManager.set(n,e)}))},mm=function(n,t,e){return sm(n,e.selector,t,-1)},gm=function(n,t,e){return sm(n,e.selector,t,1)},pm=function(n){return function(t,e,o,r){return n(t,e,o,r).bind((function(){return o.executeOnMove?lm(t,e,o):v.some(!0)}))}},hm=function(n,t,e){return e.onEscape(n,t)},vm=e([Sd(vd(cd),Md)]),bm=Td(fm,si.init,(function(n,t,e,o){var r=sd.concat(e.allowVertical?fd:[]),i=ld.concat(e.allowVertical?dd:[])
return[Sd(vd(r),pm(zd(mm,gm))),Sd(vd(i),pm(Nd(mm,gm))),Sd(vd(ud),lm),Sd(vd(cd),lm),Sd(vd(ad),hm)]}),vm,(function(){return v.some(dm)})),ym=function(n,t,e){return v.from(n[t]).bind((function(n){return v.from(n[e]).map((function(n){return{rowIndex:t,columnIndex:e,cell:n}}))}))},xm=function(n,t,e,o){var r=n[t].length,i=kc(e,o,0,r-1)
return ym(n,t,i)},wm=function(n,t,e,o){var r=kc(e,o,0,n.length-1),i=n[r].length,u=Cc(t,0,i-1)
return ym(n,r,u)},Sm=function(n,t,e,o){var r=n[t].length,i=Cc(e+o,0,r-1)
return ym(n,t,i)},km=function(n,t,e,o){var r=Cc(e+o,0,n.length-1),i=n[r].length,u=Cc(t,0,i-1)
return ym(n,r,u)},Cm=[Lt("selectors",[Rt("row"),Rt("cell")]),Jt("cycles",!0),Jt("previousSelector",v.none),Jt("execute",Ad)],Om=function(n,t,e){t.previousSelector(n).orThunk((function(){var e=t.selectors
return Xu(n.element,e.cell)})).each((function(e){t.focusManager.set(n,e)}))},_m=function(n,t){return function(e,o,r){var i=r.cycles?n:t
return Yu(o,r.selectors.row).bind((function(n){var t=as(n,r.selectors.cell)
return qd(t,o).bind((function(t){var o=as(e,r.selectors.row)
return qd(o,n).bind((function(n){var e=function(n,t){return P(n,(function(n){return as(n,t.selectors.cell)}))}(o,r)
return i(e,n,t).map((function(n){return n.cell}))}))}))}))}},Tm=_m((function(n,t,e){return xm(n,t,e,-1)}),(function(n,t,e){return Sm(n,t,e,-1)})),Em=_m((function(n,t,e){return xm(n,t,e,1)}),(function(n,t,e){return Sm(n,t,e,1)})),Bm=_m((function(n,t,e){return wm(n,e,t,-1)}),(function(n,t,e){return km(n,e,t,-1)})),Dm=_m((function(n,t,e){return wm(n,e,t,1)}),(function(n,t,e){return km(n,e,t,1)})),Am=e([Sd(vd(sd),zd(Tm,Em)),Sd(vd(ld),Nd(Tm,Em)),Sd(vd(fd),Ud(Bm)),Sd(vd(dd),Wd(Dm)),Sd(vd(cd.concat(ud)),(function(n,t,e){return lc(n.element).bind((function(o){return e.execute(n,t,o)}))}))]),Mm=e([Sd(vd(cd),Md)]),Fm=Td(Cm,si.init,Am,Mm,(function(){return v.some(Om)})),Im=[Rt("selector"),Jt("execute",Ad),Jt("moveOnTab",!1)],Rm=function(n,t,e){return e.focusManager.get(n).bind((function(o){return e.execute(n,t,o)}))},Vm=function(n,t,e){Xu(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},Pm=function(n,t,e){return sm(n,e.selector,t,-1)},Hm=function(n,t,e){return sm(n,e.selector,t,1)},zm=e([Sd(vd(fd),Gd(Pm)),Sd(vd(dd),Gd(Hm)),Sd(bd([yd,vd(id)]),(function(n,t,e,o){return e.moveOnTab?Gd(Pm)(n,t,e,o):v.none()})),Sd(bd([wd,vd(id)]),(function(n,t,e,o){return e.moveOnTab?Gd(Hm)(n,t,e,o):v.none()})),Sd(vd(ud),Rm),Sd(vd(cd),Rm)]),Nm=e([Sd(vd(cd),Md)]),Lm=Td(Im,si.init,zm,Nm,(function(){return v.some(Vm)})),jm=[da("onSpace"),da("onEnter"),da("onShiftEnter"),da("onLeft"),da("onRight"),da("onTab"),da("onShiftTab"),da("onUp"),da("onDown"),da("onEscape"),Jt("stopSpaceKeyup",!1),Wt("focusIn")],Um=Td(jm,si.init,(function(n,t,e){return[Sd(vd(cd),e.onSpace),Sd(bd([wd,vd(ud)]),e.onEnter),Sd(bd([yd,vd(ud)]),e.onShiftEnter),Sd(bd([yd,vd(id)]),e.onShiftTab),Sd(bd([wd,vd(id)]),e.onTab),Sd(vd(fd),e.onUp),Sd(vd(dd),e.onDown),Sd(vd(sd),e.onLeft),Sd(vd(ld),e.onRight),Sd(vd(cd),e.onSpace),Sd(vd(ad),e.onEscape)]}),(function(n,t,e){return e.stopSpaceKeyup?[Sd(vd(cd),Md)]:[]}),(function(n){return n.focusIn})),Wm=Bd.schema(),Gm=Dd.schema(),Xm=bm.schema(),Ym=cm.schema(),qm=Fm.schema(),Km=Rd.schema(),Jm=Lm.schema(),$m=Um.schema(),Qm=ic({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Wm,cyclic:Gm,flow:Xm,flatgrid:Ym,matrix:qm,execution:Km,menu:Jm,special:$m}),name:"keying",active:{events:function(n,t){return n.handler.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element,n.element)}),(function(o){o(n,t,e)}))},setGridSize:function(n,t,e,o,r){!function(n){return En(n,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(o,r)}},state:Pd}),Zm=function(n,t,e,o){var r=n.getSystem().build(o)
Qs(n,r,e)},ng=function(n,t,e,o){var r=tg(n)
U(r,(function(n){return je(o.element,n.element)})).each(nf)},tg=function(n,t){return n.components()},eg=function(n,t,e,o,r){var i=tg(n)
return v.from(i[o]).map((function(t){return ng(n,0,0,t),r.each((function(t){Zm(n,0,(function(n,t){(function(n,t,e){Cr(n,e).fold((function(){Er(n,t)}),(function(n){Or(n,t)}))})(n,t,o)}),t)})),t}))},og=oc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,t,e,o){Zm(n,0,Er,o)},prepend:function(n,t,e,o){Zm(n,0,Tr,o)},remove:ng,replaceAt:eg,replaceBy:function(n,t,e,o,r){var i=tg(n)
return W(i,o).bind((function(t){return eg(n,0,0,t,r)}))},set:function(n,t,e,o){dc((function(){var t=P(o,n.getSystem().build)
Js(n,t)}),n.element)},contents:tg})}),rg=function(n,t){return{key:n,value:{config:{},me:function(n,t){var o=Jo(t)
return oc({fields:[Rt("enabled")],name:n,active:{events:e(o)}})}(n,t),configAsRaw:e({}),initialConfig:{},state:si}}},ig=function(n,t){t.ignore||(sc(n.element),t.onFocus(n))},ug=Object.freeze({__proto__:null,focus:ig,blur:function(n,t){t.ignore||function(n){n.dom.blur()}(n.element)},isFocused:function(n){return function(n){var t=Ri(n).dom
return n.dom===t.activeElement}(n.element)}}),ag=Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}}
return di(e)},events:function(n){return Jo([Zo(yo(),(function(t,e){ig(t,n),e.stop()}))].concat(n.stopMousedown?[Zo(eo(),(function(n,t){t.event.prevent()}))]:[]))}}),cg=[la("onFocus"),Jt("stopMousedown",!1),Jt("ignore",!1)],sg=oc({fields:cg,name:"focusing",active:ag,apis:ug}),fg=function(n,t,e){var o=t.aria
o.update(n,o,e.get())},lg=function(n,t,e){t.toggleClass.each((function(t){e.get()?Oi(n.element,t):Ti(n.element,t)}))},dg=function(n,t,e){pg(n,t,e,!e.get())},mg=function(n,t,e){e.set(!0),lg(n,t,e),fg(n,t,e)},gg=function(n,t,e){e.set(!1),lg(n,t,e),fg(n,t,e)},pg=function(n,t,e,o){(o?mg:gg)(n,t,e)},hg=function(n,t,e){pg(n,t,e,t.selected)},vg=Object.freeze({__proto__:null,onLoad:hg,toggle:dg,isOn:function(n,t,e){return e.get()},on:mg,off:gg,set:pg}),bg=Object.freeze({__proto__:null,exhibit:function(){return di({})},events:function(n,t){var e,o,r,i=(e=n,o=t,r=dg,fr((function(n){r(n,e,o)}))),u=$a(n,t,hg)
return Jo(G([n.toggleOnExecute?[i]:[],[u]]))}}),yg=function(n,t,e){Vr(n.element,"aria-expanded",e)},xg=[Jt("selected",!1),Wt("toggleClass"),Jt("toggleOnExecute",!0),$t("aria",{mode:"none"},Ot("mode",{pressed:[Jt("syncWithExpanded",!1),pa("update",(function(n,t,e){Vr(n.element,"aria-pressed",e),t.syncWithExpanded&&yg(n,t,e)}))],checked:[pa("update",(function(n,t,e){Vr(n.element,"aria-checked",e)}))],expanded:[pa("update",yg)],selected:[pa("update",(function(n,t,e){Vr(n.element,"aria-selected",e)}))],none:[pa("update",n)]}))],wg=oc({fields:xg,name:"toggling",active:bg,apis:vg,state:(_d=!1,{init:function(){var n=ie(_d)
return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(_d)},readState:function(){return n.get()}}}})}),Sg=function(){var n=function(n,t){t.stop(),Xo(n)}
return[Zo(go(),n),Zo(Oo(),n),rr(Qe()),rr(eo())]},kg=function(n){return Jo(G([n.map((function(n){return fr((function(t,e){n(t),e.stop()}))})).toArray(),Sg()]))},Cg="alloy.item-hover",Og="alloy.item-focus",_g=function(n){(lc(n.element).isNone()||sg.isFocused(n))&&(sg.isFocused(n)||sg.focus(n),Go(n,Cg,{item:n}))},Tg=function(n){Go(n,Og,{item:n})},Eg=e(Cg),Bg=e(Og),Dg=[Rt("data"),Rt("components"),Rt("dom"),Jt("hasSubmenu",!1),Wt("toggling"),zf("itemBehaviours",[wg,sg,Qm,Rf]),Jt("ignoreFocus",!1),Jt("domModification",{}),pa("builder",(function(n){return{dom:n.dom,domModification:f(f({},n.domModification),{attributes:f(f(f({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Nf(n.itemBehaviours,[n.toggling.fold(wg.revoke,(function(n){return wg.config(f({aria:{mode:"checked"}},n))})),sg.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Tg(n)}}),Qm.config({mode:"execution"}),Rf.config({store:{mode:"memory",initialValue:n.data}}),rg("item-type-events",d(Sg(),[Zo(uo(),_g),Zo(Co(),sg.focus)]))]),components:n.components,eventOrder:n.eventOrder}})),Jt("eventOrder",{})],Ag=[Rt("dom"),Rt("components"),pa("builder",(function(n){return{dom:n.dom,components:n.components,events:Jo([ir(Co())])}}))],Mg=e([ll({name:"widget",overrides:function(n){return{behaviours:tc([Rf.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),Fg=[Rt("uid"),Rt("data"),Rt("components"),Rt("dom"),Jt("autofocus",!1),Jt("ignoreFocus",!1),zf("widgetBehaviours",[Rf,sg,Qm]),Jt("domModification",{}),Ml(Mg()),pa("builder",(function(n){var t=kl(0,n,Mg()),e=Cl("item-widget",n,t.internals()),o=function(t){return Ol(t,n,"widget").map((function(n){return Qm.focusIn(n),n}))},r=function(t,e){return Ul(e.event.target)?v.none():n.autofocus?(e.setSource(t.element),v.none()):v.none()}
return{dom:n.dom,components:e,domModification:n.domModification,events:Jo([fr((function(n,t){o(n).each((function(n){t.stop()}))})),Zo(uo(),_g),Zo(Co(),(function(t,e){n.autofocus?o(t):sg.focus(t)}))]),behaviours:Nf(n.widgetBehaviours,[Rf.config({store:{mode:"memory",initialValue:n.data}}),sg.config({ignore:n.ignoreFocus,onFocus:function(n){Tg(n)}}),Qm.config({mode:"special",focusIn:n.autofocus?function(n){o(n)}:uc(),onLeft:r,onRight:r,onEscape:function(t,e){return sg.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element),v.none()):v.none():(sg.focus(t),v.some(!0))}})])}}))],Ig=Ot("type",{widget:Fg,item:Dg,separator:Ag}),Rg=e([gl({factory:{sketch:function(n){var t=St("menu.spec item",Ig,n)
return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:f(f({},t),{uid:ni("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Vg=e([Rt("value"),Rt("items"),Rt("dom"),Rt("components"),Jt("eventOrder",{}),Vf("menuBehaviours",[od,Rf,Xl,Qm]),$t("movement",{mode:"menu",moveOnTab:!0},Ot("mode",{grid:[va(),pa("config",(function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}}))],matrix:[pa("config",(function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),Rt("rowSelector")],menu:[Jt("moveOnTab",!0),pa("config",(function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}}))]})),Vt("markers",ua()),Jt("fakeFocus",!1),Jt("focusManager",Cd()),la("onHighlight")]),Pg=e("alloy.menu-focus"),Hg=Ll({name:"Menu",configFields:Vg(),partFields:Rg(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Hf(n.menuBehaviours,[od.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Rf.config({store:{mode:"memory",initialValue:n.value}}),Xl.config({find:v.some}),Qm.config(n.movement.config(n,n.movement))]),events:Jo([Zo(Bg(),(function(n,t){var e=t.event
n.getSystem().getByDom(e.target).each((function(e){od.highlight(n,e),t.stop(),Go(n,Pg(),{menu:n,item:e})}))})),Zo(Eg(),(function(n,t){var e=t.event.item
od.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),zg=function(n,t,e,o){return _n(e,o).bind((function(o){return _n(n,o).bind((function(o){var r=zg(n,t,e,o)
return v.some([o].concat(r))}))})).getOr([])},Ng=function(n,t){var e={}
yn(n,(function(n,t){H(n,(function(n){e[n]=t}))}))
var o=t,r=wn(t,(function(n,t){return{k:n,v:t}})),i=xn(r,(function(n,t){return[t].concat(zg(e,o,r,t))}))
return xn(e,(function(n){return _n(i,n).getOr([n])}))},Lg=function(n){return"prepared"===n.type?v.some(n.menu):v.none()},jg={init:function(){var n=ie({}),t=ie({}),e=ie({}),o=ie(v.none()),r=ie({}),i=function(t,e,o){return u(t).bind((function(r){return function(t){return Cn(n.get(),(function(n,e){return n===t}))}(t).bind((function(n){return e(n).map((function(n){return{triggeredMenu:r,triggeringItem:n,triggeringPath:o}}))}))}))},u=function(n){return a(n).bind(Lg)},a=function(n){return _n(t.get(),n)},c=function(t){return _n(n.get(),t)}
return{setMenuBuilt:function(n,e){var o
t.set(f(f({},t.get()),((o={})[n]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(v.some(i)),n.set(a),t.set(u),r.set(c)
var s=Ng(c,a)
e.set(s)},expand:function(t){return _n(n.get(),t).map((function(n){var o=_n(e.get(),t).getOr([])
return[n].concat(o)}))},refresh:function(n){return _n(e.get(),n)},collapse:function(n){return _n(e.get(),n).bind((function(n){return n.length>1?v.some(n.slice(1)):v.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(n){var t=r.get()
return K(vn(t),n)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return t.get()},clear:function(){n.set({}),t.set({}),e.set({}),o.set(v.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,t){var r=N(c(n).toArray(),(function(n){return u(n).isSome()}))
return _n(e.get(),n).bind((function(n){var e=q(r.concat(n))
return function(n){for(var t=[],e=0;e<n.length;e++){var o=n[e]
if(!o.isSome())return v.none()
t.push(o.getOrDie())}return v.some(t)}(X(e,(function(n,r){return i(n,t,e.slice(0,r+1)).fold((function(){return o.get().is(n)?[]:[v.none()]}),(function(n){return[v.some(n)]}))})))}))}}},extractPreparedMenu:Lg},Ug=e("collapse-item"),Wg=Nl({name:"TieredMenu",configFields:[ga("onExecute"),ga("onEscape"),ma("onOpenMenu"),ma("onOpenSubmenu"),la("onRepositionMenu"),la("onCollapseMenu"),Jt("highlightImmediately",!0),Lt("data",[Rt("primary"),Rt("menus"),Rt("expansions")]),Jt("fakeFocus",!1),la("onHighlight"),la("onHover"),ca(),Rt("dom"),Jt("navigateOnHover",!0),Jt("stayInDom",!1),Vf("tmenuBehaviours",[Qm,od,Xl,og]),Jt("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:function(n,t){var e,o=ie(v.none()),r=jg.init(),i=function(t){var e=function(t,e,o){return xn(o,(function(o,r){var i=function(){return Hg.sketch(f(f({},o),{value:r,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?Od():Cd()}))}
return r===e?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))}(t,n.data.primary,n.data.menus),o=a()
return r.setContents(n.data.primary,e,n.data.expansions,o),r.getPrimary()},u=function(n){return Rf.getValue(n).value},a=function(t){return xn(n.data.menus,(function(n,t){return X(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},c=function(n,t){od.highlight(n,t),od.getHighlighted(t).orThunk((function(){return od.getFirst(t)})).each((function(t){Yo(n,t.element,Co())}))},s=function(n,t){return jl(P(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?v.some(n.menu):v.none()}))})))},l=function(t,e,o){var r=s(e,e.otherMenus(o))
H(r,(function(e){Di(e.element,[n.markers.backgroundMenu]),n.stayInDom||og.remove(t,e)}))},d=function(t,e){var r=function(t){return o.get().getOrThunk((function(){var e={},r=as(t.element,"."+n.markers.item),i=N(r,(function(n){return"true"===Pr(n,"aria-haspopup")}))
return H(i,(function(n){t.getSystem().getByDom(n).each((function(n){var t=u(n)
e[t]=n}))})),o.set(v.some(e)),e}))}(t)
yn(r,(function(n,t){var o=F(e,t)
Vr(n.element,"aria-expanded",o)}))},m=function(t,e,o){return v.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return v.none()
var i=r.menu,u=s(e,o.slice(1))
return H(u,(function(t){Oi(t.element,n.markers.backgroundMenu)})),zi(i.element)||og.append(t,mu(i)),Di(i.element,[n.markers.backgroundMenu]),c(t,i),l(t,e,o),v.some(i)}))}))};(function(n){n[n.HighlightSubmenu=0]="HighlightSubmenu",n[n.HighlightParent=1]="HighlightParent"})(e||(e={}))
var g=function(t,o,i){void 0===i&&(i=e.HighlightSubmenu)
var a=u(o)
return r.expand(a).bind((function(u){return d(t,u),v.from(u[0]).bind((function(a){return r.lookupMenu(a).bind((function(c){var s=function(n,t,e){if("notbuilt"===e.type){var o=n.getSystem().build(e.nbMenu())
return r.setMenuBuilt(t,o),o}return e.menu}(t,a,c)
return zi(s.element)||og.append(t,mu(s)),n.onOpenSubmenu(t,o,s,q(u)),i===e.HighlightSubmenu?(od.highlightFirst(s),m(t,r,u)):(od.dehighlightAll(s),v.some(o))}))}))}))},p=function(t,e){var o=u(e)
return r.collapse(o).bind((function(o){return d(t,o),m(t,r,o).map((function(o){return n.onCollapseMenu(t,e,o),o}))}))},h=function(t){return function(e,o){return Yu(o.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOptional().bind((function(n){return t(e,n).map((function(){return!0}))}))}))}},b=Jo([Zo(Pg(),(function(n,t){var e=t.event.item
r.lookupItem(u(e)).each((function(){var e=t.event.menu
od.highlight(n,e)
var o=u(t.event.item)
r.refresh(o).each((function(t){return l(n,r,t)}))}))})),fr((function(t,o){var r=o.event.target
t.getSystem().getByDom(r).each((function(o){0===u(o).indexOf("collapse-item")&&p(t,o),g(t,o,e.HighlightSubmenu).fold((function(){n.onExecute(t,o)}),(function(){}))}))})),ar((function(t,e){i(t).each((function(e){og.append(t,mu(e)),n.onOpenMenu(t,e),n.highlightImmediately&&c(t,e)}))}))].concat(n.navigateOnHover?[Zo(Eg(),(function(t,o){var i=o.event.item;(function(n,t){var e=u(t)
r.refresh(e).bind((function(t){return d(n,t),m(n,r,t)}))})(t,i),g(t,i,e.HighlightParent),n.onHover(t,i)}))]:[])),y=function(n){return od.getHighlighted(n).bind(od.getHighlighted)},x={collapseMenu:function(n){y(n).each((function(t){p(n,t)}))},highlightPrimary:function(n){r.getPrimary().each((function(t){c(n,t)}))},repositionMenus:function(t){r.getPrimary().bind((function(n){return y(t).bind((function(n){var t=u(n),e=On(r.getMenus()),o=jl(P(e,jg.extractPreparedMenu))
return r.getTriggeringPath(t,(function(n){return function(n,t,e){return nn(t,(function(n){if(!n.getSystem().isConnected())return v.none()
var t=od.getCandidates(n)
return U(t,(function(n){return u(n)===e}))}))}(0,o,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))})).fold((function(){(function(n){return v.from(n.components()[0]).filter((function(n){return"menu"===Pr(n.element,"role")}))})(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath
n.onRepositionMenu(t,o,r)}))}}
return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Hf(n.tmenuBehaviours,[Qm.config({mode:"special",onRight:h((function(n,t){return Ul(t.element)?v.none():g(n,t,e.HighlightSubmenu)})),onLeft:h((function(n,t){return Ul(t.element)?v.none():p(n,t)})),onEscape:h((function(t,e){return p(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))})),focusIn:function(n,t){r.getPrimary().each((function(t){Yo(n,t.element,Co())}))}}),od.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),Xl.config({find:function(n){return od.getHighlighted(n)}}),og.config({})]),eventOrder:n.eventOrder,apis:x,events:b}},extraApis:{tieredData:function(n,t,e){return{primary:n,menus:t,expansions:e}},singleData:function(n,t){return{primary:n,menus:Wn(n,t),expansions:{}}},collapseItem:function(n){return{value:Yr(Ug()),meta:{text:n}}}}}),Gg=Nl({name:"InlineView",configFields:[Rt("lazySink"),la("onShow"),la("onHide"),qt("onEscape"),Vf("inlineBehaviours",[pf,Rf,ac]),Kt("fireDismissalEventInstead",[Jt("event",Vo())]),Kt("fireRepositionEventInstead",[Jt("event",Po())]),Jt("getRelated",v.none),Jt("isExtraPart",a),Jt("eventOrder",v.none)],factory:function(n,t){var e=function(n,t,e,r){o(n,t,e,(function(){return r.map((function(n){return Pu(n)}))}))},o=function(t,e,o,r){var i=n.lazySink(t).getOrDie()
pf.openWhileCloaked(t,o,(function(){return Xs.positionWithinBounds(i,e,t,r())})),Rf.setValue(t,v.some({mode:"position",anchor:e,getBounds:r}))},r=function(t,e,o,r){var i=function(n,t,e,o,r){var i=function(){return n.lazySink(t)},u="horizontal"===o.type?{layouts:{onLtr:function(){return Ya()},onRtl:function(){return qa()}}}:{},a=function(n){return function(n){return 2===n.length}(n)?u:{}}
return Wg.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return pf.close(t),n.onEscape.map((function(n){return n(t)})),v.some(!0)},onExecute:function(){return v.some(!0)},onOpenMenu:function(n,t){Xs.positionWithinBounds(i().getOrDie(),e,t,r())},onOpenSubmenu:function(n,t,e,o){var r=i().getOrDie()
Xs.position(r,f({anchor:"submenu",item:t},a(o)),e)},onRepositionMenu:function(n,t,o){var u=i().getOrDie()
Xs.positionWithinBounds(u,e,t,r()),H(o,(function(n){var t=a(n.triggeringPath)
Xs.position(u,f({anchor:"submenu",item:n.triggeringItem},t),n.triggeredMenu)}))}})}(n,t,e,o,r)
pf.open(t,i),Rf.setValue(t,v.some({mode:"menu",menu:i}))},i=function(t){pf.isOpen(t)&&Rf.getValue(t).each((function(e){switch(e.mode){case"menu":pf.getState(t).each((function(n){Wg.repositionMenus(n)}))
break
case"position":var o=n.lazySink(t).getOrDie()
Xs.positionWithinBounds(o,e.anchor,t,e.getBounds())}}))},u={setContent:function(n,t){pf.setContent(n,t)},showAt:function(n,t,o){e(n,t,o,v.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(n,t,e){r(n,t,e,(function(){return v.none()}))},showMenuWithinBounds:r,hide:function(n){pf.isOpen(n)&&(Rf.setValue(n,v.none()),pf.close(n))},getContent:function(n){return pf.getState(n)},reposition:i,isOpen:pf.isOpen}
return{uid:n.uid,dom:n.dom,behaviours:Hf(n.inlineBehaviours,[pf.config({isPartOf:function(t,e,o){return Ju(e,o)||function(t,e){return n.getRelated(t).exists((function(n){return Ju(n,e)}))}(t,o)},getAttachPoint:function(t){return n.lazySink(t).getOrDie()},onOpen:function(t){n.onShow(t)},onClose:function(t){n.onHide(t)}}),Rf.config({store:{mode:"memory",initialValue:v.none()}}),ac.config({channels:f(f({},xf(f({isExtraPart:t.isExtraPart},n.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),Sf(f(f({},n.fireRepositionEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:n.eventOrder,apis:u}},apis:{showAt:function(n,t,e,o){n.showAt(t,e,o)},showWithin:function(n,t,e,o,r){n.showWithin(t,e,o,r)},showWithinBounds:function(n,t,e,o,r){n.showWithinBounds(t,e,o,r)},showMenuAt:function(n,t,e,o){n.showMenuAt(t,e,o)},showMenuWithinBounds:function(n,t,e,o,r){n.showMenuWithinBounds(t,e,o,r)},hide:function(n,t){n.hide(t)},isOpen:function(n,t){return n.isOpen(t)},getContent:function(n,t){return n.getContent(t)},setContent:function(n,t,e){n.setContent(t,e)},reposition:function(n,t){n.reposition(t)}}}),Xg=function(n){return n.x},Yg=function(n,t){return n.x+n.width/2-t.width/2},qg=function(n,t){return n.x+n.width-t.width},Kg=function(n){return n.y},Jg=function(n,t){return n.y+n.height-t.height},$g=function(n,t,e){return ba(qg(n,t),Jg(n,t),e.innerSoutheast(),ka(),Ea(n,{right:0,bottom:3}),"layout-inner-se")},Qg=function(n,t,e){return ba(Xg(n),Jg(n,t),e.innerSouthwest(),Sa(),Ea(n,{left:1,bottom:3}),"layout-inner-sw")},Zg=function(n,t,e){return ba(qg(n,t),Kg(n),e.innerNortheast(),wa(),Ea(n,{right:0,top:2}),"layout-inner-ne")},np=function(n,t,e){return ba(Xg(n),Kg(n),e.innerNorthwest(),xa(),Ea(n,{left:1,top:2}),"layout-inner-nw")},tp=function(n,t,e){return ba(Yg(n,t),Kg(n),e.innerNorth(),Ca(),Ea(n,{top:2}),"layout-inner-n")},ep=function(n,t,e){return ba(Yg(n,t),Jg(n,t),e.innerSouth(),Oa(),Ea(n,{bottom:3}),"layout-inner-s")},op=tinymce.util.Tools.resolve("tinymce.util.Delay"),rp=Nl({name:"Button",factory:function(n){var t=kg(n.action),e=n.dom.tag,o=function(t){return _n(n.dom,"attributes").bind((function(n){return _n(n,t)}))}
return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Nf(n.buttonBehaviours,[sg.config({}),Qm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var n=o("type").getOr("button"),t=o("role").map((function(n){return{role:n}})).getOr({})
return f({type:n},t)}return{role:o("role").getOr("button")}}()},eventOrder:n.eventOrder}},configFields:[Jt("uid",void 0),Rt("dom"),Jt("components",[]),zf("buttonBehaviours",[sg,Qm]),Wt("action"),Wt("role"),Jt("eventOrder",{})]}),ip=function(n){var t=function(n){return void 0!==n.uid}(n)&&En(n,"uid")?n.uid:ni("memento")
return{get:function(n){return n.getSystem().getByUid(t).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(t).toOptional()},asSpec:function(){return f(f({},n),{uid:t})}}},up=function(n){return v.from(n()["temporary-placeholder"]).getOr("!not found!")},ap=function(n,t){return v.from(t()[n.toLowerCase()]).getOrThunk((function(){return up(t)}))},cp=function(n,t){return nn(n,(function(n){return v.from(t()[n.toLowerCase()])})).getOrThunk((function(){return up(t)}))},sp={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},fp=Nl({name:"Notification",factory:function(n){var t=ip({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:tc([og.config({})])}),e=function(n){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+n+"%"}}}},o=function(n){return{dom:{tag:"div",classes:["tox-text"],innerHtml:n+"%"}}},r=ip({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:tc([og.config({})])}),i={updateProgress:function(n,t){n.getSystem().isConnected()&&r.getOpt(n).each((function(n){og.set(n,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(t)]},o(t)])}))},updateText:function(n,e){if(n.getSystem().isConnected()){var o=t.get(n)
og.set(o,[su(e)])}}},u=G([n.icon.toArray(),n.level.toArray(),n.level.bind((function(n){return v.from(sp[n])})).toArray()]),a=ip(rp.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:ap("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),c=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:cp(u,n.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:tc([og.config({})])}]
return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map((function(n){return["tox-notification","tox-notification--in","tox-notification--"+n]})).getOr(["tox-notification","tox-notification--in"])},behaviours:tc([sg.config({}),rg("notification-events",[Zo(ao(),(function(n){a.getOpt(n).each(sg.focus)}))])]),components:c.concat(n.progress?[r.asSpec()]:[]).concat(n.closeButton?[a.asSpec()]:[]),apis:i}},configFields:[Wt("level"),Rt("progress"),Rt("icon"),Rt("onAction"),Rt("text"),Rt("iconProvider"),Rt("translationProvider"),te("closeButton",!0)],apis:{updateProgress:function(n,t,e){n.updateProgress(t,e)},updateText:function(n,t,e){n.updateText(t,e)}}})
function lp(n,t,e){var o=t.backstage
return{open:function(n,r){var i=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),u=function(){r(),Gg.hide(c)},a=du(fp.sketch({text:n.text,level:F(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:v.from(n.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=du(Gg.sketch(f({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})))
return e.add(c),n.timeout>0&&op.setTimeout((function(){u()}),n.timeout),{close:u,moveTo:function(n,t){Gg.showAt(c,{anchor:"makeshift",x:n,y:t},mu(a))},moveRel:function(n,e){if("banner"!==e){var o=function(n){switch(n){case"bc-bc":return ep
case"tc-tc":return tp
case"tc-bc":return za
case"bc-tc":default:return Na}}(e),r={anchor:"node",root:Ni(),node:v.some(ae.fromDom(n)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}}
Gg.showAt(c,r,mu(a))}else Gg.showAt(c,t.backstage.shared.anchors.banner(),mu(a))},text:function(n){fp.updateText(a,n)},settings:n,getEl:function(){return a.element.dom},progressBar:{value:function(n){fp.updateProgress(a,n)}}}},close:function(n){n.close()},reposition:function(n){(function(n){H(n,(function(n){return n.moveTo(0,0)}))})(n),function(n){n.length>0&&($(n).each((function(n){return n.moveRel(null,"banner")})),H(n,(function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})))}(n)},getArgs:function(n){return n.settings}}}var dp,mp=function(n,t){var e=null
return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
null!==e&&clearTimeout(e),e=setTimeout((function(){n.apply(null,o),e=null}),t)}}},gp=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),pp=function(n,t,e,o,r){var i=gp(n,(function(t){return function(n,t){return n.isBlock(t)||F(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t)}(n,t)}))
return v.from(i.backwards(t,e,o,r))},hp=function(n,t){return vp(ae.fromDom(n.selection.getNode())).getOrThunk((function(){var e=ae.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc())
return Er(e,ae.fromDom(t.extractContents())),t.insertNode(e.dom),wr(e).each((function(n){return n.dom.normalize()})),function(n){return us(n,is)}(e).map((function(t){n.selection.setCursorLocation(t.dom,function(n){return"img"===lr(n)?1:os(n).fold((function(){return kr(n).length}),(function(n){return n.length}))}(t))})),e}))},vp=function(n){return Yu(n,"[data-mce-autocompleter]")},bp=function(n){return n.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},yp=function(n){return""!==n&&-1!==" \f\n\r\t\v".indexOf(n)},xp=function(n,t){return n.substring(t.length)},wp=function(n,t,e,o){if(void 0===o&&(o=0),!(r=t).collapsed||3!==r.startContainer.nodeType)return v.none()
var r,i=n.getParent(t.startContainer,n.isBlock)||n.getRoot()
return pp(n,t.startContainer,t.startOffset,(function(n,t,o){return function(n,t,e){var o
for(o=t-1;o>=0;o--){var r=n.charAt(o)
if(yp(r))return v.none()
if(r===e)break}return v.some(o)}(o,t,e).getOr(t)}),i).bind((function(n){var r=t.cloneRange()
if(r.setStart(n.container,n.offset),r.setEnd(t.endContainer,t.endOffset),r.collapsed)return v.none()
var i=bp(r)
return 0!==i.lastIndexOf(e)||xp(i,e).length<o?v.none():v.some({text:xp(i,e),range:r,triggerChar:e})}))},Sp=function(n,t,e,o){return void 0===o&&(o=0),vp(ae.fromDom(t.startContainer)).fold((function(){return wp(n,t,e,o)}),(function(t){var o=n.createRng()
o.selectNode(t.dom)
var r=bp(o)
return v.some({range:o,text:xp(r,e),triggerChar:e})}))},kp=function(n,t){t.on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel)
var e=function(n,t){Go(n,so(),{raw:t})}
t.on("keydown",(function(t){var o=function(){return n.getView().bind(od.getHighlighted)}
8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(o().each(Xo),t.preventDefault()):40===t.which?(o().fold((function(){n.getView().each(od.highlightFirst)}),(function(n){e(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||o().each((function(n){e(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())})),t.on("NodeChange",(function(t){n.isActive()&&!n.isProcessingAction()&&vp(ae.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))},Cp=tinymce.util.Tools.resolve("tinymce.util.Promise"),Op=function(n,t){return{container:n,offset:t}},_p=function(n){if(function(n){return 3===n.nodeType}(n))return Op(n,n.data.length)
var t=n.childNodes
return t.length>0?_p(t[t.length-1]):Op(n,t.length)},Tp=function(n,t){var e=n.childNodes
return e.length>0&&t<e.length?Tp(e[t],0):e.length>0&&function(n){return 1===n.nodeType}(n)&&e.length===t?_p(e[e.length-1]):Op(n,t)},Ep=function(n){return function(t){var e=Tp(t.startContainer,t.startOffset)
return!function(n,t){return pp(n,t.container,t.offset,(function(n,t){return 0===t?-1:t}),n.getRoot()).filter((function(n){var t=n.container.data.charAt(n.offset-1)
return!yp(t)})).isSome()}(n,e)}},Bp=function(n,t){var e=t(),o=n.selection.getRng()
return function(n,t,e){return nn(e.triggerChars,(function(e){return Sp(n,t,e)}))}(n.dom,o,e).bind((function(e){return Dp(n,t,e)}))},Dp=function(n,t,e,o){void 0===o&&(o={})
var r=t(),i=n.selection.getRng().startContainer.nodeValue,u=N(r.lookupByChar(e.triggerChar),(function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk((function(){return Ep(n.dom)}))(e.range,i,e.text)}))
if(0===u.length)return v.none()
var a=Cp.all(P(u,(function(n){return n.fetch(e.text,n.maxResults,o).then((function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction}}))})))
return v.some({lookupData:a,context:e})},Ap=it([Ht("type"),Yt("text")]),Mp=it([Jt("type","autocompleteitem"),Jt("active",!1),Jt("disabled",!1),Jt("meta",{}),Ht("value"),Yt("text"),Yt("icon")]),Fp=it([Ht("type"),Ht("ch"),Qt("minChars",1),Jt("columns",1),Qt("maxResults",10),qt("matches"),Nt("fetch"),Nt("onAction")]),Ip=[te("disabled",!1),Yt("tooltip"),Yt("icon"),Yt("text"),ee("onSetup",(function(){return n}))],Rp=it([Ht("type"),Nt("onAction")].concat(Ip)),Vp=function(n){return xt("toolbarbutton",Rp,n)},Pp=[te("active",!1)].concat(Ip),Hp=it(Pp.concat([Ht("type"),Nt("onAction")])),zp=function(n){return xt("ToggleButton",Hp,n)},Np=[ee("predicate",(function(){return!1})),ne("scope","node",["node","editor"]),ne("position","selection",["node","selection","line"])],Lp=Ip.concat([Jt("type","contextformbutton"),Jt("primary",!1),Nt("onAction"),re("original",o)]),jp=Pp.concat([Jt("type","contextformbutton"),Jt("primary",!1),Nt("onAction"),re("original",o)]),Up=Ip.concat([Jt("type","contextformbutton")]),Wp=Pp.concat([Jt("type","contextformtogglebutton")]),Gp=Ot("type",{contextformbutton:Lp,contextformtogglebutton:jp}),Xp=it([Jt("type","contextform"),ee("initValue",(function(){return""})),Yt("label"),Ut("commands",Gp),Gt("launch",Ot("type",{contextformbutton:Up,contextformtogglebutton:Wp}))].concat(Np)),Yp=it([Jt("type","contexttoolbar"),Ht("items")].concat(Np)),qp=function(n){var t=n.ui.registry.getAll().popups,e=xn(t,(function(n){return(t=n,xt("Autocompleter",Fp,t)).fold((function(n){throw new Error(kt(n))}),(function(n){return n}))
var t})),o=function(n){var t={}
return H(n,(function(n){t[n]={}})),vn(t)}(kn(e,(function(n){return n.ch}))),r=On(e)
return{dataset:e,triggerChars:o,lookupByChar:function(n){return N(r,(function(t){return t.ch===n}))}}};(function(n){n[n.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",n[n.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"})(dp||(dp={}))
var Kp,Jp=dp,$p="tox-menu-nav__js",Qp="tox-collection__item",Zp="tox-swatch",nh={normal:$p,color:Zp},th="tox-collection__item--enabled",eh="tox-collection__item-label",oh="tox-collection__item-caret",rh="tox-collection__item--active",ih=function(n){return _n(nh,n).getOr($p)},uh=function(n){return"color"===n?"tox-swatches":"tox-menu"},ah=function(n){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:uh(n),tieredMenu:"tox-tiered-menu"}},ch=function(n){var t=ah(n)
return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:ih(n)}},sh=function(n,t,e){var o=ah(e)
return{tag:"div",classes:G([[o.menu,"tox-menu-"+t+"-column"],n?[o.hasIcons]:[]])}},fh=[Hg.parts.items({})],lh=function(n,t,e){var o=ah(e)
return{dom:{tag:"div",classes:G([[o.tieredMenu]])},markers:ch(e)}},dh=function(n,t){return function(e){var o=V(e,t)
return P(o,(function(t){return{dom:n,components:t}}))}},mh=function(n,t){var e=[],o=[]
return H(n,(function(n,r){t(n,r)?(o.length>0&&e.push(o),o=[],Tn(n.dom,"innerHtml")&&o.push(n)):o.push(n)})),o.length>0&&e.push(o),P(e,(function(n){return{dom:{tag:"div",classes:["tox-collection__group"]},components:n}}))},gh=function(n,t,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Hg.parts.items({preprocess:function(e){return"auto"!==n&&n>1?dh({tag:"div",classes:["tox-collection__group"]},n)(e):mh(e,(function(n,e){return"separator"===t[e].type}))}})]}},ph=function(n){return I(n,(function(n){return"icon"in n&&void 0!==n.icon}))},hh=function(n){return console.error(kt(n)),console.log(n),v.none()},vh=function(n,t,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Hg.parts.items({preprocess:function(n){return mh(n,(function(n,t){return"separator"===i[t].type}))}})]})
return{value:n,dom:u.dom,components:u.components,items:e}},bh=function(n,t,e,r,i){var u
return"color"===i?{value:n,dom:(u=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Hg.parts.items({preprocess:"auto"!==n?dh({tag:"div",classes:["tox-swatches__row"]},n):o})]}]}}(r)).dom,components:u.components,items:e}:"normal"===i&&"auto"===r?{value:n,dom:(u=gh(r,e)).dom,components:u.components,items:e}:"normal"===i&&1===r?{value:n,dom:(u=gh(1,e)).dom,components:u.components,items:e}:"normal"===i?{value:n,dom:(u=gh(r,e)).dom,components:u.components,items:e}:"listpreview"===i&&"auto"!==r?{value:n,dom:(u=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Hg.parts.items({preprocess:dh({tag:"div",classes:["tox-collection__group"]},n)})]}}(r)).dom,components:u.components,items:e}:{value:n,dom:sh(t,r,i),components:fh,items:e}},yh=[te("disabled",!1),Yt("text"),Yt("shortcut"),dt("value","value",Nn((function(){return Yr("menuitem-value")})),_t()),Jt("meta",{})],xh=it([Ht("type"),te("active",!1),Yt("icon")].concat(yh)),wh=it([Ht("type"),zt("fancytype",["inserttable","colorswatch"]),ee("onAction",n)]),Sh=it([Ht("type"),ee("onSetup",(function(){return n})),ee("onAction",n),Yt("icon")].concat(yh)),kh=it([Ht("type"),Nt("getSubmenuItems"),ee("onSetup",(function(){return n})),Yt("icon")].concat(yh)),Ch=it([Ht("type"),Yt("icon"),te("active",!1),ee("onSetup",(function(){return n})),Nt("onAction")].concat(yh)),Oh=function(n,t,e){var o=as(n.element,"."+e)
if(o.length>0){var r=W(o,(function(n){var e=n.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top
return Math.abs(e-r)>t})).getOr(o.length)
return v.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return v.none()},_h=function(n,t){return tc([rg(n,t)])},Th=function(n){return _h(Yr("unnamed-events"),n)},Eh=[Rt("lazySink"),Rt("tooltipDom"),Jt("exclusive",!0),Jt("tooltipComponents",[]),Jt("delay",300),ne("mode","normal",["normal","follow-highlight"]),Jt("anchor",(function(n){return{anchor:"hotspot",hotspot:n,layouts:{onLtr:e([Na,za,Ra,Pa,Va,Ha]),onRtl:e([Na,za,Ra,Pa,Va,Ha])}}})),la("onHide"),la("onShow")],Bh=Object.freeze({__proto__:null,init:function(){var n=ie(v.none()),t=ie(v.none()),o=function(){n.get().each((function(n){clearTimeout(n)}))},r=e("not-implemented")
return fi({getTooltip:function(){return t.get()},isShowing:function(){return t.get().isSome()},setTooltip:function(n){t.set(v.some(n))},clearTooltip:function(){t.set(v.none())},clearTimer:o,resetTimer:function(t,e){o(),n.set(v.some(setTimeout((function(){t()}),e)))},readState:r})}}),Dh=Yr("tooltip.exclusive"),Ah=Yr("tooltip.show"),Mh=Yr("tooltip.hide"),Fh=function(n,t,e){n.getSystem().broadcastOn([Dh],{})},Ih=Object.freeze({__proto__:null,hideAllExclusive:Fh,setComponents:function(n,t,e,o){e.getTooltip().each((function(n){n.getSystem().isConnected()&&og.set(n,o)}))}}),Rh=oc({fields:Eh,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(n,t){var e=function(e){t.getTooltip().each((function(o){nf(o),n.onHide(e,o),t.clearTooltip()})),t.clearTimer()}
return Jo(G([[Zo(Ah,(function(e){t.resetTimer((function(){(function(e){if(!t.isShowing()){Fh(e)
var o=n.lazySink(e).getOrDie(),r=e.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:Jo("normal"===n.mode?[Zo(uo(),(function(n){Wo(e,Ah)})),Zo(ro(),(function(n){Wo(e,Mh)}))]:[]),behaviours:tc([og.config({})])})
t.setTooltip(r),$s(o,r),n.onShow(e,r),Xs.position(o,n.anchor(e),r)}})(e)}),n.delay)})),Zo(Mh,(function(o){t.resetTimer((function(){e(o)}),n.delay)})),Zo(So(),(function(n,t){var o=t
o.universal||F(o.channels,Dh)&&e(n)})),cr((function(n){e(n)}))],"normal"===n.mode?[Zo(ao(),(function(n){Wo(n,Ah)})),Zo(xo(),(function(n){Wo(n,Mh)})),Zo(uo(),(function(n){Wo(n,Ah)})),Zo(ro(),(function(n){Wo(n,Mh)}))]:[Zo(jo(),(function(n,t){Wo(n,Ah)})),Zo(Uo(),(function(n){Wo(n,Mh)}))]]))}}),state:Bh,apis:Ih}),Vh=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ph=tinymce.util.Tools.resolve("tinymce.util.I18n"),Hh=["input","button","textarea","select"],zh=function(n,t,e){(t.disabled()?Gh:Xh)(n,t)},Nh=function(n,t){return!0===t.useNative&&F(Hh,lr(n.element))},Lh=function(n){Vr(n.element,"disabled","disabled")},jh=function(n){Nr(n.element,"disabled")},Uh=function(n){Vr(n.element,"aria-disabled","true")},Wh=function(n){Vr(n.element,"aria-disabled","false")},Gh=function(n,t,e){t.disableClass.each((function(t){Oi(n.element,t)})),(Nh(n,t)?Lh:Uh)(n),t.onDisabled(n)},Xh=function(n,t,e){t.disableClass.each((function(t){Ti(n.element,t)})),(Nh(n,t)?jh:Wh)(n),t.onEnabled(n)},Yh=function(n,t){return Nh(n,t)?function(n){return zr(n.element,"disabled")}(n):function(n){return"true"===Pr(n.element,"aria-disabled")}(n)},qh=Object.freeze({__proto__:null,enable:Xh,disable:Gh,isDisabled:Yh,onLoad:zh,set:function(n,t,e,o){(o?Gh:Xh)(n,t)}}),Kh=Object.freeze({__proto__:null,exhibit:function(n,t){return di({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(n,t){return Jo([$o(ko(),(function(t,e){return Yh(t,n)})),$a(n,t,zh)])}}),Jh=[ee("disabled",a),Jt("useNative",!0),Wt("disableClass"),la("onDisabled"),la("onEnabled")],$h=oc({fields:Jh,name:"disabling",active:Kh,apis:qh}),Qh=tinymce.util.Tools.resolve("tinymce.EditorManager"),Zh=function(n){return n.getParam("height",Math.max(n.getElement().offsetHeight,200))},nv=function(n){return n.getParam("width",Vh.DOM.getStyle(n.getElement(),"width"))},tv=function(n){return v.from(n.getParam("min_width")).filter(T)},ev=function(n){return v.from(n.getParam("min_height")).filter(T)},ov=function(n){return v.from(n.getParam("max_width")).filter(T)},rv=function(n){return v.from(n.getParam("max_height")).filter(T)},iv=function(n){return!1!==n.getParam("menubar",!0,"boolean")},uv=function(n){var t=n.getParam("toolbar",!0),e=!0===t,o=x(t),r=S(t)&&t.length>0
return!cv(n)&&(r||o||e)},av=function(n){var t=R(9,(function(t){return n.getParam("toolbar"+(t+1),!1,"string")})),e=N(t,(function(n){return"string"==typeof n}))
return e.length>0?v.some(e):v.none()},cv=function(n){return av(n).fold((function(){return n.getParam("toolbar",[],"string[]").length>0}),(function(){return!0}))};(function(n){n.default="wrap",n.floating="floating",n.sliding="sliding",n.scrolling="scrolling"})(Kp||(Kp={}))
var sv,fv=function(n){return n.getParam("toolbar_mode","","string")};(function(n){n.auto="auto",n.top="top",n.bottom="bottom"})(sv||(sv={}))
var lv,dv,mv=function(n){return n.getParam("toolbar_location",sv.auto,"string")},gv=function(n){return mv(n)===sv.bottom},pv=function(n){var t=function(n){return n.getParam("fixed_toolbar_container","","string")}(n)
return t.length>0&&n.inline?Xu(Ni(),t):v.none()},hv=function(n){return n.inline&&pv(n).isSome()},vv=function(n){return n.inline&&!iv(n)&&!uv(n)&&!cv(n)},bv=function(n){return(n.getParam("toolbar_sticky",!1,"boolean")||n.inline)&&!hv(n)&&!vv(n)},yv=function(n){var t=n.getParam("menu")
return t?xn(t,(function(n){return f(f({},n),{items:n.items})})):{}},xv=function(n){return n.getParam("menubar")},wv=function(n){return n.getParam("anchor_top","#top")},Sv=function(n){return n.getParam("anchor_bottom","#bottom")},kv="silver.readonly",Cv=it([(lv="readonly",Vt(lv,Dt))]),Ov=function(n,t){var e=n.outerContainer.element
t&&(n.mothership.broadcastOn([hf()],{target:e}),n.uiMothership.broadcastOn([hf()],{target:e})),n.mothership.broadcastOn([kv],{readonly:t}),n.uiMothership.broadcastOn([kv],{readonly:t})},_v=function(n,t){n.on("init",(function(){n.mode.isReadOnly()&&Ov(t,!0)})),n.on("SwitchMode",(function(){return Ov(t,n.mode.isReadOnly())})),function(n){return n.getParam("readonly",!1,"boolean")}(n)&&n.setMode("readonly")},Tv=function(){var n
return ac.config({channels:(n={},n[kv]={schema:Cv,onReceive:function(n,t){$h.set(n,t.readonly)}},n)})},Ev=function(n){return $h.config({disabled:n,disableClass:"tox-collection__item--state-disabled"})},Bv=function(n){return $h.config({disabled:n})},Dv=function(n){return $h.config({disabled:n,disableClass:"tox-tbtn--disabled"})},Av=function(n){return $h.config({disabled:n,disableClass:"tox-tbtn--disabled",useNative:!1})},Mv=function(n,t){var e=n.getApi(t)
return function(n){n(e)}},Fv=function(n,t){return ar((function(e){Mv(n,e)((function(e){var o=n.onSetup(e)
null!=o&&t.set(o)}))}))},Iv=function(n,t){return cr((function(e){return Mv(n,e)(t.get())}))},Rv=function(n,t){return fr((function(e,o){Mv(n,e)(n.onAction),n.triggersSubmenu||t!==Jp.CLOSE_ON_EXECUTE||(Wo(e,To()),o.stop())}))},Vv=((dv={})[ko()]=["disabling","alloy.base.behaviour","toggling","item-events"],dv),Pv=function(n){return X(n,(function(n){return n.toArray()}))},Hv=function(t,e,o,r){var i=ie(n)
return{type:"item",dom:e.dom,components:Pv(e.optComponents),data:t.data,eventOrder:Vv,hasSubmenu:t.triggersSubmenu,itemBehaviours:tc([rg("item-events",[Rv(t,o),Fv(t,i),Iv(t,i)]),Ev((function(){return t.disabled||r.isReadOnly()})),Tv(),og.config({})].concat(t.itemBehaviours))}},zv=function(n){return{value:n.value,meta:f({text:n.text.getOr("")},n.meta)}},Nv=tinymce.util.Tools.resolve("tinymce.Env"),Lv=function(n){var t=Nv.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=n.split("+"),o=P(e,(function(n){var e=n.toLowerCase().trim()
return Tn(t,e)?t[e]:n}))
return Nv.mac?o.join(""):o.join("+")},jv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:n}}},Uv=function(n){return{dom:{tag:"div",classes:[eh]},components:[su(Ph.translate(n))]}},Wv=function(n,t){return{dom:{tag:"div",classes:[eh]},components:[{dom:{tag:n.tag,styles:n.styles},components:[su(Ph.translate(t))]}]}},Gv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:Lv(n)}}},Xv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:ap("checkmark",n)}}},Yv=function(n,t,e,o,r){var i=e?t.or(v.some("")).map(jv):v.none(),u=n.checkMark,a=n.ariaLabel.map((function(n){return{attributes:{title:Ph.translate(n)}}})).getOr({})
return{dom:f({tag:"div",classes:[$p,Qp].concat(r?["tox-collection__item-icon-rtl"]:[])},a),optComponents:[i,n.htmlContent.fold((function(){return n.textContent.map(o)}),(function(n){return v.some(function(n){return{dom:{tag:"div",classes:[eh],innerHtml:n}}}(n))})),n.shortcutContent.map(Gv),u,n.caret]}},qv=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Kv=["list-bull-circle","list-bull-default","list-bull-square"],Jv=function(n,t,e,o){void 0===o&&(o=v.none())
var i,u=Ph.isRtl()&&n.iconContent.exists((function(n){return F(Kv,n)})),a=(i=n.iconContent,i.map((function(n){return Ph.isRtl()&&F(qv,n)?n+"-rtl":n}))).map((function(n){return function(n,t,e){return v.from(t()[n.toLowerCase()]).or(e).getOrThunk((function(){return up(t)}))}(n,t.icons,o)})),c=v.from(n.meta).fold((function(){return Uv}),(function(n){return Tn(n,"style")?r(Wv,n.style):Uv}))
return"color"===n.presets?function(n,t,e,o){var r,i
return{dom:(r=e.getOr(""),i={tag:"div",attributes:n.map((function(n){return{title:o.translate(n)}})).getOr({}),classes:["tox-swatch"]},f(f({},i),"custom"===t?{tag:"button",classes:d(i.classes,["tox-swatches__picker-btn"]),innerHtml:r}:"remove"===t?{classes:d(i.classes,["tox-swatch--remove"]),innerHtml:r}:{attributes:f(f({},i.attributes),{"data-mce-color":t}),styles:{"background-color":t}})),optComponents:[]}}(n.ariaLabel,n.value,a,t):Yv(n,a,e,c,u)},$v=function(n,t){return _n(n,"tooltipWorker").map((function(n){return[Rh.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(n){return{anchor:"submenu",item:n,overrides:{maxHeightFunction:Ac}}},mode:"follow-highlight",onShow:function(t,e){n((function(n){Rh.setComponents(t,[fu({element:ae.fromDom(n)})])}))}})]})).getOr([])},Qv=function(n,t){var e=function(n){return Vh.DOM.encode(n)}(Ph.translate(n))
if(t.length>0){var o=new RegExp(function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(t),"gi")
return e.replace(o,(function(n){return'<span class="tox-autocompleter-highlight">'+n+"</span>"}))}return e},Zv=bl("item-widget",Mg()),nb=function(n){return{value:n}},tb=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,eb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ob=function(n){return tb.test(n)||eb.test(n)},rb=function(n){var t=function(n){return{value:n.value.replace(tb,(function(n,t,e,o){return t+t+e+e+o+o}))}}(n),e=eb.exec(t.value)
return null===e?["FFFFFF","FF","FF","FF"]:e},ib=function(n){var t=n.toString(16)
return 1===t.length?"0"+t:t},ub=function(n){var t=ib(n.red)+ib(n.green)+ib(n.blue)
return nb(t)},ab=Math.min,cb=Math.max,sb=Math.round,fb=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,lb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,db=function(n,t,e,o){return{red:n,green:t,blue:e,alpha:o}},mb=function(n){var t=parseInt(n,10)
return t.toString()===n&&t>=0&&t<=255},gb=function(n){var t,e,o,r=(n.hue||0)%360,i=n.saturation/100,u=n.value/100
if(i=cb(0,ab(i,1)),u=cb(0,ab(u,1)),0===i)return t=e=o=sb(255*u),db(t,e,o,1)
var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c
switch(Math.floor(a)){case 0:t=c,e=s,o=0
break
case 1:t=s,e=c,o=0
break
case 2:t=0,e=c,o=s
break
case 3:t=0,e=s,o=c
break
case 4:t=s,e=0,o=c
break
case 5:t=c,e=0,o=s
break
default:t=e=o=0}return t=sb(255*(t+f)),e=sb(255*(e+f)),o=sb(255*(o+f)),db(t,e,o,1)},pb=function(n){var t=rb(n),e=parseInt(t[1],16),o=parseInt(t[2],16),r=parseInt(t[3],16)
return db(e,o,r,1)},hb=function(n,t,e,o){var r=parseInt(n,10),i=parseInt(t,10),u=parseInt(e,10),a=parseFloat(o)
return db(r,i,u,a)},vb=function(n){return"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")"},bb=db(255,0,0,1),yb=function(n,t){return n.fire("ResizeContent",t)},xb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),wb="tinymce-custom-colors"
var Sb="choiceitem",kb=[{type:Sb,text:"Light Green",value:"#BFEDD2"},{type:Sb,text:"Light Yellow",value:"#FBEEB8"},{type:Sb,text:"Light Red",value:"#F8CAC6"},{type:Sb,text:"Light Purple",value:"#ECCAFA"},{type:Sb,text:"Light Blue",value:"#C2E0F4"},{type:Sb,text:"Green",value:"#2DC26B"},{type:Sb,text:"Yellow",value:"#F1C40F"},{type:Sb,text:"Red",value:"#E03E2D"},{type:Sb,text:"Purple",value:"#B96AD9"},{type:Sb,text:"Blue",value:"#3598DB"},{type:Sb,text:"Dark Turquoise",value:"#169179"},{type:Sb,text:"Orange",value:"#E67E23"},{type:Sb,text:"Dark Red",value:"#BA372A"},{type:Sb,text:"Dark Purple",value:"#843FA1"},{type:Sb,text:"Dark Blue",value:"#236FA1"},{type:Sb,text:"Light Gray",value:"#ECF0F1"},{type:Sb,text:"Medium Gray",value:"#CED4D9"},{type:Sb,text:"Gray",value:"#95A5A6"},{type:Sb,text:"Dark Gray",value:"#7E8C8D"},{type:Sb,text:"Navy Blue",value:"#34495E"},{type:Sb,text:"Black",value:"#000000"},{type:Sb,text:"White",value:"#ffffff"}],Cb=function(n){void 0===n&&(n=10)
var t,e=xb.getItem(wb),o=x(e)?JSON.parse(e):[],r=n-(t=o).length<0?t.slice(0,n):t,i=function(n){r.splice(n,1)}
return{add:function(t){(function(n,t){var e=M(n,t)
return-1===e?v.none():v.some(e)})(r,t).each(i),r.unshift(t),r.length>n&&r.pop(),xb.setItem(wb,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),Ob=function(n){return!1!==n.getParam("custom_colors")},_b=function(n){var t=function(n){return n.getParam("color_map")}(n)
return void 0!==t?function(n){var t=[],e=document.createElement("canvas")
e.height=1,e.width=1
for(var o=e.getContext("2d"),r=function(n,t){var e=t/255
return("0"+Math.round(n*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=function(n){if(/^[0-9A-Fa-f]{6}$/.test(n))return"#"+n.toUpperCase()
o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=n,o.fillRect(0,0,1,1)
var t=o.getImageData(0,0,1,1).data,i=t[0],u=t[1],a=t[2],c=t[3]
return"#"+r(i,c)+r(u,c)+r(a,c)},u=0;u<n.length;u+=2)t.push({text:n[u+1],value:i(n[u]),type:"choiceitem"})
return t}(t):kb},Tb=function(n){Cb.add(n)},Eb=function(n){return function(n,t){return n.getParam("color_cols",t,"number")}(n,function(n){return Math.max(5,Math.ceil(Math.sqrt(n)))}(_b(n).length))},Bb=function(n,t,e,o){"custom"===e?Rb(n)((function(e){e.each((function(e){Tb(e),n.execCommand("mceApplyTextcolor",t,e),o(e)}))}),"#000000"):"remove"===e?(o(""),n.execCommand("mceRemoveTextcolor",t)):(o(e),n.execCommand("mceApplyTextcolor",t,e))},Db=function(n,t){return n.concat(P(Cb.state(),(function(n){return{type:Sb,text:n,value:n}})).concat(function(n){var t="choiceitem",e={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"}
return n?[e,{type:t,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]}(t)))},Ab=function(n,t){return function(e){e(Db(n,t))}},Mb=function(n,t,e){var o,r
o="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,n.setIconFill(o,r),n.setIconStroke(o,r)},Fb=function(n,t,e,o,r){n.ui.registry.addSplitButton(t,{tooltip:o,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){return v.from(function(n,t){var e
return n.dom.getParents(n.selection.getStart(),(function(n){var o;(o=n.style["forecolor"===t?"color":"background-color"])&&(e=e||o)})),e}(n,e)).bind((function(n){return function(n){if("transparent"===n)return v.some(db(0,0,0,0))
var t=fb.exec(n)
if(null!==t)return v.some(hb(t[1],t[2],t[3],"1"))
var e=lb.exec(n)
return null!==e?v.some(hb(e[1],e[2],e[3],e[4])):v.none()}(n).map((function(n){var e=ub(n).value
return ge(t.toLowerCase(),e)}))})).getOr(!1)},columns:Eb(n),fetch:Ab(_b(n),Ob(n)),onAction:function(t){null!==r.get()&&Bb(n,e,r.get(),(function(){}))},onItemAction:function(o,i){Bb(n,e,i,(function(e){r.set(e),function(n,t){n.fire("TextColorChange",t)}(n,{name:t,color:e})}))},onSetup:function(e){null!==r.get()&&Mb(e,t,r.get())
var o=function(n){n.name===t&&Mb(e,n.name,n.color)}
return n.on("TextColorChange",o),function(){n.off("TextColorChange",o)}}})},Ib=function(t,e,o,r){t.ui.registry.addNestedMenuItem(e,{text:r,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){Bb(t,o,e.value,n)}}]}})},Rb=function(n){return function(t,e){var o={colorpicker:e},r=function(n){return function(t){var e=t.getData()
n(v.from(e.colorpicker)),t.close()}}(t)
n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onAction:function(n,t){"hex-valid"===t.name&&(t.value?n.enable("ok"):n.disable("ok"))},onSubmit:r,onClose:function(){},onCancel:function(){t(v.none())}})}},Vb=function(n,t,e,o,r,i,u,a){var c=ph(t),s=Pb(t,e,o,"color"!==r?"normal":"color",i,u,a)
return bh(n,c,s,o,r)},Pb=function(n,t,e,o,r,i,u){return jl(P(n,(function(a){return"choiceitem"===a.type?(c=a,xt("choicemenuitem",xh,c)).fold(hh,(function(c){return v.some(function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0)
var c=Jv({presets:e,textContent:t?n.text:v.none(),htmlContent:v.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:v.none(),checkMark:t?v.some(Xv(u.icons)):v.none(),caret:v.none(),value:n.value},u,a)
return Mn(Hv({data:zv(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){wg.set(n,t)},isActive:function(){return wg.isOn(n)},isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},onAction:function(t){return o(n.value)},onSetup:function(n){return n.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:th,toggleOnExecute:!1,selected:n.active}})}(c,1===e,o,t,i(a.value),r,u,ph(n)))})):v.none()
var c})))},Hb=function(n,t){var e=ch(t)
return 1===n?{mode:"menu",moveOnTab:!0}:"auto"===n?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group")}}
var zb,Nb=Yr("cell-over"),Lb=Yr("cell-execute"),jb=function(n,t,e){var o,r=function(e){return Go(e,Lb,{row:n,col:t})},i=function(n,t){t.stop(),r(n)}
return du({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:tc([rg("insert-table-picker-cell",[Zo(uo(),sg.focus),Zo(ko(),r),Zo(go(),i),Zo(Oo(),i)]),wg.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),sg.config({onFocus:function(e){return Go(e,Nb,{row:n,col:t})}})])})},Ub=function(n){return X(n,(function(n){return P(n,mu)}))},Wb=function(n,t){return su(t+1+"x"+(n+1))},Gb={inserttable:function(n){var t=Yr("size-label"),e=function(n,t,e){for(var o=[],r=0;r<t;r++){for(var i=[],u=0;u<e;u++)i.push(jb(r,u,n))
o.push(i)}return o}(t,10,10),o=ip({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[su("0x0")],behaviours:tc([og.config({})])})
return{type:"widget",data:{value:Yr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Zv.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Ub(e).concat(o.asSpec()),behaviours:tc([rg("insert-table-picker",[or(Nb,(function(n,t,r){var i=r.event.row,u=r.event.col;(function(n,t,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)wg.set(n[i][u],i<=t&&u<=e)})(e,i,u,10,10),og.set(o.get(n),[Wb(i,u)])})),or(Lb,(function(t,e,o){n.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Wo(t,To())}))]),Qm.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=Db(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),r="color",i=Vb(Yr("menu-value"),e,(function(t){n.onAction({value:t})}),o,r,Jp.CLOSE_ON_EXECUTE,(function(){return!1}),t.shared.providers),u=f(f({},i),{markers:ch(r),movement:Hb(o,r)})
return{type:"widget",data:{value:Yr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Zv.widget(Hg.sketch(u))]}}},Xb=function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0)
var c=Jv({presets:o,textContent:v.none(),htmlContent:e?n.text.map((function(n){return Qv(n,t)})):v.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:v.none(),checkMark:v.none(),caret:v.none(),value:n.value},u.providers,a,n.icon)
return Hv({data:zv(n),disabled:n.disabled,getApi:function(){return{}},onAction:function(t){return r(n.value,n.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:$v(n.meta,u)},c,i,u.providers)},Yb=function(n){var t=n.text.fold((function(){return{}}),(function(n){return{innerHtml:n}}))
return{type:"separator",dom:f({tag:"div",classes:[Qp,"tox-collection__group-heading"]},t),components:[]}},qb=function(n,t,e,o){void 0===o&&(o=!0)
var r=Jv({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:v.none(),ariaLabel:n.text,caret:v.none(),checkMark:v.none(),shortcutContent:n.shortcut},e,o)
return Hv({data:zv(n),getApi:function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},disabled:n.disabled,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,e)},Kb=function(t,e,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1)
var u,a=i?(u=o.icons,{dom:{tag:"div",classes:[oh],innerHtml:ap("chevron-down",u)}}):function(n){return{dom:{tag:"div",classes:[oh],innerHtml:ap("chevron-right",n)}}}(o.icons),c=Jv({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:v.none(),ariaLabel:t.text,caret:v.some(a),checkMark:v.none(),shortcutContent:t.shortcut},o,r)
return Hv({data:zv(t),getApi:function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},disabled:t.disabled,onAction:n,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,e,o)},Jb=function(n,t,e,o){void 0===o&&(o=!0)
var r=Jv({iconContent:n.icon,textContent:n.text,htmlContent:v.none(),ariaLabel:n.text,checkMark:v.some(Xv(e.icons)),caret:v.none(),shortcutContent:n.shortcut,presets:"normal",meta:n.meta},e,o)
return Mn(Hv({data:zv(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){wg.set(n,t)},isActive:function(){return wg.isOn(n)},isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,e),{toggling:{toggleClass:th,toggleOnExecute:!1,selected:n.active}})},$b=function(n,t){return function(n,t){return Object.prototype.hasOwnProperty.call(n,t)?v.some(n[t]):v.none()}(Gb,n.fancytype).map((function(e){return e(n,t)}))};(function(n){n[n.ContentFocus=0]="ContentFocus",n[n.UiFocus=1]="UiFocus"})(zb||(zb={}))
var Qb=function(n,t,e,o,r){var i,u=e.shared.providers,a=function(n){return r?f(f({},n),{shortcut:v.none(),icon:n.text.isSome()?v.none():n.icon}):n}
switch(n.type){case"menuitem":return(i=n,xt("menuitem",Sh,i)).fold(hh,(function(n){return v.some(qb(a(n),t,u,o))}))
case"nestedmenuitem":return function(n){return xt("nestedmenuitem",kh,n)}(n).fold(hh,(function(n){return v.some(Kb(a(n),t,u,o,r))}))
case"togglemenuitem":return function(n){return xt("togglemenuitem",Ch,n)}(n).fold(hh,(function(n){return v.some(Jb(a(n),t,u,o))}))
case"separator":return function(n){return xt("separatormenuitem",Ap,n)}(n).fold(hh,(function(n){return v.some(Yb(n))}))
case"fancymenuitem":return function(n){return xt("fancymenuitem",wh,n)}(n).fold(hh,(function(n){return $b(a(n),e)}))
default:return console.error("Unknown item in general menu",n),v.none()}},Zb=function(n,t,e,o,r,i){var u=1===o,a=!u||ph(n)
return jl(P(n,(function(n){return"separator"===n.type?(o=n,xt("Autocompleter.Separator",Ap,o)).fold(hh,(function(n){return v.some(Yb(n))})):function(n){return xt("Autocompleter.Item",Mp,n)}(n).fold(hh,(function(n){return v.some(Xb(n,t,u,"normal",e,r,i,a))}))
var o})))},ny=function(n,t,e,o,r){var i=ph(t),u=jl(P(t,(function(n){var t=function(n){return Qb(n,e,o,function(n){return r?!n.hasOwnProperty("text"):i}(n),r)}
return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?t(f(f({},n),{disabled:!0})):t(n)})))
return(r?vh:bh)(n,i,u,1,"normal")},ty=function(n){return Wg.singleData(n.value,n)},ey=function(n,t){var e=ie(v.none()),o=ie(!1),r=du(Gg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:tc([rg("dismissAutocompleter",[Zo(Vo(),(function(){return a()}))])]),lazySink:t.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&Gg.hide(r)},a=function(){if(i()){var t=e.get().map((function(n){return n.element}))
vp(t.getOr(ae.fromDom(n.selection.getNode()))).each(Mr),u(),e.set(v.none()),o.set(!1)}},c=In((function(){return qp(n)})),s=function(t,e,o,i){t.matchLength=e.text.length
var u=nn(o,(function(n){return v.from(n.columns)})).getOr(1)
Gg.showAt(r,{anchor:"node",root:ae.fromDom(n.getBody()),node:v.from(t.element)},Hg.sketch(function(n,t,e,o){var r=e===zb.ContentFocus?Od():Cd(),i=Hb(t,o),u=ch(o)
return{dom:n.dom,components:n.components,items:n.items,value:n.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===zb.ContentFocus,focusManager:r,menuBehaviours:Th("auto"!==t?[]:[ar((function(n,t){Oh(n,4,u.item).each((function(t){var e=t.numColumns,o=t.numRows
Qm.setGridSize(n,o,e)}))}))])}}(bh("autocompleter-value",!0,i,u,"normal"),u,zb.ContentFocus,"normal"))),Gg.getContent(r).each(od.highlightFirst)},f=function(r){(function(t){return e.get().map((function(e){return Sp(n.dom,n.selection.getRng(),e.triggerChar).bind((function(e){return Dp(n,c,e,t)}))})).getOrThunk((function(){return Bp(n,c)}))})(r).fold(a,(function(r){(function(t){if(!i()){var r=hp(n,t.range)
e.set(v.some({triggerChar:t.triggerChar,element:r,matchLength:t.text.length})),o.set(!1)}})(r.context),r.lookupData.then((function(i){e.get().map((function(e){var c,l,d,m=r.context
if(e.triggerChar===m.triggerChar){var g=(c=m.triggerChar,d=nn(l=i,(function(n){return v.from(n.columns)})).getOr(1),X(l,(function(e){var r=e.items
return Zb(r,e.matchText,(function(t,r){var i=n.selection.getRng()
Sp(n.dom,i,c).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(n){var i=n.range,c={hide:function(){a()},reload:function(n){u(),f(n)}}
o.set(!0),e.onAction(c,i,t,r),o.set(!1)}))}),d,Jp.BUBBLE_TO_SANDBOX,t)})))
g.length>0?s(e,m,i,g):m.text.length-e.matchLength>=10?a():u()}}))}))}))},l={onKeypress:mp((function(n){27!==n.which&&f()}),50),cancelIfNecessary:a,isMenuOpen:function(){return Gg.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return Gg.getContent(r)}}
kp(l,n)},oy=c,ry=function(n,t,e){return function(n,t,e,o){return Tu(n,t,e,o,!1)}(n,t,oy,e)},iy=function(n,t,e){return function(n,t,e,o){return Tu(n,t,e,o,!0)}(n,t,oy,e)},uy=_u,ay=function(n,t,e){return Yu(n,t,e).isSome()}
function cy(n,t){var e=null
return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
e=setTimeout((function(){n.apply(null,o),e=null}),t)}}}var sy=function(n){var t=n.raw
return void 0===t.touches||1!==t.touches.length?v.none():v.some(t.touches[0])},fy=function(n){var t=ie(v.none()),e=ie(!1),o=cy((function(t){n.triggerEvent(_o(),t),e.set(!0)}),400),r=Gn([{key:Qe(),value:function(n){return sy(n).each((function(r){o.cancel()
var i={x:r.clientX,y:r.clientY,target:n.target}
o.schedule(n),e.set(!1),t.set(v.some(i))})),v.none()}},{key:Ze(),value:function(n){return o.cancel(),sy(n).each((function(n){t.get().each((function(e){(function(n,t){var e=Math.abs(n.clientX-t.x),o=Math.abs(n.clientY-t.y)
return e>5||o>5})(n,e)&&t.set(v.none())}))})),v.none()}},{key:no(),value:function(r){o.cancel()
return t.get().filter((function(n){return je(n.target,r.target)})).map((function(t){return e.get()?(r.prevent(),!1):n.triggerEvent(Oo(),r)}))}}])
return{fireIfReady:function(n,t){return _n(r,t).bind((function(t){return t(n)}))}}},ly=function(){return ze().browser.isFirefox()},dy=rt([Nt("triggerEvent"),Jt("stopBackspace",!0)]),my=function(n,t){var e=St("Getting GUI events settings",dy,t),o=fy(e),r=P(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return ry(n,t,(function(n){o.fireIfReady(n,t).each((function(t){t&&n.kill()})),e.triggerEvent(t,n)&&n.kill()}))})),i=ie(v.none()),u=ry(n,"paste",(function(n){o.fireIfReady(n,"paste").each((function(t){t&&n.kill()})),e.triggerEvent("paste",n)&&n.kill(),i.set(v.some(setTimeout((function(){e.triggerEvent(wo(),n)}),0)))})),a=ry(n,"keydown",(function(n){e.triggerEvent("keydown",n)?n.kill():!0===e.stopBackspace&&function(n){return n.raw.which===rd[0]&&!F(["input","textarea"],lr(n.target))&&!ay(n.target,'[contenteditable="true"]')}(n)&&n.prevent()})),c=function(n,t){return ly()?iy(n,"focus",t):ry(n,"focusin",t)}(n,(function(n){e.triggerEvent("focusin",n)&&n.kill()})),s=ie(v.none()),f=function(n,t){return ly()?iy(n,"blur",t):ry(n,"focusout",t)}(n,(function(n){e.triggerEvent("focusout",n)&&n.kill(),s.set(v.some(setTimeout((function(){e.triggerEvent(xo(),n)}),0)))}))
return{unbind:function(){H(r,(function(n){n.unbind()})),a.unbind(),c.unbind(),f.unbind(),u.unbind(),i.get().each(clearTimeout),s.get().each(clearTimeout)}}},gy=function(n,t){var e=_n(n,"target").getOr(t)
return ie(e)},py=Bn([{stopped:[]},{resume:["element"]},{complete:[]}]),hy=function(n,t,e,o,r,i){var u=n(t,o),a=function(n,t){var e=ie(!1),o=ie(!1)
return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:n,setSource:t.set,getSource:t.get}}(e,r)
return u.fold((function(){return i.logEventNoHandlers(t,o),py.complete()}),(function(n){var e=n.descHandler
return mi(e)(a),a.isStopped()?(i.logEventStopped(t,n.element,e.purpose),py.stopped()):a.isCut()?(i.logEventCut(t,n.element,e.purpose),py.complete()):wr(n.element).fold((function(){return i.logNoParent(t,n.element,e.purpose),py.complete()}),(function(o){return i.logEventResponse(t,n.element,e.purpose),py.resume(o)}))}))},vy=function(n,t,e,o,r,i){return hy(n,t,e,o,r,i).fold((function(){return!0}),(function(o){return vy(n,t,e,o,r,i)}),(function(){return!1}))},by=function(t,e,o){var r=function(t){var e=ie(!1)
return{stop:function(){e.set(!0)},cut:n,isStopped:e.get,isCut:a,event:t,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")}}(e)
return H(t,(function(n){var t=n.descHandler
mi(t)(r)})),r.isStopped()},yy=function(n,t,e,o,r){var i=gy(e,o)
return vy(n,t,e,o,i,r)}
function xy(){var n={}
return{registerId:function(t,e,o){yn(o,(function(o,i){var u=void 0!==n[i]?n[i]:{}
u[e]=function(n,t){return e=r.apply(void 0,[n.handler].concat(t)),o=n.purpose,{cHandler:e,purpose:o}
var e,o}(o,t),n[i]=u}))},unregisterId:function(t){yn(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))},filterByType:function(t){return _n(n,t).map((function(n){return kn(n,(function(n,t){return function(n,t){return{id:n,descHandler:t}}(t,n)}))})).getOr([])},find:function(t,e,o){var r=_n(n,e)
return Ye(o,(function(n){return function(n,t){return Zr(t).fold((function(){return v.none()}),(function(e){return n.bind((function(n){return _n(n,e)})).map((function(n){return function(n,t){return{element:n,descHandler:t}}(t,n)}))}))}(r,n)}),t)}}}function wy(){var n=xy(),t={},e=function(n){var t=n.element
return Zr(t).fold((function(){return function(n,t){var e=Yr(Jr+n)
return Qr(t,e),e}("uid-",n.element)}),(function(n){return n}))},o=function(e){Zr(e.element).each((function(e){delete t[e],n.unregisterId(e)}))}
return{find:function(t,e,o){return n.find(t,e,o)},filter:function(t){return n.filterByType(t)},register:function(r){var i=e(r)
En(t,i)&&function(n,e){var r=t[e]
if(r!==n)throw new Error('The tagId "'+e+'" is already used by: '+Ur(r.element)+"\nCannot use it for: "+Ur(n.element)+"\nThe conflicting element is"+(zi(r.element)?" ":" not ")+"already in the DOM")
o(n)}(r,i)
var u=[r]
n.registerId(u,i,r.events),t[i]=r},unregister:o,getById:function(n){return _n(t,n)}}}var Sy=Nl({name:"Container",factory:function(n){var t=n.dom,e=t.attributes,o=l(t,["attributes"])
return{uid:n.uid,dom:f({tag:"div",attributes:f({role:"presentation"},e)},o),components:n.components,behaviours:Pf(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[Jt("components",[]),Vf("containerBehaviours",[]),Jt("events",{}),Jt("domModification",{}),Jt("eventOrder",{})]}),ky=function(t){var o=function(n){return wr(t.element).fold((function(){return!0}),(function(t){return je(n,t)}))},r=wy(),i=function(n,t){return r.find(o,n,t)},u=my(t.element,{triggerEvent:function(n,t){return ea(n,t.target,(function(e){return function(n,t,e,o){return yy(n,t,e,e.target,o)}(i,n,t,e)}))}}),a={debugInfo:e("real"),triggerEvent:function(n,t,e){ea(n,t,(function(o){return yy(i,n,e,t,o)}))},triggerFocus:function(t,e){Zr(t).fold((function(){sc(t)}),(function(o){ea(yo(),t,(function(o){return function(n,t,e,o,r){var i=gy(e,o)
hy(n,t,e,o,i,r)}(i,yo(),{originator:e,kill:n,prevent:n,target:t},t,o),!1}))}))},triggerEscape:function(n,t){a.triggerEvent("keydown",n.element,t.event)},getByUid:function(n){return v(n)},getByDom:function(n){return b(n)},build:du,addToGui:function(n){l(n)},removeFromGui:function(n){d(n)},addToWorld:function(n){s(n)},removeFromWorld:function(n){f(n)},broadcast:function(n){g(n)},broadcastOn:function(n,t){p(n,t)},broadcastEvent:function(n,t){h(n,t)},isConnected:c},s=function(n){n.connect(a),gr(n.element)||(r.register(n),H(n.components(),s),a.triggerEvent(Bo(),n.element,{target:n.element}))},f=function(n){gr(n.element)||(H(n.components(),f),r.unregister(n)),n.disconnect()},l=function(n){$s(t,n)},d=function(n){nf(n)},m=function(n){var t=r.filter(So())
H(t,(function(t){var e=t.descHandler
mi(e)(n)}))},g=function(n){m({universal:!0,data:n})},p=function(n,t){m({universal:!1,channels:n,data:t})},h=function(n,t){var e=r.filter(n)
return by(e,t)},v=function(n){return r.getById(n).fold((function(){return on.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),on.value)},b=function(n){var t=Zr(n).getOr("not found")
return v(t)}
return s(t),{root:t,element:t.element,destroy:function(){u.unbind(),Ar(t.element)},add:l,remove:d,getByUid:v,getByDom:b,addToWorld:s,removeFromWorld:f,broadcast:g,broadcastOn:p,broadcastEvent:h}},Cy=e([Jt("prefix","form-field"),Vf("fieldBehaviours",[Xl,Rf])]),Oy=e([ml({schema:[Rt("dom")],name:"label"}),ml({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[Rt("text")],name:"aria-descriptor"}),ll({factory:{sketch:function(n){var t=Un(n,["factory"])
return n.factory.sketch(t)}},schema:[Rt("factory")],name:"field"})]),_y=Ll({name:"FormField",configFields:Cy(),partFields:Oy(),factory:function(n,t,e,o){var r=Hf(n.fieldBehaviours,[Xl.config({find:function(t){return Ol(t,n,"field")}}),Rf.config({store:{mode:"manual",getValue:function(n){return Xl.getCurrent(n).bind(Rf.getValue)},setValue:function(n,t){Xl.getCurrent(n).each((function(n){Rf.setValue(n,t)}))}}})]),i=Jo([ar((function(t,e){var o=Tl(t,n,["label","field","aria-descriptor"])
o.field().each((function(t){var e=Yr(n.prefix)
o.label().each((function(n){Vr(n.element,"for",e),Vr(t.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Yr(n.prefix)
Vr(e.element,"id",o),Vr(t.element,"aria-describedby",o)}))}))}))]),u={getField:function(t){return Ol(t,n,"field")},getLabel:function(t){return Ol(t,n,"label")}}
return{uid:n.uid,dom:n.dom,components:t,behaviours:r,events:i,apis:u}},apis:{getField:function(n,t){return n.getField(t)},getLabel:function(n,t){return n.getLabel(t)}}}),Ty=Object.freeze({__proto__:null,exhibit:function(n,t){return di({attributes:Gn([{key:t.tabAttr,value:"true"}])})}}),Ey=[Jt("tabAttr","data-alloy-tabstop")],By=oc({fields:Ey,name:"tabstopping",active:Ty}),Dy=function(n,t,e,o){var r=Ay(n,t,e,o)
return _y.sketch(r)},Ay=function(n,t,e,o){return{dom:My(e),components:n.toArray().concat([t]),fieldBehaviours:tc(o)}},My=function(n){return{tag:"div",classes:["tox-form__group"].concat(n)}},Fy=function(n,t){return _y.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}})},Iy=Yr("form-component-change"),Ry=Yr("form-close"),Vy=Yr("form-cancel"),Py=Yr("form-action"),Hy=Yr("form-submit"),zy=Yr("form-block"),Ny=Yr("form-unblock"),Ly=Yr("form-tabchange"),jy=Yr("form-resize"),Uy=function(n,t){var e,r,i,u=n.label.map((function(n){return Fy(n,t)})),a=function(n){return function(t,e){Yu(e.event.target,"[data-collection-item-value]").each((function(o){n(t,e,o,Pr(o,"data-collection-item-value"))}))}},c=a((function(e,o,r,i){o.stop(),t.isReadOnly()||Go(e,Py,{name:n.name,value:i})})),s=[Zo(uo(),a((function(n,t,e){sc(e)}))),Zo(go(),c),Zo(Oo(),c),Zo(ao(),a((function(n,t,e){Xu(n.element,"."+rh).each((function(n){Ti(n,rh)})),Oi(e,rh)}))),Zo(co(),a((function(n){Xu(n.element,"."+rh).each((function(n){Ti(n,rh)}))}))),fr(a((function(t,e,o,r){Go(t,Py,{name:n.name,value:r})})))],f=function(n,t){return P(as(n.element,".tox-collection__item"),t)},l=_y.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==n.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:o},behaviours:tc([$h.config({disabled:t.isReadOnly,onDisabled:function(n){f(n,(function(n){Oi(n,"tox-collection__item--state-disabled"),Vr(n,"aria-disabled",!0)}))},onEnabled:function(n){f(n,(function(n){Ti(n,"tox-collection__item--state-disabled"),Nr(n,"aria-disabled")}))}}),Tv(),og.config({}),Rf.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){(function(e,o){var r=P(o,(function(e){var o,r=Ph.translate(e.text),i=1===n.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",u='<div class="tox-collection__item-icon">'+e.icon+"</div>",a={_:" "," - ":" ","-":" "},c=r.replace(/\_| \- |\-/g,(function(n){return a[n]}))
return'<div class="tox-collection__item'+(t.isReadOnly()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+('"'===(o=e.value)?"&quot;":o)+'" title="'+c+'" aria-label="'+c+'">'+u+i+"</div>"})),i="auto"!==n.columns&&n.columns>1?V(r,n.columns):[r],u=P(i,(function(n){return'<div class="tox-collection__group">'+n.join("")+"</div>"}))
Ir(e.element,u.join(""))})(e,o),"auto"===n.columns&&Oh(e,5,"tox-collection__item").each((function(n){var t=n.numRows,o=n.numColumns
Qm.setGridSize(e,t,o)})),Wo(e,jy)}}),By.config({}),Qm.config((r=n.columns,i="normal",1===r?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===r?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===i?".tox-swatches__row":".tox-collection__group",cell:"color"===i?".tox-swatch":"."+Qp}})),rg("collection-events",s)]),eventOrder:(e={},e[ko()]=["disabling","alloy.base.behaviour","collection-events"],e)})
return Dy(u,l,["tox-form__group--collection"],[])},Wy=e([Wt("data"),Jt("inputAttributes",{}),Jt("inputStyles",{}),Jt("tag","input"),Jt("inputClasses",[]),la("onSetValue"),Jt("styles",{}),Jt("eventOrder",{}),Vf("inputBehaviours",[Rf,sg]),Jt("selectOnFocus",!0)]),Gy=function(t){return tc([sg.config({onFocus:t.selectOnFocus?function(n){var t=n.element,e=nu(t)
t.dom.setSelectionRange(0,e.length)}:n})])},Xy=function(n){return f(f({},Gy(n)),Hf(n.inputBehaviours,[Rf.config({store:f(f({mode:"manual"},n.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return nu(n.element)},setValue:function(n,t){nu(n.element)!==t&&tu(n.element,t)}}),onSetValue:n.onSetValue})]))},Yy=function(n){return{tag:n.tag,attributes:f({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},qy=Nl({name:"Input",configFields:Wy(),factory:function(n,t){return{uid:n.uid,dom:Yy(n),components:[],behaviours:Xy(n),eventOrder:n.eventOrder}}}),Ky={},Jy={exports:Ky};(function(n,t,e,o){(function(o){if("object"==typeof t&&void 0!==e)e.exports=o()
else if("function"==typeof n&&n.amd)n([],o)
else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=o()}})((function(){return function n(t,e,r){function i(a,c){if(!e[a]){if(!t[a]){var s="function"==typeof o&&o
if(!c&&s)return s(a,!0)
if(u)return u(a,!0)
var f=new Error("Cannot find module '"+a+"'")
throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}}
t[a][0].call(l.exports,(function(n){return i(t[a][1][n]||n)}),l,l.exports,n,t,e,r)}return e[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a])
return i}({1:[function(n,t,e){var o,r,i=t.exports={}
function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(n){if(o===setTimeout)return setTimeout(n,0)
if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0)
try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}(function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(n){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(n){r=a}})()
var s,f=[],l=!1,d=-1
function m(){l&&s&&(l=!1,s.length?f=s.concat(f):d=-1,f.length&&g())}function g(){if(!l){var n=c(m)
l=!0
for(var t=f.length;t;){for(s=f,f=[];++d<t;)s&&s[d].run()
d=-1,t=f.length}s=null,l=!1,function(n){if(r===clearTimeout)return clearTimeout(n)
if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n)
try{r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(n)}}function p(n,t){this.fun=n,this.array=t}function h(){}i.nextTick=function(n){var t=new Array(arguments.length-1)
if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e]
f.push(new p(n,t)),1!==f.length||l||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){(function(e){var o=setTimeout
function r(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new")
if("function"!=typeof n)throw new TypeError("not a function")
this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(n,this)}function u(n,t){for(;3===n._state;)n=n._value
0!==n._state?(n._handled=!0,i._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected
if(null!==e){var o
try{o=e(n._value)}catch(r){return void c(t.promise,r)}a(t.promise,o)}else(1===n._state?a:c)(t.promise,n._value)}))):n._deferreds.push(t)}function a(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.")
if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then
if(t instanceof i)return n._state=3,n._value=t,void s(n)
if("function"==typeof e)return void l((o=e,r=t,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=t,s(n)}catch(u){c(n,u)}var o,r}function c(n,t){n._state=2,n._value=t,s(n)}function s(n){2===n._state&&0===n._deferreds.length&&i._immediateFn((function(){n._handled||i._unhandledRejectionFn(n._value)}))
for(var t=0,e=n._deferreds.length;t<e;t++)u(n,n._deferreds[t])
n._deferreds=null}function f(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function l(n,t){var e=!1
try{n((function(n){e||(e=!0,a(t,n))}),(function(n){e||(e=!0,c(t,n))}))}catch(o){if(e)return
e=!0,c(t,o)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,t){var e=new this.constructor(r)
return u(this,new f(n,t,e)),e},i.all=function(n){var t=Array.prototype.slice.call(n)
return new i((function(n,e){if(0===t.length)return n([])
var o=t.length
function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then
if("function"==typeof a)return void a.call(u,(function(n){r(i,n)}),e)}t[i]=u,0==--o&&n(t)}catch(c){e(c)}}for(var i=0;i<t.length;i++)r(i,t[i])}))},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i((function(t){t(n)}))},i.reject=function(n){return new i((function(t,e){e(n)}))},i.race=function(n){return new i((function(t,e){for(var o=0,r=n.length;o<r;o++)n[o].then(t,e)}))},i._immediateFn="function"==typeof n?function(t){n(t)}:function(n){o(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==t&&t.exports?t.exports=i:e.Promise||(e.Promise=i)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,o){var r=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0
function s(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId)
var t=n._idleTimeout
t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"==typeof t?t:function(n){var t=c++,o=!(arguments.length<2)&&u.call(arguments,1)
return a[t]=!0,r((function(){a[t]&&(o?n.apply(null,o):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"==typeof o?o:function(n){delete a[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var o=n("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")()
t.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,Ky,Jy,void 0)
var $y,Qy=Jy.exports.boltExport,Zy=function(n){var t=v.none(),e=[],o=function(n){r()?u(n):e.push(n)},r=function(){return t.isSome()},i=function(n){H(n,u)},u=function(n){t.each((function(t){setTimeout((function(){n(t)}),0)}))}
return n((function(n){r()||(t=v.some(n),i(e),e=[])})),{get:o,map:function(n){return Zy((function(t){o((function(e){t(n(e))}))}))},isReady:r}},nx={nu:Zy,pure:function(n){return Zy((function(t){t(n)}))}},tx=function(n){setTimeout((function(){throw n}),0)},ex=function(n){var t=function(t){n().then(t,tx)}
return{map:function(t){return ex((function(){return n().then(t)}))},bind:function(t){return ex((function(){return n().then((function(n){return t(n).toPromise()}))}))},anonBind:function(t){return ex((function(){return n().then((function(){return t.toPromise()}))}))},toLazy:function(){return nx.nu(t)},toCached:function(){var t=null
return ex((function(){return null===t&&(t=n()),t}))},toPromise:n,get:t}},ox=function(n){return ex((function(){return new Qy(n)}))},rx=function(n){return ex((function(){return Qy.resolve(n)}))},ix=["input","textarea"],ux=function(n){var t=lr(n)
return F(ix,t)},ax=function(n,t){var e=t.getRoot(n).getOr(n.element)
Ti(e,t.invalidClass),t.notify.each((function(t){ux(n.element)&&Vr(n.element,"aria-invalid",!1),t.getContainer(n).each((function(n){Ir(n,t.validHtml)})),t.onValid(n)}))},cx=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element)
Oi(r,t.invalidClass),t.notify.each((function(t){ux(n.element)&&Vr(n.element,"aria-invalid",!0),t.getContainer(n).each((function(n){Ir(n,o)})),t.onInvalid(n,o)}))},sx=function(n,t,e){return t.validator.fold((function(){return rx(on.value(!0))}),(function(t){return t.validate(n)}))},fx=function(n,t,e){return t.notify.each((function(t){t.onValidate(n)})),sx(n,t).map((function(e){return n.getSystem().isConnected()?e.fold((function(e){return cx(n,t,0,e),on.error(e)}),(function(e){return ax(n,t),on.value(e)})):on.error("No longer in system")}))},lx=Object.freeze({__proto__:null,markValid:ax,markInvalid:cx,query:sx,run:fx,isInvalid:function(n,t){var e=t.getRoot(n).getOr(n.element)
return Ei(e,t.invalidClass)}}),dx=Object.freeze({__proto__:null,events:function(t,e){return t.validator.map((function(e){return Jo([Zo(e.onEvent,(function(n){fx(n,t).get(o)}))].concat(e.validateOnLoad?[ar((function(e){fx(e,t).get(n)}))]:[]))})).getOr({})}}),mx=[Rt("invalidClass"),Jt("getRoot",v.none),Kt("notify",[Jt("aria","alert"),Jt("getContainer",v.none),Jt("validHtml",""),la("onValid"),la("onInvalid"),la("onValidate")]),Kt("validator",[Rt("validate"),Jt("onEvent","input"),Jt("validateOnLoad",!0)])],gx=oc({fields:mx,name:"invalidating",active:dx,apis:lx,extra:{validation:function(n){return function(t){var e=Rf.getValue(t)
return rx(n(e))}}}}),px=Object.freeze({__proto__:null,getCoupled:function(n,t,e,o){return e.getOrCreate(n,t,o)}}),hx=[Vt("others",yt(on.value,_t()))],vx=oc({fields:hx,name:"coupling",apis:px,state:Object.freeze({__proto__:null,init:function(){var n={},t=e({})
return fi({readState:t,getOrCreate:function(t,e,o){var r=vn(e.others)
if(r)return _n(n,o).getOrThunk((function(){var r=_n(e.others,o).getOrDie("No information found for coupled component: "+o)(t),i=t.getSystem().build(r)
return n[o]=i,i}))
throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),bx=e("sink"),yx=e(ml({name:bx(),overrides:e({dom:{tag:"div"},behaviours:tc([Xs.config({useFixed:c})]),events:Jo([rr(so()),rr(eo()),rr(go())])})}));(function(n){n[n.HighlightFirst=0]="HighlightFirst",n[n.HighlightNone=1]="HighlightNone"})($y||($y={}))
var xx=function(n,t){var e=n.getHotspot(t).getOr(t),o="hotspot",r=n.getAnchorOverrides()
return n.layouts.fold((function(){return{anchor:o,hotspot:e,overrides:r}}),(function(n){return{anchor:o,hotspot:e,overrides:r,layouts:n}}))},wx=function(n,t,e,o,r,i,u){return function(n,t,e,o,r,i,u){var a=function(n,t,e){return(0,n.fetch)(e).map(t)}(n,t,o),c=Ox(o,n)
return a.map((function(n){return n.bind((function(n){return v.from(Wg.sketch(f(f({},i.menu()),{uid:ni(""),data:n,highlightImmediately:u===$y.HighlightFirst,onOpenMenu:function(n,t){var o=c().getOrDie()
Xs.position(o,e,t),pf.decloak(r)},onOpenSubmenu:function(n,t,e){var o=c().getOrDie()
Xs.position(o,{anchor:"submenu",item:t},e),pf.decloak(r)},onRepositionMenu:function(n,t,o){var r=c().getOrDie()
Xs.position(r,e,t),H(o,(function(n){Xs.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)}))},onEscape:function(){return sg.focus(o),pf.close(r),v.some(!0)}})))}))}))}(n,t,xx(n,e),e,o,r,u).map((function(n){return n.fold((function(){pf.isOpen(o)&&pf.close(o)}),(function(n){pf.cloak(o),pf.open(o,n),i(o)})),o}))},Sx=function(n,t,e,o,r,i,u){return pf.close(o),rx(o)},kx=function(n,t,e,o,r,i){var u=vx.getCoupled(e,"sandbox")
return(pf.isOpen(u)?Sx:wx)(n,t,e,u,o,r,i)},Cx=function(n,t,e){var o=Xl.getCurrent(t).getOr(t),r=Cu(n.element)
e?Wi(o.element,"min-width",r+"px"):function(n,t){ku.set(n,t)}(o.element,r)},Ox=function(n,t){return n.getSystem().getByUid(t.uid+"-"+bx()).map((function(n){return function(){return on.value(n)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return on.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(n)}}))}))},_x=function(n){pf.getState(n).each((function(n){Wg.repositionMenus(n)}))},Tx=function(n,t,e){var o=qu(),r=Ox(t,n)
return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Nf(n.sandboxBehaviours,[Rf.config({store:{mode:"memory",initialValue:t}}),pf.config({onOpen:function(r,i){var u=xx(n,t)
o.link(t.element),n.matchWidth&&Cx(u.hotspot,i,n.useMinWidth),n.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(n,r){o.unlink(t.element),void 0!==e&&void 0!==e.onClose&&e.onClose(n,r)},isPartOf:function(n,e,o){return Ju(e,o)||Ju(t,o)},getAttachPoint:function(){return r().getOrDie()}}),Xl.config({find:function(n){return pf.getState(n).bind((function(n){return Xl.getCurrent(n)}))}}),ac.config({channels:f(f({},xf({isExtraPart:a})),Sf({doReposition:_x}))})])}},Ex=function(n){var t=vx.getCoupled(n,"sandbox")
_x(t)},Bx=function(){return[Jt("sandboxClasses",[]),zf("sandboxBehaviours",[Xl,ac,pf,Rf])]},Dx=e([Rt("dom"),Rt("fetch"),la("onOpen"),da("onExecute"),Jt("getHotspot",v.some),Jt("getAnchorOverrides",e({})),Lc(),Vf("dropdownBehaviours",[wg,vx,Qm,sg]),Rt("toggleClass"),Jt("eventOrder",{}),Wt("lazySink"),Jt("matchWidth",!1),Jt("useMinWidth",!1),Wt("role")].concat(Bx())),Ax=e([dl({schema:[ca()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),yx()]),Mx=Ll({name:"Dropdown",configFields:Dx(),partFields:Ax(),factory:function(t,e,o,r){var i,u,a=function(n){pf.getState(n).each((function(n){Wg.highlightPrimary(n)}))},c={expand:function(e){wg.isOn(e)||kx(t,(function(n){return n}),e,r,n,$y.HighlightNone).get(n)},open:function(e){wg.isOn(e)||kx(t,(function(n){return n}),e,r,n,$y.HighlightFirst).get(n)},isOpen:wg.isOn,close:function(e){wg.isOn(e)&&kx(t,(function(n){return n}),e,r,n,$y.HighlightFirst).get(n)},repositionMenus:function(n){wg.isOn(n)&&Ex(n)}},s=function(n,t){return Xo(n),v.some(!0)}
return{uid:t.uid,dom:t.dom,components:e,behaviours:Hf(t.dropdownBehaviours,[wg.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),vx.config({others:{sandbox:function(n){return Tx(t,n,{onOpen:function(){wg.on(n)},onClose:function(){wg.off(n)}})}}}),Qm.config({mode:"special",onSpace:s,onEnter:s,onDown:function(n,t){if(Mx.isOpen(n)){var e=vx.getCoupled(n,"sandbox")
a(e)}else Mx.open(n)
return v.some(!0)},onEscape:function(n,t){return Mx.isOpen(n)?(Mx.close(n),v.some(!0)):v.none()}}),sg.config({})]),events:kg(v.some((function(e){kx(t,(function(n){return n}),e,r,a,$y.HighlightFirst).get(n)}))),eventOrder:f(f({},t.eventOrder),(i={},i[ko()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:c,domModification:{attributes:f(f({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(n){return{role:n}}))),"button"===t.dom.tag?{type:(u="type",_n(t.dom,"attributes").bind((function(n){return _n(n,u)}))).getOr("button")}:{})}}},apis:{open:function(n,t){return n.open(t)},expand:function(n,t){return n.expand(t)},close:function(n,t){return n.close(t)},isOpen:function(n,t){return n.isOpen(t)},repositionMenus:function(n,t){return n.repositionMenus(t)}}}),Fx=Object.freeze({__proto__:null,events:function(){return Jo([$o(ho(),c)])},exhibit:function(){return di({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),Ix=oc({fields:[],name:"unselecting",active:Fx}),Rx=Yr("color-input-change"),Vx=Yr("color-swatch-change"),Px=Yr("color-picker-cancel"),Hx=function(n,t,e){var o=_y.parts.field({factory:qy,inputClasses:["tox-textfield"],onSetValue:function(n){return gx.run(n).get((function(){}))},inputBehaviours:tc([$h.config({disabled:t.providers.isReadOnly}),Tv(),By.config({}),gx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(n){return wr(n.element)},notify:{onValid:function(n){var t=Rf.getValue(n)
Go(n,Rx,{color:t})}},validator:{validateOnLoad:!1,validate:function(n){var t=Rf.getValue(n)
if(0===t.length)return rx(on.value(!0))
var e=ae.fromTag("span")
Wi(e,"background-color",t)
var o=Ki(e,"background-color").fold((function(){return on.error("blah")}),(function(n){return on.value(t)}))
return rx(o)}}})]),selectOnFocus:!1}),r=n.label.map((function(n){return Fy(n,t.providers)})),i=function(n,t){Go(n,Vx,{value:t})},u=ip(function(n,t){return Mx.sketch({dom:n.dom,components:n.components,toggleClass:"mce-active",dropdownBehaviours:tc([Bv(t.providers.isReadOnly),Tv(),Ix.config({}),By.config({})]),layouts:n.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(e){return ox((function(t){return n.fetch(t)})).map((function(o){return v.from(ty(Mn(Vb(Yr("menu-value"),o,(function(t){n.onItemAction(e,t)}),n.columns,n.presets,Jp.CLOSE_ON_EXECUTE,(function(){return!1}),t.providers),{movement:Hb(n.columns,n.presets)})))}))},parts:{menu:lh(0,0,n.presets)}})}({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Va,Ra,Na]},onLtr:function(){return[Ra,Va,Na]}},components:[],fetch:Ab(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(n,t){u.getOpt(n).each((function(n){"custom"===t?e.colorPicker((function(t){t.fold((function(){return Wo(n,Px)}),(function(t){i(n,t),Tb(t)}))}),"#ffffff"):i(n,"remove"===t?"":t)}))}},t))
return _y.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,u.asSpec()]}]),fieldBehaviours:tc([rg("form-field-events",[Zo(Rx,(function(t,e){u.getOpt(t).each((function(n){Wi(n.element,"background-color",e.event.color)})),Go(t,Iy,{name:n.name})})),Zo(Vx,(function(n,t){_y.getField(n).each((function(e){Rf.setValue(e,t.event.value),Xl.getCurrent(n).each(sg.focus)}))})),Zo(Px,(function(n,t){_y.getField(n).each((function(t){Xl.getCurrent(n).each(sg.focus)}))}))])])})},zx=function(n,t,e){return{hue:n,saturation:t,value:e}},Nx=Yr("rgb-hex-update"),Lx=Yr("slider-update"),jx=Yr("palette-update"),Ux=ml({schema:[Rt("dom")],name:"label"}),Wx=function(n){return ml({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold((function(){return{}}),(function(n){return{events:Jo([nr(Qe(),(function(t,e,o){return n(t,o)}),[t]),nr(eo(),(function(t,e,o){return n(t,o)}),[t]),nr(oo(),(function(t,e,o){o.mouseIsDown.get()&&n(t,o)}),[t])])}}))}})},Gx=Wx("top-left"),Xx=Wx("top"),Yx=Wx("top-right"),qx=Wx("right"),Kx=Wx("bottom-right"),Jx=Wx("bottom"),$x=Wx("bottom-left"),Qx=[Ux,Wx("left"),qx,Xx,Jx,Gx,Yx,$x,Kx,ll({name:"thumb",defaults:e({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Jo([er(Qe(),n,"spectrum"),er(Ze(),n,"spectrum"),er(no(),n,"spectrum"),er(eo(),n,"spectrum"),er(oo(),n,"spectrum"),er(io(),n,"spectrum")])}}}),ll({schema:[re("mouseIsDown",(function(){return ie(!1)}))],name:"spectrum",overrides:function(n){var t=n.model.manager,e=function(e,o){return t.getValueFromEvent(o).map((function(o){return t.setValueFrom(e,n,o)}))}
return{behaviours:tc([Qm.config({mode:"special",onLeft:function(e){return t.onLeft(e,n)},onRight:function(e){return t.onRight(e,n)},onUp:function(e){return t.onUp(e,n)},onDown:function(e){return t.onDown(e,n)}}),sg.config({})]),events:Jo([Zo(Qe(),e),Zo(Ze(),e),Zo(eo(),e),Zo(oo(),(function(t,o){n.mouseIsDown.get()&&e(t,o)}))])}}})],Zx=e("slider.change.value"),nw=function(n){var t=n.event.raw
if(function(n){return-1!==n.type.indexOf("touch")}(t)){var e=t
return void 0!==e.touches&&1===e.touches.length?v.some(e.touches[0]).map((function(n){return yu(n.clientX,n.clientY)})):v.none()}var o=t
return void 0!==o.clientX?v.some(o).map((function(n){return yu(n.clientX,n.clientY)})):v.none()},tw=function(n){return n.model.minX},ew=function(n){return n.model.minY},ow=function(n){return n.model.minX-1},rw=function(n){return n.model.minY-1},iw=function(n){return n.model.maxX},uw=function(n){return n.model.maxY},aw=function(n){return n.model.maxX+1},cw=function(n){return n.model.maxY+1},sw=function(n,t,e){return t(n)-e(n)},fw=function(n){return sw(n,iw,tw)},lw=function(n){return sw(n,uw,ew)},dw=function(n){return fw(n)/2},mw=function(n){return lw(n)/2},gw=function(n){return n.stepSize},pw=function(n){return n.snapToGrid},hw=function(n){return n.snapStart},vw=function(n){return n.rounded},bw=function(n,t){return void 0!==n[t+"-edge"]},yw=function(n){return bw(n,"left")},xw=function(n){return bw(n,"right")},ww=function(n){return bw(n,"top")},Sw=function(n){return bw(n,"bottom")},kw=function(n){return n.model.value.get()},Cw=function(n){return{x:n}},Ow=function(n){return{y:n}},_w=function(n,t){return{x:n,y:t}},Tw=function(n,t){Go(n,Zx(),{value:t})},Ew=function(n,t,e,o){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-o)},Bw=function(n,t,e,o){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+o)},Dw=function(n,t,e){return Math.max(t,Math.min(e,n))},Aw=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.step,u=n.snap,a=n.snapStart,c=n.rounded,s=n.hasMinEdge,f=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=s?t-1:t,p=f?e+1:e
if(r<l)return g
if(r>d)return p
var h=function(n,t,e){return Math.min(e,Math.max(n,t))-t}(r,l,d),v=Dw(h/m*o+t,g,p)
return u&&v>=t&&v<=e?function(n,t,e,o,r){return r.fold((function(){var r=n-t,i=Math.round(r/o)*o
return Dw(t+i,t-1,e+1)}),(function(t){var r=(n-t)%o,i=Math.round(r/o),u=Math.floor((n-t)/o),a=Math.floor((e-t)/o),c=t+Math.min(a,u+i)*o
return Math.max(t,c)}))}(v,t,e,i,a):c?Math.round(v):v},Mw=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,a=n.maxBound,c=n.maxOffset,s=n.centerMinEdge,f=n.centerMaxEdge
return r<t?i?0:s:r>e?u?a:f:(r-t)/o*c},Fw="top",Iw="right",Rw="bottom",Vw="left",Pw=function(n){return n.element.dom.getBoundingClientRect()},Hw=function(n,t){return n[t]},zw=function(n){var t=Pw(n)
return Hw(t,Vw)},Nw=function(n){var t=Pw(n)
return Hw(t,Iw)},Lw=function(n){var t=Pw(n)
return Hw(t,Fw)},jw=function(n){var t=Pw(n)
return Hw(t,Rw)},Uw=function(n){var t=Pw(n)
return Hw(t,"width")},Ww=function(n){var t=Pw(n)
return Hw(t,"height")},Gw=function(n,t,e){return(n+t)/2-e},Xw=function(n,t){var e=Pw(n),o=Pw(t),r=Hw(e,Vw),i=Hw(e,Iw),u=Hw(o,Vw)
return Gw(r,i,u)},Yw=function(n,t){var e=Pw(n),o=Pw(t),r=Hw(e,Fw),i=Hw(e,Rw),u=Hw(o,Fw)
return Gw(r,i,u)},qw=function(n,t){Go(n,Zx(),{value:t})},Kw=function(n){return{x:n}},Jw=function(n,t,e){var o={min:tw(t),max:iw(t),range:fw(t),value:e,step:gw(t),snap:pw(t),snapStart:hw(t),rounded:vw(t),hasMinEdge:yw(t),hasMaxEdge:xw(t),minBound:zw(n),maxBound:Nw(n),screenRange:Uw(n)}
return Aw(o)},$w=function(n){return function(t,e){return function(n,t,e){var o=(n>0?Bw:Ew)(kw(e).x,tw(e),iw(e),gw(e))
return qw(t,Kw(o)),v.some(o)}(n,t,e).map((function(){return!0}))}},Qw=function(n,t,e,o,r,i){var u=function(n,t,e,o,r){var i=Uw(n),u=o.bind((function(t){return v.some(Xw(t,n))})).getOr(0),a=r.bind((function(t){return v.some(Xw(t,n))})).getOr(i),c={min:tw(t),max:iw(t),range:fw(t),value:e,hasMinEdge:yw(t),hasMaxEdge:xw(t),minBound:zw(n),minOffset:0,maxBound:Nw(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:a}
return Mw(c)}(t,i,e,o,r)
return zw(t)-zw(n)+u},Zw=$w(-1),nS=$w(1),tS=v.none,eS=v.none,oS={"top-left":v.none(),top:v.none(),"top-right":v.none(),right:v.some((function(n,t){Tw(n,Cw(aw(t)))})),"bottom-right":v.none(),bottom:v.none(),"bottom-left":v.none(),left:v.some((function(n,t){Tw(n,Cw(ow(t)))}))},rS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=Jw(n,t,e),r=Kw(o)
return qw(n,r),o},setToMin:function(n,t){var e=tw(t)
qw(n,Kw(e))},setToMax:function(n,t){var e=iw(t)
qw(n,Kw(e))},findValueOfOffset:Jw,getValueFromEvent:function(n){return nw(n).map((function(n){return n.left}))},findPositionOfValue:Qw,setPositionFromValue:function(n,t,e,o){var r=kw(e),i=Qw(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),u=Cu(t.element)/2
Wi(t.element,"left",i-u+"px")},onLeft:Zw,onRight:nS,onUp:tS,onDown:eS,edgeActions:oS}),iS=function(n,t){Go(n,Zx(),{value:t})},uS=function(n){return{y:n}},aS=function(n,t,e){var o={min:ew(t),max:uw(t),range:lw(t),value:e,step:gw(t),snap:pw(t),snapStart:hw(t),rounded:vw(t),hasMinEdge:ww(t),hasMaxEdge:Sw(t),minBound:Lw(n),maxBound:jw(n),screenRange:Ww(n)}
return Aw(o)},cS=function(n){return function(t,e){return function(n,t,e){var o=(n>0?Bw:Ew)(kw(e).y,ew(e),uw(e),gw(e))
return iS(t,uS(o)),v.some(o)}(n,t,e).map((function(){return!0}))}},sS=function(n,t,e,o,r,i){var u=function(n,t,e,o,r){var i=Ww(n),u=o.bind((function(t){return v.some(Yw(t,n))})).getOr(0),a=r.bind((function(t){return v.some(Yw(t,n))})).getOr(i),c={min:ew(t),max:uw(t),range:lw(t),value:e,hasMinEdge:ww(t),hasMaxEdge:Sw(t),minBound:Lw(n),minOffset:0,maxBound:jw(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:a}
return Mw(c)}(t,i,e,o,r)
return Lw(t)-Lw(n)+u},fS=v.none,lS=v.none,dS=cS(-1),mS=cS(1),gS={"top-left":v.none(),top:v.some((function(n,t){Tw(n,Ow(rw(t)))})),"top-right":v.none(),right:v.none(),"bottom-right":v.none(),bottom:v.some((function(n,t){Tw(n,Ow(cw(t)))})),"bottom-left":v.none(),left:v.none()},pS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=aS(n,t,e),r=uS(o)
return iS(n,r),o},setToMin:function(n,t){var e=ew(t)
iS(n,uS(e))},setToMax:function(n,t){var e=uw(t)
iS(n,uS(e))},findValueOfOffset:aS,getValueFromEvent:function(n){return nw(n).map((function(n){return n.top}))},findPositionOfValue:sS,setPositionFromValue:function(n,t,e,o){var r=kw(e),i=sS(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),u=hu(t.element)/2
Wi(t.element,"top",i-u+"px")},onLeft:fS,onRight:lS,onUp:dS,onDown:mS,edgeActions:gS}),hS=function(n,t){Go(n,Zx(),{value:t})},vS=function(n,t){return{x:n,y:t}},bS=function(n,t){return function(e,o){return function(n,t,e,o){var r=n>0?Bw:Ew,i=t?kw(o).x:r(kw(o).x,tw(o),iw(o),gw(o)),u=t?r(kw(o).y,ew(o),uw(o),gw(o)):kw(o).y
return hS(e,vS(i,u)),v.some(i)}(n,t,e,o).map((function(){return!0}))}},yS=bS(-1,!1),xS=bS(1,!1),wS=bS(-1,!0),SS=bS(1,!0),kS={"top-left":v.some((function(n,t){Tw(n,_w(ow(t),rw(t)))})),top:v.some((function(n,t){Tw(n,_w(dw(t),rw(t)))})),"top-right":v.some((function(n,t){Tw(n,_w(aw(t),rw(t)))})),right:v.some((function(n,t){Tw(n,_w(aw(t),mw(t)))})),"bottom-right":v.some((function(n,t){Tw(n,_w(aw(t),cw(t)))})),bottom:v.some((function(n,t){Tw(n,_w(dw(t),cw(t)))})),"bottom-left":v.some((function(n,t){Tw(n,_w(ow(t),cw(t)))})),left:v.some((function(n,t){Tw(n,_w(ow(t),mw(t)))}))},CS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=Jw(n,t,e.left),r=aS(n,t,e.top),i=vS(o,r)
return hS(n,i),i},setToMin:function(n,t){var e=tw(t),o=ew(t)
hS(n,vS(e,o))},setToMax:function(n,t){var e=iw(t),o=uw(t)
hS(n,vS(e,o))},getValueFromEvent:function(n){return nw(n)},setPositionFromValue:function(n,t,e,o){var r=kw(e),i=Qw(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),u=sS(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),a=Cu(t.element)/2,c=hu(t.element)/2
Wi(t.element,"left",i-a+"px"),Wi(t.element,"top",u-c+"px")},onLeft:yS,onRight:xS,onUp:wS,onDown:SS,edgeActions:kS}),OS=Ll({name:"Slider",configFields:[Jt("stepSize",1),Jt("onChange",n),Jt("onChoose",n),Jt("onInit",n),Jt("onDragStart",n),Jt("onDragEnd",n),Jt("snapToGrid",!1),Jt("rounded",!0),Wt("snapStart"),Vt("model",Ot("mode",{x:[Jt("minX",0),Jt("maxX",100),re("value",(function(n){return ie(n.mode.minX)})),Rt("getInitialValue"),pa("manager",rS)],y:[Jt("minY",0),Jt("maxY",100),re("value",(function(n){return ie(n.mode.minY)})),Rt("getInitialValue"),pa("manager",pS)],xy:[Jt("minX",0),Jt("maxX",100),Jt("minY",0),Jt("maxY",100),re("value",(function(n){return ie({x:n.mode.minX,y:n.mode.minY})})),Rt("getInitialValue"),pa("manager",CS)]})),Vf("sliderBehaviours",[Qm,Rf]),re("mouseIsDown",(function(){return ie(!1)}))],partFields:Qx,factory:function(n,t,e,o){var r,i=function(t){return _l(t,n,"thumb")},u=function(t){return _l(t,n,"spectrum")},a=function(t){return Ol(t,n,"left-edge")},s=function(t){return Ol(t,n,"right-edge")},f=function(t){return Ol(t,n,"top-edge")},l=function(t){return Ol(t,n,"bottom-edge")},d=n.model,m=d.manager,g=function(t,e){m.setPositionFromValue(t,e,n,{getLeftEdge:a,getRightEdge:s,getTopEdge:f,getBottomEdge:l,getSpectrum:u})},p=function(t,e){d.value.set(e)
var o=i(t)
return g(t,o),n.onChange(t,o,e),v.some(!0)},h=function(t){var e=n.mouseIsDown.get()
n.mouseIsDown.set(!1),e&&Ol(t,n,"thumb").each((function(e){var o=d.value.get()
n.onChoose(t,e,o)}))},b=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,i(t))},y=function(t,e){e.stop(),n.onDragEnd(t,i(t)),h(t)}
return{uid:n.uid,dom:n.dom,components:t,behaviours:Hf(n.sliderBehaviours,[Qm.config({mode:"special",focusIn:function(t){return Ol(t,n,"spectrum").map(Qm.focusIn).map(c)}}),Rf.config({store:{mode:"manual",getValue:function(n){return d.value.get()}}}),ac.config({channels:(r={},r[bf()]={onReceive:h},r)})]),events:Jo([Zo(Zx(),(function(n,t){p(n,t.event.value)})),ar((function(t,e){var o=d.getInitialValue()
d.value.set(o)
var r=i(t)
g(t,r)
var a=u(t)
n.onInit(t,r,a,d.value.get())})),Zo(Qe(),b),Zo(no(),y),Zo(eo(),b),Zo(io(),y)]),apis:{resetToMin:function(t){m.setToMin(t,n)},resetToMax:function(t){m.setToMax(t,n)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),_S=function(n,t){var o=OS.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=OS.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}})
return OS.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:e({y:0})},components:[o,r],sliderBehaviours:tc([sg.config({})]),onChange:function(n,t,e){Go(n,Lx,{value:e})}})},TS="form",ES=[Vf("formBehaviours",[Rf])],BS=function(n){return"<alloy.field."+n+">"},DS=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Hf(n.formBehaviours,[Rf.config({store:{mode:"manual",getValue:function(t){var e=El(t,n)
return xn(e,(function(n,t){return n().bind((function(n){var e,o,r=Xl.getCurrent(n)
return e=r,o=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Ur(n.element)),e.fold((function(){return on.error(o)}),on.value)})).map(Rf.getValue)}))},setValue:function(t,e){yn(e,(function(e,o){Ol(t,n,o).each((function(n){Xl.getCurrent(n).each((function(n){Rf.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return Ol(t,n,e).bind(Xl.getCurrent)}}}},AS={getField:ci((function(n,t,e){return n.getField(t,e)})),sketch:function(n){var t=function(){var n=[]
return{field:function(t,e){return n.push(t),xl(TS,BS(t),e)},record:function(){return n}}}(),e=n(t),o=t.record(),r=P(o,(function(n){return ll({name:n,pname:BS(n)})}))
return Rl(TS,ES,r,DS,e)}},MS=Yr("valid-input"),FS=Yr("invalid-input"),IS=Yr("validating-input"),RS="colorcustom.rgb.",VS=function(t,e,o,r){var i=function(n,o){return gx.config({invalidClass:e("invalid"),notify:{onValidate:function(t){Go(t,IS,{type:n})},onValid:function(t){Go(t,MS,{type:n,value:Rf.getValue(t)})},onInvalid:function(t){Go(t,FS,{type:n,value:Rf.getValue(t)})}},validator:{validate:function(n){var e=Rf.getValue(n),r=o(e)?on.value(!0):on.error(t("aria.input.invalid"))
return rx(r)},validateOnLoad:!1}})},u=function(o,r,u,a,c){var s=t("colorcustom.rgb.range"),l=[_y.parts.label({dom:{tag:"label",innerHtml:u,attributes:{"aria-label":a}}}),_y.parts.field({data:c,factory:qy,inputAttributes:f({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:tc([i(r,o),By.config({})]),onSetValue:function(t){gx.isInvalid(t)&&gx.run(t).get(n)}})],d="hex"!==r?[_y.parts["aria-descriptor"]({text:s})]:[]
return{dom:{tag:"div",attributes:{role:"presentation"}},components:l.concat(d)}},a=function(n,t){var e=t.red,o=t.green,r=t.blue
Rf.setValue(n,{red:e,green:o,blue:r})},c=ip({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),s=function(n,t){c.getOpt(n).each((function(n){Wi(n.element,"background-color","#"+t.value)}))}
return Nl({factory:function(){var n={red:ie(v.some(255)),green:ie(v.some(255)),blue:ie(v.some(255)),hex:ie(v.some("ffffff"))},i=function(t){return n[t].get()},f=function(t,e){n[t].set(e)},l=function(n){var t=n.red,e=n.green,o=n.blue
f("red",v.some(t)),f("green",v.some(e)),f("blue",v.some(o))},d=function(n,t){var e=t.event
"hex"!==e.type?f(e.type,v.none()):r(n)},m=function(n,t,e){var o=parseInt(e,10)
f(t,v.some(o)),i("red").bind((function(n){return i("green").bind((function(t){return i("blue").map((function(e){return db(n,t,e,1)}))}))})).each((function(t){var e=function(n,t){var e=ub(t)
return AS.getField(n,"hex").each((function(t){sg.isFocused(t)||Rf.setValue(n,{hex:e.value})})),e}(n,t)
s(n,e)}))},g=function(n,t){var e=t.event
!function(n){return"hex"===n.type}(e)?m(n,e.type,e.value):function(n,t){o(n)
var e=nb(t)
f("hex",v.some(t))
var r=pb(e)
a(n,r),l(r),Go(n,Nx,{hex:e}),s(n,e)}(n,e.value)},p=function(n){return{label:t(RS+n+".label"),description:t(RS+n+".description")}},h=p("red"),b=p("green"),y=p("blue"),x=p("hex")
return Mn(AS.sketch((function(n){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[n.field("red",_y.sketch(u(mb,"red",h.label,h.description,255))),n.field("green",_y.sketch(u(mb,"green",b.label,b.description,255))),n.field("blue",_y.sketch(u(mb,"blue",y.label,y.description,255))),n.field("hex",_y.sketch(u(ob,"hex",x.label,x.description,"ffffff"))),c.asSpec()],formBehaviours:tc([gx.config({invalidClass:e("form-invalid")}),rg("rgb-form-events",[Zo(MS,g),Zo(FS,d),Zo(IS,d)])])}})),{apis:{updateHex:function(n,t){Rf.setValue(n,{hex:t.value}),function(n,t){var e=pb(t)
a(n,e),l(e)}(n,t),s(n,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(n,t,e){n.updateHex(t,e)}},extraApis:{}})},PS=function(n,t){var o=OS.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),r=OS.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(n,t){var e=n.width,o=n.height,r=n.getContext("2d")
if(null!==r){r.fillStyle=t,r.fillRect(0,0,e,o)
var i=r.createLinearGradient(0,0,e,0)
i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o)
var u=r.createLinearGradient(0,0,0,o)
u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}}
return Nl({factory:function(n){var u=e({x:0,y:0}),a=tc([Xl.config({find:v.some}),sg.config({})])
return OS.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[o,r],onChange:function(n,t,e){Go(n,jx,{value:e})},onInit:function(n,t,e,o){i(e.element.dom,vb(bb))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(n,t,e){(function(n,t){var e=n.components()[0].element.dom
i(e,vb(t))})(t,e)}},extraApis:{}})},HS=function(t,e){return Nl({name:"ColourPicker",configFields:[Rt("dom"),Jt("onValidHex",n),Jt("onInvalidHex",n)],factory:function(n){var o,r=VS(t,e,n.onValidHex,n.onInvalidHex),i=PS(0,e),u={paletteRgba:ie(bb)},a=ip(i.sketch({})),c=ip(r.sketch({})),s=function(n,t){a.getOpt(n).each((function(n){var e=pb(t)
u.paletteRgba.set(e),i.setRgba(n,e)}))},f=function(n,t){c.getOpt(n).each((function(n){r.updateHex(n,t)}))},l=function(n,t,e){H(e,(function(e){e(n,t)}))}
return{uid:n.uid,dom:n.dom,components:[a.asSpec(),_S(0,e),c.asSpec()],behaviours:tc([rg("colour-picker-events",[Zo(jx,(o=[f],function(n,t){var e=t.event.value,r=function(n){var t,e=0,o=0,r=n.red/255,i=n.green/255,u=n.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u))
return a===c?zx(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),t=(c-a)/c,o=c,zx(Math.round(e),Math.round(100*t),Math.round(100*o)))}(u.paletteRgba.get()),i=zx(r.hue,e.x,100-e.y),a=gb(i),c=ub(a)
l(n,c,o)})),Zo(Lx,function(){var n=[s,f]
return function(t,e){var o=function(n){var t=zx((100-n)/100*360,100,100),e=gb(t)
return ub(e)}(e.event.value.y)
l(t,o,n)}}())]),Xl.config({find:function(n){return c.getOpt(n)}}),Qm.config({mode:"acyclic"})])}}})},zS=function(){return Xl.config({find:v.some})},NS=function(n){return Xl.config({find:n.getOpt})},LS=function(n){return Xl.config({find:function(t){return Cr(t.element,n).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}})},jS={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},US=function(n){return function(n){return jS[n]}(n)},WS=tinymce.util.Tools.resolve("tinymce.Resource"),GS=it([Jt("preprocess",o),Jt("postprocess",o)]),XS=function(n,t,e){return Rf.config(Mn({store:{mode:"manual",getValue:t,setValue:e}},n.map((function(n){return{store:{initialValue:n}}})).getOr({})))},YS=function(n,t,e){return XS(n,(function(n){return t(n.element)}),(function(n,t){return e(n.element,t)}))},qS=function(n,t){var e=St("RepresentingConfigs.memento processors",GS,t)
return Rf.config({store:{mode:"manual",getValue:function(t){var o=n.get(t),r=Rf.getValue(o)
return e.postprocess(r)},setValue:function(t,o){var r=e.preprocess(o),i=n.get(t)
Rf.setValue(i,r)}}})},KS=XS,JS=function(n){return YS(n,Fr,Ir)},$S=function(n){return Rf.config({store:{mode:"memory",initialValue:n}})},QS=function(n,t){var e=function(n,t){t.stop()},o=function(n){return function(t,e){H(n,(function(n){n(t,e)}))}},r=function(n,t){if(!$h.isDisabled(n)){var e=t.event.raw
u(n,e.dataTransfer.files)}},i=function(n,t){var e=t.event.raw.target
u(n,e.files)},u=function(t,e){Rf.setValue(t,function(n){var t=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i")
return N(Z(n),(function(n){return t.test(n.name)}))}(e)),Go(t,Iy,{name:n.name})},a=ip({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:tc([rg("input-file-events",[rr(go()),rr(Oo())])])}),c=n.label.map((function(n){return Fy(n,t)})),s=_y.parts.field({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:tc([$S([]),zS(),$h.config({}),wg.config({toggleClass:"dragenter",toggleOnExecute:!1}),rg("dropzone-events",[Zo("dragenter",o([e,wg.toggle])),Zo("dragleave",o([e,wg.toggle])),Zo("dragover",e),Zo("drop",o([e,r])),Zo(mo(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},rp.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(n){a.get(n).element.dom.click()},buttonBehaviours:tc([By.config({}),Bv(t.isReadOnly),Tv()])})]}]}}}})
return Dy(c,s,["tox-form__group--stretched"],[])},ZS=Yr("alloy-fake-before-tabstop"),nk=Yr("alloy-fake-after-tabstop"),tk=function(n){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:n},behaviours:tc([sg.config({ignore:!0}),By.config({})])}},ek=function(n){return{dom:{tag:"div",classes:["tox-navobj"]},components:[tk([ZS]),n,tk([nk])],behaviours:tc([LS(1)])}},ok=function(n,t){Go(n,so(),{raw:{which:9,shiftKey:t}})},rk=function(n,t){var e=t.element
Ei(e,ZS)?ok(n,!0):Ei(e,nk)&&ok(n,!1)},ik=function(n){return ay(n,["."+ZS,"."+nk].join(","),a)},uk=!(ze().browser.isIE()||ze().browser.isEdge()),ak=function(n,t){var e=uk&&n.sandboxed,o=f(f({},n.label.map((function(n){return{title:n}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(n){var t=ie("")
return{getValue:function(n){return t.get()},setValue:function(e,o){if(n)Vr(e.element,"srcdoc",o)
else{Vr(e.element,"src","javascript:''")
var r=e.element.dom.contentWindow.document
r.open(),r.write(o),r.close()}t.set(o)}}}(e),i=n.label.map((function(n){return Fy(n,t)})),u=_y.parts.field({factory:{sketch:function(n){return ek({uid:n.uid,dom:{tag:"iframe",attributes:o},behaviours:tc([By.config({}),sg.config({}),KS(v.none(),r.getValue,r.setValue)])})}}})
return Dy(i,u,["tox-form__group--stretched"],[])}
function ck(n,t){return lk(document.createElement("canvas"),n,t)}function sk(n){var t=ck(n.width,n.height)
return fk(t).drawImage(n,0,0),t}function fk(n){return n.getContext("2d")}function lk(n,t,e){return n.width=t,n.height=e,n}function dk(n){return n.naturalWidth||n.width}function mk(n){return n.naturalHeight||n.height}var gk=window.Promise?window.Promise:function(){var n=function(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new")
if("function"!=typeof n)throw new TypeError("not a function")
this._state=null,this._value=null,this._deferreds=[],f(n,o(u,this),o(a,this))},t=window,e=n.immediateFn||"function"==typeof t.setImmediate&&t.setImmediate||function(n){setTimeout(n,1)}
function o(n,t){return function(){return n.apply(t,arguments)}}var r=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)}
function i(n){var t=this
null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected
if(null!==e){var o
try{o=e(t._value)}catch(r){return void n.reject(r)}n.resolve(o)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.")
if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then
if("function"==typeof t)return void f(o(t,n),o(u,this),o(a,this))}this._state=!0,this._value=n,c.call(this)}catch(e){a.call(this,e)}}function a(n){this._state=!1,this._value=n,c.call(this)}function c(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n]
i.call(this,e)}this._deferreds=[]}function s(n,t,e,o){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=o}function f(n,t,e){var o=!1
try{n((function(n){o||(o=!0,t(n))}),(function(n){o||(o=!0,e(n))}))}catch(r){if(o)return
o=!0,e(r)}}return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var o=this
return new n((function(n,r){i.call(o,new s(t,e,n,r))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]
var o=Array.prototype.slice.call(1===t.length&&r(t[0])?t[0]:t)
return new n((function(n,t){if(0===o.length)return n([])
var e=o.length
function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then
if("function"==typeof a)return void a.call(u,(function(n){r(i,n)}),t)}o[i]=u,0==--e&&n(o)}catch(c){t(c)}}for(var i=0;i<o.length;i++)r(i,o[i])}))},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t;o<r.length;o++){r[o].then(n,e)}}))},n}()
function pk(n){return new gk((function(t,e){(function(n){var t=n.split(","),e=/data:([^;]+)/.exec(t[0])
if(!e)return v.none()
for(var o=e[1],r=t[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0)
s[f]=new Uint8Array(m)}return v.some(new Blob(s,{type:o}))})(n).fold((function(){e("uri is not base64: "+n)}),t)}))}function hk(n,t,e){return t=t||"image/png",_(HTMLCanvasElement.prototype.toBlob)?new gk((function(o,r){n.toBlob((function(n){n?o(n):r()}),t,e)})):pk(n.toDataURL(t,e))}function vk(n){return function(n){return new gk((function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)}
function u(){i(),t(r)}function a(){i(),e("Unable to load data of type "+n.type+": "+o)}r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&u()}))}(n).then((function(n){(function(n){URL.revokeObjectURL(n.src)})(n)
var t=ck(dk(n),mk(n))
return fk(t).drawImage(n,0,0),t}))}function bk(n,t,o){var r=t.type
function i(t,e){return n.then((function(n){return function(n,t,e){return t=t||"image/png",n.toDataURL(t,e)}(n,t,e)}))}return{getType:e(r),toBlob:function(){return gk.resolve(t)},toDataURL:e(o),toBase64:function(){return o.split(",")[1]},toAdjustedBlob:function(t,e){return n.then((function(n){return hk(n,t,e)}))},toAdjustedDataURL:i,toAdjustedBase64:function(n,t){return i(n,t).then((function(n){return n.split(",")[1]}))},toCanvas:function(){return n.then(sk)}}}function yk(n){return function(n){return new gk((function(t){var e=new FileReader
e.onloadend=function(){t(e.result)},e.readAsDataURL(n)}))}(n).then((function(t){return bk(vk(n),n,t)}))}function xk(n,t){return hk(n,t).then((function(t){return bk(gk.resolve(n),t,n.toDataURL())}))}function wk(n,t,e){var o="string"==typeof n?parseFloat(n):n
return o>e?o=e:o<t&&(o=t),o}var Sk=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10]
function kk(n,t){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=t[u+5*i]
for(u=0;u<5;u++){e=0
for(var a=0;a<5;a++)e+=n[u+5*a]*o[a]
r[u+5*i]=e}}return r}function Ck(n,t){return n.toCanvas().then((function(e){return function(n,t,e){var o=fk(n)
function r(n,t){for(var e,o,r,i,u=n.data,a=t[0],c=t[1],s=t[2],f=t[3],l=t[4],d=t[5],m=t[6],g=t[7],p=t[8],h=t[9],v=t[10],b=t[11],y=t[12],x=t[13],w=t[14],S=t[15],k=t[16],C=t[17],O=t[18],_=t[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_
return n}var i=r(o.getImageData(0,0,n.width,n.height),e)
return o.putImageData(i,0,0),xk(n,t)}(e,n.getType(),t)}))}function Ok(n,t){return n.toCanvas().then((function(e){return function(n,t,e){var o=fk(n)
function r(n,t,e){function o(n,t,e){return n>e?n=e:n<t&&(n=t),n}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=n.data,a=t.data,c=n.width,s=n.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=4*(o(f+p-i,0,s-1)*c+v),y=e[p*r+h]
d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(f*c+l)
a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return t}var i=o.getImageData(0,0,n.width,n.height),u=o.getImageData(0,0,n.width,n.height)
return u=r(i,u,e),o.putImageData(u,0,0),xk(n,t)}(e,n.getType(),t)}))}function _k(n){return function(t,e){return Ck(t,n([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}}var Tk,Ek,Bk=function(n){return function(t){return Ck(t,n)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),Dk=_k((function(n,t){return kk(n,[1,0,0,0,t=wk(255*t,-255,255),0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])})),Ak=_k((function(n,t){var e
return t=wk(t,-1,1),kk(n,[(e=(t*=100)<0?127+t/100*127:127*(e=0===(e=t%1)?Sk[t]:Sk[Math.floor(t)]*(1-e)+Sk[Math.floor(t)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),Mk=function(n,t,e,o){return Ck(n,function(n,t,e,o){return kk(n,[t=wk(t,0,2),0,0,0,0,0,e=wk(e,0,2),0,0,0,0,0,o=wk(o,0,2),0,0,0,0,0,1,0,0,0,0,0,1])}([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],t,e,o))},Fk=(Tk=[0,-1,0,-1,5,-1,0,-1,0],function(n){return Ok(n,Tk)}),Ik=(Ek=function(n,t){return 255*Math.pow(n/255,1-t)},function(n,t){return n.toCanvas().then((function(e){return function(n,t,e){for(var o=fk(n),r=new Array(256),i=0;i<r.length;i++)r[i]=Ek(i,e)
var u=function(n,t){for(var e=n.data,o=0;o<e.length;o+=4)e[o]=t[e[o]],e[o+1]=t[e[o+1]],e[o+2]=t[e[o+2]]
return n}(o.getImageData(0,0,n.width,n.height),r)
return o.putImageData(u,0,0),xk(n,t)}(e,n.getType(),t)}))})
function Rk(n,t,e){var o=dk(n),r=mk(n),i=t/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0)
var c=function(n,t,e){return new gk((function(o){var r=dk(n),i=mk(n),u=Math.floor(r*t),a=Math.floor(i*e),c=ck(u,a)
fk(c).drawImage(n,0,0,r,i,0,0,u,a),o(c)}))}(n,i,u)
return a?c.then((function(n){return Rk(n,t,e)})):c}function Vk(n,t){return n.toCanvas().then((function(e){return function(n,t,e){var o=ck(n.width,n.height),r=fk(o),i=0,u=0
90!==(e=e<0?360+e:e)&&270!==e||lk(o,o.height,o.width)
90!==e&&180!==e||(i=o.width)
270!==e&&180!==e||(u=o.height)
return r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(n,0,0),xk(o,t)}(e,n.getType(),t)}))}function Pk(n,t){return n.toCanvas().then((function(e){return function(n,t,e){var o=ck(n.width,n.height),r=fk(o)
"v"===e?(r.scale(1,-1),r.drawImage(n,0,-o.height)):(r.scale(-1,1),r.drawImage(n,-o.width,0))
return xk(o,t)}(e,n.getType(),t)}))}function Hk(n,t,e,o,r){return n.toCanvas().then((function(i){return function(n,t,e,o,r,i){var u=ck(r,i)
return fk(u).drawImage(n,-e,-o),xk(u,t)}(i,n.getType(),t,e,o,r)}))}var zk,Nk=function(n){return Bk(n)},Lk=function(n){return Fk(n)},jk=function(n,t){return Ik(n,t)},Uk=function(n,t){return Dk(n,t)},Wk=function(n,t){return Ak(n,t)},Gk=function(n,t){return Pk(n,t)},Xk=function(n,t,e){return function(n,t,e){return n.toCanvas().then((function(o){return Rk(o,t,e).then((function(t){return xk(t,n.getType())}))}))}(n,t,e)},Yk=function(n,t){return Vk(n,t)},qk=function(n,t){return f({dom:{tag:"span",innerHtml:n,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},Kk=function(n,t){return qk(ap(n,t),{})},Jk=function(n,t){return qk(ap(n,t),{behaviours:tc([og.config({})])})},$k=function(n,t,e){return{dom:{tag:"span",innerHtml:e.translate(n),classes:[t+"__select-label"]},behaviours:tc([og.config({})])}},Qk=Yr("toolbar.button.execute"),Zk=((zk={})[ko()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],zk),nC=Yr("update-menu-text"),tC=Yr("update-menu-icon"),eC=function(t,e,o){var i=ie(n),u=t.text.map((function(n){return ip($k(n,e,o.providers))})),a=t.icon.map((function(n){return ip(Jk(n,o.providers.icons))})),c=function(n,t){var e=Rf.getValue(n)
return sg.focus(e),Go(e,"keydown",{raw:t.event.raw}),Mx.close(e),v.some(!0)},s=t.role.fold((function(){return{}}),(function(n){return{role:n}})),l=t.tooltip.fold((function(){return{}}),(function(n){var t=o.providers.translate(n)
return{title:t,"aria-label":t}}))
return ip(Mx.sketch(f(f(f({},t.uid?{uid:t.uid}:{}),s),{dom:{tag:"button",classes:[e,e+"--select"].concat(P(t.classes,(function(n){return e+"--"+n}))),attributes:f({},l)},components:Pv([a.map((function(n){return n.asSpec()})),u.map((function(n){return n.asSpec()})),v.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:ap("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:tc(d(t.dropdownBehaviours,[Bv((function(){return t.disabled||o.providers.isReadOnly()})),Tv(),Ix.config({}),og.config({}),rg("dropdown-events",[Fv(t,i),Iv(t,i)]),rg("menubutton-update-display-text",[Zo(nC,(function(n,t){u.bind((function(t){return t.getOpt(n)})).each((function(n){og.set(n,[su(o.providers.translate(t.event.text))])}))})),Zo(tC,(function(n,t){a.bind((function(t){return t.getOpt(n)})).each((function(n){og.set(n,[Jk(t.event.icon,o.providers.icons)])}))}))])])),eventOrder:Mn(Zk,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:tc([Qm.config({mode:"special",onLeft:c,onRight:c})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:lh(0,t.columns,t.presets)},fetch:function(n){return ox(r(t.fetch,n))}}))).asSpec()},oC=function(n){return"separator"===n.type},rC={type:"separator"},iC=function(n,t){var e=j(n,(function(n,e){return function(n){return x(n)}(e)?""===e?n:"|"===e?n.length>0&&!oC(n[n.length-1])?n.concat([rC]):n:Tn(t,e.toLowerCase())?n.concat([t[e.toLowerCase()]]):n:n.concat([e])}),[])
return e.length>0&&oC(e[e.length-1])&&e.pop(),e},uC=function(n,t){return function(n){return Tn(n,"getSubmenuItems")}(n)?function(n,t){var e=n.getSubmenuItems(),o=aC(e,t)
return{item:n,menus:Mn(o.menus,Wn(n.value,o.items)),expansions:Mn(o.expansions,Wn(n.value,n.value))}}(n,t):{item:n,menus:{},expansions:{}}},aC=function(n,t){var e=iC(x(n)?n.split(" "):n,t)
return L(e,(function(n,e){var o=function(n){if(oC(n))return n
var t=_n(n,"value").getOrThunk((function(){return Yr("generated-menu-item")}))
return Mn({value:t},n)}(e),r=uC(o,t)
return{menus:Mn(n.menus,r.menus),items:[r.item].concat(n.items),expansions:Mn(n.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},cC=function(n,t,e,o){var r=Yr("primary-menu"),i=aC(n,e.shared.providers.menuItems())
if(0===i.items.length)return v.none()
var u=ny(r,i.items,t,e,o),a=xn(i.menus,(function(n,o){return ny(o,n,t,e,!1)})),c=Mn(a,Wn(r,u))
return v.from(Wg.tieredData(r,c,i.expansions))},sC=function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)},setActive:function(t){var e=n.element
t?(Oi(e,"tox-tbtn--enabled"),Vr(e,"aria-pressed",!0)):(Ti(e,"tox-tbtn--enabled"),Nr(e,"aria-pressed"))},isActive:function(){return Ei(n.element,"tox-tbtn--enabled")}}},fC=function(n,t,e,o){return eC({text:n.text,icon:n.icon,tooltip:n.tooltip,role:o,fetch:function(t,o){n.fetch((function(n){o(cC(n,Jp.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:n.onSetup,getApi:sC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[By.config({})]},t,e.shared)},lC=function(n,t,e){var o=function(n){return function(o){var r=!o.isActive()
o.setActive(r),n.storage.set(r),e.shared.getSink().each((function(e){t().getOpt(e).each((function(t){sc(t.element),Go(t,Py,{name:n.name,value:n.storage.get()})}))}))}},r=function(n){return function(t){t.setActive(n.storage.get())}}
return function(t){t(P(n,(function(n){var t=n.text.fold((function(){return{}}),(function(n){return{text:n}}))
return f(f({type:n.type,active:!1},t),{onAction:o(n),onSetup:r(n)})})))}},dC=function(n,t,e,o,r,i){void 0===e&&(e=[])
var u=t.fold((function(){return{}}),(function(n){return{action:n}})),a=f({buttonBehaviours:tc([Bv((function(){return n.disabled||i.isReadOnly()})),Tv(),By.config({}),rg("button press",[Qo("click"),Qo("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Mn(a,{dom:o})
return Mn(c,{components:r})},mC=function(n,t,e,o){void 0===o&&(o=[])
var r={tag:"button",classes:["tox-tbtn"],attributes:n.tooltip.map((function(n){return{"aria-label":e.translate(n),title:e.translate(n)}})).getOr({})},i=n.icon.map((function(n){return Kk(n,e.icons)})),u=Pv([i])
return dC(n,t,o,r,u,e)},gC=function(n,t,e,o){void 0===o&&(o=[])
var r=mC(n,v.some(t),e,o)
return rp.sketch(r)},pC=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[])
var i=e.translate(n.text),u=n.icon?n.icon.map((function(n){return Kk(n,e.icons)})):v.none(),a=u.isSome()?Pv([u]):[],c=u.isSome()?{}:{innerHtml:i},s=d(n.primary||n.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],n.borderless?["tox-button--naked"]:[],r),l=f(f({tag:"button",classes:s},c),{attributes:{title:i}})
return dC(n,t,o,l,a,e)},hC=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[])
var i=pC(n,v.some(t),e,o,r)
return rp.sketch(i)},vC=function(n,t){return function(e){"custom"===t?Go(e,Py,{name:n,value:{}}):"submit"===t?Wo(e,Hy):"cancel"===t?Wo(e,Vy):console.error("Unknown button type: ",t)}},bC=function(t,e,o){if(function(n,t){return"menu"===t}(0,e)){var r=t,i=f(f({},t),{onSetup:function(e){return e.setDisabled(t.disabled),n},fetch:lC(r.items,(function(){return u}),o)}),u=ip(fC(i,"tox-tbtn",o,v.none()))
return u.asSpec()}if(function(n,t){return"custom"===t||"cancel"===t||"submit"===t}(0,e)){var a=vC(t.name,e),c=f(f({},t),{borderless:!1})
return hC(c,a,o.shared.providers,[])}console.error("Unknown footer button type: ",e)},yC=function(n,t){var e,o,r=vC(n.name,"custom")
return e=v.none(),o=_y.parts.field(f({factory:rp},pC(n,v.some(r),t,[$S(""),zS()]))),Dy(e,o,[],[])},xC=e([Jt("field1Name","field1"),Jt("field2Name","field2"),ma("onLockedChange"),sa(["lockClass"]),Jt("locked",!1),zf("coupledFieldBehaviours",[Xl,Rf])]),wC=function(n,t){return ll({factory:_y,name:n,overrides:function(n){return{fieldBehaviours:tc([rg("coupled-input-behaviour",[Zo(lo(),(function(e){(function(n,t,e){return Ol(n,t,e).bind(Xl.getCurrent)})(e,n,t).each((function(t){Ol(e,n,"lock").each((function(o){wg.isOn(o)&&n.onLockedChange(e,t,o)}))}))}))])])}}})},SC=e([wC("field1","field2"),wC("field2","field1"),ll({factory:rp,schema:[Rt("dom")],name:"lock",overrides:function(n){return{buttonBehaviours:tc([wg.config({selected:n.locked,toggleClass:n.markers.lockClass,aria:{mode:"pressed"}})])}}})]),kC=Ll({name:"FormCoupledInputs",configFields:xC(),partFields:SC(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Nf(n.coupledFieldBehaviours,[Xl.config({find:v.some}),Rf.config({store:{mode:"manual",getValue:function(t){var e,o=Dl(t,n,["field1","field2"])
return(e={})[n.field1Name]=Rf.getValue(o.field1()),e[n.field2Name]=Rf.getValue(o.field2()),e},setValue:function(t,e){var o=Dl(t,n,["field1","field2"])
En(e,n.field1Name)&&Rf.setValue(o.field1(),e[n.field1Name]),En(e,n.field2Name)&&Rf.setValue(o.field2(),e[n.field2Name])}}})]),apis:{getField1:function(t){return Ol(t,n,"field1")},getField2:function(t){return Ol(t,n,"field2")},getLock:function(t){return Ol(t,n,"lock")}}}},apis:{getField1:function(n,t){return n.getField1(t)},getField2:function(n,t){return n.getField2(t)},getLock:function(n,t){return n.getLock(t)}}}),CC=function(n){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(n)
if(null!==t){var e=parseFloat(t[1]),o=t[2]
return on.value({value:e,unit:o})}return on.error(n)},OC=function(n,t){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(n){return Object.prototype.hasOwnProperty.call(e,n)}
return n.unit===t?v.some(n.value):o(n.unit)&&o(t)?e[n.unit]===e[t]?v.some(n.value):v.some(n.value/e[n.unit]*e[t]):v.none()},_C=function(n){return v.none()},TC=function(n,t){var e,o,r,i=CC(n).toOptional(),u=CC(t).toOptional()
return(e=i,o=u,r=function(n,t){return OC(n,t.unit).map((function(n){return t.value/n})).map((function(n){return function(n,t){return function(e){return OC(e,t).map((function(e){return{value:e*n,unit:t}}))}}(n,t.unit)})).getOr(_C)},e.isSome()&&o.isSome()?v.some(r(e.getOrDie(),o.getOrDie())):v.none()).getOr(_C)},EC=function(n,t){var e=_C,o=Yr("ratio-event"),r=kC.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(n.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:ap("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:ap("unlock",t.icons)}}],buttonBehaviours:tc([$h.config({disabled:function(){return n.disabled||t.isReadOnly()}}),Tv(),By.config({})])}),i=function(n){return{dom:{tag:"div",classes:["tox-form__group"]},components:n}},u=function(e){return _y.parts.field({factory:qy,inputClasses:["tox-textfield"],inputBehaviours:tc([$h.config({disabled:function(){return n.disabled||t.isReadOnly()}}),Tv(),By.config({}),rg("size-input-events",[Zo(ao(),(function(n,t){Go(n,o,{isField1:e})})),Zo(mo(),(function(t,e){Go(t,Iy,{name:n.name})}))])]),selectOnFocus:!1})},a=function(n){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}},c=kC.parts.field1(i([_y.parts.label(a("Width")),u(!0)])),s=kC.parts.field2(i([_y.parts.label(a("Height")),u(!1)]))
return kC.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(n,t,o){CC(Rf.getValue(n)).each((function(n){e(n).each((function(n){Rf.setValue(t,function(n){var t,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=n.value.toFixed((t=n.unit)in e?e[t]:1)
return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+n.unit}(n))}))}))},coupledFieldBehaviours:tc([$h.config({disabled:function(){return n.disabled||t.isReadOnly()},onDisabled:function(n){kC.getField1(n).bind(_y.getField).each($h.disable),kC.getField2(n).bind(_y.getField).each($h.disable),kC.getLock(n).each($h.disable)},onEnabled:function(n){kC.getField1(n).bind(_y.getField).each($h.enable),kC.getField2(n).bind(_y.getField).each($h.enable),kC.getLock(n).each($h.enable)}}),Tv(),rg("size-input-events2",[Zo(o,(function(n,t){var o=t.event.isField1,r=o?kC.getField1(n):kC.getField2(n),i=o?kC.getField2(n):kC.getField1(n),u=r.map(Rf.getValue).getOr(""),a=i.map(Rf.getValue).getOr("")
e=TC(u,a)}))])])})},BC={undo:e(Yr("undo")),redo:e(Yr("redo")),zoom:e(Yr("zoom")),back:e(Yr("back")),apply:e(Yr("apply")),swap:e(Yr("swap")),transform:e(Yr("transform")),tempTransform:e(Yr("temp-transform")),transformApply:e(Yr("transform-apply"))},DC=e("save-state"),AC=e("disable"),MC=e("enable"),FC={formActionEvent:Py,saveState:DC,disable:AC,enable:MC},IC=function(t,o){var r=function(n,t,e,r){return ip(hC({name:n,text:n,disabled:e,primary:r,icon:v.none(),borderless:!1},t,o))},i=function(n,t,e,r){return ip(gC({name:n,icon:v.some(n),tooltip:v.some(t),disabled:r,primary:!1,borderless:!1},e,o))},u=function(n,t){n.map((function(n){var e=n.get(t)
e.hasConfigured($h)&&$h.disable(e)}))},a=function(n,t){n.map((function(n){var e=n.get(t)
e.hasConfigured($h)&&$h.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=n,f=function(n,t,e){Go(n,t,e)},l=function(n){return Wo(n,FC.disable())},d=function(n){return Wo(n,FC.enable())},m=function(n,t){l(n),f(n,BC.transform(),{transform:t}),d(n)},g=function(n){return function(){tn.getOpt(n).each((function(n){og.set(n,[Z])}))}},p=function(n,t){l(n),f(n,BC.transformApply(),{transform:t,swap:g(n)}),d(n)},h=function(){return r("Back",(function(n){return f(n,BC.back(),{swap:g(n)})}),!1,!1)},b=function(){return ip({dom:{tag:"div",classes:["tox-spacer"]},behaviours:tc([$h.config({})])})},y=function(){return r("Apply",(function(n){return f(n,BC.apply(),{swap:g(n)})}),!0,!0)},x=function(){return function(n){var e=t.getRect()
return function(n,t,e,o,r){return Hk(n,t,e,o,r)}(n,e.x,e.y,e.w,e.h)}},w=[h(),b(),r("Apply",(function(n){var e=x()
p(n,e),t.hideCrop()}),!1,!0)],S=Sy.sketch({dom:c,components:w.map((function(n){return n.asSpec()})),containerBehaviours:tc([rg("image-tools-crop-buttons-events",[Zo(FC.disable(),(function(n,t){u(w,n)})),Zo(FC.enable(),(function(n,t){a(w,n)}))])])}),k=ip(EC({name:"size",label:v.none(),constrain:!0,disabled:!1},o)),C=[h(),b(),k,b(),r("Apply",(function(n){k.getOpt(n).each((function(t){var e=Rf.getValue(t),o=function(n,t){return function(e){return Xk(e,n,t)}}(parseInt(e.width,10),parseInt(e.height,10))
p(n,o)}))}),!1,!0)],O=Sy.sketch({dom:c,components:C.map((function(n){return n.asSpec()})),containerBehaviours:tc([rg("image-tools-resize-buttons-events",[Zo(FC.disable(),(function(n,t){u(C,n)})),Zo(FC.enable(),(function(n,t){a(C,n)}))])])}),_=function(n,t){return function(e){return n(e,t)}},T=_(Gk,"h"),E=_(Gk,"v"),B=_(Yk,-90),D=_(Yk,90),A=function(n,t){(function(n,t){l(n),f(n,BC.tempTransform(),{transform:t}),d(n)})(n,t)},M=[h(),b(),i("flip-horizontally","Flip horizontally",(function(n){A(n,T)}),!1),i("flip-vertically","Flip vertically",(function(n){A(n,E)}),!1),i("rotate-left","Rotate counterclockwise",(function(n){A(n,B)}),!1),i("rotate-right","Rotate clockwise",(function(n){A(n,D)}),!1),b(),y()],F=Sy.sketch({dom:c,components:M.map((function(n){return n.asSpec()})),containerBehaviours:tc([rg("image-tools-fliprotate-buttons-events",[Zo(FC.disable(),(function(n,t){u(M,n)})),Zo(FC.enable(),(function(n,t){a(M,n)}))])])}),I=function(n,t,r,i,u){var a=OS.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:o.translate(n)}}),c=OS.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=OS.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}})
return ip(OS.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:e({x:i})},components:[a,c,s],sliderBehaviours:tc([sg.config({})]),onChoose:t}))},R=function(n,t,e,o,r){return I(n,(function(n,e,o){var r=_(t,o.x/100)
m(n,r)}),e,o,r)},V=function(n,t,e,o,r){var i=function(n,t,e,o,r){return[h(),R(n,t,e,o,r),y()]}(n,t,e,o,r)
return Sy.sketch({dom:c,components:i.map((function(n){return n.asSpec()})),containerBehaviours:tc([rg("image-tools-filter-panel-buttons-events",[Zo(FC.disable(),(function(n,t){u(i,n)})),Zo(FC.enable(),(function(n,t){a(i,n)}))])])})},P=[h(),b(),y()],H=Sy.sketch({dom:c,components:P.map((function(n){return n.asSpec()}))}),z=V("Brightness",Uk,-100,0,100),N=V("Contrast",Wk,-100,0,100),L=V("Gamma",jk,-100,0,100),j=function(n,t,e){return function(o){return function(n,t,e,o){return Mk(n,t,e,o)}(o,n,t,e)}},U=function(n){return I(n,(function(n,t,e){var o=W.getOpt(n),r=X.getOpt(n),i=G.getOpt(n)
o.each((function(t){r.each((function(e){i.each((function(o){var r=Rf.getValue(t).x/100,i=Rf.getValue(o).x/100,u=Rf.getValue(e).x/100,a=j(r,i,u)
m(n,a)}))}))}))}),0,100,200)},W=U("R"),G=U("G"),X=U("B"),Y=[h(),W,G,X,y()],q=Sy.sketch({dom:c,components:Y.map((function(n){return n.asSpec()}))}),K=function(n,t,e){return function(o){f(o,BC.swap(),{transform:t,swap:function(){tn.getOpt(o).each((function(t){og.set(t,[n]),e(t)}))}})}},J=v.some(Lk),$=v.some(Nk),Q=[i("crop","Crop",K(S,v.none(),(function(n){t.showCrop()})),!1),i("resize","Resize",K(O,v.none(),(function(n){k.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height
Rf.setValue(n,{width:o,height:r})}))})),!1),i("orientation","Orientation",K(F,v.none(),s),!1),i("brightness","Brightness",K(z,v.none(),s),!1),i("sharpen","Sharpen",K(H,J,s),!1),i("contrast","Contrast",K(N,v.none(),s),!1),i("color-levels","Color levels",K(q,v.none(),s),!1),i("gamma","Gamma",K(L,v.none(),s),!1),i("invert","Invert",K(H,$,s),!1)],Z=Sy.sketch({dom:c,components:Q.map((function(n){return n.asSpec()}))}),nn=Sy.sketch({dom:{tag:"div"},components:[Z],containerBehaviours:tc([og.config({})])}),tn=ip(nn)
return{memContainer:tn,getApplyButton:function(n){return tn.getOpt(n).map((function(n){var t=n.components()[0]
return t.components()[t.components().length-1]}))}}},RC=tinymce.util.Tools.resolve("tinymce.geom.Rect"),VC=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),PC=tinymce.util.Tools.resolve("tinymce.util.Observable"),HC=tinymce.util.Tools.resolve("tinymce.util.Tools"),zC=tinymce.util.Tools.resolve("tinymce.util.VK")
function NC(n){var t,e
if(n.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<t.length;e++)n[t[e]]=n.changedTouches[0][t[e]]}function LC(n,t){var e,o,r,i,u=t.document||document,a=u.getElementById(t.handle||n),c=function(n){if(NC(n),n.button!==o)return s(n)
n.deltaX=n.screenX-r,n.deltaY=n.screenY-i,n.preventDefault(),t.drag(n)},s=function(n){NC(n),VC(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),t.stop&&t.stop(n)}
this.destroy=function(){VC(a).off()},VC(a).on("mousedown touchstart",(function(n){var f,l=function(n){var t=Math.max,e=n.documentElement,o=n.body,r=t(e.scrollWidth,o.scrollWidth),i=t(e.clientWidth,o.clientWidth),u=t(e.offsetWidth,o.offsetWidth),a=t(e.scrollHeight,o.scrollHeight),c=t(e.clientHeight,o.clientHeight)
return{width:r<u?i:r,height:a<t(e.offsetHeight,o.offsetHeight)?c:a}}(u)
NC(n),n.preventDefault(),o=n.button
var d=a
r=n.screenX,i=n.screenY,f=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,e=VC("<div></div>").css({position:"absolute",top:0,left:0,width:l.width,height:l.height,zIndex:2147483647,opacity:1e-4,cursor:f}).appendTo(u.body),VC(u).on("mousemove touchmove",c).on("mouseup touchend",s),t.start(n)}))}var jC=0,UC=function(n,t,e,o,r){var i,u="tox-crid-"+jC++,a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],c=["top","right","bottom","left"],s=function(n,t){return{x:t.x-n.x,y:t.y-n.y,w:t.w,h:t.h}}
function f(t,o,r,i){var u,a,c,f,l
u=o.x,a=o.y,c=o.w,f=o.h,u+=r*t.deltaX,a+=i*t.deltaY,(c+=r*t.deltaW)<20&&(c=20),(f+=i*t.deltaH)<20&&(f=20),l=n=RC.clamp({x:u,y:a,w:c,h:f},e,"move"===t.name),l=s(e,l),g.fire("updateRect",{rect:l}),m(l)}function l(n){function e(n,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),VC("#"+u+"-"+n,o).css({left:t.x,top:t.y,width:t.w,height:t.h})}HC.each(a,(function(t){VC("#"+u+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})})),e("top",{x:t.x,y:t.y,w:t.w,h:n.y-t.y}),e("right",{x:n.x+n.w,y:n.y,w:t.w-n.x-n.w+t.x,h:n.h}),e("bottom",{x:t.x,y:n.y+n.h,w:t.w,h:t.h-n.y-n.h+t.y}),e("left",{x:t.x,y:n.y,w:n.x-t.x,h:n.h}),e("move",n)}function d(t){l(n=t)}function m(n){var t,o
d((t=e,{x:(o=n).x+t.x,y:o.y+t.y,w:o.w,h:o.h}))}VC('<div id="'+u+'" class="tox-croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),HC.each(c,(function(n){VC("#"+u,o).append('<div id="'+u+"-"+n+'"class="tox-croprect-block" style="display: none" data-mce-bogus="all">')})),HC.each(a,(function(n){VC("#"+u,o).append('<div id="'+u+"-"+n.name+'" class="tox-croprect-handle tox-croprect-handle-'+n.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+n.label+'" aria-grabbed="false" title="'+n.label+'">')})),i=HC.map(a,(function(t){var e
return new LC(u,{document:o.ownerDocument,handle:u+"-"+t.name,start:function(){e=n},drag:function(n){f(t,e,n.deltaX,n.deltaY)}})})),l(n),VC(o).on("focusin focusout",(function(n){VC(n.target).attr("aria-grabbed","focus"===n.type?"true":"false")})),VC(o).on("keydown",(function(t){var e
function o(n,t,o,r,i){n.stopPropagation(),n.preventDefault(),f(e,o,r,i)}switch(HC.each(a,(function(n){if(t.target.id===u+"-"+n.name)return e=n,!1})),t.keyCode){case zC.LEFT:o(t,0,n,-10,0)
break
case zC.RIGHT:o(t,0,n,10,0)
break
case zC.UP:o(t,0,n,0,-10)
break
case zC.DOWN:o(t,0,n,0,10)
break
case zC.ENTER:case zC.SPACEBAR:t.preventDefault(),r()}}))
var g=HC.extend({toggleVisibility:function(n){var t=HC.map(a,(function(n){return"#"+u+"-"+n.name})).concat(HC.map(c,(function(n){return"#"+u+"-"+n}))).join(",")
n?VC(t,o).show():VC(t,o).hide()},setClampRect:function(t){e=t,l(n)},setRect:d,getInnerRect:function(){return s(e,n)},setInnerRect:m,setViewPortRect:function(e){t=e,l(n)},destroy:function(){HC.each(i,(function(n){n.destroy()})),i=[]}},PC)
return g},WC=function(n){var t=ip({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=ie(1),o=ie(v.none()),r=ie({x:0,y:0,w:1,h:1}),i=ie({x:0,y:0,w:1,h:1}),u=function(n,i){s.getOpt(n).each((function(n){var u=e.get(),a=Cu(n.element),c=hu(n.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"}
Gi(i,m),t.getOpt(n).each((function(n){Gi(n.element,m)})),o.get().each((function(n){var t=r.get()
n.setRect({x:t.x*u+l,y:t.y*u+d,w:t.w*u,h:t.h*u}),n.setClampRect({x:l,y:d,w:s,h:f}),n.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(n,t){var o,a=ae.fromTag("img")
return Vr(a,"src",t),(o=a.dom,new Cp((function(n){var t=function(){o.removeEventListener("load",t),n(o)}
o.complete?n(o):o.addEventListener("load",t)}))).then((function(){return s.getOpt(n).map((function(n){var t=fu({element:a})
og.replaceAt(n,1,v.some(t))
var o=i.get(),c={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight}
i.set(c)
var f=RC.inflate(c,-20,-20)
return r.set(f),o.w===c.w&&o.h===c.h||function(n,t){s.getOpt(n).each((function(n){var o=Cu(n.element),r=hu(n.element),i=t.dom.naturalWidth,u=t.dom.naturalHeight,a=Math.min(o/i,r/u)
a>=1?e.set(1):e.set(a)}))}(n,a),u(n,a),a}))}))},c=Sy.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:tc([rg("image-panel-crop-events",[ar((function(n){s.getOpt(n).each((function(n){var t=n.element.dom,i=UC({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,(function(){}))
i.toggleVisibility(!1),i.on("updateRect",(function(n){var t=n.rect,o=e.get(),i={x:Math.round(t.x/o),y:Math.round(t.y/o),w:Math.round(t.w/o),h:Math.round(t.h/o)}
r.set(i)})),o.set(v.some(i))}))}))])])}],containerBehaviours:tc([og.config({}),rg("image-panel-events",[ar((function(t){a(t,n)}))])])}),s=ip(c)
return{memContainer:s,updateSrc:a,zoom:function(n,t){var o=e.get(),r=t>0?Math.min(2,o+.1):Math.max(.1,o-.1)
e.set(r),s.getOpt(n).each((function(n){var t=n.components()[1].element
u(n,t)}))},showCrop:function(){o.get().each((function(n){n.toggleVisibility(!0)}))},hideCrop:function(){o.get().each((function(n){n.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var n=i.get()
return{width:n.w,height:n.h}}}},GC=function(n,t,e,o,r){return gC({name:n,icon:v.some(t),disabled:e,tooltip:v.some(n),primary:!1,borderless:!1},o,r)},XC=function(n,t){t?$h.enable(n):$h.disable(n)}
var YC,qC=function(n){var t=ie(n),e=ie(v.none()),o=function(){var n=[],t=-1
function e(){return t>0}function o(){return-1!==t&&t<n.length-1}return{data:n,add:function(e){var o=n.splice(++t)
return n.push(e),{state:e,removed:o}},undo:function(){if(e())return n[--t]},redo:function(){if(o())return n[++t]},canUndo:e,canRedo:o}}()
o.add(n)
var r=function(n){t.set(n)},i=function(n){return{blob:n,url:URL.createObjectURL(n)}},u=function(n){URL.revokeObjectURL(n.url)},a=function(){e.get().each(u),e.set(v.none())},c=function(n){var t=i(n)
r(t)
var e,a=o.add(t).removed
return e=a,HC.each(e,u),t.url}
return{getBlobState:function(){return t.get()},setBlobState:r,addBlobState:c,getTempState:function(){return e.get().fold((function(){return t.get()}),(function(n){return n}))},updateTempState:function(n){var t=i(n)
return a(),e.set(v.some(t)),t.url},addTempState:function(n){var t=i(n)
return e.set(v.some(t)),t.url},applyTempState:function(n){return e.get().fold((function(){}),(function(t){c(t.blob),n()}))},destroyTempState:a,undo:function(){var n=o.undo()
return r(n),n.url},redo:function(){var n=o.redo()
return r(n),n.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}},KC=function(t,e){var o=qC(t.currentState),r=function(n){var t=o.getHistoryStates()
m.updateButtonUndoStates(n,t.undoEnabled,t.redoEnabled),Go(n,FC.formActionEvent,{name:FC.saveState(),value:t.undoEnabled})},i=function(n){return n.toBlob()},u=function(n){Go(n,FC.formActionEvent,{name:FC.disable(),value:{}})},a=function(n){g.getApplyButton(n).each((function(n){$h.enable(n)})),Go(n,FC.formActionEvent,{name:FC.enable(),value:{}})},c=function(n,t){return u(n),d.updateSrc(n,t)},s=function(n,t,e,o,s){return u(n),function(n){return yk(n)}(t).then(e).then(i).then(o).then((function(t){return c(n,t).then((function(t){return r(n),s(),a(n),t}))})).catch((function(t){return console.log(t),a(n),t}))},f=function(n,t,e){var r=o.getBlobState().blob
s(n,r,t,(function(n){return o.updateTempState(n)}),e)},l=function(n){var t=o.getBlobState().url
return o.destroyTempState(),r(n),t},d=WC(t.currentState.url),m=function(n){var t=ip(GC("Undo","undo",!0,(function(n){Go(n,BC.undo(),{direction:1})}),n)),e=ip(GC("Redo","redo",!0,(function(n){Go(n,BC.redo(),{direction:1})}),n))
return{container:Sy.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[t.asSpec(),e.asSpec(),GC("Zoom in","zoom-in",!1,(function(n){Go(n,BC.zoom(),{direction:1})}),n),GC("Zoom out","zoom-out",!1,(function(n){Go(n,BC.zoom(),{direction:-1})}),n)]}),updateButtonUndoStates:function(n,o,r){t.getOpt(n).each((function(n){XC(n,o)})),e.getOpt(n).each((function(n){XC(n,r)}))}}}(e),g=IC(d,e)
return{dom:{tag:"div",attributes:{role:"presentation"}},components:[g.memContainer.asSpec(),d.memContainer.asSpec(),m.container],behaviours:tc([Rf.config({store:{mode:"manual",getValue:function(){return o.getBlobState()}}}),rg("image-tools-events",[Zo(BC.undo(),(function(n,t){var e=o.undo()
c(n,e).then((function(t){a(n),r(n)}))})),Zo(BC.redo(),(function(n,t){var e=o.redo()
c(n,e).then((function(t){a(n),r(n)}))})),Zo(BC.zoom(),(function(n,t){var e=t.event.direction
d.zoom(n,e)})),Zo(BC.back(),(function(n,t){(function(n){var t=l(n)
c(n,t).then((function(t){a(n)}))})(n),(0,t.event.swap)(),d.hideCrop()})),Zo(BC.apply(),(function(n,t){o.applyTempState((function(){l(n),(0,t.event.swap)()}))})),Zo(BC.transform(),(function(t,e){return f(t,e.event.transform,n)})),Zo(BC.tempTransform(),(function(t,e){return function(t,e){var r=o.getTempState().blob
s(t,r,e,(function(n){return o.addTempState(n)}),n)}(t,e.event.transform)})),Zo(BC.transformApply(),(function(n,t){return function(n,t,e){var r=o.getBlobState().blob
s(n,r,t,(function(t){var e=o.addBlobState(t)
return l(n),e}),e)}(n,t.event.transform,t.event.swap)})),Zo(BC.swap(),(function(n,t){(function(n){m.updateButtonUndoStates(n,!1,!1)})(n)
var e=t.event.transform,o=t.event.swap
e.fold((function(){o()}),(function(t){f(n,t,o)}))}))]),zS()])}},JC=function(n){return!Tn(n,"items")},$C="data-value",QC=function(n,t,e,o){return P(e,(function(e){return JC(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Rf.setValue(n,e.value),Go(n,Iy,{name:t}),sg.focus(n)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return QC(n,t,e.items,o)}}}))},ZC=function(n,t){return nn(n,(function(n){return JC(n)?function(n,t){return n?v.some(t):v.none()}(n.value===t,n):ZC(n.items,t)}))},nO=Nl({name:"HtmlSelect",configFields:[Rt("options"),Vf("selectBehaviours",[sg,Rf]),Jt("selectClasses",[]),Jt("selectAttributes",{}),Wt("data")],factory:function(n,t){var e=P(n.options,(function(n){return{dom:{tag:"option",value:n.value,innerHtml:n.text}}})),o=n.data.map((function(n){return Wn("initialValue",n)})).getOr({})
return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Hf(n.selectBehaviours,[sg.config({}),Rf.config({store:f({mode:"manual",getValue:function(n){return nu(n.element)},setValue:function(t,e){U(n.options,(function(n){return n.value===e})).isSome()&&tu(t.element,e)}},o)})])}}}),tO=function(n,t){var o=n.label.map((function(n){return Fy(n,t)})),r=[$h.config({disabled:function(){return n.disabled||t.isReadOnly()}}),Tv(),Qm.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(n){return Wo(n,Hy),v.some(!0)}}),rg("textfield-change",[Zo(lo(),(function(t,e){Go(t,Iy,{name:n.name})})),Zo(wo(),(function(t,e){Go(t,Iy,{name:n.name})}))]),By.config({})],i=n.validation.map((function(n){return gx.config({getRoot:function(n){return wr(n.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var e=Rf.getValue(t),o=n.validator(e)
return rx(!0===o?on.value(e):on.error(o))},validateOnLoad:n.validateOnLoad}})})).toArray(),u=n.placeholder.fold(e({}),(function(n){return{placeholder:t.translate(n)}})),a=n.inputMode.fold(e({}),(function(n){return{inputmode:n}})),c=f(f({},u),a),s=_y.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:c,inputClasses:[n.classname],inputBehaviours:tc(G([r,i])),selectOnFocus:!1,factory:qy}),l=(n.flex?["tox-form__group--stretched"]:[]).concat(n.maximized?["tox-form-group--maximize"]:[]),d=[$h.config({disabled:function(){return n.disabled||t.isReadOnly()},onDisabled:function(n){_y.getField(n).each($h.disable)},onEnabled:function(n){_y.getField(n).each($h.enable)}}),Tv()]
return Dy(o,s,l,d)},eO=Object.freeze({__proto__:null,events:function(n,t){var e=n.stream.streams.setup(n,t)
return Jo([Zo(n.event,e),cr((function(){return t.cancel()}))].concat(n.cancelEvent.map((function(n){return[Zo(n,(function(){return t.cancel()}))]})).getOr([])))}}),oO=function(n){var t=ie(null)
return fi({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(n){t.set(n)},cancel:function(){var n=t.get()
null!==n&&n.cancel()}})},rO=Object.freeze({__proto__:null,throttle:oO,init:function(n){return n.stream.streams.state(n)}}),iO=[Vt("stream",Ot("mode",{throttle:[Rt("delay"),Jt("stopEvent",!0),pa("streams",{setup:function(n,t){var e=n.stream,o=mp(n.onStream,e.delay)
return t.setTimer(o),function(n,t){o.throttle(n,t),e.stopEvent&&t.stop()}},state:oO})]})),Jt("event","input"),Wt("cancelEvent"),ma("onStream")],uO=oc({fields:iO,name:"streaming",active:eO,state:rO}),aO=function(n,t,e){var o=Rf.getValue(e)
Rf.setValue(t,o),sO(t)},cO=function(n,t){var e=n.element,o=nu(e),r=e.dom
"number"!==Pr(e,"type")&&t(r,o)},sO=function(n){cO(n,(function(n,t){return n.setSelectionRange(t.length,t.length)}))},fO=function(n,t,e){if(n.selectsOver){var o=Rf.getValue(t),r=n.getDisplayText(o),i=Rf.getValue(e)
return 0===n.getDisplayText(i).indexOf(r)?v.some((function(){aO(0,t,e),function(n,t){cO(n,(function(n,e){return n.setSelectionRange(t,e.length)}))}(t,r.length)})):v.none()}return v.none()},lO=e("alloy.typeahead.itemexecute"),dO=e([Wt("lazySink"),Rt("fetch"),Jt("minChars",5),Jt("responseTime",1e3),la("onOpen"),Jt("getHotspot",v.some),Jt("getAnchorOverrides",e({})),Jt("layouts",v.none()),Jt("eventOrder",{}),oe("model",{},[Jt("getDisplayText",(function(n){return void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.value})),Jt("selectsOver",!0),Jt("populateFromBrowse",!0)]),la("onSetValue"),da("onExecute"),la("onItemExecute"),Jt("inputClasses",[]),Jt("inputAttributes",{}),Jt("inputStyles",{}),Jt("matchWidth",!0),Jt("useMinWidth",!1),Jt("dismissOnBlur",!0),sa(["openClass"]),Wt("initialData"),Vf("typeaheadBehaviours",[sg,Rf,uO,Qm,wg,vx]),re("previewing",(function(){return ie(!0)}))].concat(Wy()).concat(Bx())),mO=e([dl({schema:[ca()],name:"menu",overrides:function(n){return{fakeFocus:!0,onHighlight:function(t,e){n.previewing.get()?t.getSystem().getByUid(n.uid).each((function(o){fO(n.model,o,e).fold((function(){return od.dehighlight(t,e)}),(function(n){return n()}))})):t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&aO(n.model,t,e)})),n.previewing.set(!1)},onExecute:function(t,e){return t.getSystem().getByUid(n.uid).toOptional().map((function(n){return Go(n,lO(),{item:e}),!0}))},onHover:function(t,e){n.previewing.set(!1),t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&aO(n.model,t,e)}))}}}})]),gO=Ll({name:"Typeahead",configFields:dO(),partFields:mO(),factory:function(t,e,o,r){var i=function(e,o,i){t.previewing.set(!1)
var u=vx.getCoupled(e,"sandbox")
if(pf.isOpen(u))Xl.getCurrent(u).each((function(n){od.getHighlighted(n).fold((function(){i(n)}),(function(){Ko(u,n.element,"keydown",o)}))}))
else{wx(t,a(e),e,u,r,(function(n){Xl.getCurrent(n).each(i)}),$y.HighlightFirst).get(n)}},u=Gy(t),a=function(n){return function(t){return t.map((function(t){var e=On(t.menus),o=X(e,(function(n){return N(n.items,(function(n){return"item"===n.type}))}))
return Rf.getState(n).update(P(o,(function(n){return n.data}))),t}))}},c=[sg.config({}),Rf.config({onSetValue:t.onSetValue,store:f({mode:"dataset",getDataKey:function(n){return nu(n.element)},getFallbackEntry:function(n){return{value:n,meta:{}}},setValue:function(n,e){tu(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(n){return Wn("initialValue",n)})).getOr({}))}),uO.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(e,o){var i=vx.getCoupled(e,"sandbox")
if(sg.isFocused(e)&&nu(e.element).length>=t.minChars){var u=Xl.getCurrent(i).bind((function(n){return od.getHighlighted(n).map(Rf.getValue)}))
t.previewing.set(!0)
wx(t,a(e),e,i,r,(function(n){Xl.getCurrent(i).each((function(n){u.fold((function(){t.model.selectsOver&&od.highlightFirst(n)}),(function(t){od.highlightBy(n,(function(n){return Rf.getValue(n).value===t.value})),od.getHighlighted(n).orThunk((function(){return od.highlightFirst(n),v.none()}))}))}))}),$y.HighlightFirst).get(n)}},cancelEvent:Eo()}),Qm.config({mode:"special",onDown:function(n,t){return i(n,t,od.highlightFirst),v.some(!0)},onEscape:function(n){var t=vx.getCoupled(n,"sandbox")
return pf.isOpen(t)?(pf.close(t),v.some(!0)):v.none()},onUp:function(n,t){return i(n,t,od.highlightLast),v.some(!0)},onEnter:function(n){var e=vx.getCoupled(n,"sandbox"),o=pf.isOpen(e)
if(o&&!t.previewing.get())return Xl.getCurrent(e).bind((function(n){return od.getHighlighted(n)})).map((function(t){return Go(n,lO(),{item:t}),!0}))
var r=Rf.getValue(n)
return Wo(n,Eo()),t.onExecute(e,n,r),o&&pf.close(e),v.some(!0)}}),wg.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),vx.config({others:{sandbox:function(n){return Tx(t,n,{onOpen:function(){return wg.on(n)},onClose:function(){return wg.off(n)}})}}}),rg("typeaheadevents",[fr((function(e){var o=n
kx(t,a(e),e,r,o,$y.HighlightFirst).get(n)})),Zo(lO(),(function(n,e){var o=vx.getCoupled(n,"sandbox")
aO(t.model,n,e.event.item),Wo(n,Eo()),t.onItemExecute(n,o,e.event.item,Rf.getValue(n)),pf.close(o),sO(n)}))].concat(t.dismissOnBlur?[Zo(xo(),(function(n){var t=vx.getCoupled(n,"sandbox")
lc(t.element).isNone()&&pf.close(t)}))]:[]))]
return{uid:t.uid,dom:Yy(Mn(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:f(f({},u),Hf(t.typeaheadBehaviours,c)),eventOrder:t.eventOrder}}}),pO=function(n){return f(f({},n),{toCached:function(){return pO(n.toCached())},bindFuture:function(t){return pO(n.bind((function(n){return n.fold((function(n){return rx(on.error(n))}),(function(n){return t(n)}))})))},bindResult:function(t){return pO(n.map((function(n){return n.bind(t)})))},mapResult:function(t){return pO(n.map((function(n){return n.map(t)})))},mapError:function(t){return pO(n.map((function(n){return n.mapError(t)})))},foldResult:function(t,e){return n.map((function(n){return n.fold(t,e)}))},withTimeout:function(t,e){return pO(ox((function(o){var r=!1,i=setTimeout((function(){r=!0,o(on.error(e()))}),t)
n.get((function(n){r||(clearTimeout(i),o(n))}))})))}})},hO=function(n){return pO(ox(n))},vO=hO,bO={type:"separator"},yO=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:function(){}}},xO=function(n,t){return{type:"menuitem",value:t,text:n,meta:{attach:void 0},onAction:function(){}}},wO=function(n,t){return function(n){return P(n,yO)}(function(n,t){return N(t,(function(t){return t.type===n}))}(n,t))},SO=function(n){return wO("header",n.targets)},kO=function(n){return wO("anchor",n.targets)},CO=function(n){return v.from(n.anchorTop).map((function(n){return xO("<top>",n)})).toArray()},OO=function(n){return v.from(n.anchorBottom).map((function(n){return xO("<bottom>",n)})).toArray()},_O=function(n,t){var e=n.toLowerCase()
return N(t,(function(n){var t=void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.text
return ge(t.toLowerCase(),e)||ge(n.value.toLowerCase(),e)}))},TO=function(n,t,e){var o=Rf.getValue(t),r=void 0!==o.meta.text?o.meta.text:o.value
return e.getLinkInformation().fold((function(){return[]}),(function(t){var o,i=_O(r,function(n){return P(n,(function(n){return xO(n,n)}))}(e.getHistory(n)))
return"file"===n?(o=[i,_O(r,SO(t)),_O(r,G([CO(t),kO(t),OO(t)]))],j(o,(function(n,t){return 0===n.length||0===t.length?n.concat(t):n.concat(bO,t)}),[])):i}))},EO=Yr("aria-invalid"),BO=function(n){return function(t,e,o){return _n(e,"name").fold((function(){return n(e,o)}),(function(r){return t.field(r,n(e,o))}))}},DO={bar:BO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:P(n.items,t.interpreter)}}(n,t.shared)})),collection:BO((function(n,t){return Uy(n,t.shared.providers)})),alertbanner:BO((function(n,t){return function(n,t){return Sy.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[rp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:ap(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(t){Go(t,Py,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]})}(n,t.shared.providers)})),input:BO((function(n,t){return function(n,t){return tO({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:v.none(),maximized:n.maximized},t)}(n,t.shared.providers)})),textarea:BO((function(n,t){return function(n,t){return tO({name:n.name,multiline:!0,label:n.label,inputMode:v.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:v.none(),maximized:n.maximized},t)}(n,t.shared.providers)})),label:BO((function(n,t){return function(n,t){var e={dom:{tag:"label",innerHtml:t.providers.translate(n.label),classes:["tox-label"]}},o=P(n.items,t.interpreter)
return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:tc([zS(),og.config({}),JS(v.none()),Qm.config({mode:"acyclic"})])}}(n,t.shared)})),iframe:function(n){return function(t,e,o){var r=Mn(e,{source:"dynamic"})
return BO(n)(t,r,o)}}((function(n,t){return ak(n,t.shared.providers)})),button:BO((function(n,t){return yC(n,t.shared.providers)})),checkbox:BO((function(n,t){return function(n,t){var e=Rf.config({store:{mode:"manual",getValue:function(n){return n.element.dom.checked},setValue:function(n,t){n.element.dom.checked=t}}}),r=function(n){return n.element.dom.click(),v.some(!0)},i=_y.parts.field({factory:{sketch:o},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:tc([zS(),$h.config({disabled:function(){return n.disabled||t.isReadOnly()}}),By.config({}),sg.config({}),e,Qm.config({mode:"special",onEnter:r,onSpace:r,stopSpaceKeyup:!0}),rg("checkbox-events",[Zo(mo(),(function(t,e){Go(t,Iy,{name:n.name})}))])])}),u=_y.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(n.label)},behaviours:tc([Ix.config({})])}),a=function(n){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+n],innerHtml:ap("checked"===n?"selected":"unselected",t.icons)}}},c=ip({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]})
return _y.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[i,c.asSpec(),u],fieldBehaviours:tc([$h.config({disabled:function(){return n.disabled||t.isReadOnly()},disableClass:"tox-checkbox--disabled",onDisabled:function(n){_y.getField(n).each($h.disable)},onEnabled:function(n){_y.getField(n).each($h.enable)}}),Tv()])})}(n,t.shared.providers)})),colorinput:BO((function(n,t){return Hx(n,t.shared,t.colorinput)})),colorpicker:BO((function(n){var t=function(n){return"tox-"+n},e=HS(US,t),o=ip(e.sketch({dom:{tag:"div",classes:[t("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(n){Go(n,Py,{name:"hex-valid",value:!0})},onInvalidHex:function(n){Go(n,Py,{name:"hex-valid",value:!1})}}))
return{dom:{tag:"div"},components:[o.asSpec()],behaviours:tc([Rf.config({store:{mode:"manual",getValue:function(n){var t=o.get(n)
return Xl.getCurrent(t).bind((function(n){return Rf.getValue(n).hex})).map((function(n){return"#"+n})).getOr("")},setValue:function(n,t){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t),r=o.get(n)
Xl.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(n){Rf.setValue(n,{hex:v.from(e[1]).getOr("")}),AS.getField(n,"hex").each((function(n){Wo(n,lo())}))}))}}}),zS()])}})),dropzone:BO((function(n,t){return QS(n,t.shared.providers)})),grid:BO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:P(n.items,t.interpreter)}}(n,t.shared)})),listbox:BO((function(t,o){return function(t,o){var r=o.shared.providers,i=$(t.items).filter(JC),u=t.label.map((function(n){return Fy(n,r)})),a={dom:{tag:"div",classes:["tox-listboxfield"]},components:[_y.parts.field({dom:{},factory:{sketch:function(r){return eC({uid:r.uid,text:i.map((function(n){return n.text})),icon:v.none(),tooltip:t.label,role:v.none(),fetch:function(n,e){var r=QC(n,t.name,t.items,Rf.getValue(n))
e(cC(r,Jp.CLOSE_ON_EXECUTE,o,!1))},onSetup:e(n),getApi:e({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[By.config({}),Rf.config({store:{mode:"manual",initialValue:i.map((function(n){return n.value})).getOr(""),getValue:function(n){return Pr(n.element,$C)},setValue:function(n,e){ZC(t.items,e).each((function(t){Vr(n.element,$C,t.value),Go(n,nC,{text:t.text})}))}}})]},"tox-listbox",o.shared)}}})]}
return _y.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:G([u.toArray(),[a]]),fieldBehaviours:tc([$h.config({disabled:e(t.disabled),onDisabled:function(n){_y.getField(n).each($h.disable)},onEnabled:function(n){_y.getField(n).each($h.enable)}})])})}(t,o)})),selectbox:BO((function(n,t){return function(n,t){var e=P(n.items,(function(n){return{text:t.translate(n.text),value:n.value}})),o=n.label.map((function(n){return Fy(n,t)})),r=_y.parts.field({dom:{},selectAttributes:{size:n.size},options:e,factory:nO,selectBehaviours:tc([$h.config({disabled:function(){return n.disabled||t.isReadOnly()}}),By.config({}),rg("selectbox-change",[Zo(mo(),(function(t,e){Go(t,Iy,{name:n.name})}))])])}),i=n.size>1?v.none():v.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:ap("chevron-down",t.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:G([[r],i.toArray()])}
return _y.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:G([o.toArray(),[u]]),fieldBehaviours:tc([$h.config({disabled:function(){return n.disabled||t.isReadOnly()},onDisabled:function(n){_y.getField(n).each($h.disable)},onEnabled:function(n){_y.getField(n).each($h.enable)}}),Tv()])})}(n,t.shared.providers)})),sizeinput:BO((function(n,t){return EC(n,t.shared.providers)})),urlinput:BO((function(t,e){return function(t,e,o){var r,i=e.shared.providers,u=function(n){var e=Rf.getValue(n)
o.addToHistory(e.value,t.filetype)},a=_y.parts.field({factory:gO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":EO,type:"url"},minChars:0,responseTime:0,fetch:function(n){var r=TO(t.filetype,n,o),i=cC(r,Jp.BUBBLE_TO_SANDBOX,e,!1)
return rx(i)},getHotspot:function(n){return g.getOpt(n)},onSetValue:function(t,e){t.hasConfigured(gx)&&gx.run(t).get(n)},typeaheadBehaviours:tc(G([o.getValidationHandler().map((function(n){return gx.config({getRoot:function(n){return wr(n.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(n,t){s.getOpt(n).each((function(n){Vr(n.element,"title",i.translate(t))}))}},validator:{validate:function(e){var o=Rf.getValue(e)
return vO((function(e){n({type:t.filetype,url:o.value},(function(n){if("invalid"===n.status){var t=on.error(n.message)
e(t)}else{var o=on.value(n.message)
e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[$h.config({disabled:function(){return t.disabled||i.isReadOnly()}}),By.config({}),rg("urlinput-events",G(["file"===t.filetype?[Zo(lo(),(function(n){Go(n,Iy,{name:t.name})}))]:[],[Zo(mo(),(function(n){Go(n,Iy,{name:t.name}),u(n)})),Zo(wo(),(function(n){Go(n,Iy,{name:t.name}),u(n)}))]]))]])),eventOrder:(r={},r[lo()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(n){return n.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:lh(0,0,"normal")},onExecute:function(n,t,e){Go(t,Hy,{})},onItemExecute:function(n,e,o,r){u(n),Go(n,Iy,{name:t.name})}}),c=t.label.map((function(n){return Fy(n,i)})),s=ip(function(n,t,e,o){return void 0===e&&(e=n),void 0===o&&(o=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:ap(e,i.icons),attributes:f({title:i.translate(o),"aria-live":"polite"},t.fold((function(){return{}}),(function(n){return{id:n}})))}}}("invalid",v.some(EO),"warning")),l=ip({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]}),d=o.getUrlPicker(t.filetype),m=Yr("browser.url.event"),g=ip({dom:{tag:"div",classes:["tox-control-wrap"]},components:[a,l.asSpec()],behaviours:tc([$h.config({disabled:function(){return t.disabled||i.isReadOnly()}})])}),p=ip(hC({name:t.name,icon:v.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(n){return Wo(n,m)}),i,[],["tox-browse-url"]))
return _y.sketch({dom:My([]),components:c.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:G([[g.asSpec()],d.map((function(){return p.asSpec()})).toArray()])}]),fieldBehaviours:tc([$h.config({disabled:function(){return t.disabled||i.isReadOnly()},onDisabled:function(n){_y.getField(n).each($h.disable),p.getOpt(n).each($h.disable)},onEnabled:function(n){_y.getField(n).each($h.enable),p.getOpt(n).each($h.enable)}}),Tv(),rg("url-input-events",[Zo(m,(function(n){Xl.getCurrent(n).each((function(e){var o=Rf.getValue(e),r=f({fieldname:t.name},o)
d.each((function(o){o(r).get((function(o){Rf.setValue(e,o),Go(n,Iy,{name:t.name})}))}))}))}))])])})}(t,e,e.urlinput)})),customeditor:BO((function(n){var t=ie(v.none()),e=ip({dom:{tag:n.tag}}),o=ie(v.none())
return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:tc([rg("custom-editor-events",[ar((function(r){e.getOpt(r).each((function(e){(!function(n){return Object.prototype.hasOwnProperty.call(n,"init")}(n)?WS.load(n.scriptId,n.scriptUrl).then((function(t){return t(e.element.dom,n.settings)})):n.init(e.element.dom)).then((function(n){o.get().each((function(t){n.setValue(t)})),o.set(v.none()),t.set(v.some(n))}))}))}))]),Rf.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return o.get().getOr("")}),(function(n){return n.getValue()}))},setValue:function(n,e){t.get().fold((function(){o.set(v.some(e))}),(function(n){return n.setValue(e)}))}}}),zS()]),components:[e.asSpec()]}})),htmlpanel:BO((function(n){return"presentation"===n.presets?Sy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html}}):Sy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html,attributes:{role:"document"}},containerBehaviours:tc([By.config({}),sg.config({})])})})),imagetools:BO((function(n,t){return KC(n,t.shared.providers)})),table:BO((function(n,t){return function(n,t){var e,o,r=function(n){return{dom:{tag:"th",innerHtml:t.translate(n)}}},i=function(n){return{dom:{tag:"td",innerHtml:t.translate(n)}}},u=function(n){return{dom:{tag:"tr"},components:P(n,i)}}
return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(o=n.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:P(o,r)}]}),(e=n.cells,{dom:{tag:"tbody"},components:P(e,u)})],behaviours:tc([By.config({}),sg.config({})])}}(n,t.shared.providers)})),panel:BO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:n.classes},components:P(n.items,t.shared.interpreter)}}(n,t)}))},AO={field:function(n,t){return t}},MO=function(n,t,e){var o=Mn(e,{shared:{interpreter:function(t){return FO(n,t,o)}}})
return FO(n,t,o)},FO=function(n,t,e){return _n(DO,t.type).fold((function(){return console.error('Unknown factory type "'+t.type+'", defaulting to container: ',t),t}),(function(o){return o(n,t,e)}))},IO={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},RO=function(n,t,e){var o=Rc(-12,12,IO),r={maxHeightFunction:Ac()}
return function(){return e()?{anchor:"node",root:Vi(n()),node:v.from(n()),bubble:o,layouts:{onRtl:function(){return[np]},onLtr:function(){return[Zg]}},overrides:r}:{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[Ra]},onLtr:function(){return[Va]}},overrides:r}}},VO=function(n,t,e){return function(){return e()?{anchor:"node",root:Vi(n()),node:v.from(n()),layouts:{onRtl:function(){return[tp]},onLtr:function(){return[tp]}}}:{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[Na]},onLtr:function(){return[Na]}}}}},PO=function(n,t){return function(){return{anchor:"selection",root:t(),getSelection:function(){var t=n.selection.getRng()
return v.some(Kc.range(ae.fromDom(t.startContainer),t.startOffset,ae.fromDom(t.endContainer),t.endOffset))}}}},HO=function(n){return function(t){return{anchor:"node",root:n(),node:t}}},zO=function(n,t,e){var o=hv(n),r=function(){return ae.fromDom(n.getBody())},i=function(){return ae.fromDom(n.getContentAreaContainer())},u=function(){return o||!e()}
return{inlineDialog:RO(i,t,u),banner:VO(i,t,u),cursor:PO(n,r),node:HO(r)}},NO=function(n){return function(t,e){Rb(n)(t,e)}},LO=function(n){return function(){return Ob(n)}},jO=function(n){return function(){return _b(n)}},UO=function(n){return function(){return Eb(n)}},WO=function(n){return{colorPicker:NO(n),hasCustomColors:LO(n),getColors:jO(n),getColorCols:UO(n)}},GO=function(n){return function(){return function(n){return n.getParam("draggable_modal",!1,"boolean")}(n)}},XO=function(n){return{isDraggableModal:GO(n)}},YO=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],qO=function(n){return j(n,(function(n,t){if(Tn(t,"items")){var e=qO(t.items)
return{customFormats:n.customFormats.concat(e.customFormats),formats:n.formats.concat([{title:t.title,items:e.formats}])}}if(function(n){return Tn(n,"inline")}(t)||function(n){return Tn(n,"block")}(t)||function(n){return Tn(n,"selector")}(t)){var o="custom-"+t.title.toLowerCase()
return{customFormats:n.customFormats.concat([{name:o,format:t}]),formats:n.formats.concat([{title:t.title,format:o,icon:t.icon}])}}return f(f({},n),{formats:n.formats.concat(t)})}),{customFormats:[],formats:[]})},KO=function(n){return function(n){return v.from(n.getParam("style_formats")).filter(S)}(n).map((function(t){var e=function(n,t){var e=qO(t),o=function(t){H(t,(function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)}))}
return n.formatter?o(e.customFormats):n.on("init",(function(){o(e.customFormats)})),e.formats}(n,t)
return function(n){return n.getParam("style_formats_merge",!1,"boolean")}(n)?YO.concat(e):e})).getOr(YO)},JO=function(n,t,e){var o={type:"formatter",isSelected:t(n.format),getStylePreview:e(n.format)}
return Mn(n,o)},$O=function(n,t,e,o){var r=function(t){return P(t,(function(t){var i=vn(t)
if(En(t,"items")){var u=r(t.items)
return Mn(function(n){return Mn(n,{type:"submenu"})}(t),{getStyleItems:function(){return u}})}return En(t,"format")?function(n){return JO(n,e,o)}(t):1===i.length&&F(i,"title")?Mn(t,{type:"separator"}):function(t){var r=Yr(t.title),i={type:"formatter",format:r,isSelected:e(r),getStylePreview:o(r)},u=Mn(t,i)
return n.formatter.register(r,u),u}(t)}))}
return r(t)},QO=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t)
return void 0!==e?v.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):v.none()}},o=function(n){var t=n.items
return void 0!==t&&t.length>0?X(t,o):[n.format]},r=ie([]),i=ie([]),u=ie([]),a=ie([]),c=ie(!1)
n.on("PreInit",(function(u){var a=KO(n),c=$O(n,a,t,e)
r.set(c),i.set(X(c,o))})),n.on("addStyleModifications",(function(r){var i=$O(n,r.items,t,e)
u.set(i),c.set(r.replace),a.set(X(i,o))}))
return{getData:function(){var n=c.get()?[]:r.get(),t=u.get()
return n.concat(t)},getFlattenedKeys:function(){var n=c.get()?[]:i.get(),t=a.get()
return n.concat(t)}}},ZO=HC.trim,n_=function(n){return function(t){if(t&&1===t.nodeType){if(t.contentEditable===n)return!0
if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},t_=n_("true"),e_=n_("false"),o_=function(n,t,e,o,r){return{type:n,title:t,url:e,level:o,attach:r}},r_=function(n){return n.innerText||n.textContent},i_=function(n){return function(n){return n&&"A"===n.nodeName&&void 0!==(n.id||n.name)}(n)&&a_(n)},u_=function(n){return n&&/^(H[1-6])$/.test(n.nodeName)},a_=function(n){return function(n){for(;n=n.parentNode;){var t=n.contentEditable
if(t&&"inherit"!==t)return t_(n)}return!1}(n)&&!e_(n)},c_=function(n){return u_(n)&&a_(n)},s_=function(n){var t=function(n){return n.id?n.id:Yr("h")}(n)
return o_("header",r_(n),"#"+t,function(n){return u_(n)?parseInt(n.nodeName.substr(1),10):0}(n),(function(){n.id=t}))},f_=function(t){var e=t.id||t.name,o=r_(t)
return o_("anchor",o||"#"+e,"#"+e,0,n)},l_=function(n){var t,e
return t="h1,h2,h3,h4,h5,h6,a:not([href])",e=n,P(as(ae.fromDom(e),t),(function(n){return n.dom}))},d_=function(n){return ZO(n.title).length>0},m_=function(n){var t=l_(n)
return N(function(n){return P(N(n,c_),s_)}(t).concat(function(n){return P(N(n,i_),f_)}(t)),d_)},g_="tinymce-url-history",p_=function(n){return x(n)&&/^https?/.test(n)},h_=function(n){return w(n)&&Cn(n,(function(n){return!(S(t=n)&&t.length<=5&&Y(t,p_))
var t})).isNone()},v_=function(){var n,t=xb.getItem(g_)
if(null===t)return{}
try{n=JSON.parse(t)}catch(e){if(e instanceof SyntaxError)return console.log("Local storage "+g_+" was not valid JSON",e),{}
throw e}return h_(n)?n:(console.log("Local storage "+g_+" was not valid format",n),{})},b_=function(n){var t=v_()
return Object.prototype.hasOwnProperty.call(t,n)?t[n]:[]},y_=function(n,t){if(p_(n)){var e=v_(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=N(o,(function(t){return t!==n}))
e[t]=[n].concat(r).slice(0,5),function(n){if(!h_(n))throw new Error("Bad format for history:\n"+JSON.stringify(n))
xb.setItem(g_,JSON.stringify(n))}(e)}},x_=function(n){return!!n},w_=function(n){return xn(HC.makeMap(n,/[, ]/),x_)},S_=function(n){return v.from(function(n){return n.getParam("file_picker_callback")}(n)).filter(_)},k_=function(n,t){var e=function(n){var t=v.some(function(n){return n.getParam("file_picker_types")}(n)).filter(x_),e=v.some(function(n){return n.getParam("file_browser_callback_types")}(n)).filter(x_),o=t.or(e).map(w_)
return S_(n).fold((function(){return!1}),(function(n){return o.fold((function(){return!0}),(function(n){return vn(n).length>0&&n}))}))}(n)
return k(e)?e?S_(n):v.none():e[t]?S_(n):v.none()},C_=function(n){return v.from(n).filter(x).getOrUndefined()},O_=function(n){return{getHistory:b_,addToHistory:y_,getLinkInformation:function(){return function(n){return function(n){return!1===n.getParam("typeahead_urls")}(n)?v.none():v.some({targets:m_(n.getBody()),anchorTop:C_(wv(n)),anchorBottom:C_(Sv(n))})}(n)},getValidationHandler:function(){return function(n){return v.from(function(n){var t=n.getParam("file_picker_validator_handler",void 0,"function")
return void 0===t?n.getParam("filepicker_validator_handler",void 0,"function"):t}(n))}(n)},getUrlPicker:function(t){return function(n,t){return k_(n,t).map((function(e){return function(o){return ox((function(r){var i=f({filetype:t,fieldname:o.fieldname},v.from(o.meta).getOr({}))
e.call(n,(function(n,t){if(!x(n))throw new Error("Expected value to be string")
if(void 0!==t&&!w(t))throw new Error("Expected meta to be a object")
r({value:n,meta:t})}),o.value,i)}))}}))}(n,t)}}},__=function(n,t,e){var o=ie(!1),r=function(n){var t=ie(gv(n)?"bottom":"top")
return{isPositionedAtTop:function(){return"top"===t.get()},getDockingMode:t.get,setDockingMode:t.set}}(t),i={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:Ph.translate,isReadOnly:function(){return t.mode.isReadOnly()}},interpreter:function(n){return function(n,t){return FO(AO,n,t)}(n,i)},anchors:zO(t,e,r.isPositionedAtTop),header:r,getSink:function(){return on.value(n)}},urlinput:O_(t),styleselect:QO(t),colorinput:WO(t),dialog:XO(t),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(n){return o.set(n)}}
return i},T_=e((function(n,t){(function(n,t){var e=ku.max(n,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"])
Wi(n,"max-width",e+"px")})(n,Math.floor(t))})),E_="contexttoolbar-hide",B_=e([Rt("dom"),Jt("shell",!0),Vf("toolbarBehaviours",[og])]),D_=e([ml({name:"groups",overrides:function(){return{behaviours:tc([og.config({})])}}})]),A_=Ll({name:"Toolbar",configFields:B_(),partFields:D_(),factory:function(n,t,e,o){var r=function(t){return n.shell?v.some(t):Ol(t,n,"groups")},i=n.shell?{behaviours:[og.config({})],components:[]}:{behaviours:[],components:t}
return{uid:n.uid,dom:n.dom,components:i.components,behaviours:Hf(n.toolbarBehaviours,i.behaviours),apis:{setGroups:function(n,t){r(n).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){og.set(n,t)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),M_=function(n,t,e){return{within:n,extra:t,withinWidth:e}},F_=function(n,t,o){var r,i=(r=function(n,t){var e=o(n)
return v.some({element:n,start:t,finish:t+e,width:e})},j(n,(function(n,t){return r(t,n.len).fold(e(n),(function(t){return{len:t.finish,list:n.list.concat([t])}}))}),{len:0,list:[]}).list),u=N(i,(function(n){return n.finish<=t})),a=L(u,(function(n,t){return n+t.width}),0)
return{within:u,extra:i.slice(u.length),withinWidth:a}},I_=function(n){return P(n,(function(n){return n.element}))},R_=function(n,t,e,o){var r=function(n,t,e){var o=F_(t,n,e)
return 0===o.extra.length?v.some(o):v.none()}(n,t,e).getOrThunk((function(){return F_(t,n-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth
return 1===u.length&&u[0].width<=e(o)?function(n,t,e){var o=I_(n.concat(t))
return M_(o,[],e)}(i,u,a):u.length>=1?function(n,t,e,o){var r=I_(n).concat([e])
return M_(r,I_(t),o)}(i,u,o,a):function(n,t,e){return M_(I_(n),[],e)}(i,0,a)},V_=function(n,t){var e=P(t,(function(n){return mu(n)}))
A_.setGroups(n,e)},P_=function(n,t,e){var o=_l(n,t,"primary"),r=vx.getCoupled(n,"overflowGroup")
Wi(o.element,"visibility","hidden")
var i=t.builtGroups.get().concat([r]),u=nn(i,(function(n){return lc(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}))
e([]),V_(o,i)
var a=Cu(o.element),c=R_(a,t.builtGroups.get(),(function(n){return Cu(n.element)}),r)
0===c.extra.length?(og.remove(o,r),e([])):(V_(o,c.within),e(c.extra)),Qi(o.element,"visibility"),Zi(o.element),u.each(sg.focus)},H_=e([Vf("splitToolbarBehaviours",[vx]),re("builtGroups",(function(){return ie([])}))]),z_=e([sa(["overflowToggledClass"]),qt("getOverflowBounds"),Rt("lazySink"),re("overflowGroups",(function(){return ie([])}))].concat(H_())),N_=e([ll({factory:A_,schema:B_(),name:"primary"}),dl({schema:B_(),name:"overflow"}),dl({name:"overflow-button"}),dl({name:"overflow-group"})]),L_=e([sa(["toggledClass"]),Rt("lazySink"),Nt("fetch"),qt("getBounds"),Kt("fireDismissalEventInstead",[Jt("event",Vo())]),Lc()]),j_=e([dl({name:"button",overrides:function(n){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:tc([wg.config({toggleClass:n.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),dl({factory:A_,schema:B_(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:tc([Qm.config({mode:"cyclic",onEscape:function(t){return Ol(t,n,"button").each(sg.focus),v.none()}})])}}})]),U_=function(n,t){var e=vx.getCoupled(n,"toolbarSandbox")
pf.isOpen(e)?pf.close(e):pf.open(e,t.toolbar())},W_=function(n,t,e,o){var r=e.getBounds.map((function(n){return n()})),i=e.lazySink(n).getOrDie()
Xs.positionWithinBounds(i,{anchor:"hotspot",hotspot:n,layouts:o,overrides:{maxWidthFunction:T_()}},t,r)},G_=function(n,t,e,o,r){A_.setGroups(t,r),W_(n,t,e,o),wg.on(n)},X_=Ll({name:"FloatingToolbarButton",factory:function(n,t,e,o){return f(f({},rp.sketch(f(f({},o.button()),{action:function(n){U_(n,o)},buttonBehaviours:Nf({dump:o.button().buttonBehaviours},[vx.config({others:{toolbarSandbox:function(t){return function(n,t,e){var o=qu()
return{dom:{tag:"div",attributes:{id:o.id}},behaviours:tc([Qm.config({mode:"special",onEscape:function(n){return pf.close(n),v.some(!0)}}),pf.config({onOpen:function(r,i){e.fetch().get((function(r){G_(n,i,e,t.layouts,r),o.link(n.element),Qm.focusIn(i)}))},onClose:function(){wg.off(n),sg.focus(n),o.unlink(n.element)},isPartOf:function(t,e,o){return Ju(e,o)||Ju(n,o)},getAttachPoint:function(){return e.lazySink(n).getOrDie()}}),ac.config({channels:f(f({},xf(f({isExtraPart:a},e.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),Sf({doReposition:function(){pf.getState(vx.getCoupled(n,"toolbarSandbox")).each((function(o){W_(n,o,e,t.layouts)}))}}))})])}}(t,e,n)}}})])}))),{apis:{setGroups:function(t,o){pf.getState(vx.getCoupled(t,"toolbarSandbox")).each((function(r){G_(t,r,n,e.layouts,o)}))},reposition:function(t){pf.getState(vx.getCoupled(t,"toolbarSandbox")).each((function(o){W_(t,o,n,e.layouts)}))},toggle:function(n){U_(n,o)},getToolbar:function(n){return pf.getState(vx.getCoupled(n,"toolbarSandbox"))},isOpen:function(n){return pf.isOpen(vx.getCoupled(n,"toolbarSandbox"))}}})},configFields:L_(),partFields:j_(),apis:{setGroups:function(n,t,e){n.setGroups(t,e)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getToolbar:function(n,t){return n.getToolbar(t)},isOpen:function(n,t){return n.isOpen(t)}}}),Y_=e([Rt("items"),sa(["itemSelector"]),Vf("tgroupBehaviours",[Qm])]),q_=e([gl({name:"items",unit:"item"})]),K_=Ll({name:"ToolbarGroup",configFields:Y_(),partFields:q_(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Hf(n.tgroupBehaviours,[Qm.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),J_=function(n){return P(n,(function(n){return mu(n)}))},$_=function(n,t,e){P_(n,e,(function(o){e.overflowGroups.set(o),t.getOpt(n).each((function(n){X_.setGroups(n,J_(o))}))}))},Q_=Ll({name:"SplitFloatingToolbar",configFields:z_(),partFields:N_(),factory:function(n,t,e,o){var r=ip(X_.sketch({fetch:function(){return ox((function(t){t(J_(n.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Va,Ra]},onRtl:function(){return[Ra,Va]},onBottomLtr:function(){return[Ha,Pa]},onBottomRtl:function(){return[Pa,Ha]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}))
return{uid:n.uid,dom:n.dom,components:t,behaviours:Hf(n.splitToolbarBehaviours,[vx.config({others:{overflowGroup:function(){return K_.sketch(f(f({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(P(e,t.getSystem().build)),$_(t,r,n)},refresh:function(t){return $_(t,r,n)},toggle:function(n){r.getOpt(n).each((function(n){X_.toggle(n)}))},isOpen:function(n){return r.getOpt(n).map(X_.isOpen).getOr(!1)},reposition:function(n){r.getOpt(n).each((function(n){X_.reposition(n)}))},getOverflow:function(n){return r.getOpt(n).bind(X_.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)},getOverflow:function(n,t){return n.getOverflow(t)}}}),Z_=function(n,t){return t.getAnimationRoot.fold((function(){return n.element}),(function(t){return t(n)}))},nT=function(n){return n.dimension.property},tT=function(n,t){return n.dimension.getDimension(t)},eT=function(n,t){var e=Z_(n,t)
Di(e,[t.shrinkingClass,t.growingClass])},oT=function(n,t){Ti(n.element,t.openClass),Oi(n.element,t.closedClass),Wi(n.element,nT(t),"0px"),Zi(n.element)},rT=function(n,t){Ti(n.element,t.closedClass),Oi(n.element,t.openClass),Qi(n.element,nT(t))},iT=function(n,t,e,o){e.setCollapsed(),Wi(n.element,nT(t),tT(t,n.element)),Zi(n.element),eT(n,t),oT(n,t),t.onStartShrink(n),t.onShrunk(n)},uT=function(n,t,e,o){var r=o.getOrThunk((function(){return tT(t,n.element)}))
e.setCollapsed(),Wi(n.element,nT(t),r),Zi(n.element)
var i=Z_(n,t)
Ti(i,t.growingClass),Oi(i,t.shrinkingClass),oT(n,t),t.onStartShrink(n)},aT=function(n,t,e){var o=tT(t,n.element);("0px"===o?iT:uT)(n,t,e,v.some(o))},cT=function(n,t,e){var o=Z_(n,t),r=Ei(o,t.shrinkingClass),i=tT(t,n.element)
rT(n,t)
var u=tT(t,n.element);(r?function(){Wi(n.element,nT(t),i),Zi(n.element)}:function(){oT(n,t)})(),Ti(o,t.shrinkingClass),Oi(o,t.growingClass),rT(n,t),Wi(n.element,nT(t),u),e.setExpanded(),t.onStartGrow(n)},sT=function(n,t,e){var o=Z_(n,t)
return!0===Ei(o,t.growingClass)},fT=function(n,t,e){var o=Z_(n,t)
return!0===Ei(o,t.shrinkingClass)},lT=Object.freeze({__proto__:null,refresh:function(n,t,e){if(e.isExpanded()){Qi(n.element,nT(t))
var o=tT(t,n.element)
Wi(n.element,nT(t),o)}},grow:function(n,t,e){e.isExpanded()||cT(n,t,e)},shrink:function(n,t,e){e.isExpanded()&&aT(n,t,e)},immediateShrink:function(n,t,e){e.isExpanded()&&iT(n,t,e,v.none())},hasGrown:function(n,t,e){return e.isExpanded()},hasShrunk:function(n,t,e){return e.isCollapsed()},isGrowing:sT,isShrinking:fT,isTransitioning:function(n,t,e){return!0===sT(n,t)||!0===fT(n,t)},toggleGrow:function(n,t,e){(e.isExpanded()?aT:cT)(n,t,e)},disableTransitions:eT}),dT=Object.freeze({__proto__:null,exhibit:function(n,t,e){var o=t.expanded
return di(o?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:Wn(t.dimension.property,"0px")})},events:function(n,t){return Jo([ur(po(),(function(e,o){o.event.raw.propertyName===n.dimension.property&&(eT(e,n),t.isExpanded()&&Qi(e.element,n.dimension.property),(t.isExpanded()?n.onGrown:n.onShrunk)(e))}))])}}),mT=[Rt("closedClass"),Rt("openClass"),Rt("shrinkingClass"),Rt("growingClass"),Wt("getAnimationRoot"),la("onShrunk"),la("onStartShrink"),la("onGrown"),la("onStartGrow"),Jt("expanded",!1),Vt("dimension",Ot("property",{width:[pa("property","width"),pa("getDimension",(function(n){return Cu(n)+"px"}))],height:[pa("property","height"),pa("getDimension",(function(n){return hu(n)+"px"}))]}))],gT=oc({fields:mT,name:"sliding",active:dT,apis:lT,state:Object.freeze({__proto__:null,init:function(n){var t=ie(n.expanded)
return fi({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:r(t.set,!1),setExpanded:r(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),pT=e([sa(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),la("onOpened"),la("onClosed")].concat(H_())),hT=e([ll({factory:A_,schema:B_(),name:"primary"}),ll({factory:A_,schema:B_(),name:"overflow",overrides:function(n){return{toolbarBehaviours:tc([gT.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Ol(t,n,"overflow-button").each((function(n){wg.off(n),sg.focus(n)})),n.onClosed(t)},onGrown:function(t){Qm.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Ol(t,n,"overflow-button").each(wg.on)}}),Qm.config({mode:"acyclic",onEscape:function(t){return Ol(t,n,"overflow-button").each(sg.focus),v.some(!0)}})])}}}),dl({name:"overflow-button",overrides:function(n){return{buttonBehaviours:tc([wg.config({toggleClass:n.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),dl({name:"overflow-group"})]),vT=function(n,t){Ol(n,t,"overflow-button").bind((function(){return Ol(n,t,"overflow")})).each((function(e){bT(n,t),gT.toggleGrow(e)}))},bT=function(n,t){Ol(n,t,"overflow").each((function(e){P_(n,t,(function(n){var t=P(n,(function(n){return mu(n)}))
A_.setGroups(e,t)})),Ol(n,t,"overflow-button").each((function(n){gT.hasGrown(e)&&wg.on(n)})),gT.refresh(e)}))},yT=Ll({name:"SplitSlidingToolbar",configFields:pT(),partFields:hT(),factory:function(n,t,e,o){var r="alloy.toolbar.toggle"
return{uid:n.uid,dom:n.dom,components:t,behaviours:Hf(n.splitToolbarBehaviours,[vx.config({others:{overflowGroup:function(n){return K_.sketch(f(f({},o["overflow-group"]()),{items:[rp.sketch(f(f({},o["overflow-button"]()),{action:function(t){Wo(n,r)}}))]}))}}}),rg("toolbar-toggle-events",[Zo(r,(function(t){vT(t,n)}))])]),apis:{setGroups:function(t,e){(function(t,e){var o=P(e,t.getSystem().build)
n.builtGroups.set(o)})(t,e),bT(t,n)},refresh:function(t){return bT(t,n)},toggle:function(t){return vT(t,n)},isOpen:function(t){return function(n,t){return Ol(n,t,"overflow").map(gT.hasGrown).getOr(!1)}(t,n)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)}}}),xT=e(Yr("toolbar-height-change")),wT=function(n){var t=n.title.fold((function(){return{}}),(function(n){return{attributes:{title:n}}}))
return{dom:f({tag:"div",classes:["tox-toolbar__group"]},t),components:[K_.parts.items({})],items:n.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:tc([By.config({}),sg.config({})])}},ST=function(n){return K_.sketch(wT(n))},kT=function(n,t){var e=ar((function(t){var e=P(n.initGroups,ST)
A_.setGroups(t,e)}))
return tc([Av(n.providers.isReadOnly),Tv(),Qm.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),rg("toolbar-events",[e])])},CT=function(n){var t=n.cyclicKeying?"cyclic":"acyclic"
return{uid:n.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":wT({title:v.none(),items:[]}),"overflow-button":mC({name:"more",icon:v.some("more-drawer"),disabled:!1,tooltip:v.some("More..."),primary:!1,borderless:!1},v.none(),n.providers)},splitToolbarBehaviours:kT(n,t)}},OT=function(n){var t=CT(n),e=Q_.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}})
return Q_.sketch(f(f({},t),{lazySink:n.getSink,getOverflowBounds:function(){var t=n.moreDrawerData.lazyHeader().element,e=Hu(t),o=yr(t),r=Hu(o),i=Math.max(o.dom.scrollHeight,r.height)
return Vu(e.x+4,r.y,e.width-8,i)},parts:f(f({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},_T=function(n){var t=yT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=yT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=CT(n)
return yT.sketch(f(f({},o),{components:[t,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(n){n.getSystem().broadcastOn([xT()],{type:"opened"})},onClosed:function(n){n.getSystem().broadcastOn([xT()],{type:"closed"})}}))},TT=function(n){var t=n.cyclicKeying?"cyclic":"acyclic"
return A_.sketch({uid:n.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(n.type===Kp.scrolling?["tox-toolbar--scrolling"]:[])},components:[A_.parts.groups({})],toolbarBehaviours:kT(n,t)})},ET=it([Ht("type"),Vt("items",at([ht([Ht("name"),Ut("items",Bt)]),Bt]))].concat(Ip)),BT=[Yt("text"),Yt("tooltip"),Yt("icon"),Nt("fetch"),ee("onSetup",(function(){return n}))],DT=it(d([Ht("type")],BT)),AT=function(n){return xt("menubutton",DT,n)},MT=it([Ht("type"),Yt("tooltip"),Yt("icon"),Yt("text"),qt("select"),Nt("fetch"),ee("onSetup",(function(){return n})),ne("presets","normal",["normal","color","listpreview"]),Jt("columns",1),Nt("onAction"),Nt("onItemAction")]),FT=Object.freeze({__proto__:null,events:function(n,t){var e=function(e,o){n.updateState.each((function(n){var r=n(e,o)
t.set(r)})),n.renderComponents.each((function(n){var r=n(o,t.get()),i=P(r,e.getSystem().build)
Js(e,i)}))}
return Jo([Zo(So(),(function(t,o){var r=o
if(!r.universal){var i=n.channel
F(r.channels,i)&&e(t,r.data)}})),ar((function(t,o){n.initialData.each((function(n){e(t,n)}))}))])}}),IT=Object.freeze({__proto__:null,getState:function(n,t,e){return e}}),RT=[Rt("channel"),Wt("renderComponents"),Wt("updateState"),Wt("initialData")],VT=oc({fields:RT,name:"reflecting",active:FT,apis:IT,state:Object.freeze({__proto__:null,init:function(){var n=ie(v.none())
return{readState:function(){return n.get().fold((function(){return"none"}),(function(n){return n}))},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(v.none())}}}})}),PT=e([Rt("toggleClass"),Rt("fetch"),ma("onExecute"),Jt("getHotspot",v.some),Jt("getAnchorOverrides",e({})),Lc(),ma("onItemExecute"),Wt("lazySink"),Rt("dom"),la("onOpen"),Vf("splitDropdownBehaviours",[vx,Qm,sg]),Jt("matchWidth",!1),Jt("useMinWidth",!1),Jt("eventOrder",{}),Wt("role")].concat(Bx())),HT=ll({factory:rp,schema:[Rt("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:tc([sg.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(Xo)},buttonBehaviours:tc([wg.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),zT=ll({factory:rp,schema:[Rt("dom")],name:"button",defaults:function(){return{buttonBehaviours:tc([sg.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each((function(e){n.onExecute(e,t)}))}}}}),NT=e([HT,zT,ml({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[Rt("text")],name:"aria-descriptor"}),dl({schema:[ca()],name:"menu",defaults:function(n){return{onExecute:function(t,e){t.getSystem().getByUid(n.uid).each((function(o){n.onItemExecute(o,t,e)}))}}}}),yx()]),LT=Ll({name:"SplitDropdown",configFields:PT(),partFields:NT(),factory:function(t,e,o,r){var i,u=function(n){Xl.getCurrent(n).each((function(n){od.highlightFirst(n),Qm.focusIn(n)}))},a=function(e){kx(t,(function(n){return n}),e,r,u,$y.HighlightFirst).get(n)},c=function(n){var e=_l(n,t,"button")
return Xo(e),v.some(!0)},s=f(f({},Jo([ar((function(n,e){Ol(n,t,"aria-descriptor").each((function(t){var e=Yr("aria")
Vr(t.element,"id",e),Vr(n.element,"aria-describedby",e)}))}))])),kg(v.some(a))),l={repositionMenus:function(n){wg.isOn(n)&&Ex(n)}}
return{uid:t.uid,dom:t.dom,components:e,apis:l,eventOrder:f(f({},t.eventOrder),(i={},i[ko()]=["disabling","toggling","alloy.base.behaviour"],i)),events:s,behaviours:Hf(t.splitDropdownBehaviours,[vx.config({others:{sandbox:function(n){var e=_l(n,t,"arrow")
return Tx(t,n,{onOpen:function(){wg.on(e),wg.on(n)},onClose:function(){wg.off(e),wg.off(n)}})}}}),Qm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(n){return a(n),v.some(!0)}}),sg.config({}),wg.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(n,t){return n.repositionMenus(t)}}}),jT=function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},UT=function(n){return{setActive:function(t){wg.set(n,t)},isActive:function(){return wg.isOn(n)},isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},WT=function(n,t){return n.map((function(n){return{"aria-label":t.translate(n),title:t.translate(n)}})).getOr({})},GT=Yr("focus-button"),XT=["checklist","ordered-list"],YT=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],qT=function(n,t,e,o,r,i){var u,a=function(n){return Ph.isRtl()&&F(XT,n)?n+"-rtl":n},c=Ph.isRtl()&&n.exists((function(n){return F(YT,n)}))
return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:WT(e,i)},components:Pv([n.map((function(n){return Kk(a(n),i.icons)})),t.map((function(n){return $k(n,"tox-tbtn",i)}))]),eventOrder:(u={},u[eo()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:tc([Av(i.isReadOnly),Tv(),rg("common-button-display-events",[Zo(eo(),(function(n,t){t.event.prevent(),Wo(n,GT)}))])].concat(o.map((function(e){return VT.config({channel:e,initialData:{icon:n,text:t},renderComponents:function(n,t){return Pv([n.icon.map((function(n){return Kk(a(n),i.icons)})),n.text.map((function(n){return $k(n,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},KT=function(t,e,o){var r,i=ie(n),u=qT(t.icon,t.text,t.tooltip,v.none(),v.none(),o)
return rp.sketch({dom:u.dom,components:u.components,eventOrder:Zk,buttonBehaviours:tc([rg("toolbar-button-events",[(r={onAction:t.onAction,getApi:e.getApi},fr((function(n,t){Mv(r,n)((function(t){Go(n,Qk,{buttonApi:t}),r.onAction(t)}))}))),Fv(e,i),Iv(e,i)]),Av((function(){return t.disabled||o.isReadOnly()})),Tv()].concat(e.toolbarButtonBehaviours))})},JT=function(n,t,e){return KT(n,{toolbarButtonBehaviours:[].concat(e.length>0?[rg("toolbarButtonWith",e)]:[]),getApi:jT,onSetup:n.onSetup},t)},$T=function(n,t,e){return Mn(KT(n,{toolbarButtonBehaviours:[og.config({}),wg.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[rg("toolbarToggleButtonWith",e)]:[]),getApi:UT,onSetup:n.onSetup},t))},QT=function(n,t,e){return function(o){return ox((function(n){return t.fetch(n)})).map((function(r){return v.from(ty(Mn(Vb(Yr("menu-value"),r,(function(e){t.onItemAction(n(o),e)}),t.columns,t.presets,Jp.CLOSE_ON_EXECUTE,t.select.getOr((function(){return!1})),e),{movement:Hb(t.columns,t.presets),menuBehaviours:Th("auto"!==t.columns?[]:[ar((function(n,e){Oh(n,4,ih(t.presets)).each((function(t){var e=t.numRows,o=t.numColumns
Qm.setGridSize(n,e,o)}))}))])})))}))}},ZT=function(n,t){return Zo(Qk,(function(e,o){var r=function(n){return{hide:function(){return Wo(n,To())},getValue:function(){return Rf.getValue(n)}}}(n.get(e))
t.onAction(r,o.event.buttonApi)}))},nE=function(n,t,e){var o={backstage:{shared:{providers:e}}}
return"contextformtogglebutton"===t.type?function(n,t,e){var o=t.original,r=(o.primary,l(o,["primary"])),i=wt(zp(f(f({},r),{type:"togglebutton",onAction:function(){}})))
return $T(i,e.backstage.shared.providers,[ZT(n,t)])}(n,t,o):function(n,t,e){var o=t.original,r=(o.primary,l(o,["primary"])),i=wt(Vp(f(f({},r),{type:"button",onAction:function(){}})))
return JT(i,e.backstage.shared.providers,[ZT(n,t)])}(n,t,o)},tE=function(n,t){var e=n.label.fold((function(){return{}}),(function(n){return{"aria-label":n}})),o=ip(qy.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:tc([Qm.config({mode:"special",onEnter:function(n){return r.findPrimary(n).map((function(n){return Xo(n),!0}))},onLeft:function(n,t){return t.cut(),v.none()},onRight:function(n,t){return t.cut(),v.none()}})])})),r=function(n,t,e){var o=P(t,(function(t){return ip(nE(n,t,e))}))
return{asSpecs:function(){return P(o,(function(n){return n.asSpec()}))},findPrimary:function(n){return nn(t,(function(t,e){return t.primary?v.from(o[e]).bind((function(t){return t.getOpt(n)})).filter(i($h.isDisabled)):v.none()}))}}}(o,n.commands,t)
return[{title:v.none(),items:[o.asSpec()]},{title:v.none(),items:r.asSpecs()}]},eE=tE,oE=function(n,t){var e=Mu(window),o=Pu(ae.fromDom(n.getContentAreaContainer())),r=iv(n)||uv(n)||cv(n),i=function(n,t){var e=Math.max(t.x,n.x),o=n.right-e,r=t.width-(e-t.x)
return{x:e,width:Math.min(o,r)}}(o,e),u=i.x,a=i.width
if(n.inline&&!r)return Vu(u,e.y,a,e.height)
var c=function(n,t,e,o){var r=ae.fromDom(n.getContainer()),i=Xu(r,".tox-editor-header").getOr(r),u=Pu(i),a=u.y>=t.bottom,c=o&&!a
if(n.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom}
if(n.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)}
var s=Pu(r)
return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(n,o,e,t.header.isPositionedAtTop()),s=c.y,f=c.bottom
return Vu(u,s,a,f-s)},rE=function(n,t){var e=N(t,(function(t){return t.predicate(n.dom)})),o=z(e,(function(n){return"contexttoolbar"===n.type}))
return{contextToolbars:o.pass,contextForms:o.fail}},iE=function(n,t,e){var o=rE(n,t)
if(o.contextForms.length>0)return v.some({elem:n,toolbars:[o.contextForms[0]]})
var r=rE(n,e)
if(r.contextForms.length>0)return v.some({elem:n,toolbars:[r.contextForms[0]]})
if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=function(n){if(n.length<=1)return n
var t=function(t){return I(n,(function(n){return n.position===t}))},e=function(t){return N(n,(function(n){return n.position===t}))},o=t("selection"),r=t("node")
if(o||r){if(r&&o){var i=e("node"),u=P(e("selection"),(function(n){return f(f({},n),{position:"node"})}))
return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars))
return v.some({elem:n,toolbars:i})}return v.none()},uE=function(n,t,e){return n(t)?v.none():Xe(t,(function(n){var t=rE(n,e.inNodeScope),o=t.contextToolbars,r=t.contextForms,i=r.length>0?r:function(n){if(n.length<=1)return n
var t=function(t){return U(n,(function(n){return n.position===t}))}
return t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(n){return n.position})).fold((function(){return[]}),(function(t){return N(n,(function(n){return n.position===t}))}))}(o)
return i.length>0?v.some({elem:n,toolbars:i}):v.none()}),n)},aE=function(n,t){var e={},o=[],r=[],i={},u={},a=function(n,a){var c=wt(xt("ContextForm",Xp,a))
e[n]=c,c.launch.map((function(e){i["form:"+n]=f(f({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){t(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[n]=c},c=function(n,t){var e;(e=t,xt("ContextToolbar",Yp,e)).each((function(e){"editor"===t.scope?r.push(e):o.push(e),u[n]=e}))},s=vn(n)
return H(s,(function(t){var e=n[t]
"contextform"===e.type?a(t,e):"contexttoolbar"===e.type&&c(t,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},cE=Yr("forward-slide"),sE=Yr("backward-slide"),fE=Yr("change-slide-event"),lE="tox-pop--resizing",dE=function(n,t,e){var o=function(n,o,i,u){var a=t.shared.providers.translate(n.title)
if("separator"===n.type)return v.some({type:"separator",text:a})
if("submenu"===n.type){var c=X(n.getStyleItems(),(function(n){return r(n,o,u)}))
return 0===o&&c.length<=0?v.none():v.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return X(n.getStyleItems(),(function(n){return r(n,o,u)}))}})}return v.some(f({type:"togglemenuitem",text:a,icon:n.icon,active:n.isSelected(u),disabled:i,onAction:e.onAction(n)},n.getStylePreview().fold((function(){return{}}),(function(n){return{meta:{style:n}}}))))},r=function(n,t,r){var i="formatter"===n.type&&e.isInvalid(n)
return 0===t?i?[]:o(n,t,!1,r).toArray():o(n,t,i,r).toArray()},i=function(n){var t=e.getCurrentValue(),o=e.shouldHide?0:1
return X(n,(function(n){return r(n,o,t)}))}
return{validateItems:i,getFetch:function(n,t){return function(e,o){var r=t(),u=i(r)
o(cC(u,Jp.CLOSE_ON_EXECUTE,n,!1))}}}},mE=function(n,t,e){var o=e.dataset,r="basic"===o.type?function(){return P(o.data,(function(n){return JO(n,e.isSelectedFor,e.getPreviewFor)}))}:o.getData
return{items:dE(0,t,e),getStyleItems:r}},gE=function(t,e,o){var r=mE(0,e,o),i=r.items,u=r.getStyleItems
return eC({text:o.icon.isSome()?v.none():v.some(""),icon:o.icon,tooltip:v.from(o.tooltip),role:v.none(),fetch:i.getFetch(e,u),onSetup:function(e){return o.setInitialValue.each((function(n){return n(e.getComponent())})),o.nodeChangeHandler.map((function(n){var o=n(e.getComponent())
return t.on("NodeChange",o),function(){t.off("NodeChange",o)}})).getOr(n)},getApi:function(n){return{getComponent:function(){return n}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};(function(n){n[n.SemiColon=0]="SemiColon",n[n.Space=1]="Space"})(YC||(YC={}))
var pE,hE,vE,bE,yE,xE=function(n,t,e,o){return{type:"basic",data:function(n){return P(n,(function(n){var t=n,e=n,o=n.split("=")
return o.length>1&&(t=o[0],e=o[1]),{title:t,format:e}}))}(function(n,t){return t===YC.SemiColon?n.replace(/;$/,"").split(";"):n.split(" ")}(n.getParam(t,e,"string"),o))}},wE=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],SE=function(n){var t=function(t){var e=U(wE,(function(t){return n.formatter.match(t.format)})).fold((function(){return"left"}),(function(n){return n.title.toLowerCase()}))
Go(t,tC,{icon:"align-"+e})},e=v.some((function(n){return function(){return t(n)}})),o=v.some((function(n){return t(n)})),r={type:"basic",data:wE}
return{tooltip:"Align",icon:v.some("align-left"),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:v.none,getPreviewFor:function(n){return function(){return v.none()}},onAction:function(t){return function(){return U(wE,(function(n){return n.format===t.format})).each((function(t){return n.execCommand(t.command)}))}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},kE=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],CE=function(n){var t=n.split(/\s*,\s*/)
return P(t,(function(n){return n.replace(/^['"]+|['"]+$/g,"")}))},OE=function(n){var t=function(){var t=function(n){return n?CE(n)[0]:""},e=n.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():""
return{matchOpt:U(o,(function(n){var e=n.format
return e.toLowerCase()===r||t(e).toLowerCase()===t(r).toLowerCase()})).orThunk((function(){return function(n){var t
return 0===n.indexOf("-apple-system")&&(t=CE(n.toLowerCase()),Y(kE,(function(n){return t.indexOf(n.toLowerCase())>-1})))}(r)?v.from({title:"System Font",format:r}):v.none()})),font:e}},e=function(n){var e=t(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(n){return n.title}))
Go(n,nC,{text:i})},o=v.some((function(n){return function(){return e(n)}})),r=v.some((function(n){return e(n)})),i=xE(n,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",YC.SemiColon)
return{tooltip:"Fonts",icon:v.none(),isSelectedFor:function(n){return function(t){return t.exists((function(t){return t.format===n}))}},getCurrentValue:function(){return t().matchOpt},getPreviewFor:function(n){return function(){return v.some({tag:"div",styles:-1===n.indexOf("dings")?{"font-family":n}:{}})}},onAction:function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontName",!1,t.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:function(){return!1}}},_E={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},TE=function(n,t){return/[0-9.]+px$/.test(n)?function(n,t){var e=Math.pow(10,t)
return Math.round(n*e)/e}(72*parseInt(n,10)/96,t||0)+"pt":n},EE=function(n){var t=function(){var t=v.none(),e=a.data,o=n.queryCommandValue("FontSize")
if(o)for(var r=function(n){var r=TE(o,n),i=function(n){return _n(_E,n).getOr("")}(r)
t=U(e,(function(n){return n.format===o||n.format===r||n.format===i}))},i=3;t.isNone()&&i>=0;i--)r(i)
return{matchOpt:t,size:o}},o=e(v.none),r=function(n){var e=t(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(n){return n.title}))
Go(n,nC,{text:i})},i=v.some((function(n){return function(){return r(n)}})),u=v.some((function(n){return r(n)})),a=xE(n,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",YC.Space)
return{tooltip:"Font sizes",icon:v.none(),isSelectedFor:function(n){return function(t){return t.exists((function(t){return t.format===n}))}},getPreviewFor:o,getCurrentValue:function(){return t().matchOpt},onAction:function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontSize",!1,t.format)}))}},setInitialValue:u,nodeChangeHandler:i,dataset:a,shouldHide:!1,isInvalid:function(){return!1}}},BE=function(n,t,e){var o=t()
return nn(e,(function(t){return U(o,(function(e){return n.formatter.matchNode(t,e.format)}))})).orThunk((function(){return n.formatter.match("p")?v.some({title:"Paragraph",format:"p"}):v.none()}))},DE=function(n){var t=n.selection.getStart(!0)||n.getBody()
return n.dom.getParents(t,(function(){return!0}),n.getBody())},AE=function(n){var t=ie(v.none()),e=function(){return t.get().each(n)}
return{clear:function(){e(),t.set(v.none())},isSet:function(){return t.get().isSome()},set:function(n){e(),t.set(v.some(n))}}},ME=function(){return AE((function(n){return n.unbind()}))},FE=function(n,t){return function(e){var o=ME(),r=function(){e.setActive(n.formatter.match(t))
var r=n.formatter.formatChanged(t,e.setActive)
o.set(r)}
return n.initialized?r():n.on("init",r),o.clear}},IE=function(n){return function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)}))}}},RE=function(n){var t=function(t,e){var o=BE(n,(function(){return r.data}),t).fold((function(){return"Paragraph"}),(function(n){return n.title}))
Go(e,nC,{text:o})},e=v.some((function(n){return function(e){return t(e.parents,n)}})),o=v.some((function(e){var o=DE(n)
t(o,e)})),r=xE(n,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",YC.SemiColon)
return{tooltip:"Blocks",icon:v.none(),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:v.none,getPreviewFor:function(t){return function(){var e=n.formatter.get(t)
return v.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},onAction:IE(n),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},VE=function(n,t){var e=function(t,e){var o=function(n){var t=n.items
return void 0!==t&&t.length>0?X(t,o):[{title:n.title,format:n.format}]},r=X(KO(n),o),i=BE(n,(function(){return r}),t).fold((function(){return"Paragraph"}),(function(n){return n.title}))
Go(e,nC,{text:i})},o=v.some((function(n){return function(t){return e(t.parents,n)}})),r=v.some((function(t){var o=DE(n)
e(o,t)}))
return{tooltip:"Formats",icon:v.none(),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:v.none,getPreviewFor:function(t){return function(){var e=n.formatter.get(t)
return void 0!==e?v.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):v.none()}},onAction:IE(n),setInitialValue:r,nodeChangeHandler:o,shouldHide:n.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!n.formatter.canApply(t.format)},dataset:t}},PE=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],HE=function(n,t){return function(e,o,r){var i=n(e).mapError((function(n){return kt(n)})).getOrDie()
return t(i,o,r)}},zE={button:HE(Vp,(function(n,t){return e=n,o=t.backstage.shared.providers,JT(e,o,[])
var e,o})),togglebutton:HE(zp,(function(n,t){return e=n,o=t.backstage.shared.providers,$T(e,o,[])
var e,o})),menubutton:HE(AT,(function(n,t){return fC(n,"tox-tbtn",t.backstage,v.none())})),splitbutton:HE((function(n){return xt("SplitButton",MT,n)}),(function(t,e){return function(t,e){var o,r=Yr("channel-update-split-dropdown-display"),i=function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)},setIconFill:function(t,e){Xu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Vr(n,"fill",e)}))},setIconStroke:function(t,e){Xu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Vr(n,"stroke",e)}))},setActive:function(t){Vr(n.element,"aria-pressed",t),Xu(n.element,"span").each((function(e){n.getSystem().getByDom(e).each((function(n){return wg.set(n,t)}))}))},isActive:function(){return Xu(n.element,"span").exists((function(t){return n.getSystem().getByDom(t).exists(wg.isOn)}))}}},u=ie(n),a={getApi:i,onSetup:t.onSetup}
return LT.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:f({"aria-pressed":!1},WT(t.tooltip,e.providers))},onExecute:function(n){t.onAction(i(n))},onItemExecute:function(n,t,e){},splitDropdownBehaviours:tc([Dv(e.providers.isReadOnly),Tv(),rg("split-dropdown-events",[Zo(GT,sg.focus),Fv(a,u),Iv(a,u)]),Ix.config({})]),eventOrder:(o={},o[Io()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:QT(i,t,e.providers),parts:{menu:lh(0,t.columns,t.presets)},components:[LT.parts.button(qT(t.icon,t.text,v.none(),v.some(r),v.some([wg.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),LT.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:ap("chevron-down",e.providers.icons)},buttonBehaviours:tc([Dv(e.providers.isReadOnly),Tv()])}),LT.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}(t,e.backstage.shared)})),grouptoolbarbutton:HE((function(n){return xt("GroupToolbarButton",ET,n)}),(function(n,t,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[zc]=t.backstage.shared.header.isPositionedAtTop()?Qu.TopToBottom:Qu.BottomToTop,o)
switch(fv(e)){case Kp.floating:return function(n,t,e,o){var r=t.shared
return X_.sketch({lazySink:r.getSink,fetch:function(){return ox((function(t){t(P(e(n.items),ST))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:qT(n.icon,n.text,n.tooltip,v.none(),v.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(n,t.backstage,(function(n){return UE(e,{buttons:r,toolbar:n,allowToolbarGroups:!1},t,v.none())}),i)
default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(n,t){return function(n,t){var e=f({type:"advanced"},t.styleselect)
return gE(n,t,VE(n,e))}(n,t.backstage)},fontsizeSelectButton:function(n,t){return function(n,t){return gE(n,t,EE(n))}(n,t.backstage)},fontSelectButton:function(n,t){return function(n,t){return gE(n,t,OE(n))}(n,t.backstage)},formatButton:function(n,t){return function(n,t){return gE(n,t,RE(n))}(n,t.backstage)},alignMenuButton:function(n,t){return function(n,t){return gE(n,t,SE(n))}(n,t.backstage)}},NE={styleselect:zE.styleSelectButton,fontsizeselect:zE.fontsizeSelectButton,fontselect:zE.fontSelectButton,formatselect:zE.formatButton,align:zE.alignMenuButton},LE=function(n){var t,e=n.toolbar,o=n.buttons
return!1===e?[]:void 0===e||!0===e?function(n){var t=P(PE,(function(t){var e=N(t.items,(function(t){return Tn(n,t)||Tn(NE,t)}))
return{name:t.name,items:e}}))
return N(t,(function(n){return n.items.length>0}))}(o):x(e)?(t=e.split("|"),P(t,(function(n){return{items:n.trim().split(" ")}}))):function(n){return E(n,(function(n){return Tn(n,"name")&&Tn(n,"items")}))}(e)?e:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},jE=function(n,t,e,o,r,i){return _n(t,e.toLowerCase()).orThunk((function(){return i.bind((function(n){return nn(n,(function(n){return _n(t,n+e.toLowerCase())}))}))})).fold((function(){return _n(NE,e.toLowerCase()).map((function(t){return t(n,r)})).orThunk((function(){return v.none()}))}),(function(t){return"grouptoolbarbutton"!==t.type||o?function(n,t,e){return _n(zE,n.type).fold((function(){return console.error("skipping button defined by",n),v.none()}),(function(o){return v.some(o(n,t,e))}))}(t,r,n):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),v.none())}))},UE=function(n,t,e,o){var r=LE(t),i=P(r,(function(r){var i=X(r.items,(function(r){return 0===r.trim().length?[]:jE(n,t.buttons,r,t.allowToolbarGroups,e,o).toArray()}))
return{title:v.from(n.translate(r.name)),items:i}}))
return N(i,(function(n){return n.items.length>0}))},WE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},GE={maxHeightFunction:Ac(),maxWidthFunction:T_()},XE={onLtr:function(){return[za,Na,Pa,Ra,Ha,Va,tp,ep,Zg,$g,np,Qg]},onRtl:function(){return[za,Na,Ha,Va,Pa,Ra,tp,ep,np,Qg,Zg,$g]}},YE={onLtr:function(){return[Na,Ra,Va,Pa,Ha,za,tp,ep,Zg,$g,np,Qg]},onRtl:function(){return[Na,Va,Ra,Ha,Pa,za,tp,ep,np,Qg,Zg,$g]}},qE=function(n,t,e,o){var r,i,u=ze().deviceType.isTouch,a=du((r={sink:e,onEscape:function(){return n.focus(),v.some(!0)}},i=ie([]),Gg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(n){i.set([]),Gg.getContent(n).each((function(n){Qi(n.element,"visibility")})),Ti(n.element,lE),Qi(n.element,"width")},inlineBehaviours:tc([rg("context-toolbar-events",[ur(po(),(function(n,t){Ti(n.element,lE),Qi(n.element,"width")})),Zo(fE,(function(n,t){Qi(n.element,"width")
var e=Cu(n.element)
Gg.setContent(n,t.event.contents),Oi(n.element,lE)
var o=Cu(n.element)
Wi(n.element,"width",e+"px"),Gg.getContent(n).each((function(e){t.event.focus.bind((function(t){return sc(t),lc(n.element)})).orThunk((function(){return Qm.focusIn(e),fc()}))})),op.setTimeout((function(){Wi(n.element,"width",o+"px")}),0)})),Zo(cE,(function(n,t){Gg.getContent(n).each((function(n){i.set(i.get().concat([{bar:n,focus:fc()}]))})),Go(n,fE,{contents:t.event.forwardContents,focus:v.none()})})),Zo(sE,(function(n,t){Q(i.get()).each((function(t){i.set(i.get().slice(0,i.get().length-1)),Go(n,fE,{contents:mu(t.bar),focus:t.focus})}))}))]),Qm.config({mode:"special",onEscape:function(n){return Q(i.get()).fold((function(){return r.onEscape()}),(function(t){return Wo(n,sE),v.some(!0)}))}})]),lazySink:function(){return on.value(r.sink)}}))),c=function(){return oE(n,o.backstage.shared)},s=function(){if(u()&&o.backstage.isContextMenuOpen())return!0
var t,e,r,i,a,s,f=(t=g.get().filter((function(n){return zi(ae.fromDom(n))})).map((function(n){return n.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?Bu().top:Hu(ae.fromDom(n.getBody())).y,{y:t.top+e,bottom:t.bottom+e}),l=c()
return r=f.y,i=f.bottom,a=l.y,s=l.bottom,!(Math.max(r,a)<=Math.min(i,s))},l=function(){Gg.hide(a)},d=function(){m.get().each((function(n){var t=a.element
Qi(t,"display"),s()?Wi(t,"display","none"):Xs.positionWithinBounds(e,n,a,v.some(c()))}))},m=ie(v.none()),g=ie(v.none()),p=ie(null),h=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:tc([Qm.config({mode:"acyclic"}),rg("pop-dialog-wrap-events",[ar((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Qm.focusIn(t)}))})),cr((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},b=In((function(){return aE(t,(function(n){var t=y([n])
Go(a,cE,{forwardContents:h(t)})}))})),y=function(t){var e=n.ui.registry.getAll().buttons,r=b(),i=f(f({},e),r.formNavigators),u=fv(n)===Kp.scrolling?Kp.scrolling:Kp.default,a=G(P(t,(function(t){return"contexttoolbar"===t.type?function(t,e){return UE(n,{buttons:t,toolbar:e.items,allowToolbarGroups:!1},o,v.some(["form:"]))}(i,t):function(n,t){return eE(n,t)}(t,o.backstage.shared.providers)})))
return TT({type:u,uid:Yr("context-toolbar"),initGroups:a,onEscape:v.none,cyclicKeying:!0,providers:o.backstage.shared.providers})}
n.on("contexttoolbar-show",(function(t){var e=b()
_n(e.lookupTable,t.toolbarKey).each((function(e){w([e],t.target===n?v.none():v.some(t)),Gg.getContent(a).each(Qm.focusIn)}))}))
var x=function(n,t){var e="node"===n?o.backstage.shared.anchors.node(t):o.backstage.shared.anchors.cursor()
return Mn(e,function(n,t){return"line"===n?{bubble:Rc(12,0,WE),layouts:{onLtr:function(){return[La]},onRtl:function(){return[ja]}},overrides:GE}:{bubble:Rc(0,12,WE),layouts:t?YE:XE,overrides:GE}}(n,u()))},w=function(n,t){if(k(),!u()||!o.backstage.isContextMenuOpen()){var e=y(n),r=t.map(ae.fromDom),i=x(n[0].position,r)
m.set(v.some(i)),g.set(t)
var f=a.element
Qi(f,"display"),Gg.showWithinBounds(a,i,h(e),(function(){return v.some(c())})),s()&&Wi(f,"display","none")}},S=function(){n.hasFocus()&&function(n,t){var e=ae.fromDom(t.getBody()),o=function(n){return je(n,e)},r=ae.fromDom(t.selection.getNode())
return function(n){return!o(n)&&!We(e,n)}(r)?v.none():iE(r,n.inNodeScope,n.inEditorScope).orThunk((function(){return uE(o,r,n)}))}(b(),n).fold((function(){m.set(v.none()),Gg.hide(a)}),(function(n){w(n.toolbars,v.some(n.elem.dom))}))},k=function(){var n=p.get()
null!==n&&(op.clearTimeout(n),p.set(null))},C=function(n){k(),p.set(n)}
n.on("init",(function(){n.on(E_,l),n.on("ScrollContent ScrollWindow longpress",d),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){C(op.setEditorTimeout(n,S,0))})),n.on("focusout",(function(t){op.setEditorTimeout(n,(function(){lc(e.element).isNone()&&lc(a.element).isNone()&&(m.set(v.none()),Gg.hide(a))}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&(m.set(v.none()),Gg.hide(a))})),n.on("NodeChange",(function(t){lc(a.element).fold((function(){C(op.setEditorTimeout(n,S,0))}),(function(n){}))}))}))},KE=Fl,JE=hl,$E=e([Jt("shell",!1),Rt("makeItem"),Jt("setupItem",n),zf("listBehaviours",[og])]),QE=ml({name:"items",overrides:function(){return{behaviours:tc([og.config({})])}}}),ZE=e([QE]),nB=e("CustomList"),tB=Ll({name:nB(),configFields:$E(),partFields:ZE(),factory:function(n,t,e,o){var r=n.shell?{behaviours:[og.config({})],components:[]}:{behaviours:[],components:t},i=function(t){return n.shell?v.some(t):Ol(t,n,"items")}
return{uid:n.uid,dom:n.dom,components:r.components,behaviours:Hf(n.listBehaviours,r.behaviours),apis:{setItems:function(t,e){i(t).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=og.contents(o),i=e.length,u=i-r.length,a=u>0?R(u,(function(){return n.makeItem()})):[],c=r.slice(i)
H(c,(function(n){return og.remove(o,n)})),H(a,(function(n){return og.append(o,n)}))
var s=og.contents(o)
H(s,(function(o,r){n.setupItem(t,o,e[r],r)}))}))}}}},apis:{setItems:function(n,t,e){n.setItems(t,e)}}}),eB=n,oB=a,rB=e([]),iB=Object.freeze({__proto__:null,setup:eB,isDocked:oB,getBehaviours:rB}),uB=function(n){return(Ki(n,"position").is("fixed")?v.none():Sr(n)).orThunk((function(){var t=ae.fromTag("span")
return wr(n).bind((function(n){Er(n,t)
var e=Sr(t)
return Ar(t),e}))}))},aB=function(n){return uB(n).map(wu).getOrThunk((function(){return yu(0,0)}))},cB=Bn([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),sB=function(n,t){var e=n.element
Oi(e,t.transitionClass),Ti(e,t.fadeOutClass),Oi(e,t.fadeInClass),t.onShow(n)},fB=function(n,t){var e=n.element
Oi(e,t.transitionClass),Ti(e,t.fadeInClass),Oi(e,t.fadeOutClass),t.onHide(n)},lB=function(n,t,e){return Y(n,(function(n){switch(n){case"bottom":return function(n,t){return n.bottom<=t.bottom}(t,e)
case"top":return function(n,t){return n.y>=t.y}(t,e)}}))},dB=function(n,t){return t.getInitialPosition().map((function(t){return Vu(t.bounds.x,t.bounds.y,Cu(n),hu(n))}))},mB=function(n,t,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(v.none()),o.position){case"static":return v.some(cB.static())
case"absolute":var r=uB(n).map(Pu).getOrThunk((function(){return Pu(Ni())}))
return v.some(cB.absolute(mc("absolute",_n(o.style,"left").map((function(n){return t.x-r.x})),_n(o.style,"top").map((function(n){return t.y-r.y})),_n(o.style,"right").map((function(n){return r.right-t.right})),_n(o.style,"bottom").map((function(n){return r.bottom-t.bottom})))))
default:return v.none()}}))},gB=function(n,t,e){var o=Pu(n)
if(lB(e.getModes(),o,t))return v.none();(function(n,t,e){e.setInitialPosition(v.some({style:Ji(n),position:Yi(n,"position")||"static",bounds:t}))})(n,o,e)
var r=zu(),i=o.x-r.x,u=t.y-r.y,a=r.bottom-t.bottom,c=o.y<=t.y
return v.some(cB.fixed(mc("fixed",v.some(i),c?v.some(u):v.none(),v.none(),c?v.none():v.some(a))))},pB=function(n,t,e){var o=n.element
return Ki(o,"position").is("fixed")?function(n,t,e){return dB(n,e).filter((function(n){return lB(e.getModes(),n,t)})).bind((function(t){return mB(n,t,e)}))}(o,t,e):gB(o,t,e)},hB=function(n,t){H(["left","right","top","bottom","position"],(function(t){return Qi(n.element,t)})),t.onUndocked(n)},vB=function(n,t,e){gc(n.element,e),("fixed"===e.position?t.onDocked:t.onUndocked)(n)},bB=function(n,t,e,o,r){void 0===r&&(r=!1),t.contextual.each((function(t){t.lazyContext(n).each((function(i){var u=function(n,t){return n.y<t.bottom&&n.bottom>t.y}(i,o)
u!==e.isVisible()&&(e.setVisible(u),r&&!u?(Bi(n.element,[t.fadeOutClass]),t.onHide(n)):(u?sB:fB)(n,t))}))}))},yB=function(t,e,o){var r=t.element
o.setDocked(!1),function(n,t){var e=n.element
return dB(e,t).bind((function(n){return mB(e,n,t)}))}(t,o).each((function(o){o.fold((function(){return hB(t,e)}),(function(n){return vB(t,e,n)}),n)})),o.setVisible(!0),e.contextual.each((function(n){Di(r,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),xB(t,e,o)},xB=function(n,t,e){n.getSystem().isConnected()&&function(n,t,e){var o=t.lazyViewport(n),r=e.isDocked()
r&&bB(n,t,e,o),pB(n,o,e).each((function(i){e.setDocked(!r),i.fold((function(){return hB(n,t)}),(function(e){return vB(n,t,e)}),(function(r){bB(n,t,e,o,!0),vB(n,t,r)}))}))}(n,t,e)},wB=function(n,t,e){e.isDocked()&&yB(n,t,e)},SB=Object.freeze({__proto__:null,refresh:xB,reset:wB,isDocked:function(n,t,e){return e.isDocked()},getModes:function(n,t,e){return e.getModes()},setModes:function(n,t,e,o){return e.setModes(o)}}),kB=Object.freeze({__proto__:null,events:function(n,t){return Jo([ur(po(),(function(e,o){n.contextual.each((function(n){Ei(e.element,n.transitionClass)&&(Di(e.element,[n.transitionClass,n.fadeInClass]),(t.isVisible()?n.onShown:n.onHidden)(e))
o.stop()}))})),Zo(Mo(),(function(e,o){xB(e,n,t)})),Zo(Fo(),(function(e,o){wB(e,n,t)}))])}}),CB=[Kt("contextual",[Ht("fadeInClass"),Ht("fadeOutClass"),Ht("transitionClass"),Nt("lazyContext"),la("onShow"),la("onShown"),la("onHide"),la("onHidden")]),ee("lazyViewport",zu),function(n,t,e){return $t(n,t,ut(e))}("modes",["top","bottom"],Bt),la("onDocked"),la("onUndocked")],OB=Object.freeze({__proto__:null,init:function(n){var t=ie(!1),e=ie(!0),o=ie(v.none()),r=ie(n.modes)
return fi({isDocked:t.get,setDocked:t.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+t.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}}),_B=oc({fields:CB,name:"docking",active:kB,apis:SB,state:OB}),TB={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},EB="tox-tinymce--toolbar-sticky-on",BB="tox-tinymce--toolbar-sticky-off",DB=function(n){var t=n.element
wr(t).each((function(e){var o="padding-"+_B.getModes(n)[0]
if(_B.isDocked(n)){var r=Cu(e)
Wi(t,"width",r+"px"),Wi(e,o,function(n){return vu(n)+(parseInt(Yi(n,"margin-top"),10)||0)+(parseInt(Yi(n,"margin-bottom"),10)||0)}(t)+"px")}else Qi(t,"width"),Qi(e,o)}))},AB=function(n,t){t?(Ti(n,TB.fadeOutClass),Bi(n,[TB.transitionClass,TB.fadeInClass])):(Ti(n,TB.fadeInClass),Bi(n,[TB.fadeOutClass,TB.transitionClass]))},MB=function(n,t){var e=ae.fromDom(n.getContainer())
t?(Oi(e,EB),Ti(e,BB)):(Oi(e,BB),Ti(e,EB))},FB=function(n,t){var e=ie(v.none()),o=t.getSink,r=function(n){o().each((function(t){return n(t.element)}))},i=function(t){n.inline||DB(t),MB(n,_B.isDocked(t)),t.getSystem().broadcastOn([vf()],{}),o().each((function(n){return n.getSystem().broadcastOn([vf()],{})}))},u=n.inline?[]:function(){var n
return[ac.config({channels:(n={},n[xT()]={onReceive:DB},n)})]}()
return d([sg.config({}),_B.config({contextual:f({lazyContext:function(t){var e,o,r=vu(t.element),i=n.inline?n.getContentAreaContainer():n.getContainer(),u=Pu(ae.fromDom(i)),a=u.height-r,c=u.y+(e=t,o="top",F(_B.getModes(e),o)?0:r)
return v.some(Vu(u.x,c,u.width,a))},onShow:function(){r((function(n){return AB(n,!0)}))},onShown:function(n){r((function(n){return Di(n,[TB.transitionClass,TB.fadeInClass])})),e.get().each((function(t){var o,r,i
o=n.element,i=vr(r=t),fc(i).filter((function(n){return!je(r,n)})).filter((function(n){return je(n,ae.fromDom(i.dom.body))||We(o,n)})).each((function(){return sc(r)})),e.set(v.none())}))},onHide:function(n){e.set(function(n,t){return lc(n).orThunk((function(){return t().toOptional().bind((function(n){return lc(n.element)}))}))}(n.element,o)),r((function(n){return AB(n,!1)}))},onHidden:function(){r((function(n){return Di(n,[TB.transitionClass])}))}},TB),modes:[t.header.getDockingMode()],onDocked:i,onUndocked:i})],u)},IB=Object.freeze({__proto__:null,setup:function(n,t,e){n.inline||(t.header.isPositionedAtTop()||n.on("ResizeEditor",(function(){e().each(_B.reset)})),n.on("ResizeWindow ResizeEditor",(function(){e().each(DB)})),n.on("SkinLoaded",(function(){e().each((function(n){_B.isDocked(n)?_B.reset(n):_B.refresh(n)}))})),n.on("FullscreenStateChanged",(function(){e().each(_B.reset)}))),n.on("AfterScrollIntoView",(function(n){e().each((function(t){_B.refresh(t)
var e=t.element
Xd(e)&&function(n,t){var e=vr(t),o=e.dom.defaultView.innerHeight,r=Bu(e),i=ae.fromDom(n.elm),u=Hu(i),a=hu(i),c=u.y,s=c+a,f=wu(t),l=hu(t),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2
if(g&&c<m)Du(r.left,c-l,e)
else if(p&&s>d){var h=c-o+a+l
Du(r.left,h,e)}}(n,e)}))})),n.on("PostRender",(function(){MB(n,!1)}))},isDocked:function(n){return n().map(_B.isDocked).getOr(!1)},getBehaviours:FB}),RB=Nl({factory:function(n,t){var e={focus:Qm.focusIn,setMenus:function(n,e){var o=P(e,(function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},o=AT(e).mapError((function(n){return kt(n)})).getOrDie()
return fC(o,"tox-mbtn",t.backstage,v.some("menuitem"))}))
og.set(n,o)}}
return{uid:n.uid,dom:n.dom,components:[],behaviours:tc([og.config({}),rg("menubar-events",[ar((function(t){n.onSetup(t)})),Zo(uo(),(function(n,t){Xu(n.element,".tox-mbtn--active").each((function(e){Yu(t.event.target,".tox-mbtn").each((function(t){je(e,t)||n.getSystem().getByDom(e).each((function(e){n.getSystem().getByDom(t).each((function(n){Mx.expand(n),Mx.close(e),sg.focus(n)}))}))}))}))})),Zo(Ho(),(function(n,t){t.event.prevFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(e){t.event.newFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(n){Mx.isOpen(e)&&(Mx.expand(n),Mx.close(e))}))}))}))]),Qm.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),v.some(!0)}}),By.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Rt("dom"),Rt("uid"),Rt("onEscape"),Rt("backstage"),Jt("onSetup",n)],apis:{focus:function(n,t){n.focus(t)},setMenus:function(n,t,e){n.setMenus(t,e)}}}),VB="container",PB=[Vf("slotBehaviours",[])],HB=function(n){return"<alloy.field."+n+">"},zB=function(n,t){var e,o=function(t){return Bl(n)},r=function(t,e){return function(o,r){return Ol(o,n,r).map((function(n){return t(n,r)})).getOr(e)}},i=function(n,t){return"true"!==Pr(n.element,"aria-hidden")},u=r(i,!1),a=r((function(n,t){if(i(n)){var e=n.element
Wi(e,"display","none"),Vr(e,"aria-hidden","true"),Go(n,zo(),{name:t,visible:!1})}})),c=(e=a,function(n,t){H(t,(function(t){return e(n,t)}))}),s=r((function(n,t){if(!i(n)){var e=n.element
Qi(e,"display"),Nr(e,"aria-hidden"),Go(n,zo(),{name:t,visible:!0})}})),f={getSlotNames:o,getSlot:function(t,e){return Ol(t,n,e)},isShowing:u,hideSlot:a,hideAllSlots:function(n){return c(n,o())},showSlot:s}
return{uid:n.uid,dom:n.dom,components:t,behaviours:Pf(n.slotBehaviours),apis:f}},NB=xn({getSlotNames:function(n,t){return n.getSlotNames(t)},getSlot:function(n,t,e){return n.getSlot(t,e)},isShowing:function(n,t,e){return n.isShowing(t,e)},hideSlot:function(n,t,e){return n.hideSlot(t,e)},hideAllSlots:function(n,t){return n.hideAllSlots(t)},showSlot:function(n,t,e){return n.showSlot(t,e)}},(function(n){return ci(n)})),LB=f(f({},NB),{sketch:function(n){var t=function(){var n=[]
return{slot:function(t,e){return n.push(t),xl(VB,HB(t),e)},record:function(){return n}}}(),e=n(t),o=t.record(),r=P(o,(function(n){return ll({name:n,pname:HB(n)})}))
return Rl(VB,PB,r,zB,e)}}),jB=it([Yt("icon"),Yt("tooltip"),ee("onShow",n),ee("onHide",n),ee("onSetup",(function(){return n}))]),UB=function(n){return{element:function(){return n.element.dom}}},WB=function(t,e){var o=P(vn(e),(function(n){var t=e[n],o=wt(function(n){return xt("sidebar",jB,n)}(t))
return{name:n,getApi:UB,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}))
return P(o,(function(e){var r=ie(n)
return t.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Th([Fv(e,r),Iv(e,r),Zo(zo(),(function(n,t){var e=t.event
U(o,(function(n){return n.name===e.name})).each((function(t){(e.visible?t.onShow:t.onHide)(t.getApi(n))}))}))])})}))},GB=function(n){return LB.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:WB(t,n),slotBehaviours:Th([ar((function(n){return LB.hideAllSlots(n)}))])}}))},XB=function(n){return Xl.getCurrent(n).bind((function(n){return gT.isGrowing(n)||gT.hasGrown(n)?Xl.getCurrent(n).bind((function(n){return U(LB.getSlotNames(n),(function(t){return LB.isShowing(n,t)}))})):v.none()}))},YB=Yr("FixSizeEvent"),qB=Yr("AutoSizeEvent"),KB=function(n){var t=ae.fromHtml(n),e=kr(t),o=function(n){var t=void 0!==n.dom.attributes?n.dom.attributes:[]
return j(t,(function(n,t){var e
return"class"===t.name?n:f(f({},n),((e={})[t.name]=t.value,e))}),{})}(t),r=function(n){return Array.prototype.slice.call(n.dom.classList,0)}(t),i=0===e.length?{}:{innerHtml:Fr(t)}
return f({tag:lr(t),classes:r,attributes:o},i)},JB=function(n){return{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:KB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:tc([Qm.config({mode:"special",onTab:function(){return v.some(!0)},onShiftTab:function(){return v.some(!0)}}),sg.config({})])}},$B=function(n,t,e){var o=ie(!1),r=ie(v.none()),i=function(n){n!==o.get()&&(function(n,t,e){var o=n.element
!0===t?(og.set(n,[JB(e)]),Qi(o,"display"),Nr(o,"aria-hidden")):(og.set(n,[]),Wi(o,"display","none"),Vr(o,"aria-hidden","true"))}(t(),n,e.providers),o.set(n))}
n.on("ProgressState",(function(t){if(r.get().each(op.clearTimeout),T(t.time)){var e=op.setEditorTimeout(n,(function(){return i(t.state)}),t.time)
r.set(v.some(e))}else i(t.state),r.set(v.none())}))},QB=JE.optional({factory:RB,name:"menubar",schema:[Rt("backstage")]}),ZB=JE.optional({factory:{sketch:function(n){return tB.sketch({uid:n.uid,dom:n.dom,listBehaviours:tc([Qm.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return TT({type:n.type,uid:Yr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:n.providers,onEscape:function(){return n.onEscape(),v.some(!0)}})},setupItem:function(n,t,e,o){A_.setGroups(t,e)},shell:!0})}},name:"multiple-toolbar",schema:[Rt("dom"),Rt("onEscape")]}),nD=JE.optional({factory:{sketch:function(n){return function(n){return n.type===Kp.sliding?_T:n.type===Kp.floating?OT:TT}(n)({type:n.type,uid:n.uid,onEscape:function(){return n.onEscape(),v.some(!0)},cyclicKeying:!1,initGroups:[],getSink:n.getSink,providers:n.providers,moreDrawerData:{lazyToolbar:n.lazyToolbar,lazyMoreButton:n.lazyMoreButton,lazyHeader:n.lazyHeader},attributes:n.attributes})}},name:"toolbar",schema:[Rt("dom"),Rt("onEscape"),Rt("getSink")]}),tD=JE.optional({factory:{sketch:function(n){var t=n.editor,e=n.sticky?FB:rB
return{uid:n.uid,dom:n.dom,components:n.components,behaviours:tc(e(t,n.sharedBackstage))}}},name:"header",schema:[Rt("dom")]}),eD=JE.optional({name:"socket",schema:[Rt("dom")]}),oD=JE.optional({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:tc([By.config({}),sg.config({}),gT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(n){Xl.getCurrent(n).each(LB.hideAllSlots),Wo(n,qB)},onGrown:function(n){Wo(n,qB)},onStartGrow:function(n){Go(n,YB,{width:Ki(n.element,"width").getOr("")})},onStartShrink:function(n){Go(n,YB,{width:Cu(n.element)+"px"})}}),og.config({}),Xl.config({find:function(n){var t=og.contents(n)
return $(t)}})])}],behaviours:tc([LS(0),rg("sidebar-sliding-events",[Zo(YB,(function(n,t){Wi(n.element,"width",t.event.width)})),Zo(qB,(function(n,t){Qi(n.element,"width")}))])])}}},name:"sidebar",schema:[Rt("dom")]}),rD=JE.optional({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:tc([og.config({})]),components:[]}}},name:"throbber",schema:[Rt("dom")]}),iD=Ll({name:"OuterContainer",factory:function(n,t,e){var o={getSocket:function(t){return KE.getPart(t,n,"socket")},setSidebar:function(t,e){KE.getPart(t,n,"sidebar").each((function(n){return function(n,t){Xl.getCurrent(n).each((function(n){return og.set(n,[GB(t)])}))}(n,e)}))},toggleSidebar:function(t,e){KE.getPart(t,n,"sidebar").each((function(n){return function(n,t){Xl.getCurrent(n).each((function(n){Xl.getCurrent(n).each((function(e){gT.hasGrown(n)?LB.isShowing(e,t)?gT.shrink(n):(LB.hideAllSlots(e),LB.showSlot(e,t)):(LB.hideAllSlots(e),LB.showSlot(e,t),gT.grow(n))}))}))}(n,e)}))},whichSidebar:function(t){return KE.getPart(t,n,"sidebar").bind(XB).getOrNull()},getHeader:function(t){return KE.getPart(t,n,"header")},getToolbar:function(t){return KE.getPart(t,n,"toolbar")},setToolbar:function(t,e){KE.getPart(t,n,"toolbar").each((function(n){n.getApis().setGroups(n,e)}))},setToolbars:function(t,e){KE.getPart(t,n,"multiple-toolbar").each((function(n){tB.setItems(n,e)}))},refreshToolbar:function(t){KE.getPart(t,n,"toolbar").each((function(n){return n.getApis().refresh(n)}))},toggleToolbarDrawer:function(t){KE.getPart(t,n,"toolbar").each((function(n){var t,e
t=n.getApis().toggle,e=function(t){return t(n)},null!=t?v.some(e(t)):v.none()}))},isToolbarDrawerToggled:function(t){return KE.getPart(t,n,"toolbar").bind((function(n){return v.from(n.getApis().isOpen).map((function(t){return t(n)}))})).getOr(!1)},getThrobber:function(t){return KE.getPart(t,n,"throbber")},focusToolbar:function(t){KE.getPart(t,n,"toolbar").orThunk((function(){return KE.getPart(t,n,"multiple-toolbar")})).each((function(n){Qm.focusIn(n)}))},setMenubar:function(t,e){KE.getPart(t,n,"menubar").each((function(n){RB.setMenus(n,e)}))},focusMenubar:function(t){KE.getPart(t,n,"menubar").each((function(n){RB.focus(n)}))}}
return{uid:n.uid,dom:n.dom,components:t,apis:o,behaviours:n.behaviours}},configFields:[Rt("dom"),Rt("behaviours")],partFields:[tD,QB,nD,ZB,eD,oD,rD],apis:{getSocket:function(n,t){return n.getSocket(t)},setSidebar:function(n,t,e){n.setSidebar(t,e)},toggleSidebar:function(n,t,e){n.toggleSidebar(t,e)},whichSidebar:function(n,t){return n.whichSidebar(t)},getHeader:function(n,t){return n.getHeader(t)},getToolbar:function(n,t){return n.getToolbar(t)},setToolbar:function(n,t,e){var o=P(e,(function(n){return ST(n)}))
n.setToolbar(t,o)},setToolbars:function(n,t,e){var o=P(e,(function(n){return P(n,ST)}))
n.setToolbars(t,o)},refreshToolbar:function(n,t){return n.refreshToolbar(t)},toggleToolbarDrawer:function(n,t){n.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(n,t){return n.isToolbarDrawerToggled(t)},getThrobber:function(n,t){return n.getThrobber(t)},setMenubar:function(n,t,e){n.setMenubar(t,e)},focusMenubar:function(n,t){n.focusMenubar(t)},focusToolbar:function(n,t){n.focusToolbar(t)}}}),uD={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},aD=function(n){return"string"==typeof n?n.split(" "):n},cD=function(n,t){var e=f(f({},uD),t.menus),o=vn(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?aD("file edit view insert format tools table help"):aD(!1===t.menubar?"":t.menubar),i=N(r,(function(n){return o&&t.menus.hasOwnProperty(n)&&t.menus[n].hasOwnProperty("items")||uD.hasOwnProperty(n)})),u=P(i,(function(o){var r=e[o]
return function(n,t,e){var o=function(n){return n.getParam("removed_menuitems","")}(e).split(/[ ,]/)
return{text:n.title,getItems:function(){return X(n.items,(function(n){var e=n.toLowerCase()
return 0===e.trim().length||I(o,(function(n){return n===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:t.menuItems[e]?[t.menuItems[e]]:[]}))}}}({title:r.title,items:aD(r.items)},t,n)}))
return N(u,(function(n){return n.getItems().length>0&&I(n.getItems(),(function(n){return"separator"!==n.type}))}))},sD=function(n){var t=function(){n._skinLoaded=!0,function(n){n.fire("SkinLoaded")}(n)}
return function(){n.initialized?t():n.on("init",t)}},fD=function(n,t){var e,o=function(n){var t=n.getParam("skin"),e=n.getParam("skin_url")
if(!1!==t){var o=t||"oxide"
e=e?n.documentBaseURI.toAbsolute(e):Qh.baseURL+"/skins/ui/"+o}return e}(t)
if(o&&(e=o+"/skin.min.css",t.contentCSS.push(o+(n?"/content.inline":"/content")+".min.css")),!1===function(n){return!1===n.getParam("skin")}(t)&&e){var r=t.ui.styleSheetLoader
r.load(e,sD(t),function(n,t){return function(){return function(n,t){return n.fire("SkinLoadError",t)}(n,{message:t})}}(t,"Skin could not be loaded")),t.on("remove",(function(){return r.unload(e)}))}else sD(t)()},lD=r(fD,!1),dD=r(fD,!0),mD=function(n,t,e,o){var r=t.outerContainer,i=e.toolbar,u=e.buttons
if(E(i,x)){var a=i.map((function(t){var r={toolbar:t,buttons:u,allowToolbarGroups:e.allowToolbarGroups}
return UE(n,r,{backstage:o},v.none())}))
iD.setToolbars(r,a)}else iD.setToolbar(r,UE(n,e,{backstage:o},v.none()))},gD=Vh.DOM,pD=ze(),hD=pD.os.isiOS()&&pD.os.version.major<=12,vD=Object.freeze({__proto__:null,render:function(n,t,e,o,r){var i=ie(0),u=t.outerContainer
lD(n)
var a=ae.fromDom(r.targetNode),c=Vi(Ri(a));(function(n,t){of(n,t,_r)})(a,t.mothership),ef(c,t.uiMothership),n.on("PostRender",(function(){mD(n,t,e,o),i.set(n.getWin().innerWidth),iD.setMenubar(u,cD(n,e)),iD.setSidebar(u,e.sidebar),function(n,t){var e=n.getWin(),o=n.getDoc().documentElement,r=ie(yu(e.innerWidth,e.innerHeight)),i=ie(yu(o.offsetWidth,o.offsetHeight)),u=function(){var t=r.get()
t.left===e.innerWidth&&t.top===e.innerHeight||(r.set(yu(e.innerWidth,e.innerHeight)),yb(n))},a=function(){var t=n.getDoc().documentElement,e=i.get()
e.left===t.offsetWidth&&e.top===t.offsetHeight||(i.set(yu(t.offsetWidth,t.offsetHeight)),yb(n))},c=function(t){return function(n,t){return n.fire("ScrollContent",t)}(n,t)}
gD.bind(e,"resize",u),gD.bind(e,"scroll",c)
var s=iy(ae.fromDom(n.getBody()),"load",a),f=t.uiMothership.element
n.on("hide",(function(){Wi(f,"display","none")})),n.on("show",(function(){Qi(f,"display")})),n.on("NodeChange",a),n.on("remove",(function(){s.unbind(),gD.unbind(e,"resize",u),gD.unbind(e,"scroll",c)}))}(n,t)}))
var s,f,l,d=iD.getSocket(u).getOrDie("Could not find expected socket element")
if(hD){Gi(d.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"})
var m=(s=function(){n.fire("ScrollContent")},f=20,l=null,{cancel:function(){null!==l&&(clearTimeout(l),l=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t]
null===l&&(l=setTimeout((function(){s.apply(null,n),l=null}),f))}})
ry(d.element,"scroll",m.throttle)}_v(n,t),n.addCommand("ToggleSidebar",(function(t,e){iD.toggleSidebar(u,e),n.fire("ToggleSidebar")})),n.addQueryValueHandler("ToggleSidebar",(function(){return iD.whichSidebar(u)}))
var g=fv(n)
return g!==Kp.sliding&&g!==Kp.floating||n.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=n.getWin().innerWidth
e!==i.get()&&(iD.refreshToolbar(t.outerContainer),i.set(e))})),{iframeContainer:d.element.dom,editorContainer:u.element.dom}}}),bD=function(n){return/^[0-9\.]+(|px)$/i.test(""+n)?v.some(parseInt(""+n,10)):v.none()},yD=function(n){return T(n)?n+"px":n},xD=function(n,t,e){var o=t.filter((function(t){return n<t})),r=e.filter((function(t){return n>t}))
return o.or(r).getOr(n)},wD=function(n){return function(n){var t=Zh(n),e=ev(n),o=rv(n)
return bD(t).map((function(n){return xD(n,e,o)}))}(n).getOr(Zh(n))},SD=function(n){var t=nv(n),e=tv(n),o=ov(n)
return bD(t).map((function(n){return xD(n,e,o)}))},kD=function(n,t,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=Vh.DOM,c=hv(n),s=bv(n),f=ov(n).or(SD(n)),l=o.shared.header,d=l.isPositionedAtTop,m=fv(n),g=m===Kp.sliding||m===Kp.floating,p=ie(!1),h=function(){return p.get()&&!n.removed},v=function(n){return g?n.fold((function(){return 0}),(function(n){return n.components().length>1?hu(n.components()[1].element):0})):0},b=function(){i.broadcastOn([vf()],{})},y=function(n){if(void 0===n&&(n=!1),h()){var e
if(c||(e=f.getOrThunk((function(){var n=bD(Yi(Ni(),"margin-left")).getOr(0)
return Cu(Ni())-wu(t).left+n})),Wi(r.get().element,"max-width",e+"px")),g&&iD.refreshToolbar(u),c||function(){var n=iD.getToolbar(u),e=v(n),o=Pu(t),i=d()?Math.max(o.y-hu(r.get().element)+e,0):o.bottom
Gi(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})}(),s){var o=r.get()
n?_B.reset(o):_B.refresh(o)}b()}},x=function(e){if(void 0===e&&(e=!0),!c&&s&&h()){var o=l.getDockingMode(),i=function(e){switch(mv(n)){case sv.auto:var o=iD.getToolbar(u),r=v(o),i=hu(e.element)-r,a=Pu(t)
if(a.y>i)return"top"
var c=yr(t),s=Math.max(c.dom.scrollHeight,hu(c))
return a.bottom<s-i||zu().bottom<a.bottom-i?"bottom":"top"
case sv.bottom:return"bottom"
case sv.top:default:return"top"}}(r.get())
i!==o&&(function(n){var t=r.get()
_B.setModes(t,[n]),l.setDockingMode(n)
var e=d()?Qu.TopToBottom:Qu.BottomToTop
Vr(t.element,zc,e)}(i),e&&y(!0))}}
return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Wi(u.element,"display","flex"),a.addClass(n.getBody(),"mce-edit-focus"),Qi(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(Wi(u.element,"display","none"),a.removeClass(n.getBody(),"mce-edit-focus")),Wi(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}},CD=function(n,t){var e=Pu(n)
return{pos:t?e.y:e.bottom,bounds:e}},OD=Object.freeze({__proto__:null,render:function(n,t,e,o,r){var i=t.mothership,u=t.uiMothership,a=t.outerContainer,c=ie(null),s=ae.fromDom(r.targetNode),f=kD(n,s,t,o,c),l=function(n){return n.getParam("toolbar_persist",!1,"boolean")}(n)
dD(n)
var d=function(){if(c.get())f.show()
else{c.set(iD.getHeader(a).getOrDie())
var r=function(n){return pv(n).getOrThunk((function(){return Vi(Ri(ae.fromDom(n.getElement())))}))}(n)
ef(r,i),ef(r,u),mD(n,t,e,o),iD.setMenubar(a,cD(n,e)),f.show(),function(n,t,e,o){var r=ie(CD(t,e.isPositionedAtTop())),i=function(o){var i=CD(t,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width
r.set({pos:u,bounds:a}),l&&yb(n,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))}
o||(n.on("activate",e.show),n.on("deactivate",e.hide)),n.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),n.on("NodeChange keydown",(function(n){op.requestAnimationFrame((function(){return i(n)}))})),n.on("ScrollWindow",(function(){return e.updateMode()}))
var u=ME()
u.set(iy(ae.fromDom(n.getBody()),"load",i)),n.on("remove",(function(){u.clear()}))}(n,s,f,l),n.nodeChanged()}}
n.on("show",d),n.on("hide",f.hide),l||(n.on("focus",d),n.on("blur",f.hide)),n.on("init",(function(){(n.hasFocus()||l)&&d()})),_v(n,t)
var m={show:function(){f.show()},hide:function(){f.hide()}}
return{editorContainer:a.element.dom,api:m}}}),_D=function(n,t){(function(n,t){var e=mE(0,t,SE(n))
n.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})})(n,t),function(n,t){var e=mE(0,t,OE(n))
n.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=f({type:"advanced"},t.styleselect),o=mE(0,t,VE(n,e))
n.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(n,t),function(n,t){var e=mE(0,t,RE(n))
n.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=mE(0,t,EE(n))
n.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t)},TD=function(n,t){return function(){n.execCommand("mceToggleFormat",!1,t)}},ED=function(n){(function(n){HC.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,e){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:FE(n,t.name),onAction:TD(n,t.name)})}))
for(var t=1;t<=6;t++){var e="h"+t
n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:FE(n,e),onAction:TD(n,e)})}})(n),function(n){HC.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}))}(n),function(n){HC.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)},onSetup:FE(n,t.name)})}))}(n)},BD=function(n){ED(n),function(n){HC.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:TD(n,"code")})}(n)},DD=function(n,t,e){var o=function(){return!!t.undoManager&&t.undoManager[e]()},r=function(){n.setDisabled(t.mode.isReadOnly()||!o())}
return n.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},AD=function(n){(function(n){n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return DD(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return DD(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})})(n),function(n){n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return DD(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return DD(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}(n)},MD={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},FD=(hE="[eE][+-]?[0-9]+",bE=["Infinity","[0-9]+\\."+(vE=function(n){return"(?:"+n+")?"})(pE="[0-9]+")+vE(hE),"\\.[0-9]+"+vE(hE),pE+vE(hE)].join("|"),new RegExp("^([+-]?(?:"+bE+"))(.*)$")),ID=function(n,t){return v.from(FD.exec(n)).bind((function(n){var e=Number(n[1]),o=n[2]
return function(n,t){return I(t,(function(t){return I(MD[t],(function(t){return n===t}))}))}(o,t)?v.some({value:e,unit:o}):v.none()}))},RD=function(n){return function(n,t){return ID(n,t).map((function(n){return n.value+n.unit}))}(n,["fixed","relative","empty"]).getOr(n)},VD=function(n){var t=function(n){return n.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")}(n),e=new Map,o=AE((function(n){return n.destroy()})),r=function(){var t=RD(n.queryCommandValue("LineHeight"))
v.from(e.get(t)).fold((function(){return o.clear()}),(function(n){o.set({destroy:function(){n.setActive(!1)}}),n.setActive(!0)}))}
return n.on("nodeChange",r),P(t,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(RD(i),a),u+1===t.length&&r(),function(){0===u&&(n.off("nodeChange",r),o.clear())}},onAction:function(){return n.execCommand("LineHeight",!1,i)}}}))},PD=function(n){(function(n){n.ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return VD(n)}})})(n),function(n){n.ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(VD(n))}})}(n)},HD=function(n,t){(function(n){HC.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:FE(n,t.name)})}))
var t="alignnone",e="No alignment",o="JustifyNone",r="align-none"
n.ui.registry.addButton(t,{tooltip:e,onAction:function(){return n.execCommand(o)},icon:r})})(n),BD(n),_D(n,t),AD(n),function(n){(function(n){n.addCommand("mceApplyTextcolor",(function(t,e){(function(n,t,e){n.undoManager.transact((function(){n.focus(),n.formatter.apply(t,{value:e}),n.nodeChanged()}))})(n,t,e)})),n.addCommand("mceRemoveTextcolor",(function(t){(function(n,t){n.undoManager.transact((function(){n.focus(),n.formatter.remove(t,{value:null},null,!0),n.nodeChanged()}))})(n,t)}))})(n)
var t=ie(null),e=ie(null)
Fb(n,"forecolor","forecolor","Text color",t),Fb(n,"backcolor","hilitecolor","Background color",e),Ib(n,"forecolor","forecolor","Text color"),Ib(n,"backcolor","hilitecolor","Background color")}(n),function(n){(function(n){n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}})})(n),function(n){n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(n,t){n.setActive(t.hasVisual)
var e=function(t){n.setActive(t.hasVisual)}
return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}}(t,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})}(n)}(n),function(n){(function(n){n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(n,t){n.setDisabled(!t.queryCommandState("outdent"))
var e=function(){n.setDisabled(!t.queryCommandState("outdent"))}
return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})})(n)}(n),PD(n)},zD=function(n,t){return{anchor:"makeshift",x:n,y:t}},ND=function(n){return"longpress"===n.type||0===n.type.indexOf("touch")},LD=function(n,t){var e=Vh.DOM.getPos(n)
return function(n,t,e){return zD(n.x+t,n.y+e)}(t,e.x,e.y)},jD=function(n,t){return"contextmenu"===t.type||"longpress"===t.type?n.inline?function(n){if(ND(n)){var t=n.touches[0]
return zD(t.pageX,t.pageY)}return zD(n.pageX,n.pageY)}(t):LD(n.getContentAreaContainer(),function(n){if(ND(n)){var t=n.touches[0]
return zD(t.clientX,t.clientY)}return zD(n.clientX,n.clientY)}(t)):UD(n)},UD=function(n){return{anchor:"selection",root:ae.fromDom(n.selection.getNode())}},WD=function(n){return{anchor:"node",node:v.some(ae.fromDom(n.selection.getNode())),root:ae.fromDom(n.getBody())}},GD=function(n,t,e,o,r,i){var u=e(),a=i?WD(n):jD(n,t)
cC(u,Jp.CLOSE_ON_EXECUTE,o,!1).map((function(n){t.preventDefault(),Gg.showMenuAt(r,a,{menu:{markers:ch("normal")},data:n})}))},XD={onLtr:function(){return[Na,Ra,Va,Pa,Ha,za,tp,ep,Zg,$g,np,Qg]},onRtl:function(){return[Na,Va,Ra,Ha,Pa,za,tp,ep,np,Qg,Zg,$g]}},YD={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},qD=function(n,t,e,o,r,i,u){var a=i?WD(n):function(n,t){return f({bubble:Rc(0,12,YD),layouts:XD,overrides:{maxWidthFunction:T_(),maxHeightFunction:Ac()}},jD(n,t))}(n,t)
cC(e,Jp.CLOSE_ON_EXECUTE,o,!0).map((function(e){t.preventDefault(),Gg.showMenuWithinBounds(r,a,{menu:{markers:ch("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return v.some(oE(n,o.shared))})),n.fire(E_)}))},KD=function(n,t,e,o,r,i){var u=ze(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){var u=e()
qD(n,t,u,o,r,i,!(s||a||c&&f))}
if(!c&&!a||i)s&&!i&&n.selection.setCursorLocation(t.target,0),l()
else{var d=function(){(function(n){var t=n.selection.getRng(),e=function(){op.setEditorTimeout(n,(function(){n.selection.setRng(t)}),10),i()}
n.once("touchend",e)
var o=function(n){n.preventDefault(),n.stopImmediatePropagation()}
n.on("mousedown",o,!0)
var r=function(){return i()}
n.once("longpresscancel",r)
var i=function(){n.off("touchend",e),n.off("longpresscancel",r),n.off("mousedown",o)}})(n),l()}
!function(n,t){var e=n.selection
if(e.isCollapsed()||t.touches.length<1)return!1
var o=t.touches[0],r=e.getRng()
return ds(n.getWin(),Kc.domRange(r)).exists((function(n){return n.left<=o.clientX&&n.right>=o.clientX&&n.top<=o.clientY&&n.bottom>=o.clientY}))}(n,t)?(n.once("selectionchange",d),n.once("touchend",(function(){return n.off("selectionchange",d)}))):d()}},JD=function(n){return"string"==typeof n?n.split(/[ ,]/):n},$D=function(n){return n.getParam("contextmenu_never_use_native",!1,"boolean")},QD=function(n){return function(n,t,e){var o=n.ui.registry.getAll().contextMenus
return v.from(n.getParam(t)).map(JD).getOrThunk((function(){return N(JD(e),(function(n){return Tn(o,n)}))}))}(n,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},ZD=function(n){return x(n)?"|"===n:"separator"===n.type},nA={type:"separator"},tA=function(n){if(x(n))return n
switch(n.type){case"separator":return nA
case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var t=n.getSubmenuItems()
return x(t)?t:P(t,tA)}}
default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:(t=n.onAction,function(){return t()})}}var t},eA=function(n,t){if(0===t.length)return n
var e=Q(n).filter((function(n){return!ZD(n)})).fold((function(){return[]}),(function(n){return[nA]}))
return n.concat(e).concat(t).concat([nA])},oA=function(n,t){return"longpress"!==t.type&&(2!==t.button||t.target===n.getBody()&&""===t.pointerType)},rA=function(n,t){return oA(n,t)?n.selection.getStart(!0):t.target},iA=function(n,t,e){var o=ze().deviceType.isTouch,r=du(Gg.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return n.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:tc([rg("dismissContextMenu",[Zo(Vo(),(function(t,e){pf.close(t),n.focus()}))])])})),i=function(n){return Gg.hide(r)},u=function(t){if($D(n)&&t.preventDefault(),!function(n,t){return t.ctrlKey&&!$D(n)}(n,t)&&!function(n){return!1===n.getParam("contextmenu")}(n)){var i=function(n,t){var e=function(n){return n.getParam("contextmenu_avoid_overlap","","string")}(n)
if(oA(n,t))return!0
if(e){var o=rA(n,t)
return ay(ae.fromDom(o),e)}return!1}(n,t);(o()?KD:GD)(n,t,(function(){var e=rA(n,t),o=n.ui.registry.getAll(),r=QD(n)
return function(n,t,e){var o=j(t,(function(t,o){if(Tn(n,o)){var r=n[o].update(e)
if(x(r))return eA(t,r.split(" "))
if(r.length>0){var i=P(r,tA)
return eA(t,i)}return t}return t.concat([o])}),[])
return o.length>0&&ZD(o[o.length-1])&&o.pop(),o}(o.contextMenus,r,e)}),e,r,i)}}
n.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow")
n.on(t,i),n.on("longpress contextmenu",u)}))},uA=Bn([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),aA=function(n){return function(t){return t.translate(-n.left,-n.top)}},cA=function(n){return function(t){return t.translate(n.left,n.top)}},sA=function(n){return function(t,e){return j(n,(function(n,t){return t(n)}),yu(t,e))}},fA=function(n,t,e){return n.fold(sA([cA(e),aA(t)]),sA([aA(t)]),sA([]))},lA=function(n,t,e){return n.fold(sA([cA(e)]),sA([]),sA([cA(t)]))},dA=function(n,t,e){return n.fold(sA([]),sA([aA(e)]),sA([cA(t),aA(e)]))},mA=function(n,t,e){var o=n.fold((function(n,t){return{position:v.some("absolute"),left:v.some(n+"px"),top:v.some(t+"px")}}),(function(n,t){return{position:v.some("absolute"),left:v.some(n-e.left+"px"),top:v.some(t-e.top+"px")}}),(function(n,t){return{position:v.some("fixed"),left:v.some(n+"px"),top:v.some(t+"px")}}))
return f({right:v.none(),bottom:v.none()},o)},gA=function(n,t,e,o){var r=function(n,r){return function(i,u){var a=n(t,e,o)
return r(i.getOr(a.left),u.getOr(a.top))}}
return n.fold(r(dA,pA),r(lA,hA),r(fA,vA))},pA=uA.offset,hA=uA.absolute,vA=uA.fixed,bA=function(n,t){var e=Pr(n,t)
return C(e)?NaN:parseInt(e,10)},yA=function(n,t,e,o){return function(n,t){var e=n.element,o=bA(e,t.leftAttr),r=bA(e,t.topAttr)
return isNaN(o)||isNaN(r)?v.none():v.some(yu(o,r))}(n,t).fold((function(){return e}),(function(n){return vA(n.left+o.left,n.top+o.top)}))},xA=function(n,t,e,o,r,i){var u=yA(n,t,e,o),a=t.mustSnap?kA(n,t,u,r,i):CA(n,t,u,r,i),c=fA(u,r,i)
return function(n,t,e){var o=n.element
Vr(o,t.leftAttr,e.left+"px"),Vr(o,t.topAttr,e.top+"px")}(n,t,c),a.fold((function(){return{coord:vA(c.left,c.top),extra:v.none()}}),(function(n){return{coord:n.output,extra:n.extra}}))},wA=function(n,t){(function(n,t){var e=n.element
Nr(e,t.leftAttr),Nr(e,t.topAttr)})(n,t)},SA=function(n,t,e,o){return nn(n,(function(n){var r=n.sensor
return function(n,t,e,o,r,i){var u=lA(n,r,i),a=lA(t,r,i)
return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o}(t,r,n.range.left,n.range.top,e,o)?v.some({output:gA(n.output,t,e,o),extra:n.extra}):v.none()}))},kA=function(n,t,e,o,r){var i=t.getSnapPoints(n)
return SA(i,e,o,r).orThunk((function(){return j(i,(function(n,t){var i=t.sensor,u=function(n,t,e,o,r,i){var u=lA(n,r,i),a=lA(t,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top)
return yu(c,s)}(e,i,t.range.left,t.range.top,o,r)
return n.deltas.fold((function(){return{deltas:v.some(u),snap:v.some(t)}}),(function(e){return(u.left+u.top)/2<=(e.left+e.top)/2?{deltas:v.some(u),snap:v.some(t)}:n}))}),{deltas:v.none(),snap:v.none()}).snap.map((function(n){return{output:gA(n.output,e,o,r),extra:n.extra}}))}))},CA=function(n,t,e,o,r){var i=t.getSnapPoints(n)
return SA(i,e,o,r)},OA=Object.freeze({__proto__:null,snapTo:function(n,t,e,o){var r=t.getTarget(n.element)
if(t.repositionTarget){var i=vr(n.element),u=Bu(i),a=aB(r),c=function(n,t,e){return{coord:gA(n.output,n.output,t,e),extra:n.extra}}(o,u,a),s=mA(c.coord,0,a)
Xi(r,s)}}}),_A="data-initial-z-index",TA=function(n,t){n.getSystem().addToGui(t),function(n){wr(n.element).filter(mr).each((function(t){Ki(t,"z-index").each((function(n){Vr(t,_A,n)})),Wi(t,"z-index",Yi(n.element,"z-index"))}))}(t)},EA=function(n){(function(n){wr(n.element).filter(mr).each((function(n){Hr(n,_A).fold((function(){return Qi(n,"z-index")}),(function(t){return Wi(n,"z-index",t)})),Nr(n,_A)}))})(n),n.getSystem().removeFromGui(n)},BA=function(n,t,e){return n.getSystem().build(Sy.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:e}))},DA=Kt("snaps",[Rt("getSnapPoints"),la("onSensor"),Rt("leftAttr"),Rt("topAttr"),Jt("lazyViewport",zu),Jt("mustSnap",!1)]),AA=[Jt("useFixed",a),Rt("blockerClass"),Jt("getTarget",o),Jt("onDrag",n),Jt("repositionTarget",!0),Jt("onDrop",n),ee("getBounds",zu),DA],MA=function(n){return(t=Ki(n,"left"),e=Ki(n,"top"),o=Ki(n,"position"),r=function(n,t,e){return("fixed"===e?vA:pA)(parseInt(n,10),parseInt(t,10))},t.isSome()&&e.isSome()&&o.isSome()?v.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):v.none()).getOrThunk((function(){var t=wu(n)
return hA(t.left,t.top)}))
var t,e,o,r},FA=function(n,t,e,o,r,i,u){return function(n,t,e,o,r){var i=r.bounds,u=lA(t,e,o),a=Cc(u.left,i.x,i.x+i.width-r.width),c=Cc(u.top,i.y,i.y+i.height-r.height),s=hA(a,c)
return t.fold((function(){var n=dA(s,e,o)
return pA(n.left,n.top)}),(function(){return s}),(function(){var n=fA(s,e,o)
return vA(n.left,n.top)}))}(0,t.fold((function(){var n,t,u,a=(n=e,t=i.left,u=i.top,n.fold((function(n,e){return pA(n+t,e+u)}),(function(n,e){return hA(n+t,e+u)}),(function(n,e){return vA(n+t,e+u)}))),c=fA(a,o,r)
return vA(c.left,c.top)}),(function(t){var u=xA(n,t,e,i,o,r)
return u.extra.each((function(e){t.onSensor(n,e)})),u.coord})),o,r,u)},IA=function(n,t){return{bounds:n.getBounds(),height:vu(t.element),width:Ou(t.element)}},RA=function(n,t,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return IA(t,n)}))
i.each((function(e){(function(n,t,e,o){var r=t.getTarget(n.element)
if(t.repositionTarget){var i=vr(n.element),u=Bu(i),a=aB(r),c=MA(r),s=FA(n,t.snaps,c,u,a,o,e),f=mA(s,0,a)
Xi(r,f)}t.onDrag(n,r,o)})(n,t,u,e)}))},VA=function(n,t,e,o){t.each(EA),e.snaps.each((function(t){wA(n,t)}))
var r=e.getTarget(n.element)
o.reset(),e.onDrop(n,r)},PA=function(n){return function(t,e){var o=function(n){e.setStartData(IA(t,n))}
return Jo(d([Zo(Mo(),(function(n){e.getStartData().each((function(){return o(n)}))}))],n(t,e,o)))}},HA=Object.freeze({__proto__:null,getData:function(n){return v.from(yu(n.x,n.y))},getDelta:function(n,t){return yu(t.left-n.left,t.top-n.top)}}),zA=function(n,t,e){return[Zo(eo(),(function(o,r){if(0===r.event.raw.button){r.stop()
var i=function(){return VA(o,v.some(c),n,t)},u=cy(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),RA(o,n,t,HA,e)}},c=BA(o,n.blockerClass,function(n){return Jo([Zo(eo(),n.forceDrop),Zo(io(),n.drop),Zo(oo(),(function(t,e){n.move(e.event)})),Zo(ro(),n.delayDrop)])}(a))
e(o),TA(o,c)}}))]},NA=d(AA,[pa("dragger",{handlers:PA(zA)})]),LA=Object.freeze({__proto__:null,getData:function(n){var t=n.raw.touches
return 1===t.length?function(n){var t=n[0]
return v.some(yu(t.clientX,t.clientY))}(t):v.none()},getDelta:function(n,t){return yu(t.left-n.left,t.top-n.top)}}),jA=function(n,t,e){var o=ie(v.none())
return[Zo(Qe(),(function(r,i){i.stop()
var u=function(){VA(r,o.get(),n,t),o.set(v.none())},a={drop:u,delayDrop:function(){},forceDrop:u,move:function(e){RA(r,n,t,LA,e)}},c=BA(r,n.blockerClass,function(n){return Jo([Zo(Qe(),n.forceDrop),Zo(no(),n.drop),Zo(to(),n.drop),Zo(Ze(),(function(t,e){n.move(e.event)}))])}(a))
o.set(v.some(c))
e(r),TA(r,c)})),Zo(Ze(),(function(e,o){o.stop(),RA(e,n,t,LA,o.event)})),Zo(no(),(function(e,r){r.stop(),VA(e,o.get(),n,t),o.set(v.none())})),Zo(to(),(function(e){VA(e,o.get(),n,t),o.set(v.none())}))]},UA=NA,WA=d(AA,[pa("dragger",{handlers:PA(jA)})]),GA=d(AA,[pa("dragger",{handlers:PA((function(n,t,e){return d(zA(n,t,e),jA(n,t,e))}))})]),XA=ic({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:UA,touch:WA,mouseOrTouch:GA}),name:"dragging",active:{events:function(n,t){return n.dragger.handlers(n,t)}},extra:{snap:function(n){return{sensor:n.sensor,range:n.range,output:n.output,extra:v.from(n.extra)}}},state:Object.freeze({__proto__:null,init:function(){var n=v.none(),t=v.none(),o=e({})
return fi({readState:o,reset:function(){n=v.none(),t=v.none()},update:function(t,e){return t.getData(e).bind((function(e){return function(t,e){var o=n.map((function(n){return t.getDelta(n,e)}))
return n=v.some(e),o}(t,e)}))},getStartData:function(){return t},setStartData:function(n){t=v.some(n)}})}}),apis:OA}),YA=function(n,t,e,o,r,i){return n.fold((function(){return XA.snap({sensor:hA(e-20,o-20),range:yu(r,i),output:hA(v.some(e),v.some(o)),extra:{td:t}})}),(function(n){var r=e-20,i=o-20,u=n.element.dom.getBoundingClientRect()
return XA.snap({sensor:hA(r,i),range:yu(40,40),output:hA(v.some(e-u.width/2),v.some(o-u.height/2)),extra:{td:t}})}))},qA=function(n,t,e){return{getSnapPoints:n,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(n,o){var r=o.td;(function(n,t){return n.exists((function(n){return je(n,t)}))})(t.get(),r)||(t.set(v.some(r)),e(r))},mustSnap:!0}},KA=function(n){return ip(rp.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:tc([XA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:n}),Ix.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},JA=function(n,t){var e=ie([]),o=ie([]),r=ie(!1),i=ie(v.none()),u=ie(v.none()),a=function(n){var e=Hu(n)
return YA(l.getOpt(t),n,e.x,e.y,e.width,e.height)},c=function(n){var e=Hu(n)
return YA(d.getOpt(t),n,e.right,e.bottom,e.width,e.height)},s=qA((function(){return P(e.get(),(function(n){return a(n)}))}),i,(function(t){u.get().each((function(e){n.fire("TableSelectorChange",{start:t,finish:e})}))})),f=qA((function(){return P(o.get(),(function(n){return c(n)}))}),u,(function(t){i.get().each((function(e){n.fire("TableSelectorChange",{start:e,finish:t})}))})),l=KA(s),d=KA(f),m=du(l.asSpec()),g=du(d.asSpec()),p=function(t,e,o,r){var i=o(e)
XA.snapTo(t,i);(function(t,e,o,r){var i=e.dom.getBoundingClientRect()
Qi(t.element,"display")
var u=xr(ae.fromDom(n.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&Wi(t.element,"display","none")})(t,e,(function(n){return n[r]<0}),(function(n,t){return n[r]>t}))},h=function(n){return p(m,n,a,"top")},b=function(n){return p(g,n,c,"bottom")}
ze().deviceType.isTouch()&&(n.on("TableSelectionChange",(function(n){r.get()||($s(t,m),$s(t,g),r.set(!0)),i.set(v.some(n.start)),u.set(v.some(n.finish)),n.otherCells.each((function(t){e.set(t.upOrLeftCells),o.set(t.downOrRightCells),h(n.start),b(n.finish)}))})),n.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(b)})),n.on("TableSelectionClear",(function(){r.get()&&(nf(m),nf(g),r.set(!1)),i.set(v.none()),u.set(v.none())})))};(function(n){n[n.None=0]="None",n[n.Both=1]="Both",n[n.Vertical=2]="Vertical"})(yE||(yE={}))
var $A=function(n,t,e){var o=ae.fromDom(n.getContainer()),r=function(n,t,e,o,r){var i={}
return i.height=xD(o+t.top,ev(n),rv(n)),e===yE.Both&&(i.width=xD(r+t.left,tv(n),ov(n))),i}(n,t,e,hu(o),Cu(o))
yn(r,(function(n,t){return Wi(o,t,yD(n))})),function(n){n.fire("ResizeEditor")}(n)},QA=function(n){if(1===n.nodeType){if("BR"===n.nodeName||n.getAttribute("data-mce-bogus"))return!0
if("bookmark"===n.getAttribute("data-mce-type"))return!0}return!1},ZA=function(n,t,e){t.delimiter||(t.delimiter="")
return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:tc([Qm.config({mode:"flow",selector:"div[role=button]"}),$h.config({disabled:e.isReadOnly}),Tv(),By.config({}),og.config({}),rg("elementPathEvents",[ar((function(o,r){n.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Qm.focusIn(o)})),n.on("NodeChange",(function(r){var i,u,a=function(t){for(var e=[],o=t.length;o-- >0;){var r=t[o]
if(1===r.nodeType&&!QA(r)){var i=n.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r})
if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents)
a.length>0?og.set(o,(i=P(a||[],(function(t,o){return rp.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:t.name},action:function(e){n.focus(),n.selection.select(t.element),n.nodeChanged()},buttonBehaviours:tc([Bv(e.isReadOnly),Tv()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}},j(i.slice(1),(function(n,t){var e=n
return e.push(u),e.push(t),e}),[i[0]]))):og.set(o,[])}))}))])]),components:[]}},nM=function(n,t){var e=function(){var e,o=[]
return n.getParam("elementpath",!0,"boolean")&&o.push(ZA(n,{},t)),n.hasPlugin("wordcount")&&o.push(function(n,t){var e,o=function(n,e,o){return og.set(n,[su(t.translate(["{0} "+o,e[o]]))])}
return rp.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:tc([Bv(t.isReadOnly),Tv(),By.config({}),og.config({}),Rf.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),rg("wordcount-events",[fr((function(n){var t=Rf.getValue(n),e="words"===t.mode?"characters":"words"
Rf.setValue(n,{mode:e,count:t.count}),o(n,t.count,e)})),ar((function(t){n.on("wordCountUpdate",(function(n){var e=Rf.getValue(t).mode
Rf.setValue(t,{mode:e,count:n.wordCount}),o(t,n.wordCount,e)}))}))])]),eventOrder:(e={},e[ko()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(n,t)),n.getParam("branding",!0,"boolean")&&o.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=Ph.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]}
return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=function(n){var t=!n.hasPlugin("autoresize"),e=n.getParam("resize",t)
return!1===e?yE.None:"both"===e?yE.Both:yE.Vertical}(n)
return r!==yE.None&&o.push(function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:ap("resize-handle",t.icons)},behaviours:tc([XA.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,o,r){$A(n,r,e)},blockerClass:"tox-blocker"})])}}(r)),o}()}},tM=function(n){var t,e=n.inline,o=e?OD:vD,r=bv(n)?IB:iB,i=v.none(),u=ze(),a=u.browser.isIE()?["tox-platform-ie"]:[],c=u.deviceType.isTouch()?["tox-platform-touch"]:[],s=gv(n),l=Ph.isRtl()?{attributes:{dir:"rtl"}}:{},d={attributes:(t={},t[zc]=s?Qu.BottomToTop:Qu.TopToBottom,t)},m=function(){return i.bind(iD.getHeader)},g=du({dom:f({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(c)},l),behaviours:tc([Xs.config({useFixed:function(){return r.isDocked(m)}})])}),p=function(){return on.value(g)},h=ip({dom:{tag:"div",classes:["tox-anchorbar"]}}),b=function(){return i.bind((function(n){return iD.getThrobber(n)})).getOrDie("Could not find throbber element")},y=__(g,n,(function(){return i.bind((function(n){return h.getOpt(n)})).getOrDie("Could not find a anchor bar element")})),x=iD.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:y,onEscape:function(){n.focus()}}),w=fv(n),S=iD.parts.toolbar(f({dom:{tag:"div",classes:["tox-toolbar"]},getSink:p,providers:y.shared.providers,onEscape:function(){n.focus()},type:w,lazyToolbar:function(){return i.bind((function(n){return iD.getToolbar(n)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return m().getOrDie("Could not find header element")}},d)),k=iD.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:y.shared.providers,onEscape:function(){n.focus()},type:w}),C=iD.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),O=iD.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),_=iD.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:y}),T=n.getParam("statusbar",!0,"boolean")&&!e?v.some(nM(n,y.shared.providers)):v.none(),E={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[C,O]},B=cv(n),D=uv(n),A=iv(n),M=iD.parts.header({dom:f({tag:"div",classes:["tox-editor-header"]},d),components:G([A?[x]:[],B?[k]:D?[S]:[],hv(n)?[]:[h.asSpec()]]),sticky:bv(n),editor:n,sharedBackstage:y.shared}),F=G([s?[]:[M],e?[]:[E],s?[M]:[]]),I=G([[{dom:{tag:"div",classes:["tox-editor-container"]},components:F}],e?[]:T.toArray(),[_]]),R=vv(n),V=f(f({role:"application"},Ph.isRtl()?{dir:"rtl"}:{}),R?{"aria-hidden":"true"}:{}),P=du(iD.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(s?["tox-tinymce--toolbar-bottom"]:[]).concat(c).concat(a),styles:f({visibility:"hidden"},R?{opacity:"0",border:"0"}:{}),attributes:V},components:I,behaviours:tc([Qm.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}))
i=v.some(P),n.shortcuts.add("alt+F9","focus menubar",(function(){iD.focusMenubar(P)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){iD.focusToolbar(P)})),n.addCommand("ToggleToolbarDrawer",(function(){iD.toggleToolbarDrawer(P)})),n.addQueryStateHandler("ToggleToolbarDrawer",(function(){return iD.isToolbarDrawerToggled(P)}))
var z=ky(P),N=ky(g);(function(n,t,e){var o=function(n,o){H([t,e],(function(t){t.broadcastEvent(n,o)}))},r=function(n,o){H([t,e],(function(t){t.broadcastOn([n],o)}))},i=function(n){return r(hf(),{target:n.target})},u=ry(ae.fromDom(document),"touchstart",i),a=ry(ae.fromDom(document),"touchmove",(function(n){return o(Do(),n)})),c=ry(ae.fromDom(document),"touchend",(function(n){return o(Ao(),n)})),s=ry(ae.fromDom(document),"mousedown",i),f=ry(ae.fromDom(document),"mouseup",(function(n){0===n.raw.button&&r(bf(),{target:n.target})})),l=function(n){return r(hf(),{target:ae.fromDom(n.target)})},d=function(n){0===n.button&&r(bf(),{target:ae.fromDom(n.target)})},m=function(n){return o(Mo(),uy(n))},g=function(n){r(vf(),{}),o(Fo(),uy(n))},p=function(){return r(vf(),{})}
n.on("PostRender",(function(){n.on("click",l),n.on("tap",l),n.on("mouseup",d),n.on("ScrollWindow",m),n.on("ResizeWindow",g),n.on("ResizeEditor",p)})),n.on("remove",(function(){n.off("click",l),n.off("tap",l),n.off("mouseup",d),n.off("ScrollWindow",m),n.off("ResizeWindow",g),n.off("ResizeEditor",p),s.unbind(),u.unbind(),a.unbind(),c.unbind(),f.unbind()})),n.on("detach",(function(){rf(t),rf(e),t.destroy(),e.destroy()}))})(n,z,N)
var L=function(){var t=yD(wD(n)),e=yD(function(n){return SD(n).getOr(nv(n))}(n))
return n.inline||($i("div","width",e)&&Wi(P.element,"width",e),$i("div","height",t)?Wi(P.element,"height",t):Wi(P.element,"height","200px")),t}
return{mothership:z,uiMothership:N,backstage:y,renderUI:function(){r.setup(n,y.shared,m),HD(n,y),iA(n,p,y),function(n){var t=n.ui.registry.getAll().sidebars
H(vn(t),(function(e){var o=t[e],r=function(){return v.from(n.queryCommandValue("ToggleSidebar")).is(e)}
n.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(t){n.execCommand("ToggleSidebar",!1,e),t.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())}
return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}))}(n),$B(n,b,y.shared),xn(function(n){return n.getParam("toolbar_groups",{},"object")}(n),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}))
var t=n.ui.registry.getAll(),e=t.buttons,i=t.menuItems,u=t.contextToolbars,a=t.sidebars,c=av(n),s={menuItems:i,menus:yv(n),menubar:xv(n),toolbar:c.getOrThunk((function(){return function(n){return n.getParam("toolbar",!0)}(n)})),allowToolbarGroups:w===Kp.floating,buttons:e,sidebar:a}
qE(n,u,g,{backstage:y}),JA(n,g)
var f=n.getElement(),l=L(),d={mothership:z,uiMothership:N,outerContainer:P},h={targetNode:f,height:l}
return o.render(n,d,s,y,h)},getUi:function(){return{channels:{broadcastAll:N.broadcast,broadcastOn:N.broadcastOn,register:function(){}}}}}},eM=e([Rt("lazySink"),Wt("dragBlockClass"),ee("getBounds",zu),Jt("useTabstopAt",c),Jt("eventOrder",{}),Vf("modalBehaviours",[Qm]),da("onExecute"),ga("onEscape")]),oM={sketch:o},rM=e([ml({name:"draghandle",overrides:function(n,t){return{behaviours:tc([XA.config({mode:"mouse",getTarget:function(n){return Gu(n,'[role="dialog"]').getOr(n)},blockerClass:n.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:n.getDragBounds})])}}}),ll({schema:[Rt("dom")],name:"title"}),ll({factory:oM,schema:[Rt("dom")],name:"close"}),ll({factory:oM,schema:[Rt("dom")],name:"body"}),ml({factory:oM,schema:[Rt("dom")],name:"footer"}),dl({factory:{sketch:function(n,t){return f(f({},n),{dom:t.dom,components:t.components})}},schema:[Jt("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Jt("components",[])],name:"blocker"})]),iM=Ll({name:"ModalDialog",configFields:eM(),partFields:rM(),factory:function(n,t,e,r){var i,u=Yr("alloy.dialog.busy"),a=Yr("alloy.dialog.idle"),c=tc([Qm.config({mode:"special",onTab:function(){return v.some(!0)},onShiftTab:function(){return v.some(!0)}}),sg.config({})]),s=Yr("modal-events"),l=f(f({},n.eventOrder),((i={})[Io()]=[s].concat(n.eventOrder["alloy.system.attached"]||[]),i))
return{uid:n.uid,dom:n.dom,components:t,apis:{show:function(t){var e=n.lazySink(t).getOrDie(),o=ie(v.none()),i=r.blocker(),s=e.getSystem().build(f(f({},i),{components:i.components.concat([mu(t)]),behaviours:tc([sg.config({}),rg("dialog-blocker-events",[ur(ao(),(function(){Qm.focusIn(t)})),Zo(a,(function(n,e){zr(t.element,"aria-busy")&&(Nr(t.element,"aria-busy"),o.get().each((function(n){return og.remove(t,n)})))})),Zo(u,(function(n,e){Vr(t.element,"aria-busy","true")
var r=e.event.getBusySpec
o.get().each((function(n){og.remove(t,n)}))
var i=r(t,c),u=n.getSystem().build(i)
o.set(v.some(u)),og.append(t,mu(u)),u.hasConfigured(Qm)&&Qm.focusIn(u)}))])])}))
$s(e,s),Qm.focusIn(t)},hide:function(n){wr(n.element).each((function(t){n.getSystem().getByDom(t).each((function(n){nf(n)}))}))},getBody:function(t){return _l(t,n,"body")},getFooter:function(t){return _l(t,n,"footer")},setIdle:function(n){Wo(n,a)},setBusy:function(n,t){Go(n,u,{getBusySpec:t})}},eventOrder:l,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Hf(n.modalBehaviours,[og.config({}),Qm.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt}),rg(s,[ar((function(t){var e,r,i,u,a,c
e=t.element,r=_l(t,n,"title").element,i=Hr(e,"id").fold((function(){var n=Yr("dialog-label")
return Vr(r,"id",n),n}),o),Vr(e,"aria-labelledby",i),u=t.element,a=_l(t,n,"body").element,c=v.from(Pr(u,"id")).fold((function(){var n=Yr("dialog-describe")
return Vr(a,"id",n),n}),o),Vr(u,"aria-describedby",c)}))])])}},apis:{show:function(n,t){n.show(t)},hide:function(n,t){n.hide(t)},getBody:function(n,t){return n.getBody(t)},getFooter:function(n,t){return n.getFooter(t)},setBusy:function(n,t,e){n.setBusy(t,e)},setIdle:function(n,t){n.setIdle(t)}}}),uM=it([Ht("type"),Ht("name")].concat(yh)),aM=Dt,cM=[dt("name","name",Nn((function(){return Yr("button-name")})),Bt),Yt("icon"),ne("align","end",["start","end"]),te("primary",!1),te("disabled",!1)],sM=d(cM,[Ht("text")]),fM=d([zt("type",["submit","cancel","custom"])],sM),lM=d([zt("type",["menu"]),Yt("text"),Yt("tooltip"),Yt("icon"),Ut("items",uM)],cM),dM=Ot("type",{submit:fM,cancel:fM,custom:fM,menu:lM}),mM=[Ht("type"),Ht("text"),zt("level",["info","warn","error","success"]),Ht("icon"),Jt("url","")],gM=it(mM),pM=[Ht("type"),Ht("text"),te("disabled",!1),te("primary",!1),dt("name","name",Nn((function(){return Yr("button-name")})),Bt),Yt("icon"),te("borderless",!1)],hM=it(pM),vM=[Ht("type"),Ht("name"),Ht("label"),te("disabled",!1)],bM=it(vM),yM=Dt,xM=[Ht("type"),Ht("name")],wM=xM.concat([Yt("label")]),SM=wM.concat([Jt("columns","auto")]),kM=it(SM),CM=ht([Ht("value"),Ht("text"),Ht("icon")]),OM=it(wM),_M=Bt,TM=it(wM),EM=Bt,BM=xM.concat([Zt("tag","textarea"),Ht("scriptId"),Ht("scriptUrl"),function(n,t){return $t(n,t,Ft)}("settings",void 0)]),DM=xM.concat([Zt("tag","textarea"),Nt("init")]),AM=bt((function(n){return xt("customeditor.old",rt(DM),n).orThunk((function(){return xt("customeditor.new",rt(BM),n)}))})),MM=Bt,FM=it(wM),IM=ut(pt),RM=function(n){return[Ht("type"),Pt("columns"),n]},VM=[Ht("type"),Ht("html"),ne("presets","presentation",["presentation","document"])],PM=it(VM),HM=wM.concat([te("sandboxed",!0)]),zM=it(HM),NM=Bt,LM=wM.concat([Vt("currentState",it([Rt("blob"),Ht("url")]))]),jM=it(LM),UM=wM.concat([Yt("inputMode"),Yt("placeholder"),te("maximized",!1),te("disabled",!1)]),WM=it(UM),GM=Bt,XM=function(n){return[Ht("type"),Ht("label"),n]},YM=[Ht("text"),Ht("value")],qM=[Ht("text"),Ut("items",function(n,t){return e=t,o=In((function(){return e()})),{extract:function(n,t,e){return o().extract(n,t,e)},toString:function(){return o().toString()}}
var e,o}(0,(function(){return KM})))],KM=at([it(YM),it(qM)]),JM=wM.concat([Ut("items",KM),te("disabled",!1)]),$M=it(JM),QM=Bt,ZM=wM.concat([jt("items",[Ht("text"),Ht("value")]),Qt("size",1),te("disabled",!1)]),nF=it(ZM),tF=Bt,eF=wM.concat([te("constrain",!0),te("disabled",!1)]),oF=it(eF),rF=it([Ht("width"),Ht("height")]),iF=[Ht("type"),Ut("header",Bt),Ut("cells",ut(Bt))],uF=it(iF),aF=wM.concat([Yt("placeholder"),te("maximized",!1),te("disabled",!1)]),cF=it(aF),sF=Bt,fF=wM.concat([ne("filetype","file",["image","media","file"]),Jt("disabled",!1)]),lF=it(fF),dF=it([Ht("value"),Jt("meta",{})]),mF=function(n){return dt("items","items",Hn(),ut(bt((function(t){return xt("Checking item of "+n,gF,t).fold((function(n){return on.error(kt(n))}),(function(n){return on.value(n)}))}))))},gF=vt((function(){return Ct("type",{alertbanner:gM,bar:it((n=mF("bar"),[Ht("type"),n])),button:hM,checkbox:bM,colorinput:OM,colorpicker:TM,dropzone:FM,grid:it(RM(mF("grid"))),iframe:zM,input:WM,listbox:$M,selectbox:nF,sizeinput:oF,textarea:cF,urlinput:lF,customeditor:AM,htmlpanel:PM,imagetools:jM,collection:kM,label:it(XM(mF("label"))),table:uF,panel:hF})
var n})),pF=[Ht("type"),Jt("classes",[]),Ut("items",gF)],hF=it(pF),vF=[dt("name","name",Nn((function(){return Yr("tab-name")})),Bt),Ht("title"),Ut("items",gF)],bF=[Ht("type"),jt("tabs",vF)],yF=it(bF),xF=sM,wF=dM,SF=it([Ht("title"),Vt("body",Ct("type",{panel:hF,tabpanel:yF})),Zt("size","normal"),Ut("buttons",wF),Jt("initialData",{}),ee("onAction",n),ee("onChange",n),ee("onSubmit",n),ee("onClose",n),ee("onCancel",n),Jt("onTabChange",n)]),kF=it(d([zt("type",["cancel","custom"])],xF)),CF=it([Ht("title"),Ht("url"),Xt("height"),Xt("width"),function(n,t){return Gt(n,ut(t))}("buttons",kF),ee("onAction",n),ee("onCancel",n),ee("onClose",n),ee("onMessage",n)]),OF=function(n){return w(n)?[n].concat(X(On(n),OF)):S(n)?X(n,OF):[]},_F=function(n){return x(n.type)&&x(n.name)},TF={checkbox:yM,colorinput:_M,colorpicker:EM,dropzone:IM,input:GM,iframe:NM,sizeinput:rF,selectbox:tF,listbox:QM,size:rF,textarea:sF,urlinput:dF,customeditor:MM,collection:CM,togglemenuitem:aM},EF=function(n){var t=function(n){return N(OF(n),_F)}(n),e=X(t,(function(n){return function(n){return v.from(TF[n.type])}(n).fold((function(){return[]}),(function(t){return[Vt(n.name,t)]}))}))
return it(e)},BF=function(n){return{internalDialog:wt(xt("dialog",SF,n)),dataValidator:EF(n),initialData:n.initialData}},DF={open:function(n,t){var e=BF(t)
return n(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(n,t){return n(wt(xt("dialog",CF,t)))},redial:function(n){return BF(n)}},AF=function(n){var t=[],e={}
return yn(n,(function(n,o){n.fold((function(){t.push(o)}),(function(n){e[o]=n}))})),t.length>0?on.error(t):on.value(e)},MF=function(n,t){var e=ip(AS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:P(n.items,(function(n){return MO(e,n,t)}))}})))
return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:tc([Qm.config({mode:"acyclic",useTabstopAt:i(ik)}),NS(e),qS(e,{postprocess:function(n){return AF(n).fold((function(n){return console.error(n),{}}),(function(n){return n}))}})])}},FF=Nl({name:"TabButton",configFields:[Jt("uid",void 0),Rt("value"),dt("dom","dom",Ln((function(){return{attributes:{role:"tab",id:Yr("aria"),"aria-selected":"false"}}})),_t()),Wt("action"),Jt("domModification",{}),Vf("tabButtonBehaviours",[sg,Qm,Rf]),Rt("view")],factory:function(n,t){return{uid:n.uid,dom:n.dom,components:n.components,events:kg(n.action),behaviours:Hf(n.tabButtonBehaviours,[sg.config({}),Qm.config({mode:"execution",useSpace:!0,useEnter:!0}),Rf.config({store:{mode:"memory",initialValue:n.value}})]),domModification:n.domModification}}}),IF=e([Rt("tabs"),Rt("dom"),Jt("clickToDismiss",!1),Vf("tabbarBehaviours",[od,Qm]),sa(["tabClass","selectedClass"])]),RF=gl({factory:FF,name:"tabs",unit:"tab",overrides:function(t){var e=function(n,t){od.dehighlight(n,t),Go(n,Lo(),{tabbar:n,button:t})},o=function(n,t){od.highlight(n,t),Go(n,No(),{tabbar:n,button:t})}
return{action:function(r){var i=r.getSystem().getByUid(t.uid).getOrDie(),u=od.isHighlighted(i,r);(u&&t.clickToDismiss?e:u?n:o)(i,r)},domModification:{classes:[t.markers.tabClass]}}}}),VF=e([RF]),PF=Ll({name:"Tabbar",configFields:IF(),partFields:VF(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Hf(n.tabbarBehaviours,[od.config({highlightClass:n.markers.selectedClass,itemClass:n.markers.tabClass,onHighlight:function(n,t){Vr(t.element,"aria-selected","true")},onDehighlight:function(n,t){Vr(t.element,"aria-selected","false")}}),Qm.config({mode:"flow",getInitial:function(n){return od.getHighlighted(n).map((function(n){return n.element}))},selector:"."+n.markers.tabClass,executeOnMove:!0})])}}}),HF=Nl({name:"Tabview",configFields:[Vf("tabviewBehaviours",[og])],factory:function(n,t){return{uid:n.uid,dom:n.dom,behaviours:Hf(n.tabviewBehaviours,[og.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),zF=e([Jt("selectFirst",!0),la("onChangeTab"),la("onDismissTab"),Jt("tabs",[]),Vf("tabSectionBehaviours",[])]),NF=ll({factory:PF,schema:[Rt("dom"),Lt("markers",[Rt("tabClass"),Rt("selectedClass")])],name:"tabbar",defaults:function(n){return{tabs:n.tabs}}}),LF=ll({factory:HF,name:"tabview"}),jF=e([NF,LF]),UF=Ll({name:"TabSection",configFields:zF(),partFields:jF(),factory:function(n,t,e,o){var r=function(t,e){Ol(t,n,"tabbar").each((function(n){e(n).each(Xo)}))}
return{uid:n.uid,dom:n.dom,components:t,behaviours:Pf(n.tabSectionBehaviours),events:Jo(G([n.selectFirst?[ar((function(n,t){r(n,od.getFirst)}))]:[],[Zo(No(),(function(t,e){(function(t){var e=Rf.getValue(t)
Ol(t,n,"tabview").each((function(o){U(n.tabs,(function(n){return n.value===e})).each((function(e){var r=e.view()
Hr(t.element,"id").each((function(n){Vr(o.element,"aria-labelledby",n)})),og.set(o,r),n.onChangeTab(o,t,r)}))}))})(e.event.button)})),Zo(Lo(),(function(t,e){var o=e.event.button
n.onDismissTab(t,o)}))]])),apis:{getViewItems:function(t){return Ol(t,n,"tabview").map((function(n){return og.contents(n)})).getOr([])},showTab:function(n,t){r(n,(function(n){var e=od.getCandidates(n)
return U(e,(function(n){return Rf.getValue(n)===t})).filter((function(t){return!od.isHighlighted(n,t)}))}))}}}},apis:{getViewItems:function(n,t){return n.getViewItems(t)},showTab:function(n,t,e){n.showTab(t,e)}}}),WF=function(n,t){Wi(n,"height",t+"px"),ze().browser.isIE()?Qi(n,"flex-basis"):Wi(n,"flex-basis",t+"px")},GF=function(n,t,e){Gu(n,'[role="dialog"]').each((function(n){Xu(n,'[role="tablist"]').each((function(o){e.get().map((function(e){return Wi(t,"height","0"),Wi(t,"flex-basis","0"),Math.min(e,function(n,t,e){var o,r=yr(n).dom,i=Gu(n,".tox-dialog-wrap").getOr(n)
o="fixed"===Yi(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight)
var u=hu(t),a=t.dom.offsetLeft>=e.dom.offsetLeft+Cu(e)?Math.max(hu(e),u):u,c=parseInt(Yi(n,"margin-top"),10)||0,s=parseInt(Yi(n,"margin-bottom"),10)||0
return o-(hu(n)+c+s-a)}(n,t,o))})).each((function(n){WF(t,n)}))}))}))},XF=function(n){return Xu(n,'[role="tabpanel"]')},YF=function(n){var t
return{smartTabHeight:(t=ie(v.none()),{extraEvents:[ar((function(e){var o=e.element
XF(o).each((function(r){Wi(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o=function(n){return $(J(n,(function(n,t){return n>t?-1:n<t?1:0})))}(function(n,t,e){return P(n,(function(o,r){og.set(e,n[r].view())
var i=t.dom.getBoundingClientRect()
return og.set(e,[]),i.height}))}(n,r,e))
t.set(o)})),GF(o,r,t),Qi(r,"visibility"),function(n,t){$(n).each((function(n){return UF.showTab(t,n.value)}))}(n,e),op.requestAnimationFrame((function(){GF(o,r,t)}))}))})),Zo(Fo(),(function(n){var e=n.element
XF(e).each((function(n){GF(e,n,t)}))})),Zo(jy,(function(n,e){var o=n.element
XF(o).each((function(n){var e=fc()
Wi(n,"visibility","hidden")
var r=Ki(n,"height").map((function(n){return parseInt(n,10)}))
Qi(n,"height"),Qi(n,"flex-basis")
var i=n.dom.getBoundingClientRect().height
r.forall((function(n){return i>n}))?(t.set(v.from(i)),GF(o,n,t)):r.each((function(t){WF(n,t)})),Qi(n,"visibility"),e.each(sc)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},qF="send-data-to-section",KF="send-data-to-view",JF=function(n,t){var e=ie({}),o=function(n){var t=Rf.getValue(n),o=AF(t).getOr({}),r=e.get(),i=Mn(r,o)
e.set(i)},r=function(n){var t=e.get()
Rf.setValue(n,t)},u=ie(null),a=P(n.tabs,(function(n){return{value:n.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(n.title)},view:function(){return[AS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:P(n.items,(function(n){return MO(e,n,t)})),formBehaviours:tc([Qm.config({mode:"acyclic",useTabstopAt:i(ik)}),rg("TabView.form.events",[ar(r),cr(o)]),ac.config({channels:Gn([{key:qF,value:{onReceive:o}},{key:KF,value:{onReceive:r}}])})])}}))]}}})),c=YF(a).smartTabHeight
return UF.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(n,t,e){var o=Rf.getValue(t)
Go(n,Ly,{name:o,oldName:u.get()}),u.set(o)},tabs:a,components:[UF.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[PF.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:tc([By.config({})])}),UF.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:c.selectFirst,tabSectionBehaviours:tc([rg("tabpanel",c.extraEvents),Qm.config({mode:"acyclic"}),Xl.config({find:function(n){return $(UF.getViewItems(n))}}),Rf.config({store:{mode:"manual",getValue:function(n){return n.getSystem().broadcastOn([qF],{}),e.get()},setValue:function(n,t){e.set(t),n.getSystem().broadcastOn([KF],{})}}})])})},$F=Yr("update-dialog"),QF=Yr("update-title"),ZF=Yr("update-body"),nI=Yr("update-footer"),tI=Yr("body-send-message"),eI=function(n,t,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:f(f({},t.map((function(n){return{id:n}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:tc([LS(0),VT.config({channel:ZF,updateState:function(n,t){return v.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},renderComponents:function(n){switch(n.body.type){case"tabpanel":return[JF(n.body,e)]
default:return[MF(n.body,e)]}},initialData:n})])}},oI=Nv.deviceType.isTouch(),rI=function(n,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[n,t]}},iI=function(n,t){return iM.parts.close(rp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:n,buttonBehaviours:tc([By.config({})])}))},uI=function(){return iM.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},aI=function(n,t){return iM.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:KB("<p>"+t.translate(n)+"</p>")}]}]})},cI=function(n){return iM.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:n})},sI=function(n,t){return[Sy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:n}),Sy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},fI=function(n){var t,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll"
return iM.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),v.some(!0)},useTabstopAt:function(n){return!ik(n)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:f({position:"relative"},n.extraStyles)},components:d([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:KB('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:oI?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:tc(d([sg.config({}),rg("dialog-events",n.dialogEvents.concat([ur(ao(),(function(n,t){Qm.focusIn(n)}))])),rg("scroll-lock",[ar((function(){Oi(Ni(),i)})),cr((function(){Ti(Ni(),i)}))])],n.extraBehaviours)),eventOrder:f((t={},t[ko()]=["dialog-events"],t[Io()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Ro()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},lI=function(n){return rp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close"),title:n.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:ap("close",n.icons)}}],action:function(n){Wo(n,Vy)}})},dI=function(n,t,e){var o=function(n){return[su(e.translate(n.title))]}
return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:f({},t.map((function(n){return{id:n}})).getOr({}))},components:o(n),behaviours:tc([VT.config({channel:QF,renderComponents:o})])}},mI=function(){return{dom:KB('<div class="tox-dialog__draghandle"></div>')}},gI=function(n,t){return function(n,t){var e=iM.parts.title(dI(n,v.none(),t)),o=iM.parts.draghandle(mI()),r=iM.parts.close(lI(t)),i=[e].concat(n.draggable?[o]:[]).concat([r])
return Sy.sketch({dom:KB('<div class="tox-dialog__header"></div>'),components:i})}({title:t.shared.providers.translate(n),draggable:t.dialog.isDraggableModal()},t.shared.providers)},pI=function(n,t){return{onClose:function(){return t.closeWindow()},onBlock:function(t){iM.setBusy(n(),(function(n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":t.message},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:KB('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){iM.setIdle(n())}}},hI=function(n,t,e,o){var r
return du(fI(f(f({},n),{lazySink:o.shared.getSink,extraBehaviours:d([VT.config({channel:$F,updateState:function(n,t){return v.some(t)},initialData:t}),$S({})],n.extraBehaviours),onEscape:function(n){Wo(n,Vy)},dialogEvents:e,eventOrder:(r={},r[So()]=["reflecting","receiving"],r[Io()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],r[Ro()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],r)})))},vI=function(n){return P(n,(function(n){return"menu"===n.type?function(n){var t=P(n.items,(function(n){var t=ie(!1)
return f(f({},n),{storage:t})}))
return f(f({},n),{items:t})}(n):n}))},bI=function(n){return j(n,(function(n,t){return"menu"===t.type?j(t.items,(function(n,t){return n[t.name]=t.storage,n}),n):n}),{})},yI=function(n,t){return[or(ao(),rk),n(Ry,(function(n,e){t.onClose(),e.onClose()})),n(Vy,(function(n,t,e,o){t.onCancel(n),Wo(o,Ry)})),Zo(Ny,(function(n,e){return t.onUnblock()})),Zo(zy,(function(n,e){return t.onBlock(e.event)}))]},xI=function(n,t){var e=function(t,e){return Zo(t,(function(t,r){o(t,(function(o,i){e(n(),o,r.event,t)}))}))},o=function(n,t){VT.getState(n).get().each((function(e){t(e,n)}))}
return d(yI(e,t),[e(Py,(function(n,t,e){t.onAction(n,{name:e.name})}))])},wI=function(n,t,e){var o=function(t,e){return Zo(t,(function(t,o){r(t,(function(r,i){e(n(),r,o.event,t)}))}))},r=function(n,t){VT.getState(n).get().each((function(e){t(e.internalDialog,n)}))}
return d(yI(o,t),[o(Hy,(function(n,t){return t.onSubmit(n)})),o(Iy,(function(n,t,e){t.onChange(n,{name:e.name})})),o(Py,(function(n,t,o,r){var i=function(){return Qm.focusIn(r)},u=function(n){return zr(n,"disabled")||Hr(n,"aria-disabled").exists((function(n){return"true"===n}))},a=Ri(r.element),c=fc(a)
t.onAction(n,{name:o.name,value:o.value}),fc(a).fold(i,(function(n){u(n)||c.exists((function(t){return We(n,t)&&u(t)}))?i():e().toOptional().filter((function(t){return!We(t.element,n)})).each(i)}))})),o(Ly,(function(n,t,e){t.onTabChange(n,{newTabName:e.name,oldTabName:e.oldName})})),cr((function(t){var e=n()
Rf.setValue(t,e.getData())}))])},SI=function(n,t){var e=t.map((function(n){return n.footerButtons})).getOr([]),o=z(e,(function(n){return"start"===n.align})),r=function(n,t){return Sy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+n]},components:P(t,(function(n){return n.memento.asSpec()}))})}
return[r("start",o.pass),r("end",o.fail)]},kI=function(n,t){return{dom:KB('<div class="tox-dialog__footer"></div>'),components:[],behaviours:tc([VT.config({channel:nI,initialData:n,updateState:function(n,e){var o=P(e.buttons,(function(n){var e=ip(function(n,t){return bC(n,n.type,t)}(n,t))
return{name:n.name,align:n.align,memento:e}}))
return v.some({lookupByName:function(n,t){return function(n,t,e){return U(t,(function(n){return n.name===e})).bind((function(t){return t.memento.getOpt(n)}))}(n,o,t)},footerButtons:o})},renderComponents:SI})])}},CI=function(n,t){return iM.parts.footer(kI(n,t))},OI=function(n,t){if(n.getRoot().getSystem().isConnected()){var e=Xl.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper())
return AS.getField(e,t).fold((function(){var o=n.getFooter()
return VT.getState(o).get().bind((function(n){return n.lookupByName(e,t)}))}),(function(n){return v.some(n)}))}return v.none()},_I=function(n,t,e){var o=function(t){var e=n.getRoot()
e.getSystem().isConnected()&&t(e)},r={getData:function(){var t=n.getRoot(),o=t.getSystem().isConnected()?n.getFormWrapper():t,r=Rf.getValue(o),i=xn(e,(function(n){return n.get()}))
return f(f({},r),i)},setData:function(t){o((function(o){var i=r.getData(),u=f(f({},i),t),a=function(n,t){var e=n.getRoot()
return VT.getState(e).get().map((function(n){return wt(xt("data",n.dataValidator,t))})).getOr(t)}(n,u),c=n.getFormWrapper()
Rf.setValue(c,a),yn(e,(function(n,t){Tn(u,t)&&n.set(u[t])}))}))},disable:function(t){OI(n,t).each($h.disable)},enable:function(t){OI(n,t).each($h.enable)},focus:function(t){OI(n,t).each(sg.focus)},block:function(n){if(!x(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument")
o((function(t){Go(t,zy,{message:n})}))},unblock:function(){o((function(n){Wo(n,Ny)}))},showTab:function(t){o((function(e){var o=n.getBody()
VT.getState(o).get().exists((function(n){return n.isTabPanel()}))&&Xl.getCurrent(o).each((function(n){UF.showTab(n,t)}))}))},redial:function(n){o((function(e){var o=t(n)
e.getSystem().broadcastOn([$F],o),e.getSystem().broadcastOn([QF],o.internalDialog),e.getSystem().broadcastOn([ZF],o.internalDialog),e.getSystem().broadcastOn([nI],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(n){Wo(n,Ry)}))}}
return r},TI=function(n,t,e){var o=gI(n.internalDialog.title,e),r=function(n,t){var e=eI(n,v.none(),t,!1)
return iM.parts.body(e)}({body:n.internalDialog.body},e),i=vI(n.internalDialog.buttons),u=bI(i),a=CI({buttons:i},e),c=wI((function(){return d}),pI((function(){return l}),t),e.shared.getSink),s="normal"!==n.internalDialog.size?"large"===n.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],f={header:o,body:r,footer:v.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=hI(f,n,c,e),d=_I({getRoot:function(){return l},getBody:function(){return iM.getBody(l)},getFooter:function(){return iM.getFooter(l)},getFormWrapper:function(){var n=iM.getBody(l)
return Xl.getCurrent(n).getOr(n)}},t.redial,u)
return{dialog:l,instanceApi:d}},EI=function(n,t,e,o){var r,i,u,a,c,s=Yr("dialog-label"),f=Yr("dialog-content"),l=ip((u={title:n.internalDialog.title,draggable:!0},a=s,c=e.shared.providers,Sy.sketch({dom:KB('<div class="tox-dialog__header"></div>'),components:[dI(u,v.some(a),c),mI(),lI(c)],containerBehaviours:tc([XA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(n){return Yu(n,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=ip(function(n,t,e,o){return eI(n,v.some(t),e,o)}({body:n.internalDialog.body},f,e,o)),m=vI(n.internalDialog.buttons),g=bI(m),p=ip(function(n,t){return kI(n,t)}({buttons:m},e)),h=wI((function(){return y}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return t.closeWindow()}},e.shared.getSink),b=du({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=s,r["aria-describedby"]=""+f,r)},eventOrder:(i={},i[So()]=[VT.name(),ac.name()],i[ko()]=["execute-on-form"],i[Io()]=["reflecting","execute-on-form"],i),behaviours:tc([Qm.config({mode:"cyclic",onEscape:function(n){return Wo(n,Ry),v.some(!0)},useTabstopAt:function(n){return!ik(n)&&("button"!==lr(n)||"disabled"!==Pr(n,"disabled"))}}),VT.config({channel:$F,updateState:function(n,t){return v.some(t)},initialData:n}),sg.config({}),rg("execute-on-form",h.concat([ur(ao(),(function(n,t){Qm.focusIn(n)}))])),$S({})]),components:[l.asSpec(),d.asSpec(),p.asSpec()]}),y=_I({getRoot:function(){return b},getFooter:function(){return p.get(b)},getBody:function(){return d.get(b)},getFormWrapper:function(){var n=d.get(b)
return Xl.getCurrent(n).getOr(n)}},t.redial,g)
return{dialog:b,instanceApi:y}},BI=tinymce.util.Tools.resolve("tinymce.util.URI"),DI=["insertContent","setContent","execCommand","close","block","unblock"],AI=function(n){return w(n)&&-1!==DI.indexOf(n.mceAction)},MI=function(n,t,e,o){var r,u,a,c=gI(n.title,o),s=function(n){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[ek({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:tc([By.config({}),sg.config({})])})]}],behaviours:tc([Qm.config({mode:"acyclic",useTabstopAt:i(ik)})])}
return iM.parts.body(t)}(n),l=n.buttons.bind((function(n){return 0===n.length?v.none():v.some(CI({buttons:n},o))})),d=xI((function(){return C}),pI((function(){return S}),t)),m=f(f({},n.height.fold((function(){return{}}),(function(n){return{height:n+"px","max-height":n+"px"}}))),n.width.fold((function(){return{}}),(function(n){return{width:n+"px","max-width":n+"px"}}))),g=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],p=new BI(n.url,{base_uri:new BI(window.location.href)}),h=p.protocol+"://"+p.host+(p.port?":"+p.port:""),b=ie(v.none()),y=[rg("messages",[ar((function(){var t=ry(ae.fromDom(window),"message",(function(t){if(p.isSameOrigin(new BI(t.raw.origin))){var o=t.raw.data
AI(o)?function(n,t,e){switch(e.mceAction){case"insertContent":n.insertContent(e.content)
break
case"setContent":n.setContent(e.content)
break
case"execCommand":var o=!!k(e.ui)&&e.ui
n.execCommand(e.cmd,o,e.value)
break
case"close":t.close()
break
case"block":t.block(e.message)
break
case"unblock":t.unblock()}}(e,C,o):function(n){return!AI(n)&&w(n)&&Tn(n,"mceAction")}(o)&&n.onMessage(C,o)}}))
b.set(v.some(t))})),cr((function(){b.get().each((function(n){return n.unbind()}))}))]),ac.config({channels:(r={},r[tI]={onReceive:function(n,t){Xu(n.element,"iframe").each((function(n){n.dom.contentWindow.postMessage(t,h)}))}},r)})],S=hI({header:c,body:s,footer:l,extraClasses:g,extraBehaviours:y,extraStyles:m},n,d,o),C=(u=S,a=function(n){u.getSystem().isConnected()&&n(u)},{block:function(n){if(!x(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument")
a((function(t){Go(t,zy,{message:n})}))},unblock:function(){a((function(n){Wo(n,Ny)}))},close:function(){a((function(n){Wo(n,Ry)}))},sendMessage:function(n){a((function(t){t.getSystem().broadcastOn([tI],n)}))}})
return{dialog:S,instanceApi:C}},FI=function(n,t,e){return t&&e?[]:[_B.config({contextual:{lazyContext:function(){return v.some(Pu(ae.fromDom(n.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},II=function(n){var t=n.backstage,e=n.editor,o=bv(e),r=function(n){var t=n.backstage.shared
return{open:function(e,o){var r=function(){iM.hide(c),o()},i=ip(bC({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:v.none()},"cancel",n.backstage)),u=uI(),a=iI(r,t.providers),c=du(fI({lazySink:function(){return t.getSink()},header:rI(u,a),body:aI(e,t.providers),footer:v.some(cI(sI([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Zo(Vy,r)],eventOrder:{}}))
iM.show(c)
var s=i.get(c)
sg.focus(s)}}}(n),i=function(n){var t=n.backstage.shared
return{open:function(e,o){var r=function(n){iM.hide(s),o(n)},i=ip(bC({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:v.none()},"submit",n.backstage)),u=bC({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:v.none()},"cancel",n.backstage),a=uI(),c=iI((function(){return r(!1)}),t.providers),s=du(fI({lazySink:function(){return t.getSink()},header:rI(a,c),body:aI(e,t.providers),footer:v.some(cI(sI([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Zo(Vy,(function(){return r(!1)})),Zo(Hy,(function(){return r(!0)}))],eventOrder:{}}))
iM.show(s)
var f=i.get(s)
sg.focus(f)}}}(n),u=function(n,o){return DF.openUrl((function(n){var r=MI(n,{closeWindow:function(){iM.hide(r.dialog),o(r.instanceApi)}},e,t)
return iM.show(r.dialog),r.instanceApi}),n)},a=function(n,e){return DF.open((function(n,o,r){var i=o,u=TI({dataValidator:r,initialData:i,internalDialog:n},{redial:DF.redial,closeWindow:function(){iM.hide(u.dialog),e(u.instanceApi)}},t)
return iM.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),n)},c=function(n,r,i,u){return DF.open((function(n,a,c){var s,l=wt(xt("data",c,a)),m=(s=ie(v.none()),{clear:function(){return s.set(v.none())},set:function(n){return s.set(v.some(n))},isSet:function(){return s.get().isSome()},on:function(n){return s.get().each(n)}}),g=t.shared.header.isPositionedAtTop(),p=function(){return m.on((function(n){Gg.reposition(n),_B.refresh(n)}))},h=EI({dataValidator:c,initialData:l,internalDialog:n},{redial:DF.redial,closeWindow:function(){m.on(Gg.hide),e.off("ResizeEditor",p),m.clear(),i(h.instanceApi)}},t,u),b=du(Gg.sketch(f(f({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},g?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:tc(d([rg("window-manager-inline-events",[Zo(Vo(),(function(n,t){Wo(h.dialog,Vy)}))])],FI(e,o,g))),isExtraPart:function(n,t){return function(n){return ay(n,".tox-alert-dialog")||ay(n,".tox-confirm-dialog")}(t)}})))
return m.set(b),Gg.showWithin(b,r,mu(h.dialog),v.some(Ni())),o&&g||(_B.refresh(b),e.on("ResizeEditor",p)),h.instanceApi.setData(l),Qm.focusIn(h.dialog),h.instanceApi}),n)}
return{open:function(n,e,o){return void 0!==e&&"toolbar"===e.inline?c(n,t.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?c(n,t.shared.anchors.cursor(),o,e.ariaAttrs):a(n,o)},openUrl:function(n,t){return u(n,t)},alert:function(n,t){r.open(n,(function(){t()}))},close:function(n){n.close()},confirm:function(n,t){i.open(n,(function(n){t(n)}))}}}
s.add("silver",(function(n){var t=tM(n),o=t.uiMothership,r=t.backstage,i=t.renderUI,u=t.getUi
ey(n,r.shared)
var a=II({editor:n,backstage:r})
return{renderUI:i,getWindowManagerImpl:e(a),getNotificationManagerImpl:function(){return lp(0,{backstage:r},o)},ui:u()}}))})()
