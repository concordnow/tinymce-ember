!function(){"use strict"
var t=function(){},n=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
return t(n.apply(null,e))}},e=function(t){return function(){return t}},o=function(t){return t}
function r(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e]
return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o]
var r=n.concat(e)
return t.apply(null,r)}}var i=function(t){return function(n){return!t(n)}},u=function(t){return function(){throw new Error(t)}},a=e(!1),c=e(!0),s=tinymce.util.Tools.resolve("tinymce.ThemeManager"),l=function(){return(l=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])
return t}).apply(this,arguments)}
function f(t,n){var e={}
for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o])
if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0
for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function d(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length
var o=Array(t),r=0
for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u]
return o}var m,g,p,h,v,b=function(){return y},y=(m=function(t){return t.isNone()},{fold:function(t,n){return t()},is:a,isSome:a,isNone:c,getOr:p=function(t){return t},getOrThunk:g=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:e(null),getOrUndefined:e(void 0),or:p,orThunk:g,map:b,each:t,bind:b,exists:a,forall:c,filter:b,equals:m,equals_:m,toArray:function(){return[]},toString:e("none()")}),x=function(t){var n=e(t),o=function(){return i},r=function(n){return n(t)},i={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:c,isNone:a,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:o,orThunk:o,map:function(n){return x(n(t))},each:function(n){n(t)},bind:r,exists:r,forall:r,filter:function(n){return n(t)?i:y},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(a,(function(n){return e(t,n)}))}}
return i},w={some:x,none:b,from:function(t){return null==t?y:x(t)}},S=function(t){return function(n){return o=typeof(e=n),(null===e?"null":"object"==o&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":o)===t
var e,o}},k=function(t){return function(n){return typeof n===t}},C=S("string"),O=S("object"),_=S("array"),T=k("boolean"),E=(void 0,function(t){return undefined===t}),B=function(t){return!(null===(n=t)||void 0===n)
var n},A=k("function"),M=k("number"),F=function(t,n){if(_(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1
return!0}return!1},D=Array.prototype.slice,I=Array.prototype.indexOf,R=Array.prototype.push,V=function(t,n){return I.call(t,n)},P=function(t,n){return-1<V(t,n)},H=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0
return!1},z=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o))
return e},N=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=D.call(t,o,o+n)
e.push(r)}return e},L=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r]
o[r]=n(i,r)}return o},j=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},U=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},W=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o]
n(i,o)&&e.push(i)}return e},G=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e])}(t,(function(t){e=n(e,t)})),e},X=function(t,n,e){return j(t,(function(t){e=n(e,t)})),e},Y=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o]
if(n(i,o))return w.some(i)
if(e(i,o))break}return w.none()}(t,n,a)},q=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return w.some(e)
return w.none()},K=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!_(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t)
R.apply(n,t[e])}return n},J=function(t,n){return K(L(t,n))},$=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1
return!0},Q=function(t){var n=D.call(t,0)
return n.reverse(),n},Z=function(t,n){return W(t,(function(t){return!P(n,t)}))},tt=function(t,n){var e=D.call(t,0)
return e.sort(n),e},nt=function(t){return 0===t.length?w.none():w.some(t[0])},et=function(t){return 0===t.length?w.none():w.some(t[t.length-1])},ot=A(Array.from)?Array.from:function(t){return D.call(t)},rt=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e)
if(o.isSome())return o}return w.none()},it=function(t){return{is:function(n){return t===n},isValue:c,isError:a,getOr:e(t),getOrThunk:e(t),getOrDie:e(t),or:function(n){return it(t)},orThunk:function(n){return it(t)},fold:function(n,e){return e(t)},map:function(n){return it(n(t))},mapError:function(n){return it(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return w.some(t)}}},ut=function(n){return{is:a,isValue:a,isError:c,getOr:o,getOrThunk:function(t){return t()},getOrDie:function(){return u(String(n))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(t,e){return t(n)},map:function(t){return ut(n)},mapError:function(t){return ut(t(n))},each:t,bind:function(t){return ut(n)},exists:a,forall:c,toOptional:w.none}},at={value:it,error:ut,fromOption:function(t,n){return t.fold((function(){return ut(n)}),it)}};(v=h=h||{})[v.Error=0]="Error",v[v.Value=1]="Value"
var ct,st,lt=function(t,n,e){return t.stype===h.Error?n(t.serror):e(t.svalue)},ft=function(t){return{stype:h.Value,svalue:t}},dt=function(t){return{stype:h.Error,serror:t}},mt=ft,gt=function(t){var n=[],e=[]
return j(t,(function(t){lt(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},pt=dt,ht=function(t,n){return t.stype===h.Value?n(t.svalue):t},vt=function(t,n){return t.stype===h.Value?{stype:h.Value,svalue:n(t.svalue)}:t},bt=Object.keys,yt=Object.hasOwnProperty,xt=function(t,n){for(var e=bt(t),o=0,r=e.length;o<r;o++){var i=e[o]
n(t[i],i)}},wt=function(t,n){return St(t,(function(t,e){return{k:e,v:n(t,e)}}))},St=function(t,n){var e={}
return xt(t,(function(t,o){var r=n(t,o)
e[r.k]=r.v})),e},kt=function(t,n){var e=[]
return xt(t,(function(t,o){e.push(n(t,o))})),e},Ct=function(t,n){for(var e=bt(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i]
if(n(u,i,t))return w.some(u)}return w.none()},Ot=function(t){return kt(t,(function(t){return t}))},_t=function(t,n){return Tt(t,n)?w.from(t[n]):w.none()},Tt=function(t,n){return yt.call(t,n)},Et=function(t,n){return Tt(t,n)&&void 0!==t[n]&&null!==t[n]},Bt=function(t){if(!_(t))throw new Error("cases must be an array")
if(0===t.length)throw new Error("there must be at least one case")
var n=[],e={}
return j(t,(function(o,r){var i=bt(o)
if(1!==i.length)throw new Error("one and only one name per case")
var u=i[0],a=o[u]
if(void 0!==e[u])throw new Error("duplicate key detected:"+u)
if("cata"===u)throw new Error("cannot have a case named cata (sorry)")
if(!_(a))throw new Error("case arguments must be an array")
n.push(u),e[u]=function(){var e=arguments.length
if(e!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+e)
for(var o=new Array(e),i=0;i<o.length;i++)o[i]=arguments[i]
return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length)
return arguments[r].apply(null,o)},match:function(t){var e=bt(t)
if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","))
if(!$(n,(function(t){return P(e,t)})))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "))
return t[u].apply(null,o)},log:function(t){console.log(t,{constructors:n,constructor:u,params:o})}}}})),e},At=Object.prototype.hasOwnProperty,Mt=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e]
if(0===n.length)throw new Error("Can't merge zero objects")
for(var o={},r=0;r<n.length;r++){var i=n[r]
for(var u in i)At.call(i,u)&&(o[u]=t(o[u],i[u]))}return o}},Ft=Mt((function(t,n){return O(t)&&O(n)?Ft(t,n):n})),Dt=Mt((function(t,n){return n})),It=function(t){var n,e=!1
return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
return e||(e=!0,n=t.apply(null,o)),n}},Rt=Bt([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Vt=function(t){return Rt.defaultedThunk(e(t))},Pt=Rt.strict,Ht=Rt.asOption,zt=Rt.defaultedThunk,Nt=(Rt.asDefaultedOptionThunk,Rt.mergeWithThunk),Lt=(Bt([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={}
return e[t]=n,e}),jt=Lt,Ut=function(t){return n={},j(t,(function(t){n[t.key]=t.value})),n
var n},Wt=function(t){return n(pt,K)(t)},Gt=function(t){var n=gt(t)
return 0<n.errors.length?Wt(n.errors):mt(n.values)},Xt=function(t){return O(t)&&100<bt(t).length?" removed due to size":JSON.stringify(t,null,2)},Yt=function(t,n){return pt([{path:t,getErrorInfo:n}])},qt=Bt([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Kt=function(t,n,e){var r=_t(t,n).fold((function(){return e(t)}),o)
return mt(r)},Jt=function(t,n,o,r){return o.fold((function(o,i,u,a){var c=function(n){var e=a.extract(t.concat([o]),r,n)
return vt(e,(function(t){return Lt(i,r(t))}))},s=function(n){return n.fold((function(){var t=Lt(i,r(w.none()))
return mt(t)}),(function(n){var e=a.extract(t.concat([o]),r,n)
return vt(e,(function(t){return Lt(i,r(w.some(t)))}))}))}
return u.fold((function(){return ht(function(t,n,e){return _t(n,e).fold((function(){return o=e,r=n,Yt(t,(function(){return'Could not find valid *strict* value for "'+o+'" in '+Xt(r)}))
var o,r}),mt)}(t,n,o),c)}),(function(t){return ht(Kt(n,o,t),c)}),(function(){return ht(mt(_t(n,o)),s)}),(function(t){return ht((r=t,i=_t(e=n,o).map((function(t){return!0===t?r(e):t})),mt(i)),s)
var e,r,i}),(function(t){var r=t(n),i=vt(Kt(n,o,e({})),(function(t){return Ft(r,t)}))
return ht(i,c)}))}),(function(t,e){var o=e(n)
return mt(Lt(t,r(o)))}))},$t=function(t){return{extract:function(n,e,o){return function(t,n){return t.stype===h.Error?n(t.serror):t}(t(o,e),(function(t){return e=t,Yt(n,(function(){return e}))
var e}))},toString:function(){return"val"}}},Qt=function(n){var o=Zt(n),r=G(n,(function(t,n){return n.fold((function(n){return Ft(t,jt(n,!0))}),e(t))}),{})
return{extract:function(n,e,i){var u,a=T(i)?[]:bt(function(n,e){var o,r,i,u,a={}
return o=e,u=a,r=function(t,n){u[n]=t},i=t,xt(n,(function(t,n){(o(t,n)?r:i)(t,n)})),a}(i,(function(t){return null!=t}))),c=W(a,(function(t){return!Et(r,t)}))
return 0===c.length?o.extract(n,e,i):(u=c,Yt(n,(function(){return"There are unsupported fields: ["+u.join(", ")+"] specified"})))},toString:o.toString}},Zt=function(t){return{extract:function(n,e,o){return r=n,i=o,u=e,function(t,n){var e,o,r=gt(t)
return 0<r.errors.length?Wt(r.errors):(o=n,0<(e=r.values).length?mt(Ft(o,Dt.apply(void 0,e))):mt(o))}(L(t,(function(t){return Jt(r,i,t,u)})),{})
var r,i,u},toString:function(){return"obj{\n"+L(t,(function(t){return t.fold((function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"}}},tn=function(t){return{extract:function(n,e,o){var r=L(o,(function(o,r){return t.extract(n.concat(["["+r+"]"]),e,o)}))
return Gt(r)},toString:function(){return"array("+t.toString()+")"}}},nn=function(t){return{extract:function(n,e,o){for(var r=[],i=0,u=t;i<u.length;i++){var a=u[i].extract(n,e,o)
if(a.stype===h.Value)return a
r.push(a)}return Gt(r)},toString:function(){return"oneOf("+L(t,(function(t){return t.toString()})).join(", ")+")"}}},en=e($t(mt)),on=n(tn,Zt),rn=qt.state,un=qt.field,an=function(t,n){return{extract:function(e,o,r){return _t(r,t).fold((function(){return n=t,Yt(e,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))
var n}),(function(t){return function(t,n,e,o,r){return _t(o,r).fold((function(){return n=o,e=r,Yt(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Xt(n)}))
var n,e}),(function(o){return o.extract(t.concat(["branch: "+r]),n,e)}))}(e,o,r,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+bt(n)}}},cn=$t(mt),sn=function(t){return on(t)},ln=function(t){return $t((function(n){return t(n).fold(pt,mt)}))},fn=function(t,n){return function(t,n){return{extract:function(e,r,i){var u,a,c=bt(i),s=(u=e,a=c,tn($t(t)).extract(u,o,a))
return ht(s,(function(t){var o=L(t,(function(t){return qt.field(t,t,Pt(),n)}))
return Zt(o).extract(e,r,i)}))},toString:function(){return"setOf("+n.toString()+")"}}}((function(n){return function(t){return t.fold(dt,ft)}(t(n))}),n)},dn=function(t,n,e){return function(t){return lt(t,at.error,at.value)}((r=t,i=o,u=e,function(t,n){return t.stype===h.Error?{stype:h.Error,serror:n(t.serror)}:t}(n.extract([r],i,u),(function(t){return{input:u,errors:t}}))))
var r,i,u},mn=function(t){return t.fold((function(t){throw new Error(pn(t))}),o)},gn=function(t,n,e){return mn(dn(t,n,e))},pn=function(t){return"Errors: \n"+(e=10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,L(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()})).join("\n")+"\n\nInput object: ")+Xt(t.input)
var n,e},hn=an,vn=function(t,n){return an(t,wt(n,Zt))},bn=e(cn),yn=function(t,n){return $t((function(e){var o=typeof e
return t(e)?mt(e):pt("Expected type: "+n+" but got: "+o)}))},xn=yn(M,"number"),wn=yn(C,"string"),Sn=yn(T,"boolean"),kn=yn(A,"function"),Cn=function(t){var n=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1
e=t.next()}return!0}
if(Object(t)!==t)return!0
switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0
case"Array":case"Object":return Object.keys(t).every((function(n){return Cn(t[n])}))
case"Map":return n(t.keys(),Cn)&&n(t.values(),Cn)
case"Set":return n(t.keys(),Cn)
default:return!1}},On=$t((function(t){return Cn(t)?mt(t):pt("Expected value to be acceptable for sending via postMessage")})),_n=function(t){return ln((function(n){return P(t,n)?at.value(n):at.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},Tn=function(t){return un(t,t,Pt(),en())},En=function(t,n){return un(t,t,Pt(),n)},Bn=function(t){return En(t,wn)},An=function(t,n){return un(t,t,Pt(),_n(n))},Mn=function(t){return En(t,kn)},Fn=function(t,n){return un(t,t,Pt(),Zt(n))},Dn=function(t,n){return un(t,t,Pt(),on(n))},In=function(t,n){return un(t,t,Pt(),tn(n))},Rn=function(t){return un(t,t,Ht(),en())},Vn=function(t,n){return un(t,t,Ht(),n)},Pn=function(t){return Vn(t,xn)},Hn=function(t){return Vn(t,wn)},zn=function(t){return Vn(t,kn)},Nn=function(t,n){return Vn(t,Zt(n))},Ln=function(t,n){return un(t,t,Vt(n),en())},jn=function(t,n,e){return un(t,t,Vt(n),e)},Un=function(t,n){return jn(t,n,xn)},Wn=function(t,n){return jn(t,n,wn)},Gn=function(t,n,e){return jn(t,n,_n(e))},Xn=function(t,n){return jn(t,n,Sn)},Yn=function(t,n){return jn(t,n,kn)},qn=function(t,n,e){return jn(t,n,Zt(e))},Kn=function(t,n){return rn(t,n)},Jn=function(t){var n=t
return{get:function(){return n},set:function(t){n=t}}},$n=function(t){if(null==t)throw new Error("Node cannot be null or undefined")
return{dom:t}},Qn=function(t,n){var e=(n||document).createElement("div")
if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node")
return $n(e.childNodes[0])},Zn=function(t,n){var e=(n||document).createElement(t)
return $n(e)},te=function(t,n){var e=(n||document).createTextNode(t)
return $n(e)},ne=$n,ee=function(){return oe(0,0)},oe=function(t,n){return{major:t,minor:n}},re=function(t,n){var e=String(n).toLowerCase()
return 0===t.length?ee():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e]
if(o.test(n))return o}}(t,n)
if(!e)return{major:0,minor:0}
var o=function(t){return Number(n.replace(e,"$"+t))}
return oe(o(1),o(2))}(t,e)},ie=ee,ue=function(t,n){var e=String(n).toLowerCase()
return Y(t,(function(t){return t.search(e)}))},ae=function(t,n){return-1!==t.indexOf(n)},ce=(ct=/^\s+|\s+$/g,function(t){return t.replace(ct,"")}),se=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,le=function(t){return function(n){return ae(n,t)}},fe=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return ae(t,"edge/")&&ae(t,"chrome")&&ae(t,"safari")&&ae(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,se],search:function(t){return ae(t,"chrome")&&!ae(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return ae(t,"msie")||ae(t,"trident")}},{name:"Opera",versionRegexes:[se,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:le("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:le("firefox")},{name:"Safari",versionRegexes:[se,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(ae(t,"safari")||ae(t,"mobile/"))&&ae(t,"applewebkit")}}],de=[{name:"Windows",search:le("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return ae(t,"iphone")||ae(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:le("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:le("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:le("linux"),versionRegexes:[]},{name:"Solaris",search:le("sunos"),versionRegexes:[]},{name:"FreeBSD",search:le("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:le("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],me={browsers:e(fe),oses:e(de)},ge="Firefox",pe=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}}
return{current:n,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o(ge),isSafari:o("Safari")}},he=function(){return pe({current:void 0,version:ie()})},ve=pe,be=(e("Edge"),e("Chrome"),e("IE"),e("Opera"),e(ge),e("Safari"),"Windows"),ye="Android",xe="Solaris",we="FreeBSD",Se="ChromeOS",ke=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}}
return{current:n,version:e,isWindows:o(be),isiOS:o("iOS"),isAndroid:o(ye),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o(xe),isFreeBSD:o(we),isChromeOS:o(Se)}},Ce=function(){return ke({current:void 0,version:ie()})},Oe=ke,_e=(e(be),e("iOS"),e(ye),e("Linux"),e("OSX"),e(xe),e(we),e(Se),function(t,n){var o,r,i,u,a,c,s,l,f,d,m,g,p=me.browsers(),h=me.oses(),v=function(t,n){return ue(t,n).map((function(t){var e=re(t.versionRegexes,n)
return{current:t.name,version:e}}))}(p,t).fold(he,ve),b=function(t,n){return ue(t,n).map((function(t){var e=re(t.versionRegexes,n)
return{current:t.name,version:e}}))}(h,t).fold(Ce,Oe)
return{browser:v,os:b,deviceType:(r=v,i=t,u=n,a=(o=b).isiOS()&&!0===/ipad/i.test(i),c=o.isiOS()&&!a,s=o.isiOS()||o.isAndroid(),l=s||u("(pointer:coarse)"),f=a||!c&&s&&u("(min-device-width:768px)"),d=c||s&&!f,m=r.isSafari()&&o.isiOS()&&!1===/safari/i.test(i),g=!d&&!f&&!m,{isiPad:e(a),isiPhone:e(c),isTablet:e(f),isPhone:e(d),isTouch:e(l),isAndroid:o.isAndroid,isiOS:o.isiOS,isWebView:e(m),isDesktop:e(g)})}}),Te=function(t){return window.matchMedia(t).matches},Ee=It((function(){return _e(navigator.userAgent,Te)})),Be=function(){return Ee()},Ae=function(t,n){var e=t.dom
if(1!==e.nodeType)return!1
var o=e
if(void 0!==o.matches)return o.matches(n)
if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n)
if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n)
if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n)
throw new Error("Browser lacks native selectors")},Me=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Fe=function(t,n){return t.dom===n.dom},De=function(t,n){return Be().browser.isIE()?function(t,n){return e=t.dom,o=n.dom,r=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(o)&r)
var e,o,r}(t,n):(e=n,(o=t.dom)!==(r=e.dom)&&o.contains(r))
var e,o,r},Ie=function(t){return A(t)?t:a},Re=function(t,n,e){for(var o=t.dom,r=Ie(e);o.parentNode;){o=o.parentNode
var i=ne(o),u=n(i)
if(u.isSome())return u
if(r(i))break}return w.none()},Ve=function(t,n,e){var o=n(t),r=Ie(e)
return o.orThunk((function(){return r(t)?w.none():Re(t,n,r)}))},Pe=function(t,n){return Fe(t.element,n.event.target)},He=function(n){if(!Et(n,"can")&&!Et(n,"abort")&&!Et(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!")
return gn("Extracting event.handler",Qt([Ln("can",c),Ln("abort",a),Ln("run",t)]),n)},ze=e,Ne=ze("touchstart"),Le=ze("touchmove"),je=ze("touchend"),Ue=ze("touchcancel"),We=ze("mousedown"),Ge=ze("mousemove"),Xe=ze("mouseout"),Ye=ze("mouseup"),qe=ze("mouseover"),Ke=ze("focusin"),Je=ze("focusout"),$e=ze("keydown"),Qe=ze("keyup"),Ze=ze("input"),to=ze("change"),no=ze("click"),eo=ze("transitionend"),oo=ze("selectstart"),ro=function(t){return e("alloy."+t)},io={tap:ro("tap")},uo=ro("focus"),ao=ro("blur.post"),co=ro("paste.post"),so=ro("receive"),lo=ro("execute"),fo=ro("focus.item"),mo=io.tap,go=ro("longpress"),po=ro("sandbox.close"),ho=ro("typeahead.cancel"),vo=ro("system.init"),bo=ro("system.touchmove"),yo=ro("system.touchend"),xo=ro("system.scroll"),wo=ro("system.resize"),So=ro("system.attached"),ko=ro("system.detached"),Co=ro("system.dismissRequested"),Oo=ro("system.repositionRequested"),_o=ro("focusmanager.shifted"),To=ro("slotcontainer.visibility"),Eo=ro("change.tab"),Bo=ro("dismiss.tab"),Ao=ro("highlight"),Mo=ro("dehighlight"),Fo=function(t,n){Vo(t,t.element,n,{})},Do=function(t,n,e){Vo(t,t.element,n,e)},Io=function(t){Fo(t,lo())},Ro=function(t,n,e){Vo(t,n,e,{})},Vo=function(t,n,e,o){var r=l({target:n},o)
t.getSystem().triggerEvent(e,n,r)},Po=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Ho=Ut,zo=function(t,n){return{key:t,value:He({abort:n})}},No=function(t){return{key:t,value:He({run:function(t,n){n.event.prevent()}})}},Lo=function(t,n){return{key:t,value:He({run:n})}},jo=function(t,n,e){return{key:t,value:He({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},Uo=function(t){return function(n){return{key:t,value:He({run:function(t,e){Pe(t,e)&&n(t,e)}})}}},Wo=function(t,n,e){var o,r,i=n.partUids[e]
return r=i,Lo(o=t,(function(t,n){t.getSystem().getByUid(r).each((function(t){Po(t,t.element,o,n)}))}))},Go=function(t,n){return Lo(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).fold((function(){return Ve(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),a).getOr(t)}),(function(t){return t}))
n(t,r,e)}))},Xo=function(t){return Lo(t,(function(t,n){n.cut()}))},Yo=function(t,n){return Uo(t)(n)},qo=Uo(So()),Ko=Uo(ko()),Jo=Uo(vo()),$o=(st=lo(),function(t){return Lo(st,t)}),Qo=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),Zo=function(t){return function(n){return n.dom.nodeType===t}},tr=Zo(1),nr=Zo(3),er=Zo(9),or=Zo(11),rr=function(t){return ne(t.dom.ownerDocument)},ir=function(t){return er(t)?t:rr(t)},ur=function(t){return ne(ir(t).dom.documentElement)},ar=function(t){return ne(ir(t).dom.defaultView)},cr=function(t){return w.from(t.dom.parentNode).map(ne)},sr=cr,lr=function(t){return w.from(t.dom.offsetParent).map(ne)},fr=function(t){return L(t.dom.childNodes,ne)},dr=function(t,n){var e=t.dom.childNodes
return w.from(e[n]).map(ne)},mr=function(t,n){cr(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},gr=function(t,n){var e;(e=t,w.from(e.dom.nextSibling).map(ne)).fold((function(){cr(t).each((function(t){hr(t,n)}))}),(function(t){mr(t,n)}))},pr=function(t,n){dr(t,0).fold((function(){hr(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},hr=function(t,n){t.dom.appendChild(n.dom)},vr=function(t,n){j(n,(function(n){hr(t,n)}))},br=function(t){t.dom.textContent="",j(fr(t),(function(t){yr(t)}))},yr=function(t){var n=t.dom
null!==n.parentNode&&n.parentNode.removeChild(n)},xr=function(t){var n,e=fr(t)
0<e.length&&(n=t,j(e,(function(t){mr(n,t)}))),yr(t)},wr=function(t){return t.dom.innerHTML},Sr=function(t,n){var e,o,r=rr(t).dom,i=ne(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,fr(ne(o)))
vr(i,u),br(t),hr(t,i)},kr=function(t,n,e){if(!(C(e)||T(e)||M(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple")
t.setAttribute(n,e+"")},Cr=function(t,n,e){kr(t.dom,n,e)},Or=function(t,n){var e=t.dom.getAttribute(n)
return null===e?void 0:e},_r=function(t,n){return w.from(Or(t,n))},Tr=function(t,n){var e=t.dom
return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Er=function(t,n){t.dom.removeAttribute(n)},Br=function(t){var n,e,o
return n=function(t){return ne(t.dom.cloneNode(!1))}(t),e=Zn("div"),o=ne(n.dom.cloneNode(!0)),hr(e,o),wr(e)},Ar=Ho([{key:uo(),value:He({can:function(t,n){var e,o,r=n.event,i=r.originator,u=r.target
return o=u,!(Fe(e=i,t.element)&&!Fe(e,o)&&(console.warn(uo()+" did not get interpreted by the desired target. \nOriginator: "+Br(i)+"\nTarget: "+Br(u)+"\nCheck the "+uo()+" event handlers"),1))}})}]),Mr=Object.freeze({__proto__:null,events:Ar}),Fr=0,Dr=function(t){var n=(new Date).getTime()
return t+"_"+Math.floor(1e9*Math.random())+ ++Fr+String(n)},Ir=e("alloy-id-"),Rr=e("data-alloy-id"),Vr=Ir(),Pr=Rr(),Hr=function(t,n){Object.defineProperty(t.dom,Pr,{value:n,writable:!0})},zr=function(t){var n=tr(t)?t.dom[Pr]:null
return w.from(n)},Nr=Dr,Lr=o,jr=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(t?"\n"+Br(t().element)+" is not in context.":""))}}
return{debugInfo:e("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:a}},Ur=jr(),Wr=function(t){return L(t,(function(t){return e="/*",o=(n=t).length-"/*".length,""===e||n.length>=e.length&&n.substr(o,o+e.length)===e?t.substring(0,t.length-"/*".length):t
var n,e,o}))},Gr=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/)
return t.toFunctionAnnotation=function(){return{name:n,parameters:Wr(i)}},t},Xr=Dr("alloy-premade"),Yr=function(t){return jt(Xr,t)},qr=function(t){return n=function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o]
return t.apply(void 0,d([n.getApis(),n],e))},o=(e=t.toString()).indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Wr(i.slice(1))}},n
var n,e,o,r,i},Kr={init:function(){return Jr({readState:function(){return"No State required"}})}},Jr=function(t){return t},$r=function(t,n){var e={}
return xt(t,(function(t,o){xt(t,(function(t,r){var i=_t(e,r).getOr([])
e[r]=i.concat([n(o,t)])}))})),e},Qr=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},Zr=function(t){return t.cHandler},ti=function(t,n){return{name:t,handler:n}},ni=function(t,n,e){var o,r,i=n[e]
return i?function(t,n,o,r){try{var i=tt(o,(function(e,o){var i=e[n],u=o[n],a=r.indexOf(i),c=r.indexOf(u)
if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2))
if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2))
return a<c?-1:c<a?1:0}))
return at.value(i)}catch(e){return at.error([e])}}("Event: "+e,"name",t,i).map((function(t){return function(t){var n,e,o,r,i=(e=function(t){return t.can},function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o]
return X(n,(function(n,o){return n&&e(o).apply(void 0,t)}),!0)}),u=(o=n=t,r=function(t){return t.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]
return X(o,(function(n,e){return n||r(e).apply(void 0,t)}),!1)})
return He({can:i,abort:u,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e]
j(t,(function(t){t.run.apply(void 0,n)}))}})}(L(t,(function(t){return t.handler})))})):(o=e,r=t,at.error(["The event ("+o+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(L(r,(function(t){return t.name})),null,2)]))},ei=function(t,n){return function(t,n){var e,o,r,i,u,a=(e=[],o=[],j(t,(function(t){t.fold((function(t){e.push(t)}),(function(t){o.push(t)}))})),{errors:e,values:o})
return 0<a.errors.length?(u=a.errors,at.error(K(u))):(i=n,0===(r=a.values).length?at.value(i):at.value(Ft(i,Dt.apply(void 0,r))))}(kt(t,(function(t,o){return(1===t.length?at.value(t[0].handler):ni(t,n,o)).map((function(r){var i=function(t){var n,o=A(n=t)?{can:e(!0),abort:e(!1),run:n}:n
return function(t,n){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r]
var i=[t,n].concat(e)
o.abort.apply(void 0,i)?n.stop():o.can.apply(void 0,i)&&o.run.apply(void 0,i)}}(r),u=1<t.length?W(n[o],(function(n){return H(t,(function(t){return t.name===n}))})).join(" > "):t[0].name
return jt(o,{handler:i,purpose:u})}))})),{})},oi="alloy.base.behaviour",ri=function(t,n){var e=Or(t,n)
return void 0===e||""===e?[]:e.split(" ")},ii=function(t){return void 0!==t.dom.classList},ui=function(t,n){ii(t)?t.dom.classList.add(n):function(t,n){return o=n,r=ri(e=t,"class").concat([o]),Cr(e,"class",r.join(" ")),!0
var e,o,r}(t,n)},ai=function(t,n){ii(t)?t.dom.classList.remove(n):function(t,n){return r=n,0<(i=W(ri(e=t,o="class"),(function(t){return t!==r}))).length?Cr(e,o,i.join(" ")):Er(e,o),!1
var e,o,r,i}(t,n),function(t){0===(ii(t)?t.dom.classList:ri(t,"class")).length&&Er(t,"class")}(t)},ci=function(t,n){return ii(t)&&t.dom.classList.contains(n)},si=function(t,n){j(n,(function(n){ui(t,n)}))},li=function(t,n){j(n,(function(n){ai(t,n)}))},fi=function(t){return void 0!==t.style&&A(t.style.getPropertyValue)},di=function(t){return or(t)},mi=A(Element.prototype.attachShadow)&&A(Node.prototype.getRootNode),gi=e(mi),pi=mi?function(t){return ne(t.dom.getRootNode())}:ir,hi=function(t){return di(t)?t:ne(ir(t).dom.body)},vi=function(t){return ne(t.dom.host)},bi=function(t){var n=nr(t)?t.dom.parentNode:t.dom
if(null==n||null===n.ownerDocument)return!1
var e,o,r,i,u=n.ownerDocument
return r=ne(n),i=pi(r),(di(i)?w.some(i):w.none()).fold((function(){return u.body.contains(n)}),(e=bi,o=vi,function(t){return e(o(t))}))},yi=function(){return xi(ne(document))},xi=function(t){var n=t.dom.body
if(null==n)throw new Error("Body is not available yet")
return ne(n)},wi=function(t,n,e){if(!C(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e)
fi(t)&&t.style.setProperty(n,e)},Si=function(t,n){fi(t)&&t.style.removeProperty(n)},ki=function(t,n,e){var o=t.dom
wi(o,n,e)},Ci=function(t,n){var e=t.dom
xt(n,(function(t,n){wi(e,n,t)}))},Oi=function(t,n){var e=t.dom
xt(n,(function(t,n){t.fold((function(){Si(e,n)}),(function(t){wi(e,n,t)}))}))},_i=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n)
return""!==o||bi(t)?o:Ti(e,n)},Ti=function(t,n){return fi(t)?t.style.getPropertyValue(n):""},Ei=function(t,n){var e=t.dom,o=Ti(e,n)
return w.from(o).filter((function(t){return 0<t.length}))},Bi=function(t,n,e){var o=Zn(t)
return ki(o,n,e),Ei(o,n).isSome()},Ai=function(t,n){var e=t.dom
Si(e,n),_r(t,"style").map(ce).is("")&&Er(t,"style")},Mi=function(t){return t.dom.offsetWidth},Fi=function(t){return t.dom.value},Di=function(t,n){if(void 0===n)throw new Error("Value.set was undefined")
t.dom.value=n},Ii=function(t){var n,e
return function(t,n){return e=t,r=L(o=n,(function(t){return Nn(t.name(),[Tn("config"),Ln("state",Kr)])})),i=dn("component.behaviours",Zt(r),e.behaviours).fold((function(t){throw new Error(pn(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))}),(function(t){return t})),{list:o,data:wt(i,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}))
return function(){return n}}))}
var e,o,r,i}(t,(n=_t(t,"behaviours").getOr({}),e=W(bt(n),(function(t){return void 0!==n[t]})),L(e,(function(t){return n[t].me}))))},Ri=function(t,n,e){var o,r,i,u={"alloy.base.behaviour":t.events}
return o=e,r=t.eventOrder,i=function(t,n,e){var o,r,i=l(l({},e),(o=t,r={},j(n,(function(t){r[t.name()]=t.handlers(o)})),r))
return $r(i,ti)}(o,n,u),ei(i,r).getOrDie()},Vi=function(t){var n,o,r,i,u,a,c,s,d,m,g,p,h,v=Lr(t),b=v.events,y=f(v,["events"]),x=(n=_t(y,"components").getOr([]),L(n,Ni)),w=l(l({},y),{events:l(l({},Mr),b),components:x})
return at.value((r=function(){return h},i=Jn(Ur),u=mn(function(t){var n,o
return dn("custom.definition",Zt([un("dom","dom",Pt(),Zt([Tn("tag"),Ln("styles",{}),Ln("classes",[]),Ln("attributes",{}),Rn("value"),Rn("innerHtml")])),Tn("components"),Tn("uid"),Ln("events",{}),Ln("apis",{}),un("eventOrder","eventOrder",((n={})[lo()]=["disabling",oi,"toggling","typeaheadevents"],n[uo()]=[oi,"focusing","keying"],n[vo()]=[oi,"disabling","toggling","representing"],n[Ze()]=[oi,"representing","streaming","invalidating"],n[ko()]=[oi,"representing","item-events","tooltipping"],n[We()]=["focusing",oi,"item-type-events"],n[Ne()]=["focusing",oi,"item-type-events"],n[qe()]=["item-type-events","tooltipping"],n[so()]=["receiving","reflecting","tooltipping"],o=n,Rt.mergeWithThunk(e(o))),bn()),Rn("domModification")]),t)}(o=w)),c=(a=Ii(o)).list,s=a.data,d=function(t,n,e){var o,r,i,u=l(l({},(o=t).dom),{uid:o.uid,domChildren:L(o.components,(function(t){return t.element}))}),a=t.domModification.fold((function(){return Qr({})}),Qr),c={"alloy.base.modification":a}
return i=0<n.length?function(t,n,e,o){var r=l({},n)
j(e,(function(n){r[n.name()]=n.exhibit(t,o)}))
var i=$r(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return G(t,(function(t,n){return l(l({},n.modification),t)}),{})},a=G(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles)
return Qr({classes:a,attributes:c,styles:s})}(e,c,n,u):a,l(l({},r=u),{attributes:l(l({},r.attributes),i.attributes),styles:l(l({},r.styles),i.styles),classes:r.classes.concat(i.classes)})}(u,c,s),m=function(t){var n,e,o,r=Zn(t.tag)
n=r,e=t.attributes,o=n.dom,xt(e,(function(t,n){kr(o,n,t)})),si(r,t.classes),Ci(r,t.styles),t.innerHtml.each((function(t){return Sr(r,t)}))
var i=t.domChildren
return vr(r,i),t.value.each((function(t){Di(r,t)})),t.uid,Hr(r,t.uid),r}(d),g=Ri(u,c,s),p=Jn(u.components),h={getSystem:i.get,config:function(t){var n=s
return(A(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(o,null,2))})()},hasConfigured:function(t){return A(s[t.name()])},spec:o,readState:function(t){return s[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return u.apis},connect:function(t){i.set(t)},disconnect:function(){i.set(jr(r))},element:m,syncComponents:function(){var t=fr(m),n=J(t,(function(t){return i.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}))
p.set(n)},components:p.get,events:g}))},Pi=function(t){var n=te(t)
return Hi({element:n})},Hi=function(n){var o=gn("external.component",Qt([Tn("element"),Rn("uid")]),n),r=Jn(jr())
o.uid.each((function(t){Hr(o.element,t)}))
var i={getSystem:r.get,config:w.none,hasConfigured:a,connect:function(t){r.set(t)},disconnect:function(){r.set(jr((function(){return i})))},getApis:function(){return{}},element:o.element,spec:n,readState:e("No state"),syncComponents:t,components:e([]),events:{}}
return Yr(i)},zi=Nr,Ni=function(t){return _t(t,Xr).fold((function(){var n=t.hasOwnProperty("uid")?t:l({uid:zi("")},t)
return Vi(n).getOrDie()}),(function(t){return t}))},Li=Yr
function ji(t,n){var e=function(e){var o=n(e)
if(o<=0||null===o){var r=_i(e,t)
return parseFloat(r)||0}return o},o=function(t,n){return X(n,(function(n,e){var o=_i(t,e),r=void 0===o?0:parseInt(o,10)
return isNaN(r)?n:n+r}),0)}
return{set:function(n,e){if(!M(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e)
var o=n.dom
fi(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e)
return r<n?n-r:0}}}var Ui=ji("height",(function(t){var n=t.dom
return bi(t)?n.getBoundingClientRect().height:n.offsetHeight})),Wi=function(t){return Ui.get(t)},Gi=function(t){return Ui.getOuter(t)},Xi=function(t,n){return{left:t,top:n,translate:function(e,o){return Xi(t+e,n+o)}}},Yi=Xi,qi=function(t,n){return void 0!==t?t:void 0!==n?n:0},Ki=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement
if(e===t.dom)return Yi(e.offsetLeft,e.offsetTop)
var i=qi(null==o?void 0:o.pageYOffset,r.scrollTop),u=qi(null==o?void 0:o.pageXOffset,r.scrollLeft),a=qi(r.clientTop,e.clientTop),c=qi(r.clientLeft,e.clientLeft)
return Ji(t).translate(u-c,i-a)},Ji=function(t){var n,e=t.dom,o=e.ownerDocument.body
return o===e?Yi(o.offsetLeft,o.offsetTop):bi(t)?(n=e.getBoundingClientRect(),Yi(n.left,n.top)):Yi(0,0)},$i=ji("width",(function(t){return t.dom.offsetWidth})),Qi=function(t){return $i.get(t)},Zi=function(t){return $i.getOuter(t)},tu=function(t){var e=ne(function(t){if(gi()&&B(t.target)){var n=ne(t.target)
if(tr(n)&&function(t){return B(t.dom.shadowRoot)}(n)&&t.composed&&t.composedPath){var e=t.composedPath()
if(e)return nt(e)}}return w.from(t.target)}(t).getOr(t.target)),o=function(){return t.stopPropagation()},r=function(){return t.preventDefault()},i=n(r,o)
return{target:e,x:t.clientX,y:t.clientY,stop:o,prevent:r,kill:i,raw:t}},nu=function(t,n,e,o,i){var u,a,c=(u=e,a=o,function(t){u(t)&&a(tu(t))})
return t.dom.addEventListener(n,c,i),{unbind:r(eu,t,n,c,i)}},eu=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},ou=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop
return Yi(e,o)},ru=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView
o&&o.scrollTo(t,n)},iu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},uu=function(t){var n,e,o=void 0===t?window:t,r=o.document,i=ou(ne(r))
return e=void 0===(n=o)?window:n,w.from(e.visualViewport).fold((function(){var t=o.document.documentElement,n=t.clientWidth,e=t.clientHeight
return iu(i.left,i.top,n,e)}),(function(t){return iu(Math.max(t.pageLeft,i.left),Math.max(t.pageTop,i.top),t.width,t.height)}))},au=function(t,n){return t.view(n).fold(e([]),(function(n){var e=t.owner(n),o=au(t,e)
return[n].concat(o)}))},cu=Object.freeze({__proto__:null,view:function(t){var n
return(t.dom===document?w.none():w.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(ne)},owner:rr}),su=function(t){var n,e,o,i,u=ne(document),a=ou(u)
return(n=t,o=(e=cu).owner(n),i=au(e,o),w.some(i)).fold(r(Ki,t),(function(n){var e=Ji(t),o=G(n,(function(t,n){var e=Ji(n)
return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0})
return Yi(o.left+e.left+a.left,o.top+e.top+a.top)}))},lu=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},fu=function(t){var n=Ki(t),e=Zi(t),o=Gi(t)
return lu(n.left,n.top,e,o)},du=function(t){var n=su(t),e=Zi(t),o=Gi(t)
return lu(n.left,n.top,e,o)},mu=function(){return uu(window)}
function gu(t,n,e,o,r){return t(e,o)?w.some(e):A(r)&&r(e)?w.none():n(e,o,r)}var pu,hu,vu=function(t,n,e){for(var o=t.dom,r=A(e)?e:a;o.parentNode;){o=o.parentNode
var i=ne(o)
if(n(i))return w.some(i)
if(r(i))break}return w.none()},bu=function(t,n,e){return gu((function(t,n){return n(t)}),vu,t,n,e)},yu=function(t,n,e){return bu(t,n,e).isSome()},xu=function(t,n,e){return vu(t,(function(t){return Ae(t,n)}),e)},wu=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Me(r)?w.none():w.from(r.querySelector(e)).map(ne)
var e,o,r},Su=function(t,n,e){return gu(Ae,xu,t,n,e)},ku=function(){var t=Dr("aria-owns")
return{id:t,link:function(n){Cr(n,"aria-owns",t)},unlink:function(t){Er(t,"aria-owns")}}},Cu=function(t,n){return yu(n,(function(n){return Fe(n,t.element)}),a)||function(t,n){return bu(n,(function(t){if(!tr(t))return!1
var n=Or(t,"id")
return void 0!==n&&-1<n.indexOf("aria-owns")})).bind((function(t){var n=Or(t,"id"),e=pi(t)
return wu(e,'[aria-owns="'+n+'"]')})).exists((function(n){return Cu(t,n)}))}(t,n)};(hu=pu=pu||{})[hu.STOP=0]="STOP",hu[hu.NORMAL=1]="NORMAL",hu[hu.LOGGING=2]="LOGGING"
var Ou,_u,Tu=Jn({}),Eu=["alloy/data/Fields","alloy/debugging/Debugging"],Bu=function(t,n,e){var o,r,i,u
switch(_t(Tu.get(),t).orThunk((function(){var n=bt(Tu.get())
return rt(n,(function(n){return-1<t.indexOf(n)?w.some(Tu.get()[n]):w.none()}))})).getOr(pu.NORMAL)){case pu.NORMAL:return e(Au())
case pu.LOGGING:var a=(o=t,r=n,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime()
P(["mousemove","mouseover","mouseout",vo()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:L(i,(function(t){return P(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Br(t.target)+")":t.outcome}))})}}),c=e(a)
return a.write(),c
case pu.STOP:return!0}},Au=e({logEventCut:t,logEventStopped:t,logNoParent:t,logEventNoHandlers:t,logEventResponse:t,write:t}),Mu=e([Tn("menu"),Tn("selectedMenu")]),Fu=e([Tn("item"),Tn("selectedItem")]),Du=(e(Zt(Fu().concat(Mu()))),e(Zt(Fu()))),Iu=Fn("initSize",[Tn("numColumns"),Tn("numRows")]),Ru=function(){return Fn("markers",[Tn("backgroundMenu")].concat(Mu()).concat(Fu()))},Vu=function(t){return Fn("markers",L(t,Tn))},Pu=function(t,n,e){return function(){var t=new Error
if(void 0!==t.stack){var n=t.stack.split("\n")
Y(n,(function(t){return 0<t.indexOf("alloy")&&!H(Eu,(function(n){return-1<t.indexOf(n)}))})).getOr("unknown")}}(),un(n,n,e,ln((function(t){return at.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e]
return t.apply(void 0,n)}))})))},Hu=function(n){return Pu(0,n,Vt(t))},zu=function(t){return Pu(0,t,Vt(w.none))},Nu=function(t){return Pu(0,t,Pt())},Lu=function(t){return Pu(0,t,Pt())},ju=function(t,n){return Kn(t,e(n))},Uu=function(t){return Kn(t,o)},Wu=e(Iu),Gu=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},Xu=Bt([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Yu=Xu.southeast,qu=Xu.southwest,Ku=Xu.northeast,Ju=Xu.northwest,$u=Xu.south,Qu=Xu.north,Zu=Xu.east,ta=Xu.west,na=function(t,n){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o]
e[String(i)]=n(i)}return e}(["left","right","top","bottom"],(function(e){return _t(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x
case 0:return t.x+t.width
case 2:return t.y
case 3:return t.y+t.height}}(t,n)}))}))},ea=function(t){return t.x},oa=function(t,n){return t.x+t.width/2-n.width/2},ra=function(t,n){return t.x+t.width-n.width},ia=function(t,n){return t.y-n.height},ua=function(t){return t.y+t.height},aa=function(t,n){return t.y+t.height/2-n.height/2},ca=function(t,n,e){return Gu(ea(t),ua(t),e.southeast(),Yu(),na(t,{left:1,top:3}),"layout-se")},sa=function(t,n,e){return Gu(ra(t,n),ua(t),e.southwest(),qu(),na(t,{right:0,top:3}),"layout-sw")},la=function(t,n,e){return Gu(ea(t),ia(t,n),e.northeast(),Ku(),na(t,{left:1,bottom:2}),"layout-ne")},fa=function(t,n,e){return Gu(ra(t,n),ia(t,n),e.northwest(),Ju(),na(t,{right:0,bottom:2}),"layout-nw")},da=function(t,n,e){return Gu(oa(t,n),ia(t,n),e.north(),Qu(),na(t,{bottom:2}),"layout-n")},ma=function(t,n,e){return Gu(oa(t,n),ua(t),e.south(),$u(),na(t,{top:3}),"layout-s")},ga=function(t,n,e){return Gu((o=t).x+o.width,aa(t,n),e.east(),Zu(),na(t,{left:0}),"layout-e")
var o},pa=function(t,n,e){return Gu((o=n,t.x-o.width),aa(t,n),e.west(),ta(),na(t,{right:1}),"layout-w")
var o},ha=function(){return[ca,sa,la,fa,ma,da,ga,pa]},va=function(){return[sa,ca,fa,la,ma,da,ga,pa]},ba=function(){return[la,fa,ca,sa,da,ma]},ya=function(){return[fa,la,sa,ca,da,ma]},xa=function(){return[ca,sa,la,fa,ma,da]},wa=function(){return[sa,ca,fa,la,ma,da]},Sa=Object.freeze({__proto__:null,events:function(t){return Ho([Lo(so(),(function(n,e){var o,r,i=t.channels,u=bt(i),a=e,c=(o=u,(r=a).universal?o:W(o,(function(t){return P(r.channels,t)})))
j(c,(function(t){var e=i[t],o=e.schema,r=gn("channel["+t+"] data\nReceiver: "+Br(n.element),o,a.data)
e.onReceive(n,r)}))}))])}}),ka=[En("channels",fn(at.value,Qt([Nu("onReceive"),Ln("schema",bn())])))],Ca=function(t,n,e){return Jo((function(o,r){e(o,t,n)}))},Oa=function(t){return{key:t,value:void 0}},_a=function(t,n,o,i,u,a,c){var s=function(t){return Et(t,o)?t[o]():w.none()},f=wt(u,(function(t,n){return function(t,n,o){var r,i,u,a,c,s
return r=function(r){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u]
var a=[r].concat(i)
return r.config({name:e(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+o)}),(function(t){var e=Array.prototype.slice.call(a,1)
return n.apply(void 0,[r,t.config,t.state].concat(e))}))},i=o,a=(u=n.toString()).indexOf(")")+1,c=u.indexOf("("),s=u.substring(c+1,a-1).split(/,\s*/),r.toFunctionAnnotation=function(){return{name:i,parameters:Wr(s.slice(0,1).concat(s.slice(3)))}},r}(o,t,n)})),d=wt(a,Gr),m=l(l(l({},d),f),{revoke:r(Oa,o),config:function(n){var e=gn(o+"-config",t,n)
return{key:o,value:{config:e,me:m,configAsRaw:It((function(){return gn(o+"-config",t,n)})),initialConfig:n,state:c}}},schema:function(){return n},exhibit:function(t,n){return s(t).bind((function(t){return _t(i,"exhibit").map((function(e){return e(n,t.config,t.state)}))})).getOr(Qr({}))},name:function(){return o},handlers:function(t){return s(t).map((function(t){return _t(i,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}})
return m},Ta=Ut,Ea=Qt([Tn("fields"),Tn("name"),Ln("active",{}),Ln("apis",{}),Ln("state",Kr),Ln("extra",{})]),Ba=function(t){var n=gn("Creating behaviour: "+t.name,Ea,t)
return function(t,n,e,o,r,i){var u=Qt(t),a=Nn(n,[Vn("config",Qt(t))])
return _a(u,a,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},Aa=Qt([Tn("branchKey"),Tn("branches"),Tn("name"),Ln("active",{}),Ln("apis",{}),Ln("state",Kr),Ln("extra",{})]),Ma=function(t){var n,e,o,r,i,u,a,c,s=gn("Creating behaviour: "+t.name,Aa,t)
return n=vn(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=Nn(e,[Vn("config",a=n)]),_a(a,c,e,o,r,i,u)},Fa=e(void 0),Da=Ba({fields:ka,name:"receiving",active:Sa}),Ia=Object.freeze({__proto__:null,exhibit:function(t,n){return Qr({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Ra=function(t){return t.dom.focus()},Va=function(t){return void 0===t&&(t=ne(document)),w.from(t.dom.activeElement).map(ne)},Pa=function(t){return Va(pi(t)).filter((function(n){return t.dom.contains(n.dom)}))},Ha=function(n,e){var o=pi(e),r=Va(o).bind((function(t){var n,o,r=function(n){return Fe(t,n)}
return r(e)?w.some(e):(n=r,(o=function(t){for(var e=0;e<t.childNodes.length;e++){var r=ne(t.childNodes[e])
if(n(r))return w.some(r)
var i=o(t.childNodes[e])
if(i.isSome())return i}return w.none()})(e.dom))})),i=n(e)
return r.each((function(n){Va(o).filter((function(t){return Fe(t,n)})).fold((function(){Ra(n)}),t)})),i},za=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},Na=function(t,n){var e=function(t){return t+"px"}
Oi(t,{position:w.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},La=Bt([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),ja=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g=n.x-e,p=n.y-o,h=r-(g+n.width),v=i-(p+n.height),b=w.some(g),y=w.some(p),x=w.some(h),S=w.some(v),k=w.none()
return u=function(){return za(t,b,y,k,k)},a=function(){return za(t,k,y,x,k)},c=function(){return za(t,b,k,k,S)},s=function(){return za(t,k,k,x,S)},l=function(){return za(t,b,y,k,k)},f=function(){return za(t,b,k,k,S)},d=function(){return za(t,b,y,k,k)},m=function(){return za(t,k,y,x,k)},n.direction.fold(u,a,c,s,l,f,d,m)},Ua=function(t,n){var e=r(su,n),o=t.fold(e,e,(function(){var t=ou()
return su(n).translate(-t.left,-t.top)})),i=Zi(n),u=Gi(n)
return lu(o.left,o.top,i,u)},Wa=function(t,n,o){var r=Yi(n,o)
return t.fold(e(r),e(r),(function(){var t=ou()
return r.translate(-t.left,-t.top)}))},Ga=(La.none,La.relative),Xa=La.fixed,Ya=function(t,n,e,o){var r=t+n
return o<r?e:r<e?o:r},qa=function(t,n,e){return Math.min(Math.max(t,n),e)},Ka=Bt([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),Ja=function(t,n,i,u){Ai(n,"max-height"),Ai(n,"max-width")
var a,c,s,l,f,d,m,g,p,h={width:Zi(a=n),height:Gi(a)}
return c=u.preference,s=t,l=h,f=i,d=u.bounds,m=l.width,g=l.height,p=function(t,n,r,i){return function(t,n,r,i){var u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,S,k,C,O,_,T,E,B,A,M,F,D,I,R,V,P,H,z=t.x,N=t.y,L=t.bubble.offset,j=L.left,U=L.top,W=(u=i,a=t.boundsRestriction,c=L,l=(s=function(t,n){var e="top"===t||"bottom"===t?c.top:c.left
return _t(a,t).bind(o).bind((function(e){return"left"===t||"top"===t?n<=e?w.some(e):w.none():e<=n?w.some(e):w.none()})).map((function(t){return t+e})).getOr(n)})("left",u.x),f=s("top",u.y),d=s("right",u.right),m=s("bottom",u.bottom),lu(l,f,d-l,m-f)),G=W.y,X=W.bottom,Y=W.x,q=W.right,K=N+U,J=(g=z+j,p=K,h=n,v=r,y=(b=W).x,x=b.y,S=b.width,k=b.height,O=x<=p,_=(C=y<=g)&&O,T=g+h<=y+S&&p+v<=x+k,E=Math.abs(Math.min(h,C?y+S-g:y-(g+h))),B=Math.abs(Math.min(v,O?x+k-p:x-(p+v))),A=Math.max(b.x,b.right-h),M=Math.max(b.y,b.bottom-v),{originInBounds:_,sizeInBounds:T,limitX:qa(g,b.x,A),limitY:qa(p,b.y,M),deltaW:E,deltaH:B}),$=J.originInBounds,Q=J.sizeInBounds,Z=J.limitX,tt=J.limitY,nt=J.deltaW,et=J.deltaH,ot=e(tt+et-G),rt=(D=F=e(X-tt),I=ot,t.direction.fold(F,F,I,I,F,I,D,D)),it=e(Z+nt-Y),ut=e(q-Z),at={x:Z,y:tt,width:nt,height:et,maxHeight:rt,maxWidth:(R=t.direction,P=V=ut,H=it,R.fold(V,H,V,H,P,P,V,H)),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:K}
return $&&Q?Ka.fit(at):Ka.nofit(at,nt,et)}(t(s,l,f),m,g,d).fold(Ka.fit,(function(t,e,o){return i<o||r<e?Ka.nofit(t,e,o):Ka.nofit(n,r,i)}))},X(c,(function(t,n){var e=r(p,n)
return t.fold(Ka.fit,e)}),Ka.nofit({x:s.x,y:s.y,width:l.width,height:l.height,maxHeight:l.height,maxWidth:l.width,direction:Yu(),classes:{on:[],off:[]},label:"none",candidateYforTest:s.y},-1,-1)).fold(o,o)},$a=function(t,n){var e,o,r
e=t,o=Math.floor(n),r=Ui.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),ki(e,"max-height",r+"px")},Qa=e((function(t,n){$a(t,n),Ci(t,{"overflow-x":"hidden","overflow-y":"auto"})})),Za=e((function(t,n){$a(t,n)})),tc=function(t,n,e){return void 0===t[n]?e:t[n]},nc=function(t,n,e,o){var r,i,u,a,c,s,l=Ja(t,n,e,o);(function(t,n,e){var o,r
Na(t,(o=e.origin,r=n,o.fold((function(){return za("absolute",w.some(r.x),w.some(r.y),w.none(),w.none())}),(function(t,n,e,o){return ja("absolute",r,t,n,e,o)}),(function(t,n,e,o){return ja("fixed",r,t,n,e,o)}))))})(n,l,o),r=n,i=l.classes,li(r,i.off),si(r,i.on),u=n,a=l,(0,o.maxHeightFunction)(u,a.maxHeight),c=n,s=l,(0,o.maxWidthFunction)(c,s.maxWidth)},ec=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],oc=function(t,n,e){var o=function(t){return _t(e,t).getOr([])},r=function(t,n,e){var r=Z(ec,e)
return{offset:Yi(t,n),classesOn:J(e,o),classesOff:J(r,o)}}
return{southeast:function(){return r(-t,n,["top","alignLeft"])},southwest:function(){return r(t,n,["top","alignRight"])},south:function(){return r(-t/2,n,["top","alignCentre"])},northeast:function(){return r(-t,-n,["bottom","alignLeft"])},northwest:function(){return r(t,-n,["bottom","alignRight"])},north:function(){return r(-t/2,-n,["bottom","alignCentre"])},east:function(){return r(t,-n/2,["valignCentre","left"])},west:function(){return r(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return r(-t,n,["top","alignRight"])},innerNortheast:function(){return r(t,n,["top","alignLeft"])},innerNorth:function(){return r(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return r(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return r(t,-n,["bottom","alignLeft"])},innerSouth:function(){return r(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return r(t,-n/2,["valignCentre","right"])},innerEast:function(){return r(-t,-n/2,["valignCentre","left"])}}},rc=function(){return oc(0,0,{})},ic=function(t,n){return function(e){return"rtl"===uc(e)?n:t}},uc=function(t){return"rtl"===_i(t,"direction")?"rtl":"ltr"};(_u=Ou=Ou||{}).TopToBottom="toptobottom",_u.BottomToTop="bottomtotop"
var ac="data-alloy-vertical-dir",cc=function(t){return yu(t,(function(t){return tr(t)&&Or(t,"data-alloy-vertical-dir")===Ou.BottomToTop}))},sc=function(){return Nn("layouts",[Tn("onLtr"),Tn("onRtl"),Rn("onBottomLtr"),Rn("onBottomRtl")])},lc=function(t,n,e,o,r,i,u){var a=u.map(cc).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),l=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),f=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o)
return ic(l,f)(t)},fc=[Tn("hotspot"),Rn("bubble"),Ln("overrides",{}),sc(),ju("placement",(function(t,n,e){var o=n.hotspot,r=Ua(e,o.element),i=lc(t.element,n,xa(),wa(),ba(),ya(),w.some(n.hotspot.element))
return w.some({anchorBox:r,bubble:n.bubble.getOr(rc()),overrides:n.overrides,layouts:i,placer:w.none()})}))],dc=[Tn("x"),Tn("y"),Ln("height",0),Ln("width",0),Ln("bubble",rc()),Ln("overrides",{}),sc(),ju("placement",(function(t,n,e){var o=Wa(e,n.x,n.y),r=lu(o.left,o.top,n.width,n.height),i=lc(t.element,n,ha(),va(),ha(),va(),w.none())
return w.some({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:w.none()})}))],mc=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},gc=Bt([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),pc=(gc.before,gc.on,gc.after,function(t){return t.fold(o,o,o)}),hc=Bt([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),vc={domRange:hc.domRange,relative:hc.relative,exact:hc.exact,exactFromRange:function(t){return hc.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=t.match({domRange:function(t){return ne(t.startContainer)},relative:function(t,n){return pc(t)},exact:function(t,n,e,o){return t}})
return ar(n)},range:mc},bc=function(t,n,e){var o,r,i=t.document.createRange()
return o=i,n.fold((function(t){o.setStartBefore(t.dom)}),(function(t,n){o.setStart(t.dom,n)}),(function(t){o.setStartAfter(t.dom)})),r=i,e.fold((function(t){r.setEndBefore(t.dom)}),(function(t,n){r.setEnd(t.dom,n)}),(function(t){r.setEndAfter(t.dom)})),i},yc=function(t,n,e,o,r){var i=t.document.createRange()
return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},xc=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},wc=Bt([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Sc=function(t,n,e){return n(ne(e.startContainer),e.startOffset,ne(e.endContainer),e.endOffset)}
wc.ltr,wc.rtl
var kc,Cc,Oc,_c,Tc=(kc=nr,"text",{get:function(t){if(!kc(t))throw new Error("Can only get text value of a text node")
return Cc(t).getOr("")},getOption:Cc=function(t){return kc(t)?w.from(t.dom.nodeValue):w.none()},set:function(t,n){if(!kc(t))throw new Error("Can only set raw text value of a text node")
t.dom.nodeValue=n}}),Ec=function(t){return Tc.getOption(t)},Bc=["img","br"],Ac=function(t){return Ec(t).filter((function(t){return 0!==t.trim().length||-1<t.indexOf(" ")})).isSome()||P(Bc,Qo(t))},Mc=function(t,n){return e=n,r=void 0===(o=t)?document:o.dom,Me(r)?[]:L(r.querySelectorAll(e),ne)
var e,o,r},Fc=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1)
return w.some(mc(ne(n.startContainer),n.startOffset,ne(e.endContainer),e.endOffset))}return w.none()},Dc=function(t){if(null===t.anchorNode||null===t.focusNode)return Fc(t)
var n=ne(t.anchorNode),e=ne(t.focusNode)
return function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=rr(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),l=Fe(t,e)&&n===o
return s.collapsed&&!l}(n,t.anchorOffset,e,t.focusOffset)?w.some(mc(n,t.anchorOffset,e,t.focusOffset)):Fc(t)},Ic=function(t,n){var o,r,i,u,a=function(t,n){var o,r,i,u=(o=t,n.match({domRange:function(t){return{ltr:e(t),rtl:w.none}},relative:function(t,n){return{ltr:It((function(){return bc(o,t,n)})),rtl:It((function(){return w.some(bc(o,n,t))}))}},exact:function(t,n,e,r){return{ltr:It((function(){return yc(o,t,n,e,r)})),rtl:It((function(){return w.some(yc(o,e,r,t,n))}))}}}))
return(i=(r=u).ltr()).collapsed?r.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return wc.rtl(ne(t.endContainer),t.endOffset,ne(t.startContainer),t.startOffset)})).getOrThunk((function(){return Sc(0,wc.ltr,i)})):Sc(0,wc.ltr,i)}(o=t,n).match({ltr:function(t,n,e,r){var i=o.document.createRange()
return i.setStart(t.dom,n),i.setEnd(e.dom,r),i},rtl:function(t,n,e,r){var i=o.document.createRange()
return i.setStart(e.dom,r),i.setEnd(t.dom,n),i}})
return 0<(u=0<(i=(r=a).getClientRects()).length?i[0]:r.getBoundingClientRect()).width||0<u.height?w.some(u).map(xc):w.none()},Rc=function(t,n){return{element:t,offset:n}},Vc=Bt([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Pc=function(t){return t.fold(o,(function(t,n,e){return t.translate(-n,-e)}))},Hc=function(t){return t.fold(o,o)},zc=function(t){return X(t,(function(t,n){return t.translate(n.left,n.top)}),Yi(0,0))},Nc=function(t){var n=L(t,Hc)
return zc(n)},Lc=Vc.screen,jc=Vc.absolute,Uc=function(t,n,e){var o,r,i=rr(t.element),u=ou(i),a=(o=t,r=ar(e.root).dom,w.from(r.frameElement).map(ne).filter((function(t){var n=rr(t),e=rr(o.element)
return Fe(n,e)})).map(Ki).getOr(u))
return jc(a,u.left,u.top)},Wc=function(t,n,e,o){var r=t,i=n,u=e,a=o
t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n)
var c=Lc(Yi(r,i))
return w.some({point:c,width:u,height:a})},Gc=function(t,n,e,o,r){return t.map((function(t){var i,u,a,c=[n,t.point],s=(i=function(){return Nc(c)},u=function(){return Nc(c)},a=function(){return t=L(c,Pc),zc(t)
var t},o.fold(i,u,a)),l={x:s.left,y:s.top,width:t.width,height:t.height},f=(e.showAbove?ba:xa)(),d=(e.showAbove?ya:wa)(),m=lc(r,e,f,d,f,d,w.none())
return{anchorBox:l,bubble:e.bubble.getOr(rc()),overrides:e.overrides,layouts:m,placer:w.none()}}))},Xc=function(t,n){return nr(t)?{element:t,offset:n}:function(t,n){var e=fr(t)
if(0===e.length)return Rc(t,n)
if(n<e.length)return Rc(e[n],0)
var o,r=e[e.length-1],i=nr(r)?(o=r,Tc.get(o).length):fr(r).length
return Rc(r,i)}(t,n)},Yc=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return function(t){return n=t,w.from(n.getSelection()).filter((function(t){return 0<t.rangeCount})).bind(Dc)
var n}(t)}}))().map((function(t){var n=Xc(t.start,t.soffset),e=Xc(t.finish,t.foffset)
return vc.range(n.element,n.offset,e.element,e.offset)}))},qc=[Rn("getSelection"),Tn("root"),Rn("bubble"),sc(),Ln("overrides",{}),Ln("showAbove",!1),ju("placement",(function(t,n,e){var o=ar(n.root).dom,r=Uc(t,0,n),i=Yc(o,n).bind((function(t){return Ic(o,vc.exactFromRange(t)).orThunk((function(){var n=te("\ufeff")
return mr(t.start,n),Ic(o,vc.exact(n,0,n,1)).map((function(t){return yr(n),t}))})).bind((function(t){return Wc(t.left,t.top,t.width,t.height)}))})),u=Yc(o,n).bind((function(t){return tr(t.start)?w.some(t.start):sr(t.start)})).getOr(t.element)
return Gc(i,r,n,e,u)}))],Kc=[Tn("node"),Tn("root"),Rn("bubble"),sc(),Ln("overrides",{}),Ln("showAbove",!1),ju("placement",(function(t,n,e){var o=Uc(t,0,n)
return n.node.bind((function(r){var i=r.dom.getBoundingClientRect(),u=Wc(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element)
return Gc(u,o,n,e,a)}))}))],Jc=function(t){return t.x+t.width},$c=function(t,n){return t.x-n.width},Qc=function(t,n){return t.y-n.height+t.height},Zc=function(t){return t.y},ts=function(t,n,e){return Gu(Jc(t),Zc(t),e.southeast(),Yu(),na(t,{left:0,top:2}),"link-layout-se")},ns=function(t,n,e){return Gu($c(t,n),Zc(t),e.southwest(),qu(),na(t,{right:1,top:2}),"link-layout-sw")},es=function(t,n,e){return Gu(Jc(t),Qc(t,n),e.northeast(),Ku(),na(t,{left:0,bottom:3}),"link-layout-ne")},os=function(t,n,e){return Gu($c(t,n),Qc(t,n),e.northwest(),Ju(),na(t,{right:1,bottom:3}),"link-layout-nw")},rs=function(){return[ts,ns,es,os]},is=function(){return[ns,ts,os,es]},us=[Tn("item"),sc(),Ln("overrides",{}),ju("placement",(function(t,n,e){var o=Ua(e,n.item.element),r=lc(t.element,n,rs(),is(),rs(),is(),w.none())
return w.some({anchorBox:o,bubble:rc(),overrides:n.overrides,layouts:r,placer:w.none()})}))],as=vn("anchor",{selection:qc,node:Kc,hotspot:fc,submenu:us,makeshift:dc}),cs=function(n,e,o,r,i){(function(n,e,o,r,i,u){var a,c=tc(u,"maxHeightFunction",Qa()),s=tc(u,"maxWidthFunction",t),l=n.anchorBox,f=n.origin,d={bounds:(a=f,i.fold((function(){return a.fold(mu,mu,lu)}),(function(t){return a.fold(t,t,(function(){var n=t(),e=Wa(a,n.x,n.y)
return lu(e.left,e.top,n.width,n.height)}))}))),origin:f,preference:r,maxHeightFunction:c,maxWidthFunction:s}
nc(l,e,o,d)})({anchorBox:o.anchorBox,origin:e},i.element,o.bubble,o.layouts,r,o.overrides)},ss=function(t,n,e,o,r,i){var u=i.map(fu)
return ls(t,n,e,o,r,u)},ls=function(t,n,o,r,i,u){var a=gn("positioning anchor.info",as,r)
Ha((function(){ki(i.element,"position","fixed")
var o=Ei(i.element,"visibility")
ki(i.element,"visibility","hidden")
var r,c,s,l,f=n.useFixed()?(l=document.documentElement,Xa(0,0,l.clientWidth,l.clientHeight)):(c=Ki((r=t).element),s=r.element.dom.getBoundingClientRect(),Ga(c.left,c.top,s.width,s.height)),d=a.placement,m=u.map(e).or(n.getBounds)
d(t,a,f).each((function(n){n.placer.getOr(cs)(t,f,n,m,i)})),o.fold((function(){Ai(i.element,"visibility")}),(function(t){ki(i.element,"visibility",t)})),Ei(i.element,"left").isNone()&&Ei(i.element,"top").isNone()&&Ei(i.element,"right").isNone()&&Ei(i.element,"bottom").isNone()&&Ei(i.element,"position").is("fixed")&&Ai(i.element,"position")}),i.element)},fs=Object.freeze({__proto__:null,position:function(t,n,e,o,r){ss(t,n,e,o,r,w.none())},positionWithin:ss,positionWithinBounds:ls,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"}}),ds=[Ln("useFixed",a),Rn("getBounds")],ms=Ba({fields:ds,name:"positioning",active:Ia,apis:fs}),gs=function(t){Fo(t,ko())
var n=t.components()
j(n,gs)},ps=function(t){var n=t.components()
j(n,ps),Fo(t,So())},hs=function(t,n){hr(t.element,n.element)},vs=function(t,n){var e,o=t.components()
j((e=t).components(),(function(t){return yr(t.element)})),br(e.element),e.syncComponents()
var r=Z(o,n)
j(r,(function(n){gs(n),t.getSystem().removeFromWorld(n)})),j(n,(function(n){n.getSystem().isConnected()?hs(t,n):(t.getSystem().addToWorld(n),hs(t,n),bi(t.element)&&ps(n)),t.syncComponents()}))},bs=function(t,n){ys(t,n,hr)},ys=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),bi(t.element)&&ps(n),t.syncComponents()},xs=function(t){gs(t),yr(t.element),t.getSystem().removeFromWorld(t)},ws=function(t){var n=cr(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))
xs(t),n.each((function(t){t.syncComponents()}))},Ss=function(t){var n=t.components()
j(n,xs),br(t.element),t.syncComponents()},ks=function(t,n){Cs(t,n,hr)},Cs=function(t,n,e){e(t,n.element)
var o=fr(n.element)
j(o,(function(t){n.getByDom(t).each(ps)}))},Os=function(t){var n=fr(t.element)
j(n,(function(n){t.getByDom(n).each(gs)})),yr(t.element)},_s=function(t,n,e,o){e.get().each((function(n){Ss(t)}))
var r=n.getAttachPoint(t)
bs(r,t)
var i=t.getSystem().build(o)
return bs(t,i),e.set(i),i},Ts=function(t,n,e,o){var r=_s(t,n,e,o)
return n.onOpen(t,r),r},Es=function(t,n,e){e.get().each((function(o){Ss(t),ws(t),n.onClose(t,o),e.clear()}))},Bs=function(t,n,e){return e.isOpen()},As=function(t,n,e){var o,r,i,u=n.getAttachPoint(t)
ki(t.element,"position",ms.getMode(u)),o=t,r="visibility",i=n.cloakVisibilityAttr,Ei(o.element,r).fold((function(){Er(o.element,i)}),(function(t){Cr(o.element,i,t)})),ki(o.element,r,"hidden")},Ms=function(t,n,e){var o,r,i,u
o=t.element,H(["top","left","right","bottom"],(function(t){return Ei(o,t).isSome()}))||Ai(t.element,"position"),r=t,i="visibility",u=n.cloakVisibilityAttr,_r(r.element,u).fold((function(){return Ai(r.element,i)}),(function(t){return ki(r.element,i,t)}))},Fs=Object.freeze({__proto__:null,cloak:As,decloak:Ms,open:Ts,openWhileCloaked:function(t,n,e,o,r){As(t,n),Ts(t,n,e,o),r(),Ms(t,n)},close:Es,isOpen:Bs,isPartOf:function(t,n,e,o){return Bs(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return _s(t,n,e,o)}))}}),Ds=Object.freeze({__proto__:null,events:function(t,n){return Ho([Lo(po(),(function(e,o){Es(e,t,n)}))])}}),Is=[Hu("onOpen"),Hu("onClose"),Tn("isPartOf"),Tn("getAttachPoint"),Ln("cloakVisibilityAttr","data-precloak-visibility")],Rs=Ba({fields:Is,name:"sandboxing",active:Ds,apis:Fs,state:Object.freeze({__proto__:null,init:function(){var t=Jn(w.none()),n=e("not-implemented")
return Jr({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(w.none())},set:function(n){t.set(w.some(n))},get:function(){return t.get()}})}})}),Vs=e("dismiss.popups"),Ps=e("reposition.popups"),Hs=e("mouse.released"),zs=Qt([Ln("isExtraPart",a),Nn("fireEventInstead",[Ln("event",Co())])]),Ns=function(t){var n=gn("Dismissal",zs,t),e={}
return e[Vs()]={schema:Qt([Tn("target")]),onReceive:function(t,e){Rs.isOpen(t)&&(Rs.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold((function(){return Rs.close(t)}),(function(n){return Fo(t,n.event)})))}},e},Ls=Qt([Nn("fireEventInstead",[Ln("event",Oo())]),Mn("doReposition")]),js=function(t){var n=gn("Reposition",Ls,t),e={}
return e[Ps()]={onReceive:function(t){Rs.isOpen(t)&&n.fireEventInstead.fold((function(){return n.doReposition(t)}),(function(n){return Fo(t,n.event)}))}},e},Us=function(t,n,e){n.store.manager.onLoad(t,n,e)},Ws=function(t,n,e){n.store.manager.onUnload(t,n,e)},Gs=Object.freeze({__proto__:null,onLoad:Us,onUnload:Ws,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),Xs=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[qo((function(e,o){Us(e,t,n)})),Ko((function(e,o){Ws(e,t,n)}))]:[Ca(t,n,Us)]
return Ho(e)}}),Ys=function(){var t=Jn(null)
return Jr({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},qs=function(){var t=Jn({}),n=Jn({})
return Jr({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return _t(t.get(),e).orThunk((function(){return _t(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={}
j(e,(function(t){i[t.value]=t,_t(t,"meta").each((function(n){_t(n,"text").each((function(n){u[n]=t}))}))})),t.set(l(l({},o),i)),n.set(l(l({},r),u))},clear:function(){t.set({}),n.set({})}})},Ks=Object.freeze({__proto__:null,memory:Ys,dataset:qs,manual:function(){return Jr({readState:function(){}})},init:function(t){return t.store.manager.state(t)}}),Js=function(t,n,e,o){var r=n.store
e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},$s=[Rn("initialValue"),Tn("getFallbackEntry"),Tn("getDataKey"),Tn("setValue"),ju("manager",{setValue:Js,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t)
return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(t){return t}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){Js(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:qs})],Qs=[Tn("getValue"),Ln("setValue",t),Rn("initialValue"),ju("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:t,state:Kr.init})],Zs=[Rn("initialValue"),ju("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:Ys})],tl=[jn("store",{mode:"memory"},vn("mode",{memory:Zs,manual:Qs,dataset:$s})),Hu("onSetValue"),Ln("resetOnDom",!1)],nl=Ba({fields:tl,name:"representing",active:Xs,apis:Gs,extra:{setValueFrom:function(t,n){var e=nl.getValue(n)
nl.setValue(t,e)}},state:Ks}),el=function(t,n){return qn(t,{},L(n,(function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,un(e,e,Ht(),$t((function(t){return pt("The field: "+e+" is forbidden. "+o)})))
var e,o})).concat([Kn("dump",o)]))},ol=function(t){return t.dump},rl=function(t,n){return l(l({},t.dump),Ta(n))},il=el,ul=rl,al="placeholder",cl=Bt([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),sl=function(t){return Tt(t,"uiType")},ll=function(t,n,r,i){return function(t,n,o,r){return sl(o)&&o.uiType===al?(u=o,a=r,(i=t).exists((function(t){return t!==u.owner}))?cl.single(!0,e(u)):_t(a,u.name).fold((function(){throw new Error("Unknown placeholder component: "+u.name+"\nKnown: ["+bt(a)+"]\nNamespace: "+i.getOr("none")+"\nSpec: "+JSON.stringify(u,null,2))}),(function(t){return t.replace()}))):cl.single(!1,e(o))
var i,u,a}(t,0,r,i).fold((function(e,o){var u=sl(r)?o(n,r.config,r.validated):o(n),a=_t(u,"components").getOr([]),c=J(a,(function(e){return ll(t,n,e,i)}))
return[l(l({},u),{components:c})]}),(function(t,e){if(sl(r)){var i=e(n,r.config,r.validated)
return r.validated.preprocess.getOr(o)(i)}return e(n)}))},fl=cl.single,dl=cl.multiple,ml=e(al),gl=Bt([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),pl=Ln("factory",{sketch:o}),hl=Ln("schema",[]),vl=Tn("name"),bl=un("pname","pname",zt((function(t){return"<alloy."+Dr(t.name)+">"})),bn()),yl=Kn("schema",(function(){return[Rn("preprocess")]})),xl=Ln("defaults",e({})),wl=Ln("overrides",e({})),Sl=Zt([pl,hl,vl,bl,xl,wl]),kl=Zt([pl,hl,vl,xl,wl]),Cl=Zt([pl,hl,vl,bl,xl,wl]),Ol=Zt([pl,yl,vl,Tn("unit"),bl,xl,wl]),_l=function(t){return t.fold(w.some,w.none,w.some,w.some)},Tl=function(t){var n=function(t){return t.name}
return t.fold(n,n,n,n)},El=function(t,n){return function(e){var o=gn("Converting part type",n,e)
return t(o)}},Bl=El(gl.required,Sl),Al=El(gl.external,kl),Ml=El(gl.optional,Cl),Fl=El(gl.group,Ol),Dl=e("entirety"),Il=Object.freeze({__proto__:null,required:Bl,external:Al,optional:Ml,group:Fl,asNamedPart:_l,name:Tl,asCommon:function(t){return t.fold(o,o,o,o)},original:Dl}),Rl=function(t,n,e,o){return Ft(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},Vl=function(t,n){var e={}
return j(n,(function(n){_l(n).each((function(n){var o=Pl(t,n.pname)
e[n.name]=function(e){var r=gn("Part: "+n.name+" in "+t,Zt(n.schema),e)
return l(l({},o),{config:e,validated:r})}}))})),e},Pl=function(t,n){return{uiType:ml(),owner:t,name:n}},Hl=function(t,n,e){return{uiType:ml(),owner:t,name:n,config:e,validated:{}}},zl=function(t){return J(t,(function(t){return t.fold(w.none,w.some,w.none,w.none).map((function(t){return Fn(t.name,t.schema.concat([Uu(Dl())]))})).toArray()}))},Nl=function(t){return L(t,Tl)},Ll=function(t,n,o){return r=n,i={},u={},j(o,(function(t){t.fold((function(t){i[t.pname]=fl(!0,(function(n,e,o){return t.factory.sketch(Rl(n,t,e,o))}))}),(function(t){var n=r.parts[t.name]
u[t.name]=e(t.factory.sketch(Rl(r,t,n[Dl()]),n))}),(function(t){i[t.pname]=fl(!1,(function(n,e,o){return t.factory.sketch(Rl(n,t,e,o))}))}),(function(t){i[t.pname]=dl(!0,(function(n,e,o){var r=n[t.name]
return L(r,(function(e){return t.factory.sketch(Ft(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:e(i),externals:e(u)}
var r,i,u},jl=function(t,n,o){return function(t,n,o,r){var i,u,a,c=wt(r,(function(t,n){return r=t,i=!1,{name:e(o=n),required:function(){return r.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+o)
return i=!0,r}}
var o,r,i})),s=(i=t,u=n,a=c,J(o,(function(t){return ll(i,u,t,a)})))
return xt(c,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),s}(w.some(t),n,n.components,o)},Ul=function(t,n,e){var o=n.partUids[e]
return t.getSystem().getByUid(o).toOptional()},Wl=function(t,n,e){return Ul(t,n,e).getOrDie("Could not find part: "+e)},Gl=function(t,n,o){var r={},i=n.partUids,u=t.getSystem()
return j(o,(function(t){r[t]=e(u.getByUid(i[t]))})),r},Xl=function(t,n){var o=t.getSystem()
return wt(n.partUids,(function(t,n){return e(o.getByUid(t))}))},Yl=function(t){return bt(t.partUids)},ql=function(t,n,o){var r={},i=n.partUids,u=t.getSystem()
return j(o,(function(t){r[t]=e(u.getByUid(i[t]).getOrDie())})),r},Kl=function(t,n){var e=Nl(n)
return Ut(L(e,(function(n){return{key:n,value:t+"-"+n}})))},Jl=function(t){return un("partUids","partUids",Nt((function(n){return Kl(n.uid,t)})),bn())},$l=Object.freeze({__proto__:null,generate:Vl,generateOne:Hl,schemas:zl,names:Nl,substitutes:Ll,components:jl,defaultUids:Kl,defaultUidsSchema:Jl,getAllParts:Xl,getAllPartNames:Yl,getPart:Ul,getPartOrDie:Wl,getParts:Gl,getPartsOrDie:ql}),Ql=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[Fn("parts",i)]:[]).concat([Tn("uid"),Ln("dom",{}),Ln("components",[]),Uu("originalSpec"),Ln("debug.sketcher",{})]).concat(u))
return gn(t+" [SpecSchema]",Qt(a.concat(n)),e)},Zl=function(t,n,e,o,r){var i=tf(r),u=zl(e),a=Jl(e),c=Ql(t,n,i,u,[a]),s=Ll(0,c,e)
return o(c,jl(t,c,s.internals()),i,s.externals())},tf=function(t){return Tt(t,"uid")?t:l(l({},t),{uid:Nr("uid")})},nf=Qt([Tn("name"),Tn("factory"),Tn("configFields"),Ln("apis",{}),Ln("extraApis",{})]),ef=Qt([Tn("name"),Tn("factory"),Tn("configFields"),Tn("partFields"),Ln("apis",{}),Ln("extraApis",{})]),of=function(t){var n=gn("Sketcher for "+t.name,nf,t),e=wt(n.apis,qr),o=wt(n.extraApis,Gr)
return l(l({name:n.name,configFields:n.configFields,sketch:function(t){return e=n.name,o=n.configFields,r=n.factory,i=tf(t),r(Ql(e,o,i,[],[]),i)
var e,o,r,i}},e),o)},rf=function(t){var n=gn("Sketcher for "+t.name,ef,t),e=Vl(n.name,n.partFields),o=wt(n.apis,qr),r=wt(n.extraApis,Gr)
return l(l({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Zl(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},uf=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e)
return n},af=function(t){return"input"===Qo(t)&&"radio"!==Or(t,"type")||"textarea"===Qo(t)},cf=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),sf=[Tn("find")],lf=Ba({fields:sf,name:"composing",apis:cf}),ff=function(t,n,e,o){var r=Mc(t.element,"."+n.highlightClass)
j(r,(function(e){H(o,(function(t){return t.element===e}))||(ai(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),Fo(e,Mo())})))}))},df=function(t,n,e,o){ff(t,n,0,[o]),mf(t,n,e,o)||(ui(o.element,n.highlightClass),n.onHighlight(t,o),Fo(o,Ao()))},mf=function(t,n,e,o){return ci(o.element,n.highlightClass)},gf=function(t,n,e){return wu(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},pf=function(t,n,e){var o=Mc(t.element,"."+n.itemClass)
return(0<o.length?w.some(o[o.length-1]):w.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},hf=function(t,n,e,o){var r=Mc(t.element,"."+n.itemClass)
return q(r,(function(t){return ci(t,n.highlightClass)})).bind((function(n){var e=Ya(n,o,0,r.length-1)
return t.getSystem().getByDom(r[e]).toOptional()}))},vf=function(t,n,e){var o=Mc(t.element,"."+n.itemClass)
return uf(L(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},bf=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return ff(t,n,0,[])},dehighlight:function(t,n,e,o){mf(t,n,e,o)&&(ai(o.element,n.highlightClass),n.onDehighlight(t,o),Fo(o,Mo()))},highlight:df,highlightFirst:function(t,n,e){gf(t,n).each((function(o){df(t,n,e,o)}))},highlightLast:function(t,n,e){pf(t,n).each((function(o){df(t,n,e,o)}))},highlightAt:function(t,n,e,o){(function(t,n,e,o){var r=Mc(t.element,"."+n.itemClass)
return w.from(r[o]).fold((function(){return at.error("No element found with index "+o)}),t.getSystem().getByDom)})(t,n,0,o).fold((function(t){throw new Error(t)}),(function(o){df(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=vf(t,n)
Y(r,o).each((function(o){df(t,n,e,o)}))},isHighlighted:mf,getHighlighted:function(t,n,e){return wu(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:gf,getLast:pf,getPrevious:function(t,n,e){return hf(t,n,0,-1)},getNext:function(t,n,e){return hf(t,n,0,1)},getCandidates:vf}),yf=[Tn("highlightClass"),Tn("itemClass"),Hu("onHighlight"),Hu("onDehighlight")],xf=Ba({fields:yf,name:"highlighting",apis:bf}),wf=[8],Sf=[9],kf=[13],Cf=[27],Of=[32],_f=[37],Tf=[38],Ef=[39],Bf=[40],Af=function(t,n,e){var o=Q(t.slice(0,n)),r=Q(t.slice(n+1))
return Y(o.concat(r),e)},Mf=function(t,n,e){var o=Q(t.slice(0,n))
return Y(o,e)},Ff=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1)
return Y(r.concat(o),e)},Df=function(t,n,e){var o=t.slice(n+1)
return Y(o,e)},If=function(t){return function(n){var e=n.raw
return P(t,e.which)}},Rf=function(t){return function(n){return $(t,(function(t){return t(n)}))}},Vf=function(t){return!0===t.raw.shiftKey},Pf=function(t){return!0===t.raw.ctrlKey},Hf=i(Vf),zf=function(t,n){return{matches:t,classification:n}},Nf=function(t,n,e){n.exists((function(t){return e.exists((function(n){return Fe(n,t)}))}))||Do(t,_o(),{prevFocus:n,newFocus:e})},Lf=function(){var t=function(t){return Pa(t.element)}
return{get:t,set:function(n,e){var o=t(n)
n.getSystem().triggerFocus(e,n.element)
var r=t(n)
Nf(n,o,r)}}},jf=function(){var n=function(t){return xf.getHighlighted(t).map((function(t){return t.element}))}
return{get:n,set:function(e,o){var r=n(e)
e.getSystem().getByDom(o).fold(t,(function(t){xf.highlight(e,t)}))
var i=n(e)
Nf(e,r,i)}}};(_c=Oc=Oc||{}).OnFocusMode="onFocus",_c.OnEnterOrSpaceMode="onEnterOrSpace",_c.OnApiMode="onApi"
var Uf=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u
return i=e(t,n,o,r),u=n.event,Y(i,(function(t){return t.matches(u)})).map((function(t){return t.classification})).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([Ln("focusManager",Lf()),jn("focusInside","onFocus",ln((function(t){return P(["onFocus","onEnterOrSpace","onApi"],t)?at.value(t):at.error("Invalid value for focusInside")}))),ju("handler",u),ju("state",n),ju("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==Oc.OnFocusMode?w.none():r(t).map((function(e){return Lo(uo(),(function(o,r){e(o,t,n),r.stop()}))})),a=[Lo($e(),(function(o,u){i(o,u,e,t,n).fold((function(){var e,i,a
e=o,i=u,a=If(Of.concat(kf))(i.event),t.focusInside===Oc.OnEnterOrSpaceMode&&a&&Pe(e,i)&&r(t).each((function(o){o(e,t,n),i.stop()}))}),(function(t){u.stop()}))})),Lo(Qe(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))]
return Ho(u.toArray().concat(a))}}
return u},Wf=function(t){var n=[Rn("onEscape"),Rn("onEnter"),Ln("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ln("firstTabstop",0),Ln("useTabstopAt",c),Rn("visibilitySelector")].concat([t]),o=function(t,n){var e=t.visibilitySelector.bind((function(t){return Su(n,t)})).getOr(n)
return 0<Wi(e)},i=function(t,n,e){var r,i,u
r=n,i=Mc(t.element,r.selector),u=W(i,(function(t){return o(r,t)})),w.from(u[r.firstTabstop]).each((function(e){n.focusManager.set(t,e)}))},u=function(t,n,e,r,i){return i(n,e,(function(t){return o(n=r,e=t)&&n.useTabstopAt(e)
var n,e})).fold((function(){return r.cyclic?w.some(!0):w.none()}),(function(n){return r.focusManager.set(t,n),w.some(!0)}))},a=function(t,n,e,o){var i,a,c=Mc(t.element,e.selector)
return i=t,(a=e).focusManager.get(i).bind((function(t){return Su(t,a.selector)})).bind((function(n){return q(c,r(Fe,n)).bind((function(n){return u(t,c,n,e,o)}))}))},s=e([zf(Rf([Vf,If(Sf)]),(function(t,n,e){var o=e.cyclic?Af:Mf
return a(t,0,e,o)})),zf(If(Sf),(function(t,n,e){var o=e.cyclic?Ff:Df
return a(t,0,e,o)})),zf(If(Cf),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),zf(Rf([Hf,If(kf)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),l=e([])
return Uf(n,Kr.init,s,l,(function(){return w.some(i)}))},Gf=Wf(Kn("cyclic",a)),Xf=Wf(Kn("cyclic",c)),Yf=function(t,n,e){return af(e)&&If(Of)(n.event)?w.none():(Ro(t,e,lo()),w.some(!0))},qf=function(t,n){return w.some(!0)},Kf=[Ln("execute",Yf),Ln("useSpace",!1),Ln("useEnter",!0),Ln("useControlEnter",!1),Ln("useDown",!1)],Jf=function(t,n,e){return e.execute(t,n,t.element)},$f=Uf(Kf,Kr.init,(function(t,n,e,o){var r=e.useSpace&&!af(t.element)?Of:[],i=e.useEnter?kf:[],u=e.useDown?Bf:[],a=r.concat(i).concat(u)
return[zf(If(a),Jf)].concat(e.useControlEnter?[zf(Rf([Pf,If(kf)]),Jf)]:[])}),(function(t,n,e,o){return e.useSpace&&!af(t.element)?[zf(If(Of),qf)]:[]}),(function(){return w.none()})),Qf=function(){var t=Jn(w.none())
return Jr({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(w.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},Zf=Object.freeze({__proto__:null,flatgrid:Qf,init:function(t){return t.state(t)}}),td=function(t){return function(n,e,o,r){var i=t(n.element)
return rd(i,n,e,o,r)}},nd=function(t,n){var e=ic(t,n)
return td(e)},ed=function(t,n){var e=ic(n,t)
return td(e)},od=function(t){return function(n,e,o,r){return rd(t,n,e,o,r)}},rd=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},id=od,ud=od,ad=od,cd=function(t){return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0)
var n},sd=function(t,n,e){var o,r=Mc(t,e),i=W(r,cd)
return q(o=i,(function(t){return Fe(t,n)})).map((function(t){return{index:t,candidates:o}}))},ld=function(t,n){return q(t,(function(t){return Fe(n,t)}))},fd=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column
return 0<=o&&o<t.length?w.some(t[o]):w.none()}))},dd=function(t,n,e,o,r){return fd(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=Ya(i,r,0,u-1)
return w.some({row:n,column:a})}))},md=function(t,n,e,o,r){return fd(t,n,o,(function(n,i){var u=Ya(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=qa(i,0,a-1)
return w.some({row:u,column:c})}))},gd=[Tn("selector"),Ln("execute",Yf),zu("onEscape"),Ln("captureTab",!1),Wu()],pd=function(t,n,e){wu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},hd=function(t){return function(n,e,o,r){return sd(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},vd=function(t,n,e){return e.captureTab?w.some(!0):w.none()},bd=hd((function(t,n,e,o){return dd(t,n,e,o,-1)})),yd=hd((function(t,n,e,o){return dd(t,n,e,o,1)})),xd=hd((function(t,n,e,o){return md(t,n,e,o,-1)})),wd=hd((function(t,n,e,o){return md(t,n,e,o,1)})),Sd=e([zf(If(_f),nd(bd,yd)),zf(If(Ef),ed(bd,yd)),zf(If(Tf),id(xd)),zf(If(Bf),ud(wd)),zf(Rf([Vf,If(Sf)]),vd),zf(Rf([Hf,If(Sf)]),vd),zf(If(Cf),(function(t,n,e){return e.onEscape(t,n)})),zf(If(Of.concat(kf)),(function(t,n,e,o){return r=t,(i=e).focusManager.get(r).bind((function(t){return Su(t,i.selector)})).bind((function(o){return e.execute(t,n,o)}))
var r,i}))]),kd=e([zf(If(Of),qf)]),Cd=Uf(gd,Qf,Sd,kd,(function(){return w.some(pd)})),Od=function(t,n,e,o){var r=function(t,n,e){var i,u=Ya(n,o,0,e.length-1)
return u===t?w.none():(i=e[u],"button"===Qo(i)&&"disabled"===Or(i,"disabled")?r(t,u,e):w.from(e[u]))}
return sd(t,e,n).bind((function(t){var n=t.index,e=t.candidates
return r(n,n,e)}))},_d=[Tn("selector"),Ln("getInitial",w.none),Ln("execute",Yf),zu("onEscape"),Ln("executeOnMove",!1),Ln("allowVertical",!0)],Td=function(t,n,e){return o=t,(r=e).focusManager.get(o).bind((function(t){return Su(t,r.selector)})).bind((function(o){return e.execute(t,n,o)}))
var o,r},Ed=function(t,n,e){n.getInitial(t).orThunk((function(){return wu(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},Bd=function(t,n,e){return Od(t,e.selector,n,-1)},Ad=function(t,n,e){return Od(t,e.selector,n,1)},Md=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?Td(n,e,o):w.some(!0)}))}},Fd=function(t,n,e){return e.onEscape(t,n)},Dd=e([zf(If(Of),qf)]),Id=Uf(_d,Kr.init,(function(t,n,e,o){var r=_f.concat(e.allowVertical?Tf:[]),i=Ef.concat(e.allowVertical?Bf:[])
return[zf(If(r),Md(nd(Bd,Ad))),zf(If(i),Md(ed(Bd,Ad))),zf(If(kf),Td),zf(If(Of),Td),zf(If(Cf),Fd)]}),Dd,(function(){return w.some(Ed)})),Rd=function(t,n,e){return w.from(t[n]).bind((function(t){return w.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},Vd=function(t,n,e,o){var r=t[n].length,i=Ya(e,o,0,r-1)
return Rd(t,n,i)},Pd=function(t,n,e,o){var r=Ya(e,o,0,t.length-1),i=t[r].length,u=qa(n,0,i-1)
return Rd(t,r,u)},Hd=function(t,n,e,o){var r=t[n].length,i=qa(e+o,0,r-1)
return Rd(t,n,i)},zd=function(t,n,e,o){var r=qa(e+o,0,t.length-1),i=t[r].length,u=qa(n,0,i-1)
return Rd(t,r,u)},Nd=[Fn("selectors",[Tn("row"),Tn("cell")]),Ln("cycles",!0),Ln("previousSelector",w.none),Ln("execute",Yf)],Ld=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors
return wu(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},jd=function(t,n){return function(e,o,r){var i=r.cycles?t:n
return Su(o,r.selectors.row).bind((function(t){var n=Mc(t,r.selectors.cell)
return ld(n,o).bind((function(n){var o=Mc(e,r.selectors.row)
return ld(o,t).bind((function(t){var e,u=(e=r,L(o,(function(t){return Mc(t,e.selectors.cell)})))
return i(u,t,n).map((function(t){return t.cell}))}))}))}))}},Ud=jd((function(t,n,e){return Vd(t,n,e,-1)}),(function(t,n,e){return Hd(t,n,e,-1)})),Wd=jd((function(t,n,e){return Vd(t,n,e,1)}),(function(t,n,e){return Hd(t,n,e,1)})),Gd=jd((function(t,n,e){return Pd(t,e,n,-1)}),(function(t,n,e){return zd(t,e,n,-1)})),Xd=jd((function(t,n,e){return Pd(t,e,n,1)}),(function(t,n,e){return zd(t,e,n,1)})),Yd=e([zf(If(_f),nd(Ud,Wd)),zf(If(Ef),ed(Ud,Wd)),zf(If(Tf),id(Gd)),zf(If(Bf),ud(Xd)),zf(If(Of.concat(kf)),(function(t,n,e){return Pa(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),qd=e([zf(If(Of),qf)]),Kd=Uf(Nd,Kr.init,Yd,qd,(function(){return w.some(Ld)})),Jd=[Tn("selector"),Ln("execute",Yf),Ln("moveOnTab",!1)],$d=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},Qd=function(t,n,e){wu(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},Zd=function(t,n,e){return Od(t,e.selector,n,-1)},tm=function(t,n,e){return Od(t,e.selector,n,1)},nm=e([zf(If(Tf),ad(Zd)),zf(If(Bf),ad(tm)),zf(Rf([Vf,If(Sf)]),(function(t,n,e,o){return e.moveOnTab?ad(Zd)(t,n,e,o):w.none()})),zf(Rf([Hf,If(Sf)]),(function(t,n,e,o){return e.moveOnTab?ad(tm)(t,n,e,o):w.none()})),zf(If(kf),$d),zf(If(Of),$d)]),em=e([zf(If(Of),qf)]),om=Uf(Jd,Kr.init,nm,em,(function(){return w.some(Qd)})),rm=[zu("onSpace"),zu("onEnter"),zu("onShiftEnter"),zu("onLeft"),zu("onRight"),zu("onTab"),zu("onShiftTab"),zu("onUp"),zu("onDown"),zu("onEscape"),Ln("stopSpaceKeyup",!1),Rn("focusIn")],im=Uf(rm,Kr.init,(function(t,n,e){return[zf(If(Of),e.onSpace),zf(Rf([Hf,If(kf)]),e.onEnter),zf(Rf([Vf,If(kf)]),e.onShiftEnter),zf(Rf([Vf,If(Sf)]),e.onShiftTab),zf(Rf([Hf,If(Sf)]),e.onTab),zf(If(Tf),e.onUp),zf(If(Bf),e.onDown),zf(If(_f),e.onLeft),zf(If(Ef),e.onRight),zf(If(Of),e.onSpace),zf(If(Cf),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[zf(If(Of),qf)]:[]}),(function(t){return t.focusIn})),um=Gf.schema(),am=Xf.schema(),cm=Id.schema(),sm=Cd.schema(),lm=Kd.schema(),fm=$f.schema(),dm=om.schema(),mm=im.schema(),gm=Ma({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:um,cyclic:am,flow:cm,flatgrid:sm,matrix:lm,execution:fm,menu:dm,special:mm}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){Et(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Zf}),pm=function(t,n,e,o){var r=t.getSystem().build(o)
ys(t,r,e)},hm=function(t,n,e,o){var r=vm(t)
Y(r,(function(t){return Fe(o.element,t.element)})).each(ws)},vm=function(t,n){return t.components()},bm=function(t,n,e,o,r){var i=vm(t)
return w.from(i[o]).map((function(n){return hm(t,0,0,n),r.each((function(n){pm(t,0,(function(t,n){var e,r
r=n,dr(e=t,o).fold((function(){hr(e,r)}),(function(t){mr(t,r)}))}),n)})),n}))},ym=Ba({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){pm(t,0,hr,o)},prepend:function(t,n,e,o){pm(t,0,pr,o)},remove:hm,replaceAt:bm,replaceBy:function(t,n,e,o,r){var i=vm(t)
return q(i,o).bind((function(n){return bm(t,0,0,n,r)}))},set:function(t,n,e,o){Ha((function(){var n=L(o,t.getSystem().build)
vs(t,n)}),t.element)},contents:vm})}),xm=function(t,n){var o,r
return{key:t,value:{config:{},me:(o=t,r=Ho(n),Ba({fields:[Tn("enabled")],name:o,active:{events:e(r)}})),configAsRaw:e({}),initialConfig:{},state:Kr}}},wm=function(t,n){n.ignore||(Ra(t.element),n.onFocus(t))},Sm=Object.freeze({__proto__:null,focus:wm,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return n=t.element,e=pi(n).dom,n.dom===e.activeElement
var n,e}}),km=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}}
return Qr(e)},events:function(t){return Ho([Lo(uo(),(function(n,e){wm(n,t),e.stop()}))].concat(t.stopMousedown?[Lo(We(),(function(t,n){n.event.prevent()}))]:[]))}}),Cm=[Hu("onFocus"),Ln("stopMousedown",!1),Ln("ignore",!1)],Om=Ba({fields:Cm,name:"focusing",active:km,apis:Sm}),_m=function(t,n,e){var o=n.aria
o.update(t,o,e.get())},Tm=function(t,n,e){n.toggleClass.each((function(n){(e.get()?ui:ai)(t.element,n)}))},Em=function(t,n,e){Mm(t,n,e,!e.get())},Bm=function(t,n,e){e.set(!0),Tm(t,n,e),_m(t,n,e)},Am=function(t,n,e){e.set(!1),Tm(t,n,e),_m(t,n,e)},Mm=function(t,n,e,o){(o?Bm:Am)(t,n,e)},Fm=function(t,n,e){Mm(t,n,e,n.selected)},Dm=Object.freeze({__proto__:null,onLoad:Fm,toggle:Em,isOn:function(t,n,e){return e.get()},on:Bm,off:Am,set:Mm}),Im=Object.freeze({__proto__:null,exhibit:function(){return Qr({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Em,$o((function(t){r(t,e,o)}))),u=Ca(t,n,Fm)
return Ho(K([t.toggleOnExecute?[i]:[],[u]]))}}),Rm=function(t,n,e){Cr(t.element,"aria-expanded",e)},Vm=[Ln("selected",!1),Rn("toggleClass"),Ln("toggleOnExecute",!0),jn("aria",{mode:"none"},vn("mode",{pressed:[Ln("syncWithExpanded",!1),ju("update",(function(t,n,e){Cr(t.element,"aria-pressed",e),n.syncWithExpanded&&Rm(t,0,e)}))],checked:[ju("update",(function(t,n,e){Cr(t.element,"aria-checked",e)}))],expanded:[ju("update",Rm)],selected:[ju("update",(function(t,n,e){Cr(t.element,"aria-selected",e)}))],none:[ju("update",t)]}))],Pm=Ba({fields:Vm,name:"toggling",active:Im,apis:Dm,state:(!1,{init:function(){var t=Jn(false)
return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(false)},readState:function(){return t.get()}}}})}),Hm=function(){var t=function(t,n){n.stop(),Io(t)}
return[Lo(no(),t),Lo(mo(),t),Xo(Ne()),Xo(We())]},zm=function(t){return Ho(K([t.map((function(t){return $o((function(n,e){t(n),e.stop()}))})).toArray(),Hm()]))},Nm="alloy.item-hover",Lm="alloy.item-focus",jm=function(t){(Pa(t.element).isNone()||Om.isFocused(t))&&(Om.isFocused(t)||Om.focus(t),Do(t,Nm,{item:t}))},Um=function(t){Do(t,Lm,{item:t})},Wm=e(Nm),Gm=e(Lm),Xm=[Tn("data"),Tn("components"),Tn("dom"),Ln("hasSubmenu",!1),Rn("toggling"),il("itemBehaviours",[Pm,Om,gm,nl]),Ln("ignoreFocus",!1),Ln("domModification",{}),ju("builder",(function(t){return{dom:t.dom,domModification:l(l({},t.domModification),{attributes:l(l(l({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:ul(t.itemBehaviours,[t.toggling.fold(Pm.revoke,(function(t){return Pm.config(l({aria:{mode:"checked"}},t))})),Om.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Um(t)}}),gm.config({mode:"execution"}),nl.config({store:{mode:"memory",initialValue:t.data}}),xm("item-type-events",d(Hm(),[Lo(qe(),jm),Lo(fo(),Om.focus)]))]),components:t.components,eventOrder:t.eventOrder}})),Ln("eventOrder",{})],Ym=[Tn("dom"),Tn("components"),ju("builder",(function(t){return{dom:t.dom,components:t.components,events:Ho([(n=fo(),Lo(n,(function(t,n){n.stop()})))])}
var n}))],qm=e([Bl({name:"widget",overrides:function(t){return{behaviours:Ta([nl.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:function(){}}})])}}})]),Km=[Tn("uid"),Tn("data"),Tn("components"),Tn("dom"),Ln("autofocus",!1),Ln("ignoreFocus",!1),il("widgetBehaviours",[nl,Om,gm]),Ln("domModification",{}),Jl(qm()),ju("builder",(function(t){var n=Ll(0,t,qm()),e=jl("item-widget",t,n.internals()),o=function(n){return Ul(n,t,"widget").map((function(t){return gm.focusIn(t),t}))},r=function(n,e){return af(e.event.target)||t.autofocus&&e.setSource(n.element),w.none()}
return{dom:t.dom,components:e,domModification:t.domModification,events:Ho([$o((function(t,n){o(t).each((function(t){n.stop()}))})),Lo(qe(),jm),Lo(fo(),(function(n,e){t.autofocus?o(n):Om.focus(n)}))]),behaviours:ul(t.widgetBehaviours,[nl.config({store:{mode:"memory",initialValue:t.data}}),Om.config({ignore:t.ignoreFocus,onFocus:function(t){Um(t)}}),gm.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:Fa(),onLeft:r,onRight:r,onEscape:function(n,e){return Om.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),w.none()):(Om.focus(n),w.some(!0))}})])}}))],Jm=vn("type",{widget:Km,item:Xm,separator:Ym}),$m=e([Fl({factory:{sketch:function(t){var n=gn("menu.spec item",Jm,t)
return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:l(l({},n),{uid:Nr("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Qm=e([Tn("value"),Tn("items"),Tn("dom"),Tn("components"),Ln("eventOrder",{}),el("menuBehaviours",[xf,nl,lf,gm]),jn("movement",{mode:"menu",moveOnTab:!0},vn("mode",{grid:[Wu(),ju("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[ju("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),Tn("rowSelector")],menu:[Ln("moveOnTab",!0),ju("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),En("markers",Du()),Ln("fakeFocus",!1),Ln("focusManager",Lf()),Hu("onHighlight")]),Zm=e("alloy.menu-focus"),tg=rf({name:"Menu",configFields:Qm(),partFields:$m(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:rl(t.menuBehaviours,[xf.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),nl.config({store:{mode:"memory",initialValue:t.value}}),lf.config({find:w.some}),gm.config(t.movement.config(t,t.movement))]),events:Ho([Lo(Gm(),(function(t,n){var e=n.event
t.getSystem().getByDom(e.target).each((function(e){xf.highlight(t,e),n.stop(),Do(t,Zm(),{menu:t,item:e})}))})),Lo(Wm(),(function(t,n){var e=n.event.item
xf.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),ng=function(t,n,e,o){return _t(e,o).bind((function(o){return _t(t,o).bind((function(o){var r=ng(t,n,e,o)
return w.some([o].concat(r))}))})).getOr([])},eg=function(t){return"prepared"===t.type?w.some(t.menu):w.none()},og=function(){var t=Jn({}),n=Jn({}),e=Jn({}),o=Jn(w.none()),r=Jn({}),i=function(n,e,o){return u(n).bind((function(r){return i=n,Ct(t.get(),(function(t,n){return t===i})).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}}))}))
var i}))},u=function(t){return a(t).bind(eg)},a=function(t){return _t(n.get(),t)},c=function(n){return _t(t.get(),n)}
return{setMenuBuilt:function(t,e){var o
n.set(l(l({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(w.some(i)),t.set(a),n.set(u),r.set(c)
var s=function(t,n){var e={}
xt(t,(function(t,n){j(t,(function(t){e[t]=n}))}))
var o=n,r=St(n,(function(t,n){return{k:t,v:n}})),i=wt(r,(function(t,n){return[n].concat(ng(e,o,r,n))}))
return wt(e,(function(t){return _t(i,t).getOr([t])}))}(c,a)
e.set(s)},expand:function(n){return _t(t.get(),n).map((function(t){var o=_t(e.get(),n).getOr([])
return[t].concat(o)}))},refresh:function(t){return _t(e.get(),t)},collapse:function(t){return _t(e.get(),t).bind((function(t){return 1<t.length?w.some(t.slice(1)):w.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get()
return Z(bt(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.set(w.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=W(c(t).toArray(),(function(t){return u(t).isSome()}))
return _t(e.get(),t).bind((function(t){var e=Q(r.concat(t))
return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e]
if(!o.isSome())return w.none()
n.push(o.getOrDie())}return w.some(n)}(J(e,(function(t,r){return i(t,n,e.slice(0,r+1)).fold((function(){return o.get().is(t)?[]:[w.none()]}),(function(t){return[w.some(t)]}))})))}))}}},rg=eg,ig=e("collapse-item"),ug=of({name:"TieredMenu",configFields:[Lu("onExecute"),Lu("onEscape"),Nu("onOpenMenu"),Nu("onOpenSubmenu"),Hu("onRepositionMenu"),Hu("onCollapseMenu"),Ln("highlightImmediately",!0),Fn("data",[Tn("primary"),Tn("menus"),Tn("expansions")]),Ln("fakeFocus",!1),Hu("onHighlight"),Hu("onHover"),Ru(),Tn("dom"),Ln("navigateOnHover",!0),Ln("stayInDom",!1),el("tmenuBehaviours",[gm,xf,lf,ym]),Ln("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o,r=Jn(w.none()),i=og(),u=function(t){return nl.getValue(t).value},a=function(n){return wt(t.data.menus,(function(t,n){return J(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},c=function(t,n){xf.highlight(t,n),xf.getHighlighted(n).orThunk((function(){return xf.getFirst(n)})).each((function(n){Ro(t,n.element,fo())}))},s=function(t,n){return uf(L(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?w.some(t.menu):w.none()}))})))},f=function(n,e,o){var r=s(e,e.otherMenus(o))
j(r,(function(e){li(e.element,[t.markers.backgroundMenu]),t.stayInDom||ym.remove(n,e)}))},d=function(n,e){var o,i=(o=n,r.get().getOrThunk((function(){var n={},e=Mc(o.element,"."+t.markers.item),i=W(e,(function(t){return"true"===Or(t,"aria-haspopup")}))
return j(i,(function(t){o.getSystem().getByDom(t).each((function(t){var e=u(t)
n[e]=t}))})),r.set(w.some(n)),n})))
xt(i,(function(t,n){var o=P(e,n)
Cr(t.element,"aria-expanded",o)}))},m=function(n,e,o){return w.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return w.none()
var i=r.menu,u=s(e,o.slice(1))
return j(u,(function(n){ui(n.element,t.markers.backgroundMenu)})),bi(i.element)||ym.append(n,Li(i)),li(i.element,[t.markers.backgroundMenu]),c(n,i),f(n,e,o),w.some(i)}))}))};(o=e=e||{})[o.HighlightSubmenu=0]="HighlightSubmenu",o[o.HighlightParent=1]="HighlightParent"
var g=function(n,o,r){void 0===r&&(r=e.HighlightSubmenu)
var a=u(o)
return i.expand(a).bind((function(u){return d(n,u),w.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"!==e.type)return e.menu
var o=t.getSystem().build(e.nbMenu())
return i.setMenuBuilt(n,o),o}(n,a,c)
return bi(s.element)||ym.append(n,Li(s)),t.onOpenSubmenu(n,o,s,Q(u)),r===e.HighlightSubmenu?(xf.highlightFirst(s),m(n,i,u)):(xf.dehighlightAll(s),w.some(o))}))}))}))},p=function(n,e){var o=u(e)
return i.collapse(o).bind((function(o){return d(n,o),m(n,i,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},h=function(n){return function(e,o){return Su(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map((function(){return!0}))}))}))}},v=Ho([Lo(Zm(),(function(t,n){var e=n.event.item
i.lookupItem(u(e)).each((function(){var e=n.event.menu
xf.highlight(t,e)
var o=u(n.event.item)
i.refresh(o).each((function(n){return f(t,i,n)}))}))})),$o((function(n,o){var r=o.event.target
n.getSystem().getByDom(r).each((function(o){0===u(o).indexOf("collapse-item")&&p(n,o),g(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),(function(){}))}))})),qo((function(n,e){(function(n){var e,o,r,u=(e=n,o=t.data.primary,r=t.data.menus,wt(r,(function(n,r){var i=function(){return tg.sketch(l(l({},n),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:(t.fakeFocus?jf:Lf)()}))}
return r===o?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))),c=a()
return i.setContents(t.data.primary,u,t.data.expansions,c),i.getPrimary()})(n).each((function(e){ym.append(n,Li(e)),t.onOpenMenu(n,e),t.highlightImmediately&&c(n,e)}))}))].concat(t.navigateOnHover?[Lo(Wm(),(function(n,o){var r,a,c=o.event.item
r=n,a=u(c),i.refresh(a).bind((function(t){return d(r,t),m(r,i,t)})),g(n,c,e.HighlightParent),t.onHover(n,c)}))]:[])),b=function(t){return xf.getHighlighted(t).bind(xf.getHighlighted)},y={collapseMenu:function(t){b(t).each((function(n){p(t,n)}))},highlightPrimary:function(t){i.getPrimary().each((function(n){c(t,n)}))},repositionMenus:function(n){i.getPrimary().bind((function(t){return b(n).bind((function(t){var n=u(t),e=Ot(i.getMenus()),o=uf(L(e,rg))
return i.getTriggeringPath(n,(function(t){return n=t,rt(o,(function(t){if(!t.getSystem().isConnected())return w.none()
var e=xf.getCandidates(t)
return Y(e,(function(t){return u(t)===n}))}))
var n}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){var e
e=n,w.from(e.components()[0]).filter((function(t){return"menu"===Or(t.element,"role")})).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath
t.onRepositionMenu(n,o,r)}))}}
return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:rl(t.tmenuBehaviours,[gm.config({mode:"special",onRight:h((function(t,n){return af(n.element)?w.none():g(t,n,e.HighlightSubmenu)})),onLeft:h((function(t,n){return af(n.element)?w.none():p(t,n)})),onEscape:h((function(n,e){return p(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){i.getPrimary().each((function(n){Ro(t,n.element,fo())}))}}),xf.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),lf.config({find:function(t){return xf.getHighlighted(t)}}),ym.config({})]),eventOrder:t.eventOrder,apis:y,events:v}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:jt(t,n),expansions:{}}},collapseItem:function(t){return{value:Dr(ig()),meta:{text:t}}}}}),ag=of({name:"InlineView",configFields:[Tn("lazySink"),Hu("onShow"),Hu("onHide"),zn("onEscape"),el("inlineBehaviours",[Rs,nl,Da]),Nn("fireDismissalEventInstead",[Ln("event",Co())]),Nn("fireRepositionEventInstead",[Ln("event",Oo())]),Ln("getRelated",w.none),Ln("isExtraPart",a),Ln("eventOrder",w.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,(function(){return r.map(fu)}))},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie()
Rs.openWhileCloaked(n,o,(function(){return ms.positionWithinBounds(i,e,n,r())})),nl.setValue(n,w.some({mode:"position",anchor:e,getBounds:r}))},r=function(n,e,o,r){var i,u,a,c,s,f,d,m,g=(i=t,u=n,a=e,s=r,f=function(){return i.lazySink(u)},d="horizontal"===(c=o).type?{layouts:{onLtr:xa,onRtl:wa}}:{},m=function(t){return 2===t.length?d:{}},ug.sketch({dom:{tag:"div"},data:c.data,markers:c.menu.markers,highlightImmediately:c.menu.highlightImmediately,onEscape:function(){return Rs.close(u),i.onEscape.map((function(t){return t(u)})),w.some(!0)},onExecute:function(){return w.some(!0)},onOpenMenu:function(t,n){ms.positionWithinBounds(f().getOrDie(),a,n,s())},onOpenSubmenu:function(t,n,e,o){var r=f().getOrDie()
ms.position(r,l({anchor:"submenu",item:n},m(o)),e)},onRepositionMenu:function(t,n,e){var o=f().getOrDie()
ms.positionWithinBounds(o,a,n,s()),j(e,(function(t){var n=m(t.triggeringPath)
ms.position(o,l({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)}))}}))
Rs.open(n,g),nl.setValue(n,w.some({mode:"menu",menu:g}))},i=function(n){Rs.isOpen(n)&&nl.getValue(n).each((function(e){switch(e.mode){case"menu":Rs.getState(n).each((function(t){ug.repositionMenus(t)}))
break
case"position":var o=t.lazySink(n).getOrDie()
ms.positionWithinBounds(o,e.anchor,n,e.getBounds())}}))},u={setContent:function(t,n){Rs.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,w.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,(function(){return w.none()}))},showMenuWithinBounds:r,hide:function(t){Rs.isOpen(t)&&(nl.setValue(t,w.none()),Rs.close(t))},getContent:function(t){return Rs.getState(t)},reposition:i,isOpen:Rs.isOpen}
return{uid:t.uid,dom:t.dom,behaviours:rl(t.inlineBehaviours,[Rs.config({isPartOf:function(n,e,o){return Cu(e,o)||(r=n,i=o,t.getRelated(r).exists((function(t){return Cu(t,i)})))
var r,i},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),nl.config({store:{mode:"memory",initialValue:w.none()}}),Da.config({channels:l(l({},Ns(l({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),js(l(l({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),cg=function(t){return t.x},sg=function(t,n){return t.x+t.width/2-n.width/2},lg=function(t,n){return t.x+t.width-n.width},fg=function(t){return t.y},dg=function(t,n){return t.y+t.height-n.height},mg=function(t,n,e){return Gu(lg(t,n),dg(t,n),e.innerSoutheast(),Ju(),na(t,{right:0,bottom:3}),"layout-inner-se")},gg=function(t,n,e){return Gu(cg(t),dg(t,n),e.innerSouthwest(),Ku(),na(t,{left:1,bottom:3}),"layout-inner-sw")},pg=function(t,n,e){return Gu(lg(t,n),fg(t),e.innerNortheast(),qu(),na(t,{right:0,top:2}),"layout-inner-ne")},hg=function(t,n,e){return Gu(cg(t),fg(t),e.innerNorthwest(),Yu(),na(t,{left:1,top:2}),"layout-inner-nw")},vg=function(t,n,e){return Gu(sg(t,n),fg(t),e.innerNorth(),$u(),na(t,{top:2}),"layout-inner-n")},bg=function(t,n,e){return Gu(sg(t,n),dg(t,n),e.innerSouth(),Qu(),na(t,{bottom:3}),"layout-inner-s")},yg=tinymce.util.Tools.resolve("tinymce.util.Delay"),xg=of({name:"Button",factory:function(t){var n=zm(t.action),e=t.dom.tag,o=function(n){return _t(t.dom,"attributes").bind((function(t){return _t(t,n)}))}
return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:ul(t.buttonBehaviours,[Om.config({}),gm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")}
var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({})
return l({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[Ln("uid",void 0),Tn("dom"),Ln("components",[]),il("buttonBehaviours",[Om,gm]),Rn("action"),Rn("role"),Ln("eventOrder",{})]}),wg=function(t){var n=void 0!==t.uid&&Et(t,"uid")?t.uid:Nr("memento")
return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return l(l({},t),{uid:n})}}},Sg=function(t){return w.from(t()["temporary-placeholder"]).getOr("!not found!")},kg=function(t,n){return w.from(n()[t.toLowerCase()]).getOrThunk((function(){return Sg(n)}))},Cg={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Og=of({name:"Notification",factory:function(t){var n,e,o=wg({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:Ta([ym.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=wg({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:Ta([ym.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each((function(t){ym.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])}))},updateText:function(t,n){var e
t.getSystem().isConnected()&&(e=o.get(t),ym.set(e,[Pi(n)]))}},c=K([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return w.from(Cg[t])})).toArray()]),s=wg(xg.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:kg("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(n=c,e=t.iconProvider,rt(n,(function(t){return w.from(e()[t.toLowerCase()])})).getOrThunk((function(){return Sg(e)})))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:Ta([ym.config({})])}]
return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:Ta([Om.config({}),xm("notification-events",[Lo(Ke(),(function(t){s.getOpt(t).each(Om.focus)}))])]),components:l.concat(t.progress?[u.asSpec()]:[]).concat(t.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[Rn("level"),Tn("progress"),Tn("icon"),Tn("onAction"),Tn("text"),Tn("iconProvider"),Tn("translationProvider"),Xn("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}})
var _g,Tg,Eg=function(t,n){var e=null
return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
null!==e&&clearTimeout(e),e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Bg=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Ag=function(t,n,e,o,r){var i=Bg(t,(function(n){return o=n,(e=t).isBlock(o)||P(["BR","IMG","HR","INPUT"],o.nodeName)||"false"===e.getContentEditable(o)
var e,o}))
return w.from(i.backwards(n,e,o,r))},Mg=function(t,n){return Fg(ne(t.selection.getNode())).getOrThunk((function(){var e=Qn('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc())
return hr(e,ne(n.extractContents())),n.insertNode(e.dom),cr(e).each((function(t){return t.dom.normalize()})),function(t,n){var e=function(t){for(var o=fr(t),r=o.length-1;0<=r;r--){var i=o[r]
if(n(i))return w.some(i)
var u=e(i)
if(u.isSome())return u}return w.none()}
return e(t)}(e,Ac).map((function(n){var e
t.selection.setCursorLocation(n.dom,"img"===Qo(e=n)?1:Ec(e).fold((function(){return fr(e).length}),(function(t){return t.length})))})),e}))},Fg=function(t){return Su(t,"[data-mce-autocompleter]")},Dg=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Ig=function(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)},Rg=function(t,n){return t.substring(n.length)},Vg=function(t,n,e,o){return void 0===o&&(o=0),Fg(ne(n.startContainer)).fold((function(){return function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return w.none()
var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot()
return Ag(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o)
if(Ig(r))return w.none()
if(r===e)break}return w.some(o)}(o,n,e).getOr(n)}),i).bind((function(t){var r=n.cloneRange()
if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return w.none()
var i=Dg(r)
return 0!==i.lastIndexOf(e)||Rg(i,e).length<o?w.none():w.some({text:Rg(i,e),range:r,triggerChar:e})}))}(t,n,e,o)}),(function(n){var o=t.createRng()
o.selectNode(n.dom)
var r=Dg(o)
return w.some({range:o,text:Rg(r,e),triggerChar:e})}))},Pg=tinymce.util.Tools.resolve("tinymce.util.Promise"),Hg=function(t,n){return{container:t,offset:n}},zg=function(t){if(3===t.nodeType)return Hg(t,t.data.length)
var n=t.childNodes
return 0<n.length?zg(n[n.length-1]):Hg(t,n.length)},Ng=function(t,n){var e=t.childNodes
return 0<e.length&&n<e.length?Ng(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?zg(e[e.length-1]):Hg(t,n)},Lg=function(t,n,e,o){void 0===o&&(o={})
var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=W(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return function(t){return function(n){var e,o,r=Ng(n.startContainer,n.startOffset)
return!Ag(e=t,(o=r).container,o.offset,(function(t,n){return 0===n?-1:n}),e.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1)
return!Ig(n)})).isSome()}}(t.dom)}))(e.range,i,e.text)}))
if(0===u.length)return w.none()
var a=Pg.all(L(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction}}))})))
return w.some({lookupData:a,context:e})},jg=Zt([Bn("type"),Hn("text")]),Ug=Zt([Ln("type","autocompleteitem"),Ln("active",!1),Ln("disabled",!1),Ln("meta",{}),Bn("value"),Hn("text"),Hn("icon")]),Wg=Zt([Bn("type"),Bn("ch"),Un("minChars",1),Ln("columns",1),Un("maxResults",10),zn("matches"),Mn("fetch"),Mn("onAction")]),Gg=[Xn("disabled",!1),Hn("tooltip"),Hn("icon"),Hn("text"),Yn("onSetup",(function(){return t}))],Xg=Zt([Bn("type"),Mn("onAction")].concat(Gg)),Yg=function(t){return dn("toolbarbutton",Xg,t)},qg=[Xn("active",!1)].concat(Gg),Kg=Zt(qg.concat([Bn("type"),Mn("onAction")])),Jg=function(t){return dn("ToggleButton",Kg,t)},$g=[Yn("predicate",(function(){return!1})),Gn("scope","node",["node","editor"]),Gn("position","selection",["node","selection","line"])],Qg=Gg.concat([Ln("type","contextformbutton"),Ln("primary",!1),Mn("onAction"),Kn("original",o)]),Zg=qg.concat([Ln("type","contextformbutton"),Ln("primary",!1),Mn("onAction"),Kn("original",o)]),tp=Gg.concat([Ln("type","contextformbutton")]),np=qg.concat([Ln("type","contextformtogglebutton")]),ep=vn("type",{contextformbutton:Qg,contextformtogglebutton:Zg}),op=Zt([Ln("type","contextform"),Yn("initValue",(function(){return""})),Hn("label"),In("commands",ep),Vn("launch",vn("type",{contextformbutton:tp,contextformtogglebutton:np}))].concat($g)),rp=Zt([Ln("type","contexttoolbar"),Bn("items")].concat($g));(Tg=_g=_g||{})[Tg.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",Tg[Tg.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"
var ip,up,ap=_g,cp="tox-menu-nav__js",sp="tox-collection__item",lp="tox-swatch",fp={normal:cp,color:lp},dp="tox-collection__item--enabled",mp="tox-collection__item-label",gp="tox-collection__item-caret",pp="tox-collection__item--active",hp=function(t){return _t(fp,t).getOr(cp)},vp=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},bp=function(t){var n=vp(t)
return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:hp(t)}},yp=[tg.parts.items({})],xp=function(t,n,e){var o=vp(e)
return{dom:{tag:"div",classes:K([[o.tieredMenu]])},markers:bp(e)}},wp=function(t,n){return function(e){var o=N(e,n)
return L(o,(function(n){return{dom:t,components:n}}))}},Sp=function(t,n){var e=[],o=[]
return j(t,(function(t,r){n(t,r)?(0<o.length&&e.push(o),o=[],Tt(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),0<o.length&&e.push(o),L(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},kp=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[tg.parts.items({preprocess:function(e){return"auto"!==t&&1<t?wp({tag:"div",classes:["tox-collection__group"]},t)(e):Sp(e,(function(t,e){return"separator"===n[e].type}))}})]}},Cp=function(t){return H(t,(function(t){return"icon"in t&&void 0!==t.icon}))},Op=function(t){return console.error(pn(t)),console.log(t),w.none()},_p=function(t,n,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[tg.parts.items({preprocess:function(t){return Sp(t,(function(t,n){return"separator"===i[n].type}))}})]})
return{value:t,dom:u.dom,components:u.components,items:e}},Tp=function(t,n,e,r,i){var u,a,c,s,l,f
return"color"===i?{value:t,dom:(u=r,c={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[tg.parts.items({preprocess:"auto"!==u?wp({tag:"div",classes:["tox-swatches__row"]},u):o})]}]}).dom,components:c.components,items:e}:"normal"===i&&"auto"===r?{value:t,dom:(c=kp(r,e)).dom,components:c.components,items:e}:"normal"===i&&1===r?{value:t,dom:(c=kp(1,e)).dom,components:c.components,items:e}:"normal"===i?{value:t,dom:(c=kp(r,e)).dom,components:c.components,items:e}:"listpreview"!==i||"auto"===r?{value:t,dom:(s=n,l=r,f=vp(i),{tag:"div",classes:K([[f.menu,"tox-menu-"+l+"-column"],s?[f.hasIcons]:[]])}),components:yp,items:e}:{value:t,dom:(a=r,c={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[tg.parts.items({preprocess:wp({tag:"div",classes:["tox-collection__group"]},a)})]}).dom,components:c.components,items:e}},Ep=[Xn("disabled",!1),Hn("text"),Hn("shortcut"),un("value","value",zt((function(){return Dr("menuitem-value")})),bn()),Ln("meta",{})],Bp=Zt([Bn("type"),Xn("active",!1),Hn("icon")].concat(Ep)),Ap=Zt([Bn("type"),An("fancytype",["inserttable","colorswatch"]),Yn("onAction",t)]),Mp=Zt([Bn("type"),Yn("onSetup",(function(){return t})),Yn("onAction",t),Hn("icon")].concat(Ep)),Fp=Zt([Bn("type"),Mn("getSubmenuItems"),Yn("onSetup",(function(){return t})),Hn("icon")].concat(Ep)),Dp=Zt([Bn("type"),Hn("icon"),Xn("active",!1),Yn("onSetup",(function(){return t})),Mn("onAction")].concat(Ep)),Ip=function(t,n,e){var o=Mc(t.element,"."+e)
if(0<o.length){var r=q(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top
return Math.abs(e-r)>n})).getOr(o.length)
return w.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return w.none()},Rp=function(t){return function(t,n){return Ta([xm(t,n)])}(Dr("unnamed-events"),t)},Vp=[Tn("lazySink"),Tn("tooltipDom"),Ln("exclusive",!0),Ln("tooltipComponents",[]),Ln("delay",300),Gn("mode","normal",["normal","follow-highlight"]),Ln("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:e([ma,da,ca,la,sa,fa]),onRtl:e([ma,da,ca,la,sa,fa])}}})),Hu("onHide"),Hu("onShow")],Pp=Object.freeze({__proto__:null,init:function(){var t=Jn(w.none()),n=Jn(w.none()),o=function(){t.get().each((function(t){clearTimeout(t)}))},r=e("not-implemented")
return Jr({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(w.some(t))},clearTooltip:function(){n.set(w.none())},clearTimer:o,resetTimer:function(n,e){o(),t.set(w.some(setTimeout((function(){n()}),e)))},readState:r})}}),Hp=Dr("tooltip.exclusive"),zp=Dr("tooltip.show"),Np=Dr("tooltip.hide"),Lp=function(t,n,e){t.getSystem().broadcastOn([Hp],{})},jp=Object.freeze({__proto__:null,hideAllExclusive:Lp,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&ym.set(t,o)}))}}),Up=Ba({fields:Vp,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){ws(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()}
return Ho(K([[Lo(zp,(function(e){n.resetTimer((function(){var o,r,i
o=e,n.isShowing()||(Lp(o),r=t.lazySink(o).getOrDie(),i=o.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Ho("normal"===t.mode?[Lo(qe(),(function(t){Fo(o,zp)})),Lo(Xe(),(function(t){Fo(o,Np)}))]:[]),behaviours:Ta([ym.config({})])}),n.setTooltip(i),bs(r,i),t.onShow(o,i),ms.position(r,t.anchor(o),i))}),t.delay)})),Lo(Np,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Lo(so(),(function(t,n){n.universal||P(n.channels,Hp)&&e(t)})),Ko((function(t){e(t)}))],"normal"===t.mode?[Lo(Ke(),(function(t){Fo(t,zp)})),Lo(ao(),(function(t){Fo(t,Np)})),Lo(qe(),(function(t){Fo(t,zp)})),Lo(Xe(),(function(t){Fo(t,Np)}))]:[Lo(Ao(),(function(t,n){Fo(t,zp)})),Lo(Mo(),(function(t){Fo(t,Np)}))]]))}}),state:Pp,apis:jp}),Wp=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Gp=tinymce.util.Tools.resolve("tinymce.util.I18n"),Xp=["input","button","textarea","select"],Yp=function(t,n,e){(n.disabled()?Zp:th)(t,n)},qp=function(t,n){return!0===n.useNative&&P(Xp,Qo(t.element))},Kp=function(t){Cr(t.element,"disabled","disabled")},Jp=function(t){Er(t.element,"disabled")},$p=function(t){Cr(t.element,"aria-disabled","true")},Qp=function(t){Cr(t.element,"aria-disabled","false")},Zp=function(t,n,e){n.disableClass.each((function(n){ui(t.element,n)})),(qp(t,n)?Kp:$p)(t),n.onDisabled(t)},th=function(t,n,e){n.disableClass.each((function(n){ai(t.element,n)})),(qp(t,n)?Jp:Qp)(t),n.onEnabled(t)},nh=function(t,n){return qp(t,n)?Tr(t.element,"disabled"):"true"===Or(t.element,"aria-disabled")},eh=Object.freeze({__proto__:null,enable:th,disable:Zp,isDisabled:nh,onLoad:Yp,set:function(t,n,e,o){(o?Zp:th)(t,n)}}),oh=Object.freeze({__proto__:null,exhibit:function(t,n){return Qr({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return Ho([zo(lo(),(function(n,e){return nh(n,t)})),Ca(t,n,Yp)])}}),rh=[Yn("disabled",a),Ln("useNative",!0),Rn("disableClass"),Hu("onDisabled"),Hu("onEnabled")],ih=Ba({fields:rh,name:"disabling",active:oh,apis:eh}),uh=tinymce.util.Tools.resolve("tinymce.EditorManager"),ah=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},ch=function(t){return t.getParam("width",Wp.DOM.getStyle(t.getElement(),"width"))},sh=function(t){return w.from(t.getParam("min_width")).filter(M)},lh=function(t){return w.from(t.getParam("min_height")).filter(M)},fh=function(t){return w.from(t.getParam("max_width")).filter(M)},dh=function(t){return w.from(t.getParam("max_height")).filter(M)},mh=function(t){return!1!==t.getParam("menubar",!0,"boolean")},gh=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=C(n),r=_(n)&&0<n.length
return!hh(t)&&(r||o||e)},ph=function(t){var n=z(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=W(n,(function(t){return"string"==typeof t}))
return 0<e.length?w.some(e):w.none()},hh=function(t){return ph(t).fold((function(){return 0<t.getParam("toolbar",[],"string[]").length}),(function(){return!0}))};(up=ip=ip||{}).default="wrap",up.floating="floating",up.sliding="sliding",up.scrolling="scrolling"
var vh,bh,yh=function(t){return t.getParam("toolbar_mode","","string")};(bh=vh=vh||{}).auto="auto",bh.top="top",bh.bottom="bottom"
var xh,wh,Sh,kh=function(t){return t.getParam("toolbar_location",vh.auto,"string")},Ch=function(t){return kh(t)===vh.bottom},Oh=function(t){var n=t.getParam("fixed_toolbar_container","","string")
return 0<n.length&&t.inline?wu(yi(),n):w.none()},_h=function(t){return t.inline&&Oh(t).isSome()},Th=function(t){return t.inline&&!mh(t)&&!gh(t)&&!hh(t)},Eh=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!_h(t)&&!Th(t)},Bh="silver.readonly",Ah=Zt([En("readonly",Sn)]),Mh=function(t,n){var e=t.outerContainer.element
n&&(t.mothership.broadcastOn([Vs()],{target:e}),t.uiMothership.broadcastOn([Vs()],{target:e})),t.mothership.broadcastOn([Bh],{readonly:n}),t.uiMothership.broadcastOn([Bh],{readonly:n})},Fh=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&Mh(n,!0)})),t.on("SwitchMode",(function(){return Mh(n,t.mode.isReadOnly())})),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},Dh=function(){var t
return Da.config({channels:((t={})[Bh]={schema:Ah,onReceive:function(t,n){ih.set(t,n.readonly)}},t)})},Ih=function(t){return ih.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Rh=function(t){return ih.config({disabled:t})},Vh=function(t){return ih.config({disabled:t,disableClass:"tox-tbtn--disabled"})},Ph=function(t){return ih.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Hh=function(t,n){var e=t.getApi(n)
return function(t){t(e)}},zh=function(t,n){return qo((function(e){Hh(t,e)((function(e){var o=t.onSetup(e)
null!=o&&n.set(o)}))}))},Nh=function(t,n){return Ko((function(e){return Hh(t,e)(n.get())}))},Lh=((xh={})[lo()]=["disabling","alloy.base.behaviour","toggling","item-events"],xh),jh=function(t){return J(t,(function(t){return t.toArray()}))},Uh=function(n,e,o,r){var i,u,a=Jn(t)
return{type:"item",dom:e.dom,components:jh(e.optComponents),data:n.data,eventOrder:Lh,hasSubmenu:n.triggersSubmenu,itemBehaviours:Ta([xm("item-events",[(i=n,u=o,$o((function(t,n){Hh(i,t)(i.onAction),i.triggersSubmenu||u!==ap.CLOSE_ON_EXECUTE||(Fo(t,po()),n.stop())}))),zh(n,a),Nh(n,a)]),Ih((function(){return n.disabled||r.isReadOnly()})),Dh(),ym.config({})].concat(n.itemBehaviours))}},Wh=function(t){return{value:t.value,meta:l({text:t.text.getOr("")},t.meta)}},Gh=tinymce.util.Tools.resolve("tinymce.Env"),Xh=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},Yh=function(t){return{dom:{tag:"div",classes:[mp]},components:[Pi(Gp.translate(t))]}},qh=function(t,n){return{dom:{tag:"div",classes:[mp]},components:[{dom:{tag:t.tag,styles:t.styles},components:[Pi(Gp.translate(n))]}]}},Kh=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=t,e=Gh.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},o=n.split("+"),r=L(o,(function(t){var n=t.toLowerCase().trim()
return Tt(e,n)?e[n]:t})),Gh.mac?r.join(""):r.join("+"))}}
var n,e,o,r},Jh=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:kg("checkmark",t)}}},$h=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Qh=["list-bull-circle","list-bull-default","list-bull-square"],Zh=function(t,n,e,o){void 0===o&&(o=w.none())
var i,u,a,c,s,f=Gp.isRtl()&&t.iconContent.exists((function(t){return P(Qh,t)})),m=t.iconContent.map((function(t){return Gp.isRtl()&&P($h,t)?t+"-rtl":t})).map((function(t){return e=t,r=n.icons,i=o,w.from(r()[e.toLowerCase()]).or(i).getOrThunk((function(){return Sg(r)}))
var e,r,i})),g=w.from(t.meta).fold((function(){return Yh}),(function(t){return Tt(t,"style")?r(qh,t.style):Yh}))
return"color"===t.presets?(i=t.ariaLabel,u=t.value,a=n,{dom:(c=m.getOr(""),s={tag:"div",attributes:i.map((function(t){return{title:a.translate(t)}})).getOr({}),classes:["tox-swatch"]},l(l({},s),"custom"===u?{tag:"button",classes:d(s.classes,["tox-swatches__picker-btn"]),innerHtml:c}:"remove"===u?{classes:d(s.classes,["tox-swatch--remove"]),innerHtml:c}:{attributes:l(l({},s.attributes),{"data-mce-color":u}),styles:{"background-color":u}})),optComponents:[]}):function(t,n,e,o,r){var i=e?n.or(w.some("")).map(Xh):w.none(),u=t.checkMark,a=t.ariaLabel.map((function(t){return{attributes:{title:Gp.translate(t)}}})).getOr({})
return{dom:l({tag:"div",classes:[cp,sp].concat(r?["tox-collection__item-icon-rtl"]:[])},a),optComponents:[i,t.htmlContent.fold((function(){return t.textContent.map(o)}),(function(t){return w.some({dom:{tag:"div",classes:[mp],innerHtml:t}})})),t.shortcutContent.map(Kh),u,t.caret]}}(t,m,e,g,f)},tv=Vl("item-widget",qm()),nv=function(t){return{value:t}},ev=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,ov=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rv=function(t){return ev.test(t)||ov.test(t)},iv=function(t){var n=t.toString(16)
return 1===n.length?"0"+n:n},uv=function(t){var n=iv(t.red)+iv(t.green)+iv(t.blue)
return nv(n)},av=Math.min,cv=Math.max,sv=Math.round,lv=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,fv=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,dv=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},mv=function(t){var n=parseInt(t,10)
return n.toString()===t&&0<=n&&n<=255},gv=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100
i=cv(0,av(i,1)),u=cv(0,av(u,1))
if(0===i)return n=e=o=sv(255*u),dv(n,e,o,1)
var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c
switch(Math.floor(a)){case 0:n=c,e=s,o=0
break
case 1:n=s,e=c,o=0
break
case 2:n=0,e=c,o=s
break
case 3:n=0,e=s,o=c
break
case 4:n=s,e=0,o=c
break
case 5:n=c,e=0,o=s
break
default:n=e=o=0}return n=sv(255*(n+l)),e=sv(255*(e+l)),o=sv(255*(o+l)),dv(n,e,o,1)},pv=function(t){var n=function(t){var n={value:t.value.replace(ev,(function(t,n,e,o){return n+n+e+e+o+o}))},e=ov.exec(n.value)
return null===e?["FFFFFF","FF","FF","FF"]:e}(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16)
return dv(e,o,r,1)},hv=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o)
return dv(r,i,u,a)},vv=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},bv=dv(255,0,0,1),yv=function(t,n){return t.fire("ResizeContent",n)},xv=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),wv="tinymce-custom-colors",Sv="choiceitem",kv=[{type:Sv,text:"Light Green",value:"#BFEDD2"},{type:Sv,text:"Light Yellow",value:"#FBEEB8"},{type:Sv,text:"Light Red",value:"#F8CAC6"},{type:Sv,text:"Light Purple",value:"#ECCAFA"},{type:Sv,text:"Light Blue",value:"#C2E0F4"},{type:Sv,text:"Green",value:"#2DC26B"},{type:Sv,text:"Yellow",value:"#F1C40F"},{type:Sv,text:"Red",value:"#E03E2D"},{type:Sv,text:"Purple",value:"#B96AD9"},{type:Sv,text:"Blue",value:"#3598DB"},{type:Sv,text:"Dark Turquoise",value:"#169179"},{type:Sv,text:"Orange",value:"#E67E23"},{type:Sv,text:"Dark Red",value:"#BA372A"},{type:Sv,text:"Dark Purple",value:"#843FA1"},{type:Sv,text:"Dark Blue",value:"#236FA1"},{type:Sv,text:"Light Gray",value:"#ECF0F1"},{type:Sv,text:"Medium Gray",value:"#CED4D9"},{type:Sv,text:"Gray",value:"#95A5A6"},{type:Sv,text:"Dark Gray",value:"#7E8C8D"},{type:Sv,text:"Navy Blue",value:"#34495E"},{type:Sv,text:"Black",value:"#000000"},{type:Sv,text:"White",value:"#ffffff"}],Cv=function(t){void 0===t&&(t=10)
var n,e=xv.getItem(wv),o=C(e)?JSON.parse(e):[],r=t-(n=o).length<0?n.slice(0,t):n,i=function(t){r.splice(t,1)}
return{add:function(n){var e;(-1===(e=V(r,n))?w.none():w.some(e)).each(i),r.unshift(n),r.length>t&&r.pop(),xv.setItem(wv,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),Ov=function(t){return!1!==t.getParam("custom_colors")},_v=function(t){var n=t.getParam("color_map")
return void 0!==n?function(t){var n=[],e=document.createElement("canvas")
e.height=1,e.width=1
for(var o=e.getContext("2d"),r=function(t,n){var e=n/255
return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=0;i<t.length;i+=2)n.push({text:t[i+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase()
o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1)
var n=o.getImageData(0,0,1,1).data,i=n[0],u=n[1],a=n[2],c=n[3]
return"#"+r(i,c)+r(u,c)+r(a,c)}(t[i]),type:"choiceitem"})
return n}(n):kv},Tv=function(t){Cv.add(t)},Ev=function(t){var n,e
return e=(n=_v(t).length,Math.max(5,Math.ceil(Math.sqrt(n)))),t.getParam("color_cols",e,"number")},Bv=function(t,n,e,o){"custom"===e?Rv(t)((function(e){e.each((function(e){Tv(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},Av=function(t,n){return t.concat(L(Cv.state(),(function(t){return{type:Sv,text:t,value:t}})).concat((e={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[e,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[e])))
var e},Mv=function(t,n){return function(e){e(Av(t,n))}},Fv=function(t,n,e){var o,r
o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},Dv=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o,r,i
return w.from((r=e,(o=t).dom.getParents(o.selection.getStart(),(function(t){var n;(n=t.style["forecolor"===r?"color":"background-color"])&&(i=i||n)})),i)).bind((function(t){return function(t){if("transparent"===t)return w.some(dv(0,0,0,0))
var n=lv.exec(t)
if(null!==n)return w.some(hv(n[1],n[2],n[3],"1"))
var e=fv.exec(t)
return null!==e?w.some(hv(e[1],e[2],e[3],e[4])):w.none()}(t).map((function(t){var e=uv(t).value
return ae(n.toLowerCase(),e)}))})).getOr(!1)},columns:Ev(t),fetch:Mv(_v(t),Ov(t)),onAction:function(n){null!==r.get()&&Bv(t,e,r.get(),(function(){}))},onItemAction:function(o,i){Bv(t,e,i,(function(e){var o
r.set(e),o={name:n,color:e},t.fire("TextColorChange",o)}))},onSetup:function(e){null!==r.get()&&Fv(e,n,r.get())
var o=function(t){t.name===n&&Fv(e,t.name,t.color)}
return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},Iv=function(n,e,o,r){n.ui.registry.addNestedMenuItem(e,{text:r,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){Bv(n,o,e.value,t)}}]}})},Rv=function(t){return function(n,e){var o,r={colorpicker:e},i=(o=n,function(t){var n=t.getData()
o(w.from(n.colorpicker)),t.close()})
t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:i,onClose:function(){},onCancel:function(){n(w.none())}})}},Vv=function(t,n,e,o,r,i,u,a){var c=Cp(n),s=Pv(n,e,o,"color"!==r?"normal":"color",i,u,a)
return Tp(t,c,s,o,r)},Pv=function(t,n,e,o,r,i,u){return uf(L(t,(function(a){return"choiceitem"===a.type?dn("choicemenuitem",Bp,a).fold(Op,(function(c){return w.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0)
var c=Zh({presets:e,textContent:n?t.text:w.none(),htmlContent:w.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:w.none(),checkMark:n?w.some(Jh(u.icons)):w.none(),caret:w.none(),value:t.value},u,a)
return Ft(Uh({data:Wh(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Pm.set(t,n)},isActive:function(){return Pm.isOn(t)},isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:dp,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,Cp(t)))})):w.none()})))},Hv=function(t,n){var e=bp(n)
return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},zv=Dr("cell-over"),Nv=Dr("cell-execute"),Lv={inserttable:function(t){var n=Dr("size-label"),e=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(t,n,e){var o,r=function(e){return Do(e,Nv,{row:t,col:n})},i=function(t,n){n.stop(),r(t)}
return Ni({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=e,o)},behaviours:Ta([xm("insert-table-picker-cell",[Lo(qe(),Om.focus),Lo(lo(),r),Lo(no(),i),Lo(mo(),i)]),Pm.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Om.config({onFocus:function(e){return Do(e,zv,{row:t,col:n})}})])})}(r,u,t))
o.push(i)}return o}(n,10,10),o=wg({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[Pi("0x0")],behaviours:Ta([ym.config({})])})
return{type:"widget",data:{value:Dr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[tv.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:J(e,(function(t){return L(t,Li)})).concat(o.asSpec()),behaviours:Ta([xm("insert-table-picker",[Go(zv,(function(t,n,r){var i=r.event.row,u=r.event.col
!function(t,n,e,o,r){for(var i=0;i<10;i++)for(var u=0;u<10;u++)Pm.set(t[i][u],i<=n&&u<=e)}(e,i,u),ym.set(o.get(t),[Pi(u+1+"x"+(i+1))])})),Go(Nv,(function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Fo(n,po())}))]),gm.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=Av(n.colorinput.getColors(),n.colorinput.hasCustomColors()),o=n.colorinput.getColorCols(),r=Vv(Dr("menu-value"),e,(function(n){t.onAction({value:n})}),o,"color",ap.CLOSE_ON_EXECUTE,(function(){return!1}),n.shared.providers),i=l(l({},r),{markers:bp("color"),movement:Hv(o,"color")})
return{type:"widget",data:{value:Dr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[tv.widget(tg.sketch(i))]}}},jv=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0)
var c,s,l=Zh({presets:o,textContent:w.none(),htmlContent:e?t.text.map((function(t){return function(t,n){var e,o=(e=Gp.translate(t),Wp.DOM.encode(e))
if(0<n.length){var r=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")
return o.replace(r,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return o}(t,n)})):w.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:w.none(),checkMark:w.none(),caret:w.none(),value:t.value},u.providers,a,t.icon)
return Uh({data:Wh(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(n){return r(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:(c=t.meta,s=u,_t(c,"tooltipWorker").map((function(t){return[Up.config({lazySink:s.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:Za}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){Up.setComponents(n,[Hi({element:ne(t)})])}))}})]})).getOr([]))},l,i,u.providers)},Uv=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}))
return{type:"separator",dom:l({tag:"div",classes:[sp,"tox-collection__group-heading"]},n),components:[]}};(Sh=wh=wh||{})[Sh.ContentFocus=0]="ContentFocus",Sh[Sh.UiFocus=1]="UiFocus"
var Wv=function(n,e,o,r,i){var u=o.shared.providers,a=function(t){return i?l(l({},t),{shortcut:w.none(),icon:t.text.isSome()?w.none():t.icon}):t}
switch(n.type){case"menuitem":return dn("menuitem",Mp,n).fold(Op,(function(t){return w.some(function(t,n,e,o){void 0===o&&(o=!0)
var r=Zh({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:w.none(),ariaLabel:t.text,caret:w.none(),checkMark:w.none(),shortcutContent:t.shortcut},e,o)
return Uh({data:Wh(t),getApi:function(t){return{isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)}(a(t),e,u,r))}))
case"nestedmenuitem":return dn("nestedmenuitem",Fp,n).fold(Op,(function(n){return w.some(function(n,e,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1)
var u,a,c=i?(a=o.icons,{dom:{tag:"div",classes:[gp],innerHtml:kg("chevron-down",a)}}):(u=o.icons,{dom:{tag:"div",classes:[gp],innerHtml:kg("chevron-right",u)}}),s=Zh({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,caret:w.some(c),checkMark:w.none(),shortcutContent:n.shortcut},o,r)
return Uh({data:Wh(n),getApi:function(t){return{isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)}}},disabled:n.disabled,onAction:t,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},s,e,o)}(a(n),e,u,r,i))}))
case"togglemenuitem":return dn("togglemenuitem",Dp,n).fold(Op,(function(t){return w.some(function(t,n,e,o){void 0===o&&(o=!0)
var r=Zh({iconContent:t.icon,textContent:t.text,htmlContent:w.none(),ariaLabel:t.text,checkMark:w.some(Jh(e.icons)),caret:w.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o)
return Ft(Uh({data:Wh(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){Pm.set(t,n)},isActive:function(){return Pm.isOn(t)},isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:dp,toggleOnExecute:!1,selected:t.active}})}(a(t),e,u,r))}))
case"separator":return dn("separatormenuitem",jg,n).fold(Op,(function(t){return w.some(Uv(t))}))
case"fancymenuitem":return dn("fancymenuitem",Ap,n).fold(Op,(function(t){return function(t,n){return e=Lv,o=t.fancytype,(Object.prototype.hasOwnProperty.call(e,o)?w.some(e[o]):w.none()).map((function(e){return e(t,n)}))
var e,o}(a(t),o)}))
default:return console.error("Unknown item in general menu",n),w.none()}},Gv=function(t,n,e,o,r){var i=Cp(n),u=uf(L(n,(function(t){var n=function(t){return Wv(t,e,o,r?!t.hasOwnProperty("text"):i,r)}
return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(l(l({},t),{disabled:!0})):n(t)})))
return(r?_p:Tp)(t,i,u,1,"normal")},Xv=function(t){return ug.singleData(t.value,t)},Yv=function(t,n){var e=Jn(w.none()),o=Jn(!1),r=Ni(ag.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Ta([xm("dismissAutocompleter",[Lo(Co(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&ag.hide(r)},a=function(){var n
i()&&(n=e.get().map((function(t){return t.element})),Fg(n.getOr(ne(t.selection.getNode()))).each(xr),u(),e.set(w.none()),o.set(!1))},c=It((function(){return function(t){var n,e,o=t.ui.registry.getAll().popups,r=wt(o,(function(t){return dn("Autocompleter",Wg,t).fold((function(t){throw new Error(pn(t))}),(function(t){return t}))})),i=(n=kt(r,(function(t){return t.ch})),e={},j(n,(function(t){e[t]={}})),bt(e)),u=Ot(r)
return{dataset:r,triggerChars:i,lookupByChar:function(t){return W(u,(function(n){return n.ch===t}))}}}(t)})),s=function(l){var f
f=l,e.get().map((function(n){return Vg(t.dom,t.selection.getRng(),n.triggerChar).bind((function(n){return Lg(t,c,n,f)}))})).getOrThunk((function(){return function(t,n){var e,o,r=n(),i=t.selection.getRng()
return e=t.dom,o=i,rt(r.triggerChars,(function(t){return Vg(e,o,t)})).bind((function(e){return Lg(t,n,e)}))}(t,c)})).fold(a,(function(c){var l,f
l=c.context,i()||(f=Mg(t,l.range),e.set(w.some({triggerChar:l.triggerChar,element:f,matchLength:l.text.length})),o.set(!1)),c.lookupData.then((function(i){e.get().map((function(e){var l,f,d,m,g=c.context
e.triggerChar===g.triggerChar&&(f=g.triggerChar,m=rt(d=i,(function(t){return w.from(t.columns)})).getOr(1),0<(l=J(d,(function(e){return function(t,n,e,o,r,i){var u=1===o,a=!u||Cp(t)
return uf(L(t,(function(t){return"separator"===t.type?dn("Autocompleter.Separator",jg,t).fold(Op,(function(t){return w.some(Uv(t))})):dn("Autocompleter.Item",Ug,t).fold(Op,(function(t){return w.some(jv(t,n,u,"normal",e,r,i,a))}))})))}(e.items,e.matchText,(function(n,r){var i=t.selection.getRng()
Vg(t.dom,i,f).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),s(t)}}
o.set(!0),e.onAction(c,i,n,r),o.set(!1)}))}),m,ap.BUBBLE_TO_SANDBOX,n)}))).length?function(n,e,o,i){n.matchLength=e.text.length
var u,a,c,s,l,f,d,m=rt(o,(function(t){return w.from(t.columns)})).getOr(1)
ag.showAt(r,{anchor:"node",root:ne(t.getBody()),node:w.from(n.element)},tg.sketch((u=Tp("autocompleter-value",!0,i,m,"normal"),a=m,s="normal",l=((c=wh.ContentFocus)===wh.ContentFocus?jf:Lf)(),f=Hv(a,s),d=bp(s),{dom:u.dom,components:u.components,items:u.items,value:u.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:c===wh.ContentFocus,focusManager:l,menuBehaviours:Rp("auto"!==a?[]:[qo((function(t,n){Ip(t,4,d.item).each((function(n){var e=n.numColumns,o=n.numRows
gm.setGridSize(t,o,e)}))}))])}))),ag.getContent(r).each(xf.highlightFirst)}(e,g,i,l):(10<=g.text.length-e.matchLength?a:u)())}))}))}))};(function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel)
var e=function(t,n){Do(t,$e(),{raw:n})}
n.on("keydown",(function(n){var o=function(){return t.getView().bind(xf.getHighlighted)}
8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Io),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(xf.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&Fg(ne(n.element)).isNone()&&t.cancelIfNecessary()}))})({onKeypress:Eg((function(t){27!==t.which&&s()}),50),cancelIfNecessary:a,isMenuOpen:function(){return ag.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return ag.getContent(r)}},t)},qv=c,Kv=function(t,n,e){return nu(t,n,qv,e,!1)},Jv=function(t,n,e){return nu(t,n,qv,e,!0)},$v=tu,Qv=function(t,n,e){return Su(t,n,e).isSome()}
function Zv(t,n){var e=null
return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r]
e=setTimeout((function(){t.apply(null,o),e=null}),n)}}}var tb=function(t){var n=t.raw
return void 0===n.touches||1!==n.touches.length?w.none():w.some(n.touches[0])},nb=function(){return Be().browser.isFirefox()},eb=Qt([Mn("triggerEvent"),Ln("stopBackspace",!0)]),ob=function(t,n){var e,o,r,i,u=gn("Getting GUI events settings",eb,n),a=function(t){var n=Jn(w.none()),e=Jn(!1),o=Zv((function(n){t.triggerEvent(go(),n),e.set(!0)}),400),r=Ut([{key:Ne(),value:function(t){return tb(t).each((function(r){o.cancel()
var i={x:r.clientX,y:r.clientY,target:t.target}
o.schedule(t),e.set(!1),n.set(w.some(i))})),w.none()}},{key:Le(),value:function(t){return o.cancel(),tb(t).each((function(t){n.get().each((function(e){var o,r,i,u
o=t,r=e,i=Math.abs(o.clientX-r.x),u=Math.abs(o.clientY-r.y),(5<i||5<u)&&n.set(w.none())}))})),w.none()}},{key:je(),value:function(r){return o.cancel(),n.get().filter((function(t){return Fe(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(mo(),r)}))}}])
return{fireIfReady:function(t,n){return _t(r,n).bind((function(n){return n(t)}))}}}(u),c=L(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return Kv(t,n,(function(t){a.fireIfReady(t,n).each((function(n){n&&t.kill()})),u.triggerEvent(n,t)&&t.kill()}))})),s=Jn(w.none()),l=Kv(t,"paste",(function(t){a.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),u.triggerEvent("paste",t)&&t.kill(),s.set(w.some(setTimeout((function(){u.triggerEvent(co(),t)}),0)))})),f=Kv(t,"keydown",(function(t){var n
u.triggerEvent("keydown",t)?t.kill():!0!==u.stopBackspace||(n=t).raw.which!==wf[0]||P(["input","textarea"],Qo(n.target))||Qv(n.target,'[contenteditable="true"]')||t.prevent()})),d=(e=t,o=function(t){u.triggerEvent("focusin",t)&&t.kill()},nb()?Jv(e,"focus",o):Kv(e,"focusin",o)),m=Jn(w.none()),g=(r=t,i=function(t){u.triggerEvent("focusout",t)&&t.kill(),m.set(w.some(setTimeout((function(){u.triggerEvent(ao(),t)}),0)))},nb()?Jv(r,"blur",i):Kv(r,"focusout",i))
return{unbind:function(){j(c,(function(t){t.unbind()})),f.unbind(),d.unbind(),g.unbind(),l.unbind(),s.get().each(clearTimeout),m.get().each(clearTimeout)}}},rb=function(t,n){var e=_t(t,"target").getOr(n)
return Jn(e)},ib=Bt([{stopped:[]},{resume:["element"]},{complete:[]}]),ub=function(t,n,e,o,r,i){var u,a,c,s,l=t(n,o),f=(u=e,a=r,c=Jn(!1),s=Jn(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:u,setSource:a.set,getSource:a.get})
return l.fold((function(){return i.logEventNoHandlers(n,o),ib.complete()}),(function(t){var e=t.descHandler
return Zr(e)(f),f.isStopped()?(i.logEventStopped(n,t.element,e.purpose),ib.stopped()):f.isCut()?(i.logEventCut(n,t.element,e.purpose),ib.complete()):cr(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),ib.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),ib.resume(o)}))}))},ab=function(t,n,e,o,r,i){return ub(t,n,e,o,r,i).fold((function(){return!0}),(function(o){return ab(t,n,e,o,r,i)}),(function(){return!1}))},cb=function(n,e,o){var r,i,c=(r=e,i=Jn(!1),{stop:function(){i.set(!0)},cut:t,isStopped:i.get,isCut:a,event:r,setSource:u("Cannot set source of a broadcasted event"),getSource:u("Cannot get source of a broadcasted event")})
return j(n,(function(t){var n=t.descHandler
Zr(n)(c)})),c.isStopped()},sb=function(t,n,e,o,r){var i=rb(e,o)
return ab(t,n,e,o,i,r)}
function lb(){var t={}
return{registerId:function(n,e,o){xt(o,(function(o,i){var u=void 0!==t[i]?t[i]:{}
u[e]=function(t,n){return{cHandler:r.apply(void 0,[t.handler].concat(n)),purpose:t.purpose}}(o,n),t[i]=u}))},unregisterId:function(n){xt(t,(function(t,e){t.hasOwnProperty(n)&&delete t[n]}))},filterByType:function(n){return _t(t,n).map((function(t){return kt(t,(function(t,n){return function(t,n){return{id:t,descHandler:n}}(n,t)}))})).getOr([])},find:function(n,e,o){var r=_t(t,e)
return Ve(o,(function(t){return n=r,zr(e=t).fold((function(){return w.none()}),(function(t){return n.bind((function(n){return _t(n,t)})).map((function(t){return function(t,n){return{element:t,descHandler:n}}(e,t)}))}))
var n,e}),n)}}}function fb(){var t=lb(),n={},e=function(e){zr(e.element).each((function(e){delete n[e],t.unregisterId(e)}))}
return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(o){var r=function(t){var n=t.element
return zr(n).fold((function(){return n=t.element,e=Dr(Vr+"uid-"),Hr(n,e),e
var n,e}),(function(t){return t}))}(o)
Et(n,r)&&function(t,o){var r=n[o]
if(r!==t)throw new Error('The tagId "'+o+'" is already used by: '+Br(r.element)+"\nCannot use it for: "+Br(t.element)+"\nThe conflicting element is"+(bi(r.element)?" ":" not ")+"already in the DOM")
e(t)}(o,r)
var i=[o]
t.registerId(i,r,o.events),n[r]=o},unregister:e,getById:function(t){return _t(n,t)}}}var db,mb,gb,pb=of({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=f(n,["attributes"])
return{uid:t.uid,dom:l({tag:"div",attributes:l({role:"presentation"},e)},o),components:t.components,behaviours:ol(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Ln("components",[]),el("containerBehaviours",[]),Ln("events",{}),Ln("domModification",{}),Ln("eventOrder",{})]}),hb=function(n){var o=function(t){return cr(n.element).fold((function(){return!0}),(function(n){return Fe(t,n)}))},r=fb(),i=function(t,n){return r.find(o,t,n)},u=ob(n.element,{triggerEvent:function(t,n){return Bu(t,n.target,(function(e){return r=e,sb(i,t,o=n,o.target,r)
var o,r}))}}),a={debugInfo:e("real"),triggerEvent:function(t,n,e){Bu(t,n,(function(o){return sb(i,t,e,n,o)}))},triggerFocus:function(n,e){zr(n).fold((function(){Ra(n)}),(function(o){Bu(uo(),n,(function(o){var r,u,a,c,s,l
return r=i,u=uo(),s=o,l=rb(a={originator:e,kill:t,prevent:t,target:n},c=n),ub(r,u,a,c,l,s),!1}))}))},triggerEscape:function(t,n){a.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:Ni,addToGui:function(t){f(t)},removeFromGui:function(t){d(t)},addToWorld:function(t){s(t)},removeFromWorld:function(t){l(t)},broadcast:function(t){g(t)},broadcastOn:function(t,n){p(t,n)},broadcastEvent:function(t,n){h(t,n)},isConnected:c},s=function(t){t.connect(a),nr(t.element)||(r.register(t),j(t.components(),s),a.triggerEvent(vo(),t.element,{target:t.element}))},l=function(t){nr(t.element)||(j(t.components(),l),r.unregister(t)),t.disconnect()},f=function(t){bs(n,t)},d=function(t){ws(t)},m=function(t){var n=r.filter(so())
j(n,(function(n){var e=n.descHandler
Zr(e)(t)}))},g=function(t){m({universal:!0,data:t})},p=function(t,n){m({universal:!1,channels:t,data:n})},h=function(t,n){var e=r.filter(t)
return cb(e,n)},v=function(t){return r.getById(t).fold((function(){return at.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),at.value)},b=function(t){var n=zr(t).getOr("not found")
return v(n)}
return s(n),{root:n,element:n.element,destroy:function(){u.unbind(),yr(n.element)},add:f,remove:d,getByUid:v,getByDom:b,addToWorld:s,removeFromWorld:l,broadcast:g,broadcastOn:p,broadcastEvent:h}},vb=e([Ln("prefix","form-field"),el("fieldBehaviours",[lf,nl])]),bb=e([Ml({schema:[Tn("dom")],name:"label"}),Ml({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Tn("text")],name:"aria-descriptor"}),Bl({factory:{sketch:function(t){var n=function(t,n){return e=n,o={},xt(t,(function(t,n){P(e,n)||(o[n]=t)})),o
var e,o}(t,["factory"])
return t.factory.sketch(n)}},schema:[Tn("factory")],name:"field"})]),yb=rf({name:"FormField",configFields:vb(),partFields:bb(),factory:function(t,n,e,o){var r=rl(t.fieldBehaviours,[lf.config({find:function(n){return Ul(n,t,"field")}}),nl.config({store:{mode:"manual",getValue:function(t){return lf.getCurrent(t).bind(nl.getValue)},setValue:function(t,n){lf.getCurrent(t).each((function(t){nl.setValue(t,n)}))}}})]),i=Ho([qo((function(n,e){var o=Gl(n,t,["label","field","aria-descriptor"])
o.field().each((function(n){var e=Dr(t.prefix)
o.label().each((function(t){Cr(t.element,"for",e),Cr(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Dr(t.prefix)
Cr(e.element,"id",o),Cr(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return Ul(n,t,"field")},getLabel:function(n){return Ul(n,t,"label")}}
return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),xb=Object.freeze({__proto__:null,exhibit:function(t,n){return Qr({attributes:Ut([{key:n.tabAttr,value:"true"}])})}}),wb=[Ln("tabAttr","data-alloy-tabstop")],Sb=Ba({fields:wb,name:"tabstopping",active:xb}),kb=function(t,n,e,o){var r=Cb(t,n,e,o)
return yb.sketch(r)},Cb=function(t,n,e,o){return{dom:Ob(e),components:t.toArray().concat([n]),fieldBehaviours:Ta(o)}},Ob=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},_b=function(t,n){return yb.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},Tb=Dr("form-component-change"),Eb=Dr("form-close"),Bb=Dr("form-cancel"),Ab=Dr("form-action"),Mb=Dr("form-submit"),Fb=Dr("form-block"),Db=Dr("form-unblock"),Ib=Dr("form-tabchange"),Rb=Dr("form-resize"),Vb=function(t,n){var e,r,i=t.label.map((function(t){return _b(t,n)})),u=function(t){return function(n,e){Su(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,Or(o,"data-collection-item-value"))}))}},a=u((function(e,o,r,i){o.stop(),n.isReadOnly()||Do(e,Ab,{name:t.name,value:i})})),c=[Lo(qe(),u((function(t,n,e){Ra(e)}))),Lo(no(),a),Lo(mo(),a),Lo(Ke(),u((function(t,n,e){wu(t.element,"."+pp).each((function(t){ai(t,pp)})),ui(e,pp)}))),Lo(Je(),u((function(t){wu(t.element,"."+pp).each((function(t){ai(t,pp)}))}))),$o(u((function(n,e,o,r){Do(n,Ab,{name:t.name,value:r})})))],s=function(t,n){return L(Mc(t.element,".tox-collection__item"),n)},l=yb.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:o},behaviours:Ta([ih.config({disabled:n.isReadOnly,onDisabled:function(t){s(t,(function(t){ui(t,"tox-collection__item--state-disabled"),Cr(t,"aria-disabled",!0)}))},onEnabled:function(t){s(t,(function(t){ai(t,"tox-collection__item--state-disabled"),Er(t,"aria-disabled")}))}}),Dh(),ym.config({}),nl.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){(function(e,o){var r=L(o,(function(e){var o,r=Gp.translate(e.text),i=1===t.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",u='<div class="tox-collection__item-icon">'+e.icon+"</div>",a={_:" "," - ":" ","-":" "},c=r.replace(/\_| \- |\-/g,(function(t){return a[t]}))
return'<div class="tox-collection__item'+(n.isReadOnly()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+('"'===(o=e.value)?"&quot;":o)+'" title="'+c+'" aria-label="'+c+'">'+u+i+"</div>"})),i="auto"!==t.columns&&1<t.columns?N(r,t.columns):[r],u=L(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}))
Sr(e.element,u.join(""))})(e,o),"auto"===t.columns&&Ip(e,5,"tox-collection__item").each((function(t){var n=t.numRows,o=t.numColumns
gm.setGridSize(e,n,o)})),Fo(e,Rb)}}),Sb.config({}),gm.config((r=t.columns,"normal",1===r?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===r?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:".tox-collection__group",cell:"."+sp}})),xm("collection-events",c)]),eventOrder:((e={})[lo()]=["disabling","alloy.base.behaviour","collection-events"],e)})
return kb(i,l,["tox-form__group--collection"],[])},Pb=e([Rn("data"),Ln("inputAttributes",{}),Ln("inputStyles",{}),Ln("tag","input"),Ln("inputClasses",[]),Hu("onSetValue"),Ln("styles",{}),Ln("eventOrder",{}),el("inputBehaviours",[nl,Om]),Ln("selectOnFocus",!0)]),Hb=function(n){return Ta([Om.config({onFocus:n.selectOnFocus?function(t){var n=t.element,e=Fi(n)
n.dom.setSelectionRange(0,e.length)}:t})])},zb=function(t){return{tag:t.tag,attributes:l({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},Nb=of({name:"Input",configFields:Pb(),factory:function(t,n){return{uid:t.uid,dom:zb(t),components:[],behaviours:l(l({},Hb(e=t)),rl(e.inputBehaviours,[nl.config({store:l(l({mode:"manual"},e.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return Fi(t.element)},setValue:function(t,n){Fi(t.element)!==n&&Di(t.element,n)}}),onSetValue:e.onSetValue})])),eventOrder:t.eventOrder}
var e}}),Lb={},jb={exports:Lb}
db=void 0,mb=Lb,gb=jb,function(t){"object"==typeof mb&&void 0!==gb?gb.exports=t():"function"==typeof db&&db.amd?db([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}((function(){return function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){var c=!1
if(!a&&c)return c(u,!0)
if(i)return i(u,!0)
var s=new Error("Cannot find module '"+u+"'")
throw s.code="MODULE_NOT_FOUND",s}var l=e[u]={exports:{}}
n[u][0].call(l.exports,(function(t){return r(n[u][1][t]||t)}),l,l.exports,t,n,e,o)}return e[u].exports}for(var i=!1,u=0;u<o.length;u++)r(o[u])
return r}({1:[function(t,n,e){var o,r,i=n.exports={}
function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(o===setTimeout)return setTimeout(t,0)
if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0)
try{return o(t,0)}catch(n){try{return o.call(null,t,0)}catch(n){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(t){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}()
var s,l=[],f=!1,d=-1
function m(){f&&s&&(f=!1,s.length?l=s.concat(l):d=-1,l.length&&g())}function g(){if(!f){var t=c(m)
f=!0
for(var n=l.length;n;){for(s=l,l=[];++d<n;)s&&s[d].run()
d=-1,n=l.length}s=null,f=!1,function(t){if(r===clearTimeout)return clearTimeout(t)
if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t)
try{r(t)}catch(n){try{return r.call(null,t)}catch(n){return r.call(this,t)}}}(t)}}function p(t,n){this.fun=t,this.array=n}function h(){}i.nextTick=function(t){var n=new Array(arguments.length-1)
if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e]
l.push(new p(t,n)),1!==l.length||f||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,n,e){(function(t){function e(){}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new")
if("function"!=typeof t)throw new TypeError("not a function")
this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],s(t,this)}function r(t,n){for(;3===t._state;)t=t._value
0!==t._state?(t._handled=!0,o._immediateFn((function(){var e,o=1===t._state?n.onFulfilled:n.onRejected
if(null!==o){try{e=o(t._value)}catch(l){return void u(n.promise,l)}i(n.promise,e)}else(1===t._state?i:u)(n.promise,t._value)}))):t._deferreds.push(n)}function i(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.")
if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then
if(n instanceof o)return t._state=3,t._value=n,void a(t)
if("function"==typeof e)return void s((r=e,c=n,function(){r.apply(c,arguments)}),t)}t._state=1,t._value=n,a(t)}catch(i){u(t,i)}var r,c}function u(t,n){t._state=2,t._value=n,a(t)}function a(t){2===t._state&&0===t._deferreds.length&&o._immediateFn((function(){t._handled||o._unhandledRejectionFn(t._value)}))
for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n])
t._deferreds=null}function c(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function s(t,n){var o=!1
try{t((function(t){o||(o=!0,i(n,t))}),(function(t){o||(o=!0,u(n,t))}))}catch(e){if(o)return
o=!0,u(n,e)}}var l
l=setTimeout,o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,n){var o=new this.constructor(e)
return r(this,new c(t,n,o)),o},o.all=function(t){var n=Array.prototype.slice.call(t)
return new o((function(t,o){if(0===n.length)return t([])
for(var r=n.length,i=0;i<n.length;i++)!function i(u,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then
if("function"==typeof c)return void c.call(a,(function(t){i(u,t)}),o)}n[u]=a,0==--r&&t(n)}catch(e){o(e)}}(i,n[i])}))},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o((function(n){n(t)}))},o.reject=function(t){return new o((function(n,e){e(t)}))},o.race=function(t){return new o((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},o._immediateFn="function"==typeof t?function(n){t(n)}:function(t){l(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o._setImmediateFn=function(t){o._immediateFn=t},o._setUnhandledRejectionFn=function(t){o._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=o:this.Promise||(this.Promise=o)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){var r=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0
function s(t,n){this._id=t,this._clearFn=n}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId)
var n=t._idleTimeout
0<=n&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),n))},e.setImmediate="function"==typeof n?n:function(t){var n=c++,o=!(arguments.length<2)&&u.call(arguments,1)
return a[n]=!0,r((function(){a[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))})),n},e.clearImmediate="function"==typeof o?o:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n,e){var o=t("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")()
n.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))
var Ub,Wb,Gb=jb.exports.boltExport,Xb=function(t){var n=w.none(),e=[],o=function(t){r()?i(t):e.push(t)},r=function(){return n.isSome()},i=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))}
return t((function(t){r()||(n=w.some(t),function(t){j(t,i)}(e),e=[])})),{get:o,map:function(t){return Xb((function(n){o((function(e){n(t(e))}))}))},isReady:r}},Yb={nu:Xb,pure:function(t){return Xb((function(n){n(t)}))}},qb=function(t){setTimeout((function(){throw t}),0)},Kb=function(t){var n=function(n){t().then(n,qb)}
return{map:function(n){return Kb((function(){return t().then(n)}))},bind:function(n){return Kb((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return Kb((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return Yb.nu(n)},toCached:function(){var n=null
return Kb((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},Jb=function(t){return Kb((function(){return new Gb(t)}))},$b=function(t){return Kb((function(){return Gb.resolve(t)}))},Qb=["input","textarea"],Zb=function(t){var n=Qo(t)
return P(Qb,n)},ty=function(t,n){var e=n.getRoot(t).getOr(t.element)
ai(e,n.invalidClass),n.notify.each((function(n){Zb(t.element)&&Cr(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Sr(t,n.validHtml)})),n.onValid(t)}))},ny=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element)
ui(r,n.invalidClass),n.notify.each((function(n){Zb(t.element)&&Cr(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Sr(t,o)})),n.onInvalid(t,o)}))},ey=function(t,n,e){return n.validator.fold((function(){return $b(at.value(!0))}),(function(n){return n.validate(t)}))},oy=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),ey(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return ny(t,n,0,e),at.error(e)}),(function(e){return ty(t,n),at.value(e)})):at.error("No longer in system")}))},ry=Object.freeze({__proto__:null,markValid:ty,markInvalid:ny,query:ey,run:oy,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element)
return ci(e,n.invalidClass)}}),iy=Object.freeze({__proto__:null,events:function(n,e){return n.validator.map((function(e){return Ho([Lo(e.onEvent,(function(t){oy(t,n).get(o)}))].concat(e.validateOnLoad?[qo((function(e){oy(e,n).get(t)}))]:[]))})).getOr({})}}),uy=[Tn("invalidClass"),Ln("getRoot",w.none),Nn("notify",[Ln("aria","alert"),Ln("getContainer",w.none),Ln("validHtml",""),Hu("onValid"),Hu("onInvalid"),Hu("onValidate")]),Nn("validator",[Tn("validate"),Ln("onEvent","input"),Ln("validateOnLoad",!0)])],ay=Ba({fields:uy,name:"invalidating",active:iy,apis:ry,extra:{validation:function(t){return function(n){var e=nl.getValue(n)
return $b(t(e))}}}}),cy=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),sy=[En("others",fn(at.value,bn()))],ly=Ba({fields:sy,name:"coupling",apis:cy,state:Object.freeze({__proto__:null,init:function(){var t={},n=e({})
return Jr({readState:n,getOrCreate:function(n,e,o){var r=bt(e.others)
if(r)return _t(t,o).getOrThunk((function(){var r=_t(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r)
return t[o]=i}))
throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),fy=e("sink"),dy=e(Ml({name:fy(),overrides:e({dom:{tag:"div"},behaviours:Ta([ms.config({useFixed:c})]),events:Ho([Xo($e()),Xo(We()),Xo(no())])})}));(Wb=Ub=Ub||{})[Wb.HighlightFirst=0]="HighlightFirst",Wb[Wb.HighlightNone=1]="HighlightNone"
var my=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides()
return t.layouts.fold((function(){return{anchor:"hotspot",hotspot:e,overrides:o}}),(function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}}))},gy=function(t,n,e,o,r,i,u){var a,c,s,f,d,m,g,p,h,v,b=my(t,e)
return(c=b,f=o,d=r,m=u,g=n,p=s=e,h=(0,(a=t).fetch)(p).map(g),v=vy(s,a),h.map((function(t){return t.bind((function(t){return w.from(ug.sketch(l(l({},d.menu()),{uid:Nr(""),data:t,highlightImmediately:m===Ub.HighlightFirst,onOpenMenu:function(t,n){var e=v().getOrDie()
ms.position(e,c,n),Rs.decloak(f)},onOpenSubmenu:function(t,n,e){var o=v().getOrDie()
ms.position(o,{anchor:"submenu",item:n},e),Rs.decloak(f)},onRepositionMenu:function(t,n,e){var o=v().getOrDie()
ms.position(o,c,n),j(e,(function(t){ms.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)}))},onEscape:function(){return Om.focus(s),Rs.close(f),w.some(!0)}})))}))}))).map((function(t){return t.fold((function(){Rs.isOpen(o)&&Rs.close(o)}),(function(t){Rs.cloak(o),Rs.open(o,t),i(o)})),o}))},py=function(t,n,e,o,r,i,u){return Rs.close(o),$b(o)},hy=function(t,n,e,o,r,i){var u=ly.getCoupled(e,"sandbox")
return(Rs.isOpen(u)?py:gy)(t,n,e,u,o,r,i)},vy=function(t,n){return t.getSystem().getByUid(n.uid+"-"+fy()).map((function(t){return function(){return at.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return at.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},by=function(t){Rs.getState(t).each((function(t){ug.repositionMenus(t)}))},yy=function(t,n,e){var o=ku(),r=vy(n,t)
return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:ul(t.sandboxBehaviours,[nl.config({store:{mode:"memory",initialValue:n}}),Rs.config({onOpen:function(r,i){var u=my(t,n)
o.link(n.element),t.matchWidth&&function(t,n,e){var o,r,i=lf.getCurrent(n).getOr(n),u=Qi(t.element)
e?ki(i.element,"min-width",u+"px"):(o=i.element,r=u,$i.set(o,r))}(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return Cu(e,o)||Cu(n,o)},getAttachPoint:function(){return r().getOrDie()}}),lf.config({find:function(t){return Rs.getState(t).bind((function(t){return lf.getCurrent(t)}))}}),Da.config({channels:l(l({},Ns({isExtraPart:a})),js({doReposition:by}))})])}},xy=function(t){var n=ly.getCoupled(t,"sandbox")
by(n)},wy=function(){return[Ln("sandboxClasses",[]),il("sandboxBehaviours",[lf,Da,Rs,nl])]},Sy=e([Tn("dom"),Tn("fetch"),Hu("onOpen"),zu("onExecute"),Ln("getHotspot",w.some),Ln("getAnchorOverrides",e({})),sc(),el("dropdownBehaviours",[Pm,ly,gm,Om]),Tn("toggleClass"),Ln("eventOrder",{}),Rn("lazySink"),Ln("matchWidth",!1),Ln("useMinWidth",!1),Rn("role")].concat(wy())),ky=e([Al({schema:[Ru()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),dy()]),Cy=rf({name:"Dropdown",configFields:Sy(),partFields:ky(),factory:function(n,e,o,r){var i,u=function(t){Rs.getState(t).each((function(t){ug.highlightPrimary(t)}))},a={expand:function(e){Pm.isOn(e)||hy(n,(function(t){return t}),e,r,t,Ub.HighlightNone).get(t)},open:function(e){Pm.isOn(e)||hy(n,(function(t){return t}),e,r,t,Ub.HighlightFirst).get(t)},isOpen:Pm.isOn,close:function(e){Pm.isOn(e)&&hy(n,(function(t){return t}),e,r,t,Ub.HighlightFirst).get(t)},repositionMenus:function(t){Pm.isOn(t)&&xy(t)}},c=function(t,n){return Io(t),w.some(!0)}
return{uid:n.uid,dom:n.dom,components:e,behaviours:rl(n.dropdownBehaviours,[Pm.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),ly.config({others:{sandbox:function(t){return yy(n,t,{onOpen:function(){Pm.on(t)},onClose:function(){Pm.off(t)}})}}}),gm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t,n){var e
return Cy.isOpen(t)?(e=ly.getCoupled(t,"sandbox"),u(e)):Cy.open(t),w.some(!0)},onEscape:function(t,n){return Cy.isOpen(t)?(Cy.close(t),w.some(!0)):w.none()}}),Om.config({})]),events:zm(w.some((function(e){hy(n,(function(t){return t}),e,r,u,Ub.HighlightFirst).get(t)}))),eventOrder:l(l({},n.eventOrder),((i={})[lo()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:a,domModification:{attributes:l(l({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===n.dom.tag?{type:("type",_t(n.dom,"attributes").bind((function(t){return _t(t,"type")})).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Oy=Ba({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return Ho([zo(oo(),c)])},exhibit:function(){return Qr({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),_y=Dr("color-input-change"),Ty=Dr("color-swatch-change"),Ey=Dr("color-picker-cancel"),By=function(t,n,e){return{hue:t,saturation:n,value:e}},Ay=Dr("rgb-hex-update"),My=Dr("slider-update"),Fy=Dr("palette-update"),Dy=Ml({schema:[Tn("dom")],name:"label"}),Iy=function(t){return Ml({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:Ho([jo(Ne(),(function(n,e,o){return t(n,o)}),[n]),jo(We(),(function(n,e,o){return t(n,o)}),[n]),jo(Ge(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},Ry=Iy("top-left"),Vy=Iy("top"),Py=Iy("top-right"),Hy=Iy("right"),zy=Iy("bottom-right"),Ny=Iy("bottom"),Ly=Iy("bottom-left"),jy=[Dy,Iy("left"),Hy,Vy,Ny,Ry,Py,Ly,zy,Bl({name:"thumb",defaults:e({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Ho([Wo(Ne(),t,"spectrum"),Wo(Le(),t,"spectrum"),Wo(je(),t,"spectrum"),Wo(We(),t,"spectrum"),Wo(Ge(),t,"spectrum"),Wo(Ye(),t,"spectrum")])}}}),Bl({schema:[Kn("mouseIsDown",(function(){return Jn(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))}
return{behaviours:Ta([gm.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),Om.config({})]),events:Ho([Lo(Ne(),e),Lo(Le(),e),Lo(We(),e),Lo(Ge(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}})],Uy=e("slider.change.value"),Wy=function(t){var n=t.event.raw
return-1===n.type.indexOf("touch")?void 0!==n.clientX?w.some(n).map((function(t){return Yi(t.clientX,t.clientY)})):w.none():void 0!==n.touches&&1===n.touches.length?w.some(n.touches[0]).map((function(t){return Yi(t.clientX,t.clientY)})):w.none()},Gy=function(t){return t.model.minX},Xy=function(t){return t.model.minY},Yy=function(t){return t.model.minX-1},qy=function(t){return t.model.minY-1},Ky=function(t){return t.model.maxX},Jy=function(t){return t.model.maxY},$y=function(t){return t.model.maxX+1},Qy=function(t){return t.model.maxY+1},Zy=function(t,n,e){return n(t)-e(t)},tx=function(t){return Zy(t,Ky,Gy)},nx=function(t){return Zy(t,Jy,Xy)},ex=function(t){return tx(t)/2},ox=function(t){return nx(t)/2},rx=function(t){return t.stepSize},ix=function(t){return t.snapToGrid},ux=function(t){return t.snapStart},ax=function(t){return t.rounded},cx=function(t,n){return void 0!==t[n+"-edge"]},sx=function(t){return cx(t,"left")},lx=function(t){return cx(t,"right")},fx=function(t){return cx(t,"top")},dx=function(t){return cx(t,"bottom")},mx=function(t){return t.model.value.get()},gx=function(t){return{x:t}},px=function(t){return{y:t}},hx=function(t,n){return{x:t,y:n}},vx=function(t,n){Do(t,Uy(),{value:n})},bx=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},yx=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},xx=function(t,n,e){return Math.max(n,Math.min(e,t))},wx=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e
if(r<f)return g
if(d<r)return p
var h,v,b,y,x,w,S,k=(x=r,w=f,S=d,Math.min(S,Math.max(x,w))-w),C=xx(k/m*o+n,g,p)
return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold((function(){var t=h-v,n=Math.round(t/y)*y
return xx(v+n,v-1,b+1)}),(function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y
return Math.max(t,i)}))):c?Math.round(C):C},Sx=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge
return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c},kx="left",Cx=function(t){return t.element.dom.getBoundingClientRect()},Ox=function(t,n){return t[n]},_x=function(t){var n=Cx(t)
return Ox(n,kx)},Tx=function(t){var n=Cx(t)
return Ox(n,"right")},Ex=function(t){var n=Cx(t)
return Ox(n,"top")},Bx=function(t){var n=Cx(t)
return Ox(n,"bottom")},Ax=function(t){var n=Cx(t)
return Ox(n,"width")},Mx=function(t){var n=Cx(t)
return Ox(n,"height")},Fx=function(t,n,e){return(t+n)/2-e},Dx=function(t,n){var e=Cx(t),o=Cx(n),r=Ox(e,kx),i=Ox(e,"right"),u=Ox(o,kx)
return Fx(r,i,u)},Ix=function(t,n){var e=Cx(t),o=Cx(n),r=Ox(e,"top"),i=Ox(e,"bottom"),u=Ox(o,"top")
return Fx(r,i,u)},Rx=function(t,n){Do(t,Uy(),{value:n})},Vx=function(t){return{x:t}},Px=function(t,n,e){var o={min:Gy(n),max:Ky(n),range:tx(n),value:e,step:rx(n),snap:ix(n),snapStart:ux(n),rounded:ax(n),hasMinEdge:sx(n),hasMaxEdge:lx(n),minBound:_x(t),maxBound:Tx(t),screenRange:Ax(t)}
return wx(o)},Hx=function(t){return function(n,e){return o=n,i=(0<t?yx:bx)(mx(r=e).x,Gy(r),Ky(r),rx(r)),Rx(o,Vx(i)),w.some(i).map((function(){return!0}))
var o,r,i}},zx=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=Ax(u=n),d=s.bind((function(t){return w.some(Dx(t,u))})).getOr(0),m=l.bind((function(t){return w.some(Dx(t,u))})).getOr(f),g={min:Gy(a),max:Ky(a),range:tx(a),value:c,hasMinEdge:sx(a),hasMaxEdge:lx(a),minBound:_x(u),minOffset:0,maxBound:Tx(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Sx(g))
return _x(n)-_x(t)+p},Nx=Hx(-1),Lx=Hx(1),jx=w.none,Ux=w.none,Wx={"top-left":w.none(),top:w.none(),"top-right":w.none(),right:w.some((function(t,n){vx(t,gx($y(n)))})),"bottom-right":w.none(),bottom:w.none(),"bottom-left":w.none(),left:w.some((function(t,n){vx(t,gx(Yy(n)))}))},Gx=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Px(t,n,e),r=Vx(o)
return Rx(t,r),o},setToMin:function(t,n){var e=Gy(n)
Rx(t,Vx(e))},setToMax:function(t,n){var e=Ky(n)
Rx(t,Vx(e))},findValueOfOffset:Px,getValueFromEvent:function(t){return Wy(t).map((function(t){return t.left}))},findPositionOfValue:zx,setPositionFromValue:function(t,n,e,o){var r=mx(e),i=zx(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Qi(n.element)/2
ki(n.element,"left",i-u+"px")},onLeft:Nx,onRight:Lx,onUp:jx,onDown:Ux,edgeActions:Wx}),Xx=function(t,n){Do(t,Uy(),{value:n})},Yx=function(t){return{y:t}},qx=function(t,n,e){var o={min:Xy(n),max:Jy(n),range:nx(n),value:e,step:rx(n),snap:ix(n),snapStart:ux(n),rounded:ax(n),hasMinEdge:fx(n),hasMaxEdge:dx(n),minBound:Ex(t),maxBound:Bx(t),screenRange:Mx(t)}
return wx(o)},Kx=function(t){return function(n,e){return o=n,i=(0<t?yx:bx)(mx(r=e).y,Xy(r),Jy(r),rx(r)),Xx(o,Yx(i)),w.some(i).map((function(){return!0}))
var o,r,i}},Jx=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=Mx(u=n),d=s.bind((function(t){return w.some(Ix(t,u))})).getOr(0),m=l.bind((function(t){return w.some(Ix(t,u))})).getOr(f),g={min:Xy(a),max:Jy(a),range:nx(a),value:c,hasMinEdge:fx(a),hasMaxEdge:dx(a),minBound:Ex(u),minOffset:0,maxBound:Bx(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},Sx(g))
return Ex(n)-Ex(t)+p},$x=w.none,Qx=w.none,Zx=Kx(-1),tw=Kx(1),nw={"top-left":w.none(),top:w.some((function(t,n){vx(t,px(qy(n)))})),"top-right":w.none(),right:w.none(),"bottom-right":w.none(),bottom:w.some((function(t,n){vx(t,px(Qy(n)))})),"bottom-left":w.none(),left:w.none()},ew=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=qx(t,n,e),r=Yx(o)
return Xx(t,r),o},setToMin:function(t,n){var e=Xy(n)
Xx(t,Yx(e))},setToMax:function(t,n){var e=Jy(n)
Xx(t,Yx(e))},findValueOfOffset:qx,getValueFromEvent:function(t){return Wy(t).map((function(t){return t.top}))},findPositionOfValue:Jx,setPositionFromValue:function(t,n,e,o){var r=mx(e),i=Jx(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=Wi(n.element)/2
ki(n.element,"top",i-u+"px")},onLeft:$x,onRight:Qx,onUp:Zx,onDown:tw,edgeActions:nw}),ow=function(t,n){Do(t,Uy(),{value:n})},rw=function(t,n){return{x:t,y:n}},iw=function(t,n){return function(e,o){return i=e,u=o,a=0<t?yx:bx,c=(r=n)?mx(u).x:a(mx(u).x,Gy(u),Ky(u),rx(u)),s=r?a(mx(u).y,Xy(u),Jy(u),rx(u)):mx(u).y,ow(i,rw(c,s)),w.some(c).map((function(){return!0}))
var r,i,u,a,c,s}},uw=Wy,aw=iw(-1,!1),cw=iw(1,!1),sw=iw(-1,!0),lw=iw(1,!0),fw={"top-left":w.some((function(t,n){vx(t,hx(Yy(n),qy(n)))})),top:w.some((function(t,n){vx(t,hx(ex(n),qy(n)))})),"top-right":w.some((function(t,n){vx(t,hx($y(n),qy(n)))})),right:w.some((function(t,n){vx(t,hx($y(n),ox(n)))})),"bottom-right":w.some((function(t,n){vx(t,hx($y(n),Qy(n)))})),bottom:w.some((function(t,n){vx(t,hx(ex(n),Qy(n)))})),"bottom-left":w.some((function(t,n){vx(t,hx(Yy(n),Qy(n)))})),left:w.some((function(t,n){vx(t,hx(Yy(n),ox(n)))}))},dw=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=Px(t,n,e.left),r=qx(t,n,e.top),i=rw(o,r)
return ow(t,i),i},setToMin:function(t,n){var e=Gy(n),o=Xy(n)
ow(t,rw(e,o))},setToMax:function(t,n){var e=Ky(n),o=Jy(n)
ow(t,rw(e,o))},getValueFromEvent:uw,setPositionFromValue:function(t,n,e,o){var r=mx(e),i=zx(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=Jx(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=Qi(n.element)/2,c=Wi(n.element)/2
ki(n.element,"left",i-a+"px"),ki(n.element,"top",u-c+"px")},onLeft:aw,onRight:cw,onUp:sw,onDown:lw,edgeActions:fw}),mw=rf({name:"Slider",configFields:[Ln("stepSize",1),Ln("onChange",t),Ln("onChoose",t),Ln("onInit",t),Ln("onDragStart",t),Ln("onDragEnd",t),Ln("snapToGrid",!1),Ln("rounded",!0),Rn("snapStart"),En("model",vn("mode",{x:[Ln("minX",0),Ln("maxX",100),Kn("value",(function(t){return Jn(t.mode.minX)})),Tn("getInitialValue"),ju("manager",Gx)],y:[Ln("minY",0),Ln("maxY",100),Kn("value",(function(t){return Jn(t.mode.minY)})),Tn("getInitialValue"),ju("manager",ew)],xy:[Ln("minX",0),Ln("maxX",100),Ln("minY",0),Ln("maxY",100),Kn("value",(function(t){return Jn({x:t.mode.minX,y:t.mode.minY})})),Tn("getInitialValue"),ju("manager",dw)]})),el("sliderBehaviours",[gm,nl]),Kn("mouseIsDown",(function(){return Jn(!1)}))],partFields:jy,factory:function(t,n,e,o){var r,i=function(n){return Wl(n,t,"thumb")},u=function(n){return Wl(n,t,"spectrum")},a=function(n){return Ul(n,t,"left-edge")},s=function(n){return Ul(n,t,"right-edge")},l=function(n){return Ul(n,t,"top-edge")},f=function(n){return Ul(n,t,"bottom-edge")},d=t.model,m=d.manager,g=function(n,e){m.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:s,getTopEdge:l,getBottomEdge:f,getSpectrum:u})},p=function(n,e){d.value.set(e)
var o=i(n)
return g(n,o),t.onChange(n,o,e),w.some(!0)},h=function(n){var e=t.mouseIsDown.get()
t.mouseIsDown.set(!1),e&&Ul(n,t,"thumb").each((function(e){var o=d.value.get()
t.onChoose(n,e,o)}))},v=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},b=function(n,e){e.stop(),t.onDragEnd(n,i(n)),h(n)}
return{uid:t.uid,dom:t.dom,components:n,behaviours:rl(t.sliderBehaviours,[gm.config({mode:"special",focusIn:function(n){return Ul(n,t,"spectrum").map(gm.focusIn).map(c)}}),nl.config({store:{mode:"manual",getValue:function(t){return d.value.get()}}}),Da.config({channels:((r={})[Hs()]={onReceive:h},r)})]),events:Ho([Lo(Uy(),(function(t,n){p(t,n.event.value)})),qo((function(n,e){var o=d.getInitialValue()
d.value.set(o)
var r=i(n)
g(n,r)
var a=u(n)
t.onInit(n,r,a,d.value.get())})),Lo(Ne(),v),Lo(je(),b),Lo(We(),v),Lo(Ye(),b)]),apis:{resetToMin:function(n){m.setToMin(n,t)},resetToMax:function(n){m.setToMax(n,t)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),gw=[el("formBehaviours",[nl])],pw=function(t){return"<alloy.field."+t+">"},hw=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:rl(t.formBehaviours,[nl.config({store:{mode:"manual",getValue:function(n){var e=Xl(n,t)
return wt(e,(function(t,n){return t().bind((function(t){var e,o
return e=lf.getCurrent(t),o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Br(t.element)),e.fold((function(){return at.error(o)}),at.value)})).map(nl.getValue)}))},setValue:function(n,e){xt(e,(function(e,o){Ul(n,t,o).each((function(t){lf.getCurrent(t).each((function(t){nl.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return Ul(n,t,e).bind(lf.getCurrent)}}}},vw={getField:qr((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n,e=(n=[],{field:function(t,e){return n.push(t),Hl("form",pw(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=L(r,(function(t){return Bl({name:t,pname:pw(t)})}))
return Zl("form",gw,i,hw,o)}},bw=Dr("valid-input"),yw=Dr("invalid-input"),xw=Dr("validating-input"),ww="colorcustom.rgb.",Sw=function(n,e,o,r){var i=function(o,r,i,u,a){var c,s,f=n(ww+"range"),d=[yb.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),yb.parts.field({data:a,factory:Nb,inputAttributes:l({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:Ta([(c=r,s=o,ay.config({invalidClass:e("invalid"),notify:{onValidate:function(t){Do(t,xw,{type:c})},onValid:function(t){Do(t,bw,{type:c,value:nl.getValue(t)})},onInvalid:function(t){Do(t,yw,{type:c,value:nl.getValue(t)})}},validator:{validate:function(t){var e=nl.getValue(t),o=s(e)?at.value(!0):at.error(n("aria.input.invalid"))
return $b(o)},validateOnLoad:!1}})),Sb.config({})]),onSetValue:function(n){ay.isInvalid(n)&&ay.run(n).get(t)}})],m="hex"!==r?[yb.parts["aria-descriptor"]({text:f})]:[]
return{dom:{tag:"div",attributes:{role:"presentation"}},components:d.concat(m)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue
nl.setValue(t,{red:e,green:o,blue:r})},a=wg({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){ki(t.element,"background-color","#"+n.value)}))}
return of({factory:function(){var t={red:Jn(w.some(255)),green:Jn(w.some(255)),blue:Jn(w.some(255)),hex:Jn(w.some("ffffff"))},s=function(n){return t[n].get()},l=function(n,e){t[n].set(e)},f=function(t){var n=t.red,e=t.green,o=t.blue
l("red",w.some(n)),l("green",w.some(e)),l("blue",w.some(o))},d=function(t,n){var e=n.event
"hex"!==e.type?l(e.type,w.none()):r(t)},m=function(t,n){var e=n.event
"hex"===e.type?function(t,n){o(t)
var e=nv(n)
l("hex",w.some(n))
var r=pv(e)
u(t,r),f(r),Do(t,Ay,{hex:e}),c(t,e)}(t,e.value):function(t,n,e){var o=parseInt(e,10)
l(n,w.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return dv(t,n,e,1)}))}))})).each((function(n){var e,o,r=(e=t,o=uv(n),vw.getField(e,"hex").each((function(t){Om.isFocused(t)||nl.setValue(e,{hex:o.value})})),o)
c(t,r)}))}(t,e.type,e.value)},g=function(t){return{label:n(ww+t+".label"),description:n(ww+t+".description")}},p=g("red"),h=g("green"),v=g("blue"),b=g("hex")
return Ft(vw.sketch((function(t){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[t.field("red",yb.sketch(i(mv,"red",p.label,p.description,255))),t.field("green",yb.sketch(i(mv,"green",h.label,h.description,255))),t.field("blue",yb.sketch(i(mv,"blue",v.label,v.description,255))),t.field("hex",yb.sketch(i(rv,"hex",b.label,b.description,"ffffff"))),a.asSpec()],formBehaviours:Ta([ay.config({invalidClass:e("form-invalid")}),xm("rgb-form-events",[Lo(bw,m),Lo(yw,d),Lo(xw,d)])])}})),{apis:{updateHex:function(t,n){var e,o
nl.setValue(t,{hex:n.value}),e=t,o=pv(n),u(e,o),f(o),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},kw=function(n,o){return of({name:"ColourPicker",configFields:[Tn("dom"),Ln("onValidHex",t),Ln("onInvalidHex",t)],factory:function(t){var r,i,u,a,c,s=Sw(n,o,t.onValidHex,t.onInvalidHex),l=function(t,n){var o=mw.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),r=mw.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(t,n){var e,o,r=t.width,i=t.height,u=t.getContext("2d")
null!==u&&(u.fillStyle=n,u.fillRect(0,0,r,i),(e=u.createLinearGradient(0,0,r,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=e,u.fillRect(0,0,r,i),(o=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=o,u.fillRect(0,0,r,i))}
return of({factory:function(t){var u=e({x:0,y:0}),a=Ta([lf.config({find:w.some}),Om.config({})])
return mw.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[o,r],onChange:function(t,n,e){Do(t,Fy,{value:e})},onInit:function(t,n,e,o){i(e.element.dom,vv(bv))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,r
o=e,r=n.components()[0].element.dom,i(r,vv(o))}},extraApis:{}})}(0,o),f={paletteRgba:Jn(bv)},d=wg(l.sketch({})),m=wg(s.sketch({})),g=function(t,n){m.getOpt(t).each((function(t){s.updateHex(t,n)}))},p=function(t,n,e){j(e,(function(e){e(t,n)}))}
return{uid:t.uid,dom:t.dom,components:[d.asSpec(),(u=o,a=mw.parts.spectrum({dom:{tag:"div",classes:[u("hue-slider-spectrum")],attributes:{role:"presentation"}}}),c=mw.parts.thumb({dom:{tag:"div",classes:[u("hue-slider-thumb")],attributes:{role:"presentation"}}}),mw.sketch({dom:{tag:"div",classes:[u("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:e({y:0})},components:[a,c],sliderBehaviours:Ta([Om.config({})]),onChange:function(t,n,e){Do(t,My,{value:e})}})),m.asSpec()],behaviours:Ta([xm("colour-picker-events",[Lo(Fy,(i=[g],function(t,n){var e,o,r,u,a,c,s,l,d,m=n.event.value,g=(u=r=0,a=(e=f.paletteRgba.get()).red/255,c=e.green/255,s=e.blue/255,(l=Math.min(a,Math.min(c,s)))===(d=Math.max(a,Math.max(c,s)))?By(0,0,100*(u=l)):(r=60*((r=a===l?3:s===l?1:5)-(a===l?c-s:s===l?a-c:s-a)/(d-l)),o=(d-l)/d,u=d,By(Math.round(r),Math.round(100*o),Math.round(100*u)))),h=By(g.hue,m.x,100-m.y),v=gv(h),b=uv(v)
p(t,b,i)})),Lo(My,(r=[function(t,n){d.getOpt(t).each((function(t){var e=pv(n)
f.paletteRgba.set(e),l.setRgba(t,e)}))},g],function(t,n){var e,o,i,u=(e=n.event.value.y,o=By((100-e)/100*360,100,100),i=gv(o),uv(i))
p(t,u,r)}))]),lf.config({find:function(t){return m.getOpt(t)}}),gm.config({mode:"acyclic"})])}}})},Cw=function(){return lf.config({find:w.some})},Ow=function(t){return lf.config({find:t.getOpt})},_w=function(t){return lf.config({find:function(n){return dr(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},Tw={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Ew=function(t){return Tw[t]},Bw=tinymce.util.Tools.resolve("tinymce.Resource"),Aw=Zt([Ln("preprocess",o),Ln("postprocess",o)]),Mw=function(t,n,e){return nl.config(Ft({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},Fw=function(t,n){var e=gn("RepresentingConfigs.memento processors",Aw,n)
return nl.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=nl.getValue(o)
return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n)
nl.setValue(i,r)}}})},Dw=Mw,Iw=function(t){return function(t,n,e){return Mw(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))}(t,wr,Sr)},Rw=function(t){return nl.config({store:{mode:"memory",initialValue:t}})},Vw=Dr("alloy-fake-before-tabstop"),Pw=Dr("alloy-fake-after-tabstop"),Hw=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Ta([Om.config({ignore:!0}),Sb.config({})])}},zw=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[Hw([Vw]),t,Hw([Pw])],behaviours:Ta([_w(1)])}},Nw=function(t,n){Do(t,$e(),{raw:{which:9,shiftKey:n}})},Lw=function(t,n){var e=n.element
ci(e,Vw)?Nw(t,!0):ci(e,Pw)&&Nw(t,!1)},jw=function(t){return Qv(t,["."+Vw,"."+Pw].join(","),a)},Uw=!(Be().browser.isIE()||Be().browser.isEdge())
function Ww(t,n){return Yw(document.createElement("canvas"),t,n)}function Gw(t){var n=Ww(t.width,t.height)
return Xw(n).drawImage(t,0,0),n}function Xw(t){return t.getContext("2d")}function Yw(t,n,e){return t.width=n,t.height=e,t}function qw(t){return t.naturalWidth||t.width}function Kw(t){return t.naturalHeight||t.height}var Jw,$w,Qw,Zw,tS=window.Promise?window.Promise:(Jw=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new")
if("function"!=typeof t)throw new TypeError("not a function")
this._state=null,this._value=null,this._deferreds=[],aS(t,nS(oS,this),nS(rS,this))},$w=window,Qw=Jw.immediateFn||"function"==typeof $w.setImmediate&&$w.setImmediate||function(t){setTimeout(t,1)},Zw=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Jw.prototype.catch=function(t){return this.then(null,t)},Jw.prototype.then=function(t,n){var e=this
return new Jw((function(o,r){eS.call(e,new uS(t,n,o,r))}))},Jw.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]
var e=Array.prototype.slice.call(1===t.length&&Zw(t[0])?t[0]:t)
return new Jw((function(t,n){if(0===e.length)return t([])
for(var o=e.length,r=0;r<e.length;r++)!function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then
if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),n)}e[i]=u,0==--o&&t(e)}catch(p){n(p)}}(r,e[r])}))},Jw.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Jw?t:new Jw((function(n){n(t)}))},Jw.reject=function(t){return new Jw((function(n,e){e(t)}))},Jw.race=function(t){return new Jw((function(n,e){for(var o=0,r=t;o<r.length;o++)r[o].then(n,e)}))},Jw)
function nS(t,n){return function(){return t.apply(n,arguments)}}function eS(t){var n=this
null!==this._state?Qw((function(){var e,o=n._state?t.onFulfilled:t.onRejected
if(null!==o){try{e=o(n._value)}catch(g){return void t.reject(g)}t.resolve(e)}else(n._state?t.resolve:t.reject)(n._value)})):this._deferreds.push(t)}function oS(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.")
if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then
if("function"==typeof n)return void aS(nS(n,t),nS(oS,this),nS(rS,this))}this._state=!0,this._value=t,iS.call(this)}catch(g){rS.call(this,g)}}function rS(t){this._state=!1,this._value=t,iS.call(this)}function iS(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t]
eS.call(this,e)}this._deferreds=[]}function uS(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function aS(t,n,e){var o=!1
try{t((function(t){o||(o=!0,n(t))}),(function(t){o||(o=!0,e(t))}))}catch(r){if(o)return
o=!0,e(r)}}function cS(t,n,e){return n=n||"image/png",A(HTMLCanvasElement.prototype.toBlob)?new tS((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):function(t){return new tS((function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0])
if(!e)return w.none()
for(var o=e[1],r=n[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=new Array(a),s=0;s<a;++s){for(var l=1024*s,f=Math.min(1024+l,u),d=new Array(f-l),m=l,g=0;m<f;++g,++m)d[g]=i[m].charCodeAt(0)
c[s]=new Uint8Array(d)}return w.some(new Blob(c,{type:o}))})(t).fold((function(){e("uri is not base64: "+t)}),n)}))}(t.toDataURL(n,e))}function sS(t,n,o){var r=n.type
function i(n,e){return t.then((function(t){return r=e,o=(o=n)||"image/png",t.toDataURL(o,r)
var o,r}))}return{getType:e(r),toBlob:function(){return tS.resolve(n)},toDataURL:e(o),toBase64:function(){return o.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return cS(t,n,e)}))},toAdjustedDataURL:i,toAdjustedBase64:function(t,n){return i(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(Gw)}}}function lS(t,n){return cS(t,n).then((function(n){return sS(tS.resolve(t),n,t.toDataURL())}))}var fS=function(t){return n=t,new tS((function(t){var e=new FileReader
e.onloadend=function(){t(e.result)},e.readAsDataURL(n)})).then((function(n){return sS(function(t){return n=t,new tS((function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)}
function u(){i(),t(r)}function a(){i(),e("Unable to load data of type "+n.type+": "+o)}r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&u()})).then((function(t){var n
n=t,URL.revokeObjectURL(n.src)
var e=Ww(qw(t),Kw(t))
return Xw(e).drawImage(t,0,0),e}))
var n}(t),t,n)}))
var n}
function dS(t,n,e){var o="string"==typeof t?parseFloat(t):t
return e<o?o=e:o<n&&(o=n),o}var mS=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10]
function gS(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i]
for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a]
r[u+5*i]=e}}return r}function pS(t,n){return t.toCanvas().then((function(e){return o=e,r=t.getType(),i=n,a=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_
return t}((u=Xw(o)).getImageData(0,0,o.width,o.height),i),u.putImageData(a,0,0),lS(o,r)
var o,r,i,u,a}))}function hS(t){return function(n,e){return pS(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}}var vS,bS,yS,xS,wS=(vS=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return pS(t,vS)}),SS=hS((function(t,n){return gS(t,[1,0,0,0,n=dS(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),kS=hS((function(t,n){var e
return n=dS(n,-1,1),gS(t,[(e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?mS[n]:mS[Math.floor(n)]*(1-e)+mS[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),CS=(bS=[0,-1,0,-1,5,-1,0,-1,0],function(t){return function(t,n){return t.toCanvas().then((function(e){return o=e,r=t.getType(),i=n,a=function(t,n,e){function o(t,n,e){return e<t?t=e:t<n&&(t=n),t}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h]
d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f)
a[x]=o(d,0,255),a[1+x]=o(m,0,255),a[2+x]=o(g,0,255)}return n}((u=Xw(o)).getImageData(0,0,o.width,o.height),a=u.getImageData(0,0,o.width,o.height),i),u.putImageData(a,0,0),lS(o,r)
var o,r,i,u,a}))}(t,bS)}),OS=(yS=function(t,n){return 255*Math.pow(t/255,1-n)},xS=function(t,n,e){for(var o=Xw(t),r=new Array(256),i=0;i<r.length;i++)r[i]=yS(i,e)
var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]]
return t}(o.getImageData(0,0,t.width,t.height),r)
return o.putImageData(u,0,0),lS(t,n)},function(t,n){return t.toCanvas().then((function(e){return xS(e,t.getType(),n)}))})
function _S(t,n,e){var o=qw(t),r=Kw(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0)
var c,s,l,f=(c=t,s=i,l=u,new tS((function(t){var n=qw(c),e=Kw(c),o=Math.floor(n*s),r=Math.floor(e*l),i=Ww(o,r)
Xw(i).drawImage(c,0,0,n,e,0,0,o,r),t(i)})))
return a?f.then((function(t){return _S(t,n,e)})):f}var TS,ES=function(t){return wS(t)},BS=function(t){return CS(t)},AS=function(t,n){return OS(t,n)},MS=function(t,n){return SS(t,n)},FS=function(t,n){return kS(t,n)},DS=function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=Ww(t.width,t.height),r=Xw(o)
return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),lS(o,n)}(e,t.getType(),n)}))},IS=function(t,n,e,o,r){return t.toCanvas().then((function(i){return u=i,a=t.getType(),c=n,s=e,Xw(l=Ww(o,r)).drawImage(u,-c,-s),lS(l,a)
var u,a,c,s,l}))},RS=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then((function(t){return _S(t,r,i).then((function(t){return lS(t,o.getType())}))}))
var o,r,i},VS=function(t,n){return t.toCanvas().then((function(e){return function(t,n,e){var o=Ww(t.width,t.height),r=Xw(o),i=0,u=0
return 90!==(e=e<0?360+e:e)&&270!==e||Yw(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),lS(o,n)}(e,t.getType(),n)}))},PS=function(t,n){return l({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},HS=function(t,n){return PS(kg(t,n),{})},zS=function(t,n){return PS(kg(t,n),{behaviours:Ta([ym.config({})])})},NS=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Ta([ym.config({})])}},LS=Dr("toolbar.button.execute"),jS=((TS={})[lo()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],TS),US=Dr("update-menu-text"),WS=Dr("update-menu-icon"),GS=function(n,e,o){var i=Jn(t),u=n.text.map((function(t){return wg(NS(t,e,o.providers))})),a=n.icon.map((function(t){return wg(zS(t,o.providers.icons))})),c=function(t,n){var e=nl.getValue(t)
return Om.focus(e),Do(e,"keydown",{raw:n.event.raw}),Cy.close(e),w.some(!0)},s=n.role.fold((function(){return{}}),(function(t){return{role:t}})),f=n.tooltip.fold((function(){return{}}),(function(t){var n=o.providers.translate(t)
return{title:n,"aria-label":n}}))
return wg(Cy.sketch(l(l(l({},n.uid?{uid:n.uid}:{}),s),{dom:{tag:"button",classes:[e,e+"--select"].concat(L(n.classes,(function(t){return e+"--"+t}))),attributes:l({},f)},components:jh([a.map((function(t){return t.asSpec()})),u.map((function(t){return t.asSpec()})),w.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:kg("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Ta(d(n.dropdownBehaviours,[Rh((function(){return n.disabled||o.providers.isReadOnly()})),Dh(),Oy.config({}),ym.config({}),xm("dropdown-events",[zh(n,i),Nh(n,i)]),xm("menubutton-update-display-text",[Lo(US,(function(t,n){u.bind((function(n){return n.getOpt(t)})).each((function(t){ym.set(t,[Pi(o.providers.translate(n.event.text))])}))})),Lo(WS,(function(t,n){a.bind((function(n){return n.getOpt(t)})).each((function(t){ym.set(t,[zS(n.event.icon,o.providers.icons)])}))}))])])),eventOrder:Ft(jS,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Ta([gm.config({mode:"special",onLeft:c,onRight:c})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:xp(0,n.columns,n.presets)},fetch:function(t){return Jb(r(n.fetch,t))}}))).asSpec()},XS=function(t){return"separator"===t.type},YS={type:"separator"},qS=function(t,n){var e=function(t,n){var e=X(t,(function(t,e){return C(e)?""===e?t:"|"===e?0<t.length&&!XS(t[t.length-1])?t.concat([YS]):t:Tt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[])
return 0<e.length&&XS(e[e.length-1])&&e.pop(),e}(C(t)?t.split(" "):t,n)
return G(e,(function(t,e){var o=function(t,n){return Tt(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=qS(r,o),{item:e,menus:Ft(i.menus,jt(e.value,i.items)),expansions:Ft(i.expansions,jt(e.value,e.value))}):{item:t,menus:{},expansions:{}}
var e,o,r,i}(function(t){if(XS(t))return t
var n=_t(t,"value").getOrThunk((function(){return Dr("generated-menu-item")}))
return Ft({value:n},t)}(e),n)
return{menus:Ft(t.menus,o.menus),items:[o.item].concat(t.items),expansions:Ft(t.expansions,o.expansions)}}),{menus:{},expansions:{},items:[]})},KS=function(t,n,e,o){var r=Dr("primary-menu"),i=qS(t,e.shared.providers.menuItems())
if(0===i.items.length)return w.none()
var u=Gv(r,i.items,n,e,o),a=wt(i.menus,(function(t,o){return Gv(o,t,n,e,!1)})),c=Ft(a,jt(r,u))
return w.from(ug.tieredData(r,c,i.expansions))},JS=function(t){return{isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)},setActive:function(n){var e=t.element
n?(ui(e,"tox-tbtn--enabled"),Cr(e,"aria-pressed",!0)):(ai(e,"tox-tbtn--enabled"),Er(e,"aria-pressed"))},isActive:function(){return ci(t.element,"tox-tbtn--enabled")}}},$S=function(t,n,e,o){return GS({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(KS(t,ap.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:JS,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Sb.config({})]},n,e.shared)},QS=function(t,n,e){return function(o){o(L(t,(function(t){var o,r,i=t.text.fold((function(){return{}}),(function(t){return{text:t}}))
return l(l({type:t.type,active:!1},i),{onAction:function(t){var o=!t.isActive()
t.setActive(o),r.storage.set(o),e.shared.getSink().each((function(t){n().getOpt(t).each((function(t){Ra(t.element),Do(t,Ab,{name:r.name,value:r.storage.get()})}))}))},onSetup:(o=r=t,function(t){t.setActive(o.storage.get())})})})))}},ZS=function(t,n,e,o,r,i){void 0===e&&(e=[])
var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=l({buttonBehaviours:Ta([Rh((function(){return t.disabled||i.isReadOnly()})),Dh(),Sb.config({}),xm("button press",[No("click"),No("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=Ft(a,{dom:o})
return Ft(c,{components:r})},tk=function(t,n,e,o){void 0===o&&(o=[])
var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return HS(t,e.icons)})),u=jh([i])
return ZS(t,n,o,r,u,e)},nk=function(t,n,e,o){void 0===o&&(o=[])
var r=tk(t,w.some(n),e,o)
return xg.sketch(r)},ek=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[])
var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return HS(t,e.icons)})):w.none(),a=u.isSome()?jh([u]):[],c=u.isSome()?{}:{innerHtml:i},s=d(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],r),f=l(l({tag:"button",classes:s},c),{attributes:{title:i}})
return ZS(t,n,o,f,a,e)},ok=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[])
var i=ek(t,w.some(n),e,o,r)
return xg.sketch(i)},rk=function(t,n){return function(e){"custom"===n?Do(e,Ab,{name:t,value:{}}):"submit"===n?Fo(e,Mb):"cancel"===n?Fo(e,Bb):console.error("Unknown button type: ",n)}},ik=function(n,e,o){if("menu"===e){var r=n,i=l(l({},n),{onSetup:function(e){return e.setDisabled(n.disabled),t},fetch:QS(r.items,(function(){return u}),o)}),u=wg($S(i,"tox-tbtn",o,w.none()))
return u.asSpec()}if("custom"===(s=e)||"cancel"===s||"submit"===s){var a=rk(n.name,e),c=l(l({},n),{borderless:!1})
return ok(c,a,o.shared.providers,[])}var s
console.error("Unknown footer button type: ",e)},uk=e([Ln("field1Name","field1"),Ln("field2Name","field2"),Nu("onLockedChange"),Vu(["lockClass"]),Ln("locked",!1),il("coupledFieldBehaviours",[lf,nl])]),ak=function(t,n){return Bl({factory:yb,name:t,overrides:function(t){return{fieldBehaviours:Ta([xm("coupled-input-behaviour",[Lo(Ze(),(function(e){Ul(e,t,n).bind(lf.getCurrent).each((function(n){Ul(e,t,"lock").each((function(o){Pm.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},ck=e([ak("field1","field2"),ak("field2","field1"),Bl({factory:xg,schema:[Tn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Ta([Pm.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),sk=rf({name:"FormCoupledInputs",configFields:uk(),partFields:ck(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:ul(t.coupledFieldBehaviours,[lf.config({find:w.some}),nl.config({store:{mode:"manual",getValue:function(n){var e=ql(n,t,["field1","field2"]),o={}
return o[t.field1Name]=nl.getValue(e.field1()),o[t.field2Name]=nl.getValue(e.field2()),o},setValue:function(n,e){var o=ql(n,t,["field1","field2"])
Et(e,t.field1Name)&&nl.setValue(o.field1(),e[t.field1Name]),Et(e,t.field2Name)&&nl.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return Ul(n,t,"field1")},getField2:function(n){return Ul(n,t,"field2")},getLock:function(n){return Ul(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),lk=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t)
if(null===n)return at.error(t)
var e=parseFloat(n[1]),o=n[2]
return at.value({value:e,unit:o})},fk=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)}
return t.unit===n?w.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?w.some(t.value):w.some(t.value/e[t.unit]*e[n]):w.none()},dk=function(t){return w.none()},mk=function(t,n){var e=dk,o=Dr("ratio-event"),r=sk.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:kg("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:kg("unlock",n.icons)}}],buttonBehaviours:Ta([ih.config({disabled:function(){return t.disabled||n.isReadOnly()}}),Dh(),Sb.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return yb.parts.field({factory:Nb,inputClasses:["tox-textfield"],inputBehaviours:Ta([ih.config({disabled:function(){return t.disabled||n.isReadOnly()}}),Dh(),Sb.config({}),xm("size-input-events",[Lo(Ke(),(function(t,n){Do(t,o,{isField1:e})})),Lo(to(),(function(n,e){Do(n,Tb,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=sk.parts.field1(i([yb.parts.label(a("Width")),u(!0)])),s=sk.parts.field2(i([yb.parts.label(a("Height")),u(!1)]))
return sk.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){lk(nl.getValue(t)).each((function(t){e(t).each((function(t){var e,o,r,i
nl.setValue(n,(r={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},-1!==(i=(e=t).value.toFixed((o=e.unit)in r?r[o]:1)).indexOf(".")&&(i=i.replace(/\.?0*$/,"")),i+e.unit))}))}))},coupledFieldBehaviours:Ta([ih.config({disabled:function(){return t.disabled||n.isReadOnly()},onDisabled:function(t){sk.getField1(t).bind(yb.getField).each(ih.disable),sk.getField2(t).bind(yb.getField).each(ih.disable),sk.getLock(t).each(ih.disable)},onEnabled:function(t){sk.getField1(t).bind(yb.getField).each(ih.enable),sk.getField2(t).bind(yb.getField).each(ih.enable),sk.getLock(t).each(ih.enable)}}),Dh(),xm("size-input-events2",[Lo(o,(function(t,n){var o=n.event.isField1,r=o?sk.getField1(t):sk.getField2(t),i=o?sk.getField2(t):sk.getField1(t),u=r.map(nl.getValue).getOr(""),a=i.map(nl.getValue).getOr("")
e=function(t,n){var e,o,r,i=lk(t).toOptional()
return o=lk(n).toOptional(),r=function(t,n){return fk(t,n.unit).map((function(t){return n.value/t})).map((function(t){return e=t,o=n.unit,function(t){return fk(t,o).map((function(t){return{value:t*e,unit:o}}))}
var e,o})).getOr(dk)},((e=i).isSome()&&o.isSome()?w.some(r(e.getOrDie(),o.getOrDie())):w.none()).getOr(dk)}(u,a)}))])])})},gk={undo:e(Dr("undo")),redo:e(Dr("redo")),zoom:e(Dr("zoom")),back:e(Dr("back")),apply:e(Dr("apply")),swap:e(Dr("swap")),transform:e(Dr("transform")),tempTransform:e(Dr("temp-transform")),transformApply:e(Dr("transform-apply"))},pk=e("save-state"),hk=e("disable"),vk=e("enable"),bk={formActionEvent:Ab,saveState:pk,disable:hk,enable:vk},yk=function(n,o){var r=function(t,n,e,r){return wg(ok({name:t,text:t,disabled:e,primary:r,icon:w.none(),borderless:!1},n,o))},i=function(t,n,e,r){return wg(nk({name:t,icon:w.some(t),tooltip:w.some(n),disabled:r,primary:!1,borderless:!1},e,o))},u=function(t,n){t.map((function(t){var e=t.get(n)
e.hasConfigured(ih)&&ih.disable(e)}))},a=function(t,n){t.map((function(t){var e=t.get(n)
e.hasConfigured(ih)&&ih.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=t,l=function(t,n,e){Do(t,n,e)},f=function(t){return Fo(t,bk.disable())},d=function(t){return Fo(t,bk.enable())},m=function(t,n){f(t),l(t,gk.transform(),{transform:n}),d(t)},g=function(t){return function(){Q.getOpt(t).each((function(t){ym.set(t,[J])}))}},p=function(t,n){f(t),l(t,gk.transformApply(),{transform:n,swap:g(t)}),d(t)},h=function(){return r("Back",(function(t){return l(t,gk.back(),{swap:g(t)})}),!1,!1)},v=function(){return wg({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Ta([ih.config({})])})},b=function(){return r("Apply",(function(t){return l(t,gk.apply(),{swap:g(t)})}),!0,!0)},y=[h(),v(),r("Apply",(function(t){p(t,(function(t){var e=n.getRect()
return IS(t,e.x,e.y,e.w,e.h)})),n.hideCrop()}),!1,!0)],x=pb.sketch({dom:c,components:y.map((function(t){return t.asSpec()})),containerBehaviours:Ta([xm("image-tools-crop-buttons-events",[Lo(bk.disable(),(function(t,n){u(y,t)})),Lo(bk.enable(),(function(t,n){a(y,t)}))])])}),S=wg(mk({name:"size",label:w.none(),constrain:!0,disabled:!1},o)),k=[h(),v(),S,v(),r("Apply",(function(t){S.getOpt(t).each((function(n){var e,o,r=nl.getValue(n),i=parseInt(r.width,10),u=parseInt(r.height,10),a=(e=i,o=u,function(t){return RS(t,e,o)})
p(t,a)}))}),!1,!0)],C=pb.sketch({dom:c,components:k.map((function(t){return t.asSpec()})),containerBehaviours:Ta([xm("image-tools-resize-buttons-events",[Lo(bk.disable(),(function(t,n){u(k,t)})),Lo(bk.enable(),(function(t,n){a(k,t)}))])])}),O=function(t,n){return function(e){return t(e,n)}},_=O(DS,"h"),T=O(DS,"v"),E=O(VS,-90),B=O(VS,90),A=function(t,n){var e,o
o=n,f(e=t),l(e,gk.tempTransform(),{transform:o}),d(e)},M=[h(),v(),i("flip-horizontally","Flip horizontally",(function(t){A(t,_)}),!1),i("flip-vertically","Flip vertically",(function(t){A(t,T)}),!1),i("rotate-left","Rotate counterclockwise",(function(t){A(t,E)}),!1),i("rotate-right","Rotate clockwise",(function(t){A(t,B)}),!1),v(),b()],F=pb.sketch({dom:c,components:M.map((function(t){return t.asSpec()})),containerBehaviours:Ta([xm("image-tools-fliprotate-buttons-events",[Lo(bk.disable(),(function(t,n){u(M,t)})),Lo(bk.enable(),(function(t,n){a(M,t)}))])])}),D=function(t,n,r,i,u){var a=mw.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:o.translate(t)}}),c=mw.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=mw.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}})
return wg(mw.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:e({x:i})},components:[a,c,s],sliderBehaviours:Ta([Om.config({})]),onChoose:n}))},I=function(t,n,e,o,r){var i=function(t,n,e,o,r){return[h(),(i=n,D(t,(function(t,n,e){var o=O(i,e.x/100)
m(t,o)}),e,o,r)),b()]
var i}(t,n,e,o,r)
return pb.sketch({dom:c,components:i.map((function(t){return t.asSpec()})),containerBehaviours:Ta([xm("image-tools-filter-panel-buttons-events",[Lo(bk.disable(),(function(t,n){u(i,t)})),Lo(bk.enable(),(function(t,n){a(i,t)}))])])})},R=[h(),v(),b()],V=pb.sketch({dom:c,components:R.map((function(t){return t.asSpec()}))}),P=I("Brightness",MS,-100,0,100),H=I("Contrast",FS,-100,0,100),z=I("Gamma",AS,-100,0,100),N=function(t){return D(t,(function(t,n,e){var o=L.getOpt(t),r=U.getOpt(t),i=j.getOpt(t)
o.each((function(n){r.each((function(e){i.each((function(o){var r,i,u,a=nl.getValue(n).x/100,c=nl.getValue(o).x/100,s=nl.getValue(e).x/100,l=(r=a,i=c,u=s,function(t){return function(t,n,e,o){return pS(t,(r=e,i=o,gS([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],[dS(n,0,2),0,0,0,0,0,r=dS(r,0,2),0,0,0,0,0,i=dS(i,0,2),0,0,0,0,0,1,0,0,0,0,0,1])))
var r,i}(t,r,i,u)})
m(t,l)}))}))}))}),0,100,200)},L=N("R"),j=N("G"),U=N("B"),W=[h(),L,j,U,b()],G=pb.sketch({dom:c,components:W.map((function(t){return t.asSpec()}))}),X=function(t,n,e){return function(o){l(o,gk.swap(),{transform:n,swap:function(){Q.getOpt(o).each((function(n){ym.set(n,[t]),e(n)}))}})}},Y=w.some(BS),q=w.some(ES),K=[i("crop","Crop",X(x,w.none(),(function(t){n.showCrop()})),!1),i("resize","Resize",X(C,w.none(),(function(t){S.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height
nl.setValue(t,{width:o,height:r})}))})),!1),i("orientation","Orientation",X(F,w.none(),s),!1),i("brightness","Brightness",X(P,w.none(),s),!1),i("sharpen","Sharpen",X(V,Y,s),!1),i("contrast","Contrast",X(H,w.none(),s),!1),i("color-levels","Color levels",X(G,w.none(),s),!1),i("gamma","Gamma",X(z,w.none(),s),!1),i("invert","Invert",X(V,q,s),!1)],J=pb.sketch({dom:c,components:K.map((function(t){return t.asSpec()}))}),$=pb.sketch({dom:{tag:"div"},components:[J],containerBehaviours:Ta([ym.config({})])}),Q=wg($)
return{memContainer:Q,getApplyButton:function(t){return Q.getOpt(t).map((function(t){var n=t.components()[0]
return n.components()[n.components().length-1]}))}}},xk=tinymce.util.Tools.resolve("tinymce.geom.Rect"),wk=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),Sk=tinymce.util.Tools.resolve("tinymce.util.Observable"),kk=tinymce.util.Tools.resolve("tinymce.util.Tools"),Ck=tinymce.util.Tools.resolve("tinymce.util.VK")
function Ok(t){var n,e
if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function _k(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(Ok(t),t.button!==o)return s(t)
t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function(t){Ok(t),wk(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),n.stop&&n.stop(t)}
this.destroy=function(){wk(a).off()},wk(a).on("mousedown touchstart",(function(t){var l,f,d,m,g,p,h,v,b,y,x=(l=u,f=Math.max,d=l.documentElement,m=l.body,g=f(d.scrollWidth,m.scrollWidth),p=f(d.clientWidth,m.clientWidth),h=f(d.offsetWidth,m.offsetWidth),v=f(d.scrollHeight,m.scrollHeight),b=f(d.clientHeight,m.clientHeight),{width:g<h?p:g,height:v<f(d.offsetHeight,m.offsetHeight)?b:v})
Ok(t),t.preventDefault(),o=t.button
var w=a
r=t.screenX,i=t.screenY,y=window.getComputedStyle?window.getComputedStyle(w,null).getPropertyValue("cursor"):w.runtimeStyle.cursor,e=wk("<div></div>").css({position:"absolute",top:0,left:0,width:x.width,height:x.height,zIndex:2147483647,opacity:1e-4,cursor:y}).appendTo(u.body),wk(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)}))}var Tk=0,Ek=function(t){var n=wg({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Jn(1),o=Jn(w.none()),r=Jn({x:0,y:0,w:1,h:1}),i=Jn({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each((function(t){var u=e.get(),a=Qi(t.element),c=Wi(t.element),s=i.dom.naturalWidth*u,l=i.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"}
Ci(i,m),n.getOpt(t).each((function(t){Ci(t.element,m)})),o.get().each((function(t){var n=r.get()
t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){var o,a=Zn("img")
return Cr(a,"src",n),o=a.dom,new Pg((function(t){var n=function(){o.removeEventListener("load",n),t(o)}
o.complete?t(o):o.addEventListener("load",n)})).then((function(){return s.getOpt(t).map((function(t){var n=Hi({element:a})
ym.replaceAt(t,1,w.some(n))
var o=i.get(),c={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight}
i.set(c)
var l,f,d=xk.inflate(c,-20,-20)
return r.set(d),o.w===c.w&&o.h===c.h||(l=t,f=a,s.getOpt(l).each((function(t){var n=Qi(t.element),o=Wi(t.element),r=f.dom.naturalWidth,i=f.dom.naturalHeight,u=Math.min(n/r,o/i)
1<=u?e.set(1):e.set(u)}))),u(t,a),a}))}))},c=pb.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:Ta([xm("image-panel-crop-events",[qo((function(t){s.getOpt(t).each((function(t){var n=function(t,n,e,o,r){var i,u="tox-",a="tox-crid-"+Tk++,c=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],s=["top","right","bottom","left"],l=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}}
function f(n,o,r,i){var u,a=o.x,c=o.y,s=o.w,f=o.h
a+=r*n.deltaX,c+=i*n.deltaY,(s+=r*n.deltaW)<20&&(s=20),(f+=i*n.deltaH)<20&&(f=20),u=t=xk.clamp({x:a,y:c,w:s,h:f},e,"move"===n.name),u=l(e,u),p.fire("updateRect",{rect:u}),g(u)}function d(t){function e(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),wk("#"+a+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}kk.each(c,(function(n){wk("#"+a+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function m(n){d(t=n)}function g(t){m(function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}}(e,t))}wk('<div id="'+a+'" class="'+u+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),kk.each(s,(function(t){wk("#"+a,o).append('<div id="'+a+"-"+t+'"class="'+u+'croprect-block" style="display: none" data-mce-bogus="all">')})),kk.each(c,(function(t){wk("#"+a,o).append('<div id="'+a+"-"+t.name+'" class="'+u+"croprect-handle "+u+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),i=kk.map(c,(function(n){var e
return new _k(a,{document:o.ownerDocument,handle:a+"-"+n.name,start:function(){e=t},drag:function(t){f(n,e,t.deltaX,t.deltaY)}})})),d(t),wk(o).on("focusin focusout",(function(t){wk(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),wk(o).on("keydown",(function(n){var e
function o(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),f(e,o,r,i)}switch(kk.each(c,(function(t){if(n.target.id===a+"-"+t.name)return e=t,!1})),n.keyCode){case Ck.LEFT:o(n,0,t,-10,0)
break
case Ck.RIGHT:o(n,0,t,10,0)
break
case Ck.UP:o(n,0,t,0,-10)
break
case Ck.DOWN:o(n,0,t,0,10)
break
case Ck.ENTER:case Ck.SPACEBAR:n.preventDefault(),r()}}))
var p=kk.extend({toggleVisibility:function(t){var n=kk.map(c,(function(t){return"#"+a+"-"+t.name})).concat(kk.map(s,(function(t){return"#"+a+"-"+t}))).join(",")
t?wk(n,o).show():wk(n,o).hide()},setClampRect:function(n){e=n,d(t)},setRect:m,getInnerRect:function(){return l(e,t)},setInnerRect:g,setViewPortRect:function(e){n=e,d(t)},destroy:function(){kk.each(i,(function(t){t.destroy()})),i=[]}},Sk)
return p}({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t.element.dom,(function(){}))
n.toggleVisibility(!1),n.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)}
r.set(i)})),o.set(w.some(n))}))}))])])}],containerBehaviours:Ta([ym.config({}),xm("image-panel-events",[qo((function(n){a(n,t)}))])])}),s=wg(c)
return{memContainer:s,updateSrc:a,zoom:function(t,n){var o=e.get(),r=0<n?Math.min(2,o+.1):Math.max(.1,o-.1)
e.set(r),s.getOpt(t).each((function(t){var n=t.components()[1].element
u(t,n)}))},showCrop:function(){o.get().each((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){o.get().each((function(t){t.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get()
return{width:t.w,height:t.h}}}},Bk=function(t,n,e,o,r){return nk({name:t,icon:w.some(n),disabled:e,tooltip:w.some(t),primary:!1,borderless:!1},o,r)},Ak=function(t,n){n?ih.enable(t):ih.disable(t)}
var Mk,Fk,Dk,Ik=function(n,e){var o,r,i,u=function(t){var n=Jn(t),e=Jn(w.none()),o=function(){var t=[],n=-1
function e(){return 0<n}function o(){return-1!==n&&n<t.length-1}return{data:t,add:function(e){var o=t.splice(++n)
return t.push(e),{state:e,removed:o}},undo:function(){if(e())return t[--n]},redo:function(){if(o())return t[++n]},canUndo:e,canRedo:o}}()
o.add(t)
var r=function(t){n.set(t)},i=function(t){return{blob:t,url:URL.createObjectURL(t)}},u=function(t){URL.revokeObjectURL(t.url)},a=function(){e.get().each(u),e.set(w.none())},c=function(t){var n,e=i(t)
return r(e),n=o.add(e).removed,kk.each(n,u),e.url}
return{getBlobState:function(){return n.get()},setBlobState:r,addBlobState:c,getTempState:function(){return e.get().fold((function(){return n.get()}),(function(t){return t}))},updateTempState:function(t){var n=i(t)
return a(),e.set(w.some(n)),n.url},addTempState:function(t){var n=i(t)
return e.set(w.some(n)),n.url},applyTempState:function(t){return e.get().fold((function(){}),(function(n){c(n.blob),t()}))},destroyTempState:a,undo:function(){var t=o.undo()
return r(t),t.url},redo:function(){var t=o.redo()
return r(t),t.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}}(n.currentState),a=function(t){var n=u.getHistoryStates()
h.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Do(t,bk.formActionEvent,{name:bk.saveState(),value:n.undoEnabled})},c=function(t){return t.toBlob()},s=function(t){Do(t,bk.formActionEvent,{name:bk.disable(),value:{}})},l=function(t){v.getApplyButton(t).each((function(t){ih.enable(t)})),Do(t,bk.formActionEvent,{name:bk.enable(),value:{}})},f=function(t,n){return s(t),p.updateSrc(t,n)},d=function(t,n,e,o,r){return s(t),fS(n).then(e).then(c).then(o).then((function(n){return f(t,n).then((function(n){return a(t),r(),l(t),n}))})).catch((function(n){return console.log(n),l(t),n}))},m=function(t,n,e){var o=u.getBlobState().blob
d(t,o,n,(function(t){return u.updateTempState(t)}),e)},g=function(t){var n=u.getBlobState().url
return u.destroyTempState(),a(t),n},p=Ek(n.currentState.url),h=(r=wg(Bk("Undo","undo",!0,(function(t){Do(t,gk.undo(),{direction:1})}),o=e)),i=wg(Bk("Redo","redo",!0,(function(t){Do(t,gk.redo(),{direction:1})}),o)),{container:pb.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[r.asSpec(),i.asSpec(),Bk("Zoom in","zoom-in",!1,(function(t){Do(t,gk.zoom(),{direction:1})}),o),Bk("Zoom out","zoom-out",!1,(function(t){Do(t,gk.zoom(),{direction:-1})}),o)]}),updateButtonUndoStates:function(t,n,e){r.getOpt(t).each((function(t){Ak(t,n)})),i.getOpt(t).each((function(t){Ak(t,e)}))}}),v=yk(p,e)
return{dom:{tag:"div",attributes:{role:"presentation"}},components:[v.memContainer.asSpec(),p.memContainer.asSpec(),h.container],behaviours:Ta([nl.config({store:{mode:"manual",getValue:function(){return u.getBlobState()}}}),xm("image-tools-events",[Lo(gk.undo(),(function(t,n){var e=u.undo()
f(t,e).then((function(n){l(t),a(t)}))})),Lo(gk.redo(),(function(t,n){var e=u.redo()
f(t,e).then((function(n){l(t),a(t)}))})),Lo(gk.zoom(),(function(t,n){var e=n.event.direction
p.zoom(t,e)})),Lo(gk.back(),(function(t,n){var e,o
o=g(e=t),f(e,o).then((function(t){l(e)})),(0,n.event.swap)(),p.hideCrop()})),Lo(gk.apply(),(function(t,n){u.applyTempState((function(){g(t),(0,n.event.swap)()}))})),Lo(gk.transform(),(function(n,e){return m(n,e.event.transform,t)})),Lo(gk.tempTransform(),(function(n,e){return o=n,r=e.event.transform,i=u.getTempState().blob,void d(o,i,r,(function(t){return u.addTempState(t)}),t)
var o,r,i})),Lo(gk.transformApply(),(function(t,n){return e=t,o=n.event.transform,r=n.event.swap,i=u.getBlobState().blob,void d(e,i,o,(function(t){var n=u.addBlobState(t)
return g(e),n}),r)
var e,o,r,i})),Lo(gk.swap(),(function(t,n){var e
e=t,h.updateButtonUndoStates(e,!1,!1)
var o=n.event.transform,r=n.event.swap
o.fold((function(){r()}),(function(n){m(t,n,r)}))}))]),Cw()])}},Rk=function(t){return!Tt(t,"items")},Vk="data-value",Pk=function(t,n,e,o){return L(e,(function(e){return Rk(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){nl.setValue(t,e.value),Do(t,Tb,{name:n}),Om.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return Pk(t,n,e.items,o)}}}))},Hk=function(t,n){return rt(t,(function(t){return Rk(t)?(e=t,t.value===n?w.some(e):w.none()):Hk(t.items,n)
var e}))},zk=of({name:"HtmlSelect",configFields:[Tn("options"),el("selectBehaviours",[Om,nl]),Ln("selectClasses",[]),Ln("selectAttributes",{}),Rn("data")],factory:function(t,n){var e=L(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return jt("initialValue",t)})).getOr({})
return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:rl(t.selectBehaviours,[Om.config({}),nl.config({store:l({mode:"manual",getValue:function(t){return Fi(t.element)},setValue:function(n,e){Y(t.options,(function(t){return t.value===e})).isSome()&&Di(n.element,e)}},o)})])}}}),Nk=function(t,n){var o=t.label.map((function(t){return _b(t,n)})),r=[ih.config({disabled:function(){return t.disabled||n.isReadOnly()}}),Dh(),gm.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Fo(t,Mb),w.some(!0)}}),xm("textfield-change",[Lo(Ze(),(function(n,e){Do(n,Tb,{name:t.name})})),Lo(co(),(function(n,e){Do(n,Tb,{name:t.name})}))]),Sb.config({})],i=t.validation.map((function(t){return ay.config({getRoot:function(t){return cr(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=nl.getValue(n),o=t.validator(e)
return $b(!0===o?at.value(e):at.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),u=t.placeholder.fold(e({}),(function(t){return{placeholder:n.translate(t)}})),a=t.inputMode.fold(e({}),(function(t){return{inputmode:t}})),c=l(l({},u),a),s=yb.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:c,inputClasses:[t.classname],inputBehaviours:Ta(K([r,i])),selectOnFocus:!1,factory:Nb}),f=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),d=[ih.config({disabled:function(){return t.disabled||n.isReadOnly()},onDisabled:function(t){yb.getField(t).each(ih.disable)},onEnabled:function(t){yb.getField(t).each(ih.enable)}}),Dh()]
return kb(o,s,f,d)},Lk=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n)
return Ho([Lo(t.event,e),Ko((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Lo(t,(function(){return n.cancel()}))]})).getOr([])))}}),jk=function(t){var n=Jn(null)
return Jr({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get()
null!==t&&t.cancel()}})},Uk=Object.freeze({__proto__:null,throttle:jk,init:function(t){return t.stream.streams.state(t)}}),Wk=[En("stream",vn("mode",{throttle:[Tn("delay"),Ln("stopEvent",!0),ju("streams",{setup:function(t,n){var e=t.stream,o=Eg(t.onStream,e.delay)
return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:jk})]})),Ln("event","input"),Rn("cancelEvent"),Nu("onStream")],Gk=Ba({fields:Wk,name:"streaming",active:Lk,state:Uk}),Xk=function(t,n,e){var o=nl.getValue(e)
nl.setValue(n,o),qk(n)},Yk=function(t,n){var e=t.element,o=Fi(e),r=e.dom
"number"!==Or(e,"type")&&n(r,o)},qk=function(t){Yk(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},Kk=e("alloy.typeahead.itemexecute"),Jk=e([Rn("lazySink"),Tn("fetch"),Ln("minChars",5),Ln("responseTime",1e3),Hu("onOpen"),Ln("getHotspot",w.some),Ln("getAnchorOverrides",e({})),Ln("layouts",w.none()),Ln("eventOrder",{}),qn("model",{},[Ln("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),Ln("selectsOver",!0),Ln("populateFromBrowse",!0)]),Hu("onSetValue"),zu("onExecute"),Hu("onItemExecute"),Ln("inputClasses",[]),Ln("inputAttributes",{}),Ln("inputStyles",{}),Ln("matchWidth",!0),Ln("useMinWidth",!1),Ln("dismissOnBlur",!0),Vu(["openClass"]),Rn("initialData"),el("typeaheadBehaviours",[Om,nl,Gk,gm,Pm,ly]),Kn("previewing",(function(){return Jn(!0)}))].concat(Pb()).concat(wy())),$k=e([Al({schema:[Ru()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){(function(t,n,e){if(t.selectsOver){var o=nl.getValue(n),r=t.getDisplayText(o),i=nl.getValue(e)
return 0===t.getDisplayText(i).indexOf(r)?w.some((function(){var t,o
Xk(0,n,e),t=n,o=r.length,Yk(t,(function(t,n){return t.setSelectionRange(o,n.length)}))})):w.none()}return w.none()})(t.model,o,e).fold((function(){return xf.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&Xk(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Do(t,Kk(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&Xk(t.model,n,e)}))}}}})]),Qk=rf({name:"Typeahead",configFields:Jk(),partFields:$k(),factory:function(n,e,o,r){var i=function(e,o,i){n.previewing.set(!1)
var u=ly.getCoupled(e,"sandbox")
Rs.isOpen(u)?lf.getCurrent(u).each((function(t){xf.getHighlighted(t).fold((function(){i(t)}),(function(){Po(u,t.element,"keydown",o)}))})):gy(n,a(e),e,u,r,(function(t){lf.getCurrent(t).each(i)}),Ub.HighlightFirst).get(t)},u=Hb(n),a=function(t){return function(n){return n.map((function(n){var e=Ot(n.menus),o=J(e,(function(t){return W(t.items,(function(t){return"item"===t.type}))}))
return nl.getState(t).update(L(o,(function(t){return t.data}))),n}))}},c=[Om.config({}),nl.config({onSetValue:n.onSetValue,store:l({mode:"dataset",getDataKey:function(t){return Fi(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(t,e){Di(t.element,n.model.getDisplayText(e))}},n.initialData.map((function(t){return jt("initialValue",t)})).getOr({}))}),Gk.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(e,o){var i,u=ly.getCoupled(e,"sandbox")
Om.isFocused(e)&&Fi(e.element).length>=n.minChars&&(i=lf.getCurrent(u).bind((function(t){return xf.getHighlighted(t).map(nl.getValue)})),n.previewing.set(!0),gy(n,a(e),e,u,r,(function(t){lf.getCurrent(u).each((function(t){i.fold((function(){n.model.selectsOver&&xf.highlightFirst(t)}),(function(n){xf.highlightBy(t,(function(t){return nl.getValue(t).value===n.value})),xf.getHighlighted(t).orThunk((function(){return xf.highlightFirst(t),w.none()}))}))}))}),Ub.HighlightFirst).get(t))},cancelEvent:ho()}),gm.config({mode:"special",onDown:function(t,n){return i(t,n,xf.highlightFirst),w.some(!0)},onEscape:function(t){var n=ly.getCoupled(t,"sandbox")
return Rs.isOpen(n)?(Rs.close(n),w.some(!0)):w.none()},onUp:function(t,n){return i(t,n,xf.highlightLast),w.some(!0)},onEnter:function(t){var e=ly.getCoupled(t,"sandbox"),o=Rs.isOpen(e)
if(o&&!n.previewing.get())return lf.getCurrent(e).bind((function(t){return xf.getHighlighted(t)})).map((function(n){return Do(t,Kk(),{item:n}),!0}))
var r=nl.getValue(t)
return Fo(t,ho()),n.onExecute(e,t,r),o&&Rs.close(e),w.some(!0)}}),Pm.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),ly.config({others:{sandbox:function(t){return yy(n,t,{onOpen:function(){return Pm.on(t)},onClose:function(){return Pm.off(t)}})}}}),xm("typeaheadevents",[$o((function(e){var o=t
hy(n,a(e),e,r,o,Ub.HighlightFirst).get(t)})),Lo(Kk(),(function(t,e){var o=ly.getCoupled(t,"sandbox")
Xk(n.model,t,e.event.item),Fo(t,ho()),n.onItemExecute(t,o,e.event.item,nl.getValue(t)),Rs.close(o),qk(t)}))].concat(n.dismissOnBlur?[Lo(ao(),(function(t){var n=ly.getCoupled(t,"sandbox")
Pa(n.element).isNone()&&Rs.close(n)}))]:[]))]
return{uid:n.uid,dom:zb(Ft(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:l(l({},u),rl(n.typeaheadBehaviours,c)),eventOrder:n.eventOrder}}}),Zk=function(t){return l(l({},t),{toCached:function(){return Zk(t.toCached())},bindFuture:function(n){return Zk(t.bind((function(t){return t.fold((function(t){return $b(at.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return Zk(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return Zk(t.map((function(t){return t.map(n)})))},mapError:function(n){return Zk(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return Zk(Jb((function(o){var r=!1,i=setTimeout((function(){r=!0,o(at.error(e()))}),n)
t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},tC=function(t){return Zk(Jb(t))},nC={type:"separator"},eC=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},oC=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:function(){}}},rC=function(t,n){return o=t,e=W(n,(function(t){return t.type===o})),L(e,eC)
var e,o},iC=function(t,n){var e=t.toLowerCase()
return W(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text
return ae(n.toLowerCase(),e)||ae(t.value.toLowerCase(),e)}))},uC=Dr("aria-invalid"),aC=function(n,e,o){var r,i,u,a,c,s=e.shared.providers,f=function(t){var e=nl.getValue(t)
o.addToHistory(e.value,n.filetype)},d=yb.parts.field({factory:Qk,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":uC,type:"url"},minChars:0,responseTime:0,fetch:function(t){var r=function(t,n,e){var o=nl.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value
return e.getLinkInformation().fold((function(){return[]}),(function(n){var o,i,u,a,c=iC(r,(o=e.getHistory(t),L(o,(function(t){return oC(t,t)}))))
return"file"===t?(i=[c,iC(r,rC("header",n.targets)),iC(r,K([(a=n,w.from(a.anchorTop).map((function(t){return oC("<top>",t)})).toArray()),rC("anchor",n.targets),(u=n,w.from(u.anchorBottom).map((function(t){return oC("<bottom>",t)})).toArray())]))],X(i,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(nC,n)}),[])):c}))}(n.filetype,t,o),i=KS(r,ap.BUBBLE_TO_SANDBOX,e,!1)
return $b(i)},getHotspot:function(t){return b.getOpt(t)},onSetValue:function(n,e){n.hasConfigured(ay)&&ay.run(n).get(t)},typeaheadBehaviours:Ta(K([o.getValidationHandler().map((function(t){return ay.config({getRoot:function(t){return cr(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){g.getOpt(t).each((function(t){Cr(t.element,"title",s.translate(n))}))}},validator:{validate:function(e){var o=nl.getValue(e)
return tC((function(e){t({type:n.filetype,url:o.value},(function(t){var n,o
"invalid"===t.status?(n=at.error(t.message),e(n)):(o=at.value(t.message),e(o))}))}))},validateOnLoad:!1}})})).toArray(),[ih.config({disabled:function(){return n.disabled||s.isReadOnly()}}),Sb.config({}),xm("urlinput-events",K(["file"===n.filetype?[Lo(Ze(),(function(t){Do(t,Tb,{name:n.name})}))]:[],[Lo(to(),(function(t){Do(t,Tb,{name:n.name}),f(t)})),Lo(co(),(function(t){Do(t,Tb,{name:n.name}),f(t)}))]]))]])),eventOrder:((r={})[Ze()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:xp(0,0,"normal")},onExecute:function(t,n,e){Do(n,Mb,{})},onItemExecute:function(t,e,o,r){f(t),Do(t,Tb,{name:n.name})}}),m=n.label.map((function(t){return _b(t,s)})),g=wg((i="invalid",u=w.some(uC),void 0===(a="warning")&&(a=i),void 0===c&&(c=i),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+i],innerHtml:kg(a,s.icons),attributes:l({title:s.translate(c),"aria-live":"polite"},u.fold((function(){return{}}),(function(t){return{id:t}})))}})),p=wg({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[g.asSpec()]}),h=o.getUrlPicker(n.filetype),v=Dr("browser.url.event"),b=wg({dom:{tag:"div",classes:["tox-control-wrap"]},components:[d,p.asSpec()],behaviours:Ta([ih.config({disabled:function(){return n.disabled||s.isReadOnly()}})])}),y=wg(ok({name:n.name,icon:w.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(t){return Fo(t,v)}),s,[],["tox-browse-url"]))
return yb.sketch({dom:Ob([]),components:m.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:K([[b.asSpec()],h.map((function(){return y.asSpec()})).toArray()])}]),fieldBehaviours:Ta([ih.config({disabled:function(){return n.disabled||s.isReadOnly()},onDisabled:function(t){yb.getField(t).each(ih.disable),y.getOpt(t).each(ih.disable)},onEnabled:function(t){yb.getField(t).each(ih.enable),y.getOpt(t).each(ih.enable)}}),Dh(),xm("url-input-events",[Lo(v,(function(t){lf.getCurrent(t).each((function(e){var o=nl.getValue(e),r=l({fieldname:n.name},o)
h.each((function(o){o(r).get((function(o){nl.setValue(e,o),Do(t,Tb,{name:n.name})}))}))}))}))])])})},cC=function(t){return function(n,e,o){return _t(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},sC={bar:cC((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:L(e.items,o.interpreter)}
var e,o})),collection:cC((function(t,n){return Vb(t,n.shared.providers)})),alertbanner:cC((function(t,n){return e=t,o=n.shared.providers,pb.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[xg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:kg(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){Do(t,Ab,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]})
var e,o})),input:cC((function(t,n){return e=t,o=n.shared.providers,Nk({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:w.none(),maximized:e.maximized},o)
var e,o})),textarea:cC((function(t,n){return e=t,o=n.shared.providers,Nk({name:e.name,multiline:!0,label:e.label,inputMode:w.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:w.none(),maximized:e.maximized},o)
var e,o})),label:cC((function(t,n){return e=t,r={dom:{tag:"label",innerHtml:(o=n.shared).providers.translate(e.label),classes:["tox-label"]}},i=L(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:Ta([Cw(),ym.config({}),Iw(w.none()),gm.config({mode:"acyclic"})])}
var e,o,r,i})),iframe:(Mk=function(t,n){return function(t,n){var e,o,r=Uw&&t.sandboxed,i=l(l({},t.label.map((function(t){return{title:t}})).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=Jn(""),{getValue:function(t){return o.get()},setValue:function(t,n){var r
e?Cr(t.element,"srcdoc",n):(Cr(t.element,"src","javascript:''"),(r=t.element.dom.contentWindow.document).open(),r.write(n),r.close()),o.set(n)}}),a=t.label.map((function(t){return _b(t,n)})),c=yb.parts.field({factory:{sketch:function(t){return zw({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:Ta([Sb.config({}),Om.config({}),Dw(w.none(),u.getValue,u.setValue)])})}}})
return kb(a,c,["tox-form__group--stretched"],[])}(t,n.shared.providers)},function(t,n,e){var o=Ft(n,{source:"dynamic"})
return cC(Mk)(t,o,e)}),button:cC((function(t,n){return function(t,n){var e,o,r=rk(t.name,"custom")
return e=w.none(),o=yb.parts.field(l({factory:xg},ek(t,w.some(r),n,[Rw(""),Cw()]))),kb(e,o,[],[])}(t,n.shared.providers)})),checkbox:cC((function(t,n){return e=t,r=n.shared.providers,i=nl.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),u=function(t){return t.element.dom.click(),w.some(!0)},a=yb.parts.field({factory:{sketch:o},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Ta([Cw(),ih.config({disabled:function(){return e.disabled||r.isReadOnly()}}),Sb.config({}),Om.config({}),i,gm.config({mode:"special",onEnter:u,onSpace:u,stopSpaceKeyup:!0}),xm("checkbox-events",[Lo(to(),(function(t,n){Do(t,Tb,{name:e.name})}))])])}),c=yb.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:r.translate(e.label)},behaviours:Ta([Oy.config({})])}),l=wg({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(s=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:kg("checked"===t?"selected":"unselected",r.icons)}}})("checked"),s("unchecked")]}),yb.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[a,l.asSpec(),c],fieldBehaviours:Ta([ih.config({disabled:function(){return e.disabled||r.isReadOnly()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){yb.getField(t).each(ih.disable)},onEnabled:function(t){yb.getField(t).each(ih.enable)}}),Dh()])})
var e,r,i,u,a,c,s,l})),colorinput:cC((function(t,n){return function(t,n,e){var o,r,i=yb.parts.field({factory:Nb,inputClasses:["tox-textfield"],onSetValue:function(t){return ay.run(t).get((function(){}))},inputBehaviours:Ta([ih.config({disabled:n.providers.isReadOnly}),Dh(),Sb.config({}),ay.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return cr(t.element)},notify:{onValid:function(t){var n=nl.getValue(t)
Do(t,_y,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=nl.getValue(t)
if(0===n.length)return $b(at.value(!0))
var e=Zn("span")
ki(e,"background-color",n)
var o=Ei(e,"background-color").fold((function(){return at.error("blah")}),(function(t){return at.value(n)}))
return $b(o)}}})]),selectOnFocus:!1}),u=t.label.map((function(t){return _b(t,n.providers)})),a=function(t,n){Do(t,Ty,{value:n})},c=wg((o={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[sa,ca,ma]},onLtr:function(){return[ca,sa,ma]}},components:[],fetch:Mv(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){c.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return Fo(t,Ey)}),(function(n){a(t,n),Tv(n)}))}),"#ffffff"):a(t,"remove"===n?"":n)}))}},r=n,Cy.sketch({dom:o.dom,components:o.components,toggleClass:"mce-active",dropdownBehaviours:Ta([Rh(r.providers.isReadOnly),Dh(),Oy.config({}),Sb.config({})]),layouts:o.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:r.getSink,fetch:function(t){return Jb((function(t){return o.fetch(t)})).map((function(n){return w.from(Xv(Ft(Vv(Dr("menu-value"),n,(function(n){o.onItemAction(t,n)}),o.columns,o.presets,ap.CLOSE_ON_EXECUTE,(function(){return!1}),r.providers),{movement:Hv(o.columns,o.presets)})))}))},parts:{menu:xp(0,0,o.presets)}})))
return yb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[i,c.asSpec()]}]),fieldBehaviours:Ta([xm("form-field-events",[Lo(_y,(function(n,e){c.getOpt(n).each((function(t){ki(t.element,"background-color",e.event.color)})),Do(n,Tb,{name:t.name})})),Lo(Ty,(function(t,n){yb.getField(t).each((function(e){nl.setValue(e,n.event.value),lf.getCurrent(t).each(Om.focus)}))})),Lo(Ey,(function(t,n){yb.getField(t).each((function(n){lf.getCurrent(t).each(Om.focus)}))}))])])})}(t,n.shared,n.colorinput)})),colorpicker:cC((function(t){var n=kw(Ew,(function(t){return"tox-"+t})),e=wg(n.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Do(t,Ab,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Do(t,Ab,{name:"hex-valid",value:!1})}}))
return{dom:{tag:"div"},components:[e.asSpec()],behaviours:Ta([nl.config({store:{mode:"manual",getValue:function(t){var n=e.get(t)
return lf.getCurrent(n).bind((function(t){return nl.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=e.get(t)
lf.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){nl.setValue(t,{hex:w.from(o[1]).getOr("")}),vw.getField(t,"hex").each((function(t){Fo(t,Ze())}))}))}}}),Cw()])}})),dropzone:cC((function(t,n){return function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){j(t,(function(t){t(n,e)}))}},r=function(t,n){var e
ih.isDisabled(t)||(e=n.event.raw,u(t,e.dataTransfer.files))},i=function(t,n){var e=n.event.raw.target
u(t,e.files)},u=function(n,e){var o,r
nl.setValue(n,(o=e,r=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i"),W(ot(o),(function(t){return r.test(t.name)})))),Do(n,Tb,{name:t.name})},a=wg({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Ta([xm("input-file-events",[Xo(no()),Xo(mo())])])}),c=t.label.map((function(t){return _b(t,n)})),s=yb.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Ta([Rw([]),Cw(),ih.config({}),Pm.config({toggleClass:"dragenter",toggleOnExecute:!1}),xm("dropzone-events",[Lo("dragenter",o([e,Pm.toggle])),Lo("dragleave",o([e,Pm.toggle])),Lo("dragover",e),Lo("drop",o([e,r])),Lo(to(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},xg.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:Ta([Sb.config({}),Rh(n.isReadOnly),Dh()])})]}]}}}})
return kb(c,s,["tox-form__group--stretched"],[])}(t,n.shared.providers)})),grid:cC((function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:L(e.items,o.interpreter)}
var e,o})),listbox:cC((function(n,o){return r=n,u=(i=o).shared.providers,a=nt(r.items).filter(Rk),c=r.label.map((function(t){return _b(t,u)})),s={dom:{tag:"div",classes:["tox-listboxfield"]},components:[yb.parts.field({dom:{},factory:{sketch:function(n){return GS({uid:n.uid,text:a.map((function(t){return t.text})),icon:w.none(),tooltip:r.label,role:w.none(),fetch:function(t,n){var e=Pk(t,r.name,r.items,nl.getValue(t))
n(KS(e,ap.CLOSE_ON_EXECUTE,i,!1))},onSetup:e(t),getApi:e({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Sb.config({}),nl.config({store:{mode:"manual",initialValue:a.map((function(t){return t.value})).getOr(""),getValue:function(t){return Or(t.element,Vk)},setValue:function(t,n){Hk(r.items,n).each((function(n){Cr(t.element,Vk,n.value),Do(t,US,{text:n.text})}))}}})]},"tox-listbox",i.shared)}}})]},yb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:K([c.toArray(),[s]]),fieldBehaviours:Ta([ih.config({disabled:e(r.disabled),onDisabled:function(t){yb.getField(t).each(ih.disable)},onEnabled:function(t){yb.getField(t).each(ih.enable)}})])})
var r,i,u,a,c,s})),selectbox:cC((function(t,n){return e=t,o=n.shared.providers,r=L(e.items,(function(t){return{text:o.translate(t.text),value:t.value}})),i=e.label.map((function(t){return _b(t,o)})),u=yb.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:zk,selectBehaviours:Ta([ih.config({disabled:function(){return e.disabled||o.isReadOnly()}}),Sb.config({}),xm("selectbox-change",[Lo(to(),(function(t,n){Do(t,Tb,{name:e.name})}))])])}),a=1<e.size?w.none():w.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:kg("chevron-down",o.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:K([[u],a.toArray()])},yb.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:K([i.toArray(),[c]]),fieldBehaviours:Ta([ih.config({disabled:function(){return e.disabled||o.isReadOnly()},onDisabled:function(t){yb.getField(t).each(ih.disable)},onEnabled:function(t){yb.getField(t).each(ih.enable)}}),Dh()])})
var e,o,r,i,u,a,c})),sizeinput:cC((function(t,n){return mk(t,n.shared.providers)})),urlinput:cC((function(t,n){return aC(t,n,n.urlinput)})),customeditor:cC((function(t){var n=Jn(w.none()),e=wg({dom:{tag:t.tag}}),o=Jn(w.none())
return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Ta([xm("custom-editor-events",[qo((function(r){e.getOpt(r).each((function(e){var r
r=t,(Object.prototype.hasOwnProperty.call(r,"init")?t.init(e.element.dom):Bw.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)}))).then((function(t){o.get().each((function(n){t.setValue(n)})),o.set(w.none()),n.set(w.some(t))}))}))}))]),nl.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(w.some(e))}),(function(t){return t.setValue(e)}))}}}),Cw()]),components:[e.asSpec()]}})),htmlpanel:cC((function(t){return"presentation"===t.presets?pb.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):pb.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Ta([Sb.config({}),Om.config({})])})})),imagetools:cC((function(t,n){return Ik(t,n.shared.providers)})),table:cC((function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:L(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:L(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:L(r,c)})],behaviours:Ta([Sb.config({}),Om.config({})])}
var e,o,r,i,u,a,c})),panel:cC((function(t,n){return o=n,{dom:{tag:"div",classes:(e=t).classes},components:L(e.items,o.shared.interpreter)}
var e,o}))},lC={field:function(t,n){return n}},fC=function(t,n,e){var o=Ft(e,{shared:{interpreter:function(n){return dC(t,n,o)}}})
return dC(t,n,o)},dC=function(t,n,e){return _t(sC,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},mC={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},gC=function(t,n,e){var o=oc(-12,12,mC),r={maxHeightFunction:Za()}
return function(){return e()?{anchor:"node",root:hi(t()),node:w.from(t()),bubble:o,layouts:{onRtl:function(){return[hg]},onLtr:function(){return[pg]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[ca]},onLtr:function(){return[sa]}},overrides:r}}},pC=function(t,n,e){return function(){return e()?{anchor:"node",root:hi(t()),node:w.from(t()),layouts:{onRtl:function(){return[vg]},onLtr:function(){return[vg]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[ma]},onLtr:function(){return[ma]}}}}},hC=function(t,n,e){var o,r,i,u=_h(t),a=function(){return ne(t.getContentAreaContainer())},c=function(){return u||!e()}
return{inlineDialog:gC(a,n,c),banner:pC(a,n,c),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng()
return w.some(vc.range(ne(t.startContainer),t.startOffset,ne(t.endContainer),t.endOffset))}}}),node:(o=i=function(){return ne(t.getBody())},function(t){return{anchor:"node",root:o(),node:t}})}},vC=function(t){return{colorPicker:function(t,n){Rv(r)(t,n)},hasCustomColors:function(){return Ov(o)},getColors:function(){return _v(e)},getColorCols:(n=e=o=r=t,function(){return Ev(n)})}
var n,e,o,r},bC=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],yC=function(t){return X(t,(function(t,n){if(Tt(n,"items")){var e=yC(n.items)
return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(Tt(n,"inline")||Tt(n,"block")||Tt(n,"selector")){var o="custom-"+n.title.toLowerCase()
return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return l(l({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},xC=function(t){return n=t,w.from(n.getParam("style_formats")).filter(_).map((function(n){var e,o,r,i=(e=t,o=yC(n),r=function(t){j(t,(function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)}))},e.formatter?r(o.customFormats):e.on("init",(function(){r(o.customFormats)})),o.formats)
return t.getParam("style_formats_merge",!1,"boolean")?bC.concat(i):i})).getOr(bC)
var n},wC=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)}
return Ft(t,o)},SC=function(t,n,e,o){var r=function(n){return L(n,(function(n){var i,u,a,c,s=bt(n)
if(Et(n,"items")){var l=r(n.items)
return Ft(Ft(n,{type:"submenu"}),{getStyleItems:function(){return l}})}return Et(n,"format")?wC(n,e,o):1===s.length&&P(s,"title")?Ft(n,{type:"separator"}):(a={type:"formatter",format:u=Dr((i=n).title),isSelected:e(u),getStylePreview:o(u)},c=Ft(i,a),t.formatter.register(u,c),c)}))}
return r(n)},kC=kk.trim,CC=function(t){return function(n){if(n&&1===n.nodeType){if(n.contentEditable===t)return!0
if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},OC=CC("true"),_C=CC("false"),TC=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},EC=function(t){return t.innerText||t.textContent},BC=function(t){return(n=t)&&"A"===n.nodeName&&void 0!==(n.id||n.name)&&MC(t)
var n},AC=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},MC=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable
if(n&&"inherit"!==n)return OC(t)}return!1}(t)&&!_C(t)},FC=function(t){return AC(t)&&MC(t)},DC=function(t){var n,e,o=(n=t).id?n.id:Dr("h")
return TC("header",EC(t),"#"+o,AC(e=t)?parseInt(e.nodeName.substr(1),10):0,(function(){t.id=o}))},IC=function(n){var e=n.id||n.name,o=EC(n)
return TC("anchor",o||"#"+e,"#"+e,0,t)},RC=function(t){return 0<kC(t.title).length},VC=function(t){var n=function(t){return L(Mc(ne(t),"h1,h2,h3,h4,h5,h6,a:not([href])"),(function(t){return t.dom}))}(t)
return W(L(W(n,FC),DC).concat(L(W(n,BC),IC)),RC)},PC="tinymce-url-history",HC=function(t){return C(t)&&/^https?/.test(t)},zC=function(t){return O(t)&&Ct(t,(function(t){return!(_(n=t)&&n.length<=5&&$(n,HC))
var n})).isNone()},NC=function(){var t,n=xv.getItem(PC)
if(null===n)return{}
try{t=JSON.parse(n)}catch(g){if(g instanceof SyntaxError)return console.log("Local storage "+PC+" was not valid JSON",g),{}
throw g}return zC(t)?t:(console.log("Local storage "+PC+" was not valid format",t),{})},LC=function(t){var n=NC()
return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},jC=function(t,n){var e,o,r
HC(t)&&(e=NC(),o=Object.prototype.hasOwnProperty.call(e,n)?e[n]:[],r=W(o,(function(n){return n!==t})),e[n]=[t].concat(r).slice(0,5),function(t){if(!zC(t))throw new Error("Bad format for history:\n"+JSON.stringify(t))
xv.setItem(PC,JSON.stringify(t))}(e))},UC=function(t){return!!t},WC=function(t){return wt(kk.makeMap(t,/[, ]/),UC)},GC=function(t){return w.from(t.getParam("file_picker_callback")).filter(A)},XC=function(t){return w.from(t).filter(C).getOrUndefined()},YC=function(t){return{getHistory:LC,addToHistory:jC,getLinkInformation:function(){return!1===(n=t).getParam("typeahead_urls")?w.none():w.some({targets:VC(n.getBody()),anchorTop:XC(n.getParam("anchor_top","#top")),anchorBottom:XC(n.getParam("anchor_bottom","#bottom"))})
var n},getValidationHandler:function(){return function(t){return w.from(void 0===(e=(n=t).getParam("file_picker_validator_handler",void 0,"function"))?n.getParam("filepicker_validator_handler",void 0,"function"):e)
var n,e}(t)},getUrlPicker:function(n){return function(t,n){var e,o,r,i,u=(e=t,o=w.some(e.getParam("file_picker_types")).filter(UC),r=w.some(e.getParam("file_browser_callback_types")).filter(UC),i=o.or(r).map(WC),GC(e).fold((function(){return!1}),(function(t){return i.fold((function(){return!0}),(function(t){return 0<bt(t).length&&t}))})))
return T(u)?u?GC(t):w.none():u[n]?GC(t):w.none()}(e=t,o=n).map((function(t){return function(n){return Jb((function(r){var i=l({filetype:o,fieldname:n.fieldname},w.from(n.meta).getOr({}))
t.call(e,(function(t,n){if(!C(t))throw new Error("Expected value to be string")
if(void 0!==n&&!O(n))throw new Error("Expected meta to be a object")
r({value:t,meta:n})}),n.value,i)}))}}))
var e,o}}},qC=function(t,n,e){var o,r,i=Jn(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=Jn(Ch(n)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:Gp.translate,isReadOnly:function(){return n.mode.isReadOnly()}},interpreter:function(t){return dC(lC,t,a)},anchors:hC(n,e,u.isPositionedAtTop),header:u,getSink:function(){return at.value(t)}},urlinput:YC(n),styleselect:function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n)
return void 0!==e?w.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):w.none()}},o=function(t){var n=t.items
return void 0!==n&&0<n.length?J(n,o):[t.format]},r=Jn([]),i=Jn([]),u=Jn([]),a=Jn([]),c=Jn(!1)
return t.on("PreInit",(function(u){var a=xC(t),c=SC(t,a,n,e)
r.set(c),i.set(J(c,o))})),t.on("addStyleModifications",(function(r){var i=SC(t,r.items,n,e)
u.set(i),c.set(r.replace),a.set(J(i,o))})),{getData:function(){var t=c.get()?[]:r.get(),n=u.get()
return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get()
return t.concat(n)}}}(n),colorinput:vC(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}}
return a},KC=e((function(t,n){var e,o,r
e=t,o=Math.floor(n),r=$i.max(e,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),ki(e,"max-width",r+"px")})),JC="contexttoolbar-hide",$C=e([Tn("dom"),Ln("shell",!0),el("toolbarBehaviours",[ym])]),QC=e([Ml({name:"groups",overrides:function(){return{behaviours:Ta([ym.config({})])}}})]),ZC=rf({name:"Toolbar",configFields:$C(),partFields:QC(),factory:function(t,n,e,o){var r=function(n){return t.shell?w.some(n):Ul(n,t,"groups")},i=t.shell?{behaviours:[ym.config({})],components:[]}:{behaviours:[],components:n}
return{uid:t.uid,dom:t.dom,components:i.components,behaviours:rl(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){ym.set(t,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),tO=function(t,n,e){return{within:t,extra:n,withinWidth:e}},nO=function(t,n,o){var r,i=(r=function(t,n){var e=o(t)
return w.some({element:t,start:n,finish:n+e,width:e})},X(t,(function(t,n){return r(n,t.len).fold(e(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list),u=W(i,(function(t){return t.finish<=n})),a=G(u,(function(t,n){return t+n.width}),0)
return{within:u,extra:i.slice(u.length),withinWidth:a}},eO=function(t){return L(t,(function(t){return t.element}))},oO=function(t,n){var e=L(n,(function(t){return Li(t)}))
ZC.setGroups(t,e)},rO=function(t,n,e){var o=Wl(t,n,"primary"),r=ly.getCoupled(t,"overflowGroup")
ki(o.element,"visibility","hidden")
var i=n.builtGroups.get().concat([r]),u=rt(i,(function(t){return Pa(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}))
e([]),oO(o,i)
var a=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=(0===(r=nO(n,t,e)).extra.length?w.some(r):w.none()).getOrThunk((function(){return nO(n,t-e(o),e)})),g=m.within,p=m.extra,h=m.withinWidth
return 1===p.length&&p[0].width<=e(o)?(l=p,f=h,d=eO(g.concat(l)),tO(d,[],f)):1<=p.length?(u=p,a=o,c=h,s=eO(g).concat([a]),tO(s,eO(u),c)):(i=h,tO(eO(g),[],i))}(Qi(o.element),n.builtGroups.get(),(function(t){return Qi(t.element)}),r)
0===a.extra.length?(ym.remove(o,r),e([])):(oO(o,a.within),e(a.extra)),Ai(o.element,"visibility"),Mi(o.element),u.each(Om.focus)},iO=e([el("splitToolbarBehaviours",[ly]),Kn("builtGroups",(function(){return Jn([])}))]),uO=e([Vu(["overflowToggledClass"]),zn("getOverflowBounds"),Tn("lazySink"),Kn("overflowGroups",(function(){return Jn([])}))].concat(iO())),aO=e([Bl({factory:ZC,schema:$C(),name:"primary"}),Al({schema:$C(),name:"overflow"}),Al({name:"overflow-button"}),Al({name:"overflow-group"})]),cO=e([Vu(["toggledClass"]),Tn("lazySink"),Mn("fetch"),zn("getBounds"),Nn("fireDismissalEventInstead",[Ln("event",Co())]),sc()]),sO=e([Al({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Ta([Pm.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Al({factory:ZC,schema:$C(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:Ta([gm.config({mode:"cyclic",onEscape:function(n){return Ul(n,t,"button").each(Om.focus),w.none()}})])}}})]),lO=function(t,n){var e=ly.getCoupled(t,"toolbarSandbox")
Rs.isOpen(e)?Rs.close(e):Rs.open(e,n.toolbar())},fO=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie()
ms.positionWithinBounds(i,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:KC()}},n,r)},dO=function(t,n,e,o,r){ZC.setGroups(n,r),fO(t,n,e,o),Pm.on(t)},mO=rf({name:"FloatingToolbarButton",factory:function(t,n,e,o){return l(l({},xg.sketch(l(l({},o.button()),{action:function(t){lO(t,o)},buttonBehaviours:ul({dump:o.button().buttonBehaviours},[ly.config({others:{toolbarSandbox:function(n){return o=n,r=e,i=t,{dom:{tag:"div",attributes:{id:(u=ku()).id}},behaviours:Ta([gm.config({mode:"special",onEscape:function(t){return Rs.close(t),w.some(!0)}}),Rs.config({onOpen:function(t,n){i.fetch().get((function(t){dO(o,n,i,r.layouts,t),u.link(o.element),gm.focusIn(n)}))},onClose:function(){Pm.off(o),Om.focus(o),u.unlink(o.element)},isPartOf:function(t,n,e){return Cu(n,e)||Cu(o,e)},getAttachPoint:function(){return i.lazySink(o).getOrDie()}}),Da.config({channels:l(l({},Ns(l({isExtraPart:a},i.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),js({doReposition:function(){Rs.getState(ly.getCoupled(o,"toolbarSandbox")).each((function(t){fO(o,t,i,r.layouts)}))}}))})])}
var o,r,i,u}}})])}))),{apis:{setGroups:function(n,o){Rs.getState(ly.getCoupled(n,"toolbarSandbox")).each((function(r){dO(n,r,t,e.layouts,o)}))},reposition:function(n){Rs.getState(ly.getCoupled(n,"toolbarSandbox")).each((function(o){fO(n,o,t,e.layouts)}))},toggle:function(t){lO(t,o)},getToolbar:function(t){return Rs.getState(ly.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return Rs.isOpen(ly.getCoupled(t,"toolbarSandbox"))}}})},configFields:cO(),partFields:sO(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),gO=e([Tn("items"),Vu(["itemSelector"]),el("tgroupBehaviours",[gm])]),pO=e([Fl({name:"items",unit:"item"})]),hO=rf({name:"ToolbarGroup",configFields:gO(),partFields:pO(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:rl(t.tgroupBehaviours,[gm.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),vO=function(t){return L(t,(function(t){return Li(t)}))},bO=function(t,n,e){rO(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){mO.setGroups(t,vO(o))}))}))},yO=rf({name:"SplitFloatingToolbar",configFields:uO(),partFields:aO(),factory:function(t,n,e,o){var r=wg(mO.sketch({fetch:function(){return Jb((function(n){n(vO(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[sa,ca]},onRtl:function(){return[ca,sa]},onBottomLtr:function(){return[fa,la]},onBottomRtl:function(){return[la,fa]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}))
return{uid:t.uid,dom:t.dom,components:n,behaviours:rl(t.splitToolbarBehaviours,[ly.config({others:{overflowGroup:function(){return hO.sketch(l(l({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(L(e,n.getSystem().build)),bO(n,r,t)},refresh:function(n){return bO(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){mO.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(mO.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){mO.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(mO.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),xO=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},wO=function(t){return t.dimension.property},SO=function(t,n){return t.dimension.getDimension(n)},kO=function(t,n){var e=xO(t,n)
li(e,[n.shrinkingClass,n.growingClass])},CO=function(t,n){ai(t.element,n.openClass),ui(t.element,n.closedClass),ki(t.element,wO(n),"0px"),Mi(t.element)},OO=function(t,n){ai(t.element,n.closedClass),ui(t.element,n.openClass),Ai(t.element,wO(n))},_O=function(t,n,e,o){e.setCollapsed(),ki(t.element,wO(n),SO(n,t.element)),Mi(t.element),kO(t,n),CO(t,n),n.onStartShrink(t),n.onShrunk(t)},TO=function(t,n,e,o){var r=o.getOrThunk((function(){return SO(n,t.element)}))
e.setCollapsed(),ki(t.element,wO(n),r),Mi(t.element)
var i=xO(t,n)
ai(i,n.growingClass),ui(i,n.shrinkingClass),CO(t,n),n.onStartShrink(t)},EO=function(t,n,e){var o=SO(n,t.element);("0px"===o?_O:TO)(t,n,e,w.some(o))},BO=function(t,n,e){var o=xO(t,n),r=ci(o,n.shrinkingClass),i=SO(n,t.element)
OO(t,n)
var u=SO(n,t.element);(r?function(){ki(t.element,wO(n),i),Mi(t.element)}:function(){CO(t,n)})(),ai(o,n.shrinkingClass),ui(o,n.growingClass),OO(t,n),ki(t.element,wO(n),u),e.setExpanded(),n.onStartGrow(t)},AO=function(t,n,e){var o=xO(t,n)
return!0===ci(o,n.growingClass)},MO=function(t,n,e){var o=xO(t,n)
return!0===ci(o,n.shrinkingClass)},FO=Object.freeze({__proto__:null,refresh:function(t,n,e){var o
e.isExpanded()&&(Ai(t.element,wO(n)),o=SO(n,t.element),ki(t.element,wO(n),o))},grow:function(t,n,e){e.isExpanded()||BO(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&EO(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&_O(t,n,e,w.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:AO,isShrinking:MO,isTransitioning:function(t,n,e){return!0===AO(t,n)||!0===MO(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?EO:BO)(t,n,e)},disableTransitions:kO}),DO=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded
return Qr(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:jt(n.dimension.property,"0px")})},events:function(t,n){return Ho([Yo(eo(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(kO(e,t),n.isExpanded()&&Ai(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),IO=[Tn("closedClass"),Tn("openClass"),Tn("shrinkingClass"),Tn("growingClass"),Rn("getAnimationRoot"),Hu("onShrunk"),Hu("onStartShrink"),Hu("onGrown"),Hu("onStartGrow"),Ln("expanded",!1),En("dimension",vn("property",{width:[ju("property","width"),ju("getDimension",(function(t){return Qi(t)+"px"}))],height:[ju("property","height"),ju("getDimension",(function(t){return Wi(t)+"px"}))]}))],RO=Ba({fields:IO,name:"sliding",active:DO,apis:FO,state:Object.freeze({__proto__:null,init:function(t){var n=Jn(t.expanded)
return Jr({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:r(n.set,!1),setExpanded:r(n.set,!0),readState:function(){return"expanded: "+n.get()}})}})}),VO=e([Vu(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Hu("onOpened"),Hu("onClosed")].concat(iO())),PO=e([Bl({factory:ZC,schema:$C(),name:"primary"}),Bl({factory:ZC,schema:$C(),name:"overflow",overrides:function(t){return{toolbarBehaviours:Ta([RO.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){Ul(n,t,"overflow-button").each((function(t){Pm.off(t),Om.focus(t)})),t.onClosed(n)},onGrown:function(n){gm.focusIn(n),t.onOpened(n)},onStartGrow:function(n){Ul(n,t,"overflow-button").each(Pm.on)}}),gm.config({mode:"acyclic",onEscape:function(n){return Ul(n,t,"overflow-button").each(Om.focus),w.some(!0)}})])}}}),Al({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Ta([Pm.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Al({name:"overflow-group"})]),HO=function(t,n){Ul(t,n,"overflow-button").bind((function(){return Ul(t,n,"overflow")})).each((function(e){zO(t,n),RO.toggleGrow(e)}))},zO=function(t,n){Ul(t,n,"overflow").each((function(e){rO(t,n,(function(t){var n=L(t,(function(t){return Li(t)}))
ZC.setGroups(e,n)})),Ul(t,n,"overflow-button").each((function(t){RO.hasGrown(e)&&Pm.on(t)})),RO.refresh(e)}))},NO=rf({name:"SplitSlidingToolbar",configFields:VO(),partFields:PO(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle"
return{uid:t.uid,dom:t.dom,components:n,behaviours:rl(t.splitToolbarBehaviours,[ly.config({others:{overflowGroup:function(t){return hO.sketch(l(l({},o["overflow-group"]()),{items:[xg.sketch(l(l({},o["overflow-button"]()),{action:function(n){Fo(t,r)}}))]}))}}}),xm("toolbar-toggle-events",[Lo(r,(function(n){HO(n,t)}))])]),apis:{setGroups:function(n,e){var o
o=L(e,n.getSystem().build),t.builtGroups.set(o),zO(n,t)},refresh:function(n){return zO(n,t)},toggle:function(n){return HO(n,t)},isOpen:function(n){return Ul(n,t,"overflow").map(RO.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),LO=e(Dr("toolbar-height-change")),jO=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}))
return{dom:l({tag:"div",classes:["tox-toolbar__group"]},n),components:[hO.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Ta([Sb.config({}),Om.config({})])}},UO=function(t){return hO.sketch(jO(t))},WO=function(t,n){var e=qo((function(n){var e=L(t.initGroups,UO)
ZC.setGroups(n,e)}))
return Ta([Ph(t.providers.isReadOnly),Dh(),gm.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),xm("toolbar-events",[e])])},GO=function(t){var n=t.cyclicKeying?"cyclic":"acyclic"
return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":jO({title:w.none(),items:[]}),"overflow-button":tk({name:"more",icon:w.some("more-drawer"),disabled:!1,tooltip:w.some("More..."),primary:!1,borderless:!1},w.none(),t.providers)},splitToolbarBehaviours:WO(t,n)}},XO=function(t){var n=GO(t),e=yO.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}})
return yO.sketch(l(l({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=du(n),o=ur(n),r=du(o),i=Math.max(o.dom.scrollHeight,r.height)
return lu(e.x+4,r.y,e.width-8,i)},parts:l(l({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},YO=function(t){var n=NO.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=NO.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=GO(t)
return NO.sketch(l(l({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([LO()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([LO()],{type:"closed"})}}))},qO=function(t){var n=t.cyclicKeying?"cyclic":"acyclic"
return ZC.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===ip.scrolling?["tox-toolbar--scrolling"]:[])},components:[ZC.parts.groups({})],toolbarBehaviours:WO(t,n)})},KO=Zt([Bn("type"),En("items",nn([sn([Bn("name"),In("items",wn)]),wn]))].concat(Gg)),JO=[Hn("text"),Hn("tooltip"),Hn("icon"),Mn("fetch"),Yn("onSetup",(function(){return t}))],$O=Zt(d([Bn("type")],JO)),QO=function(t){return dn("menubutton",$O,t)},ZO=Zt([Bn("type"),Hn("tooltip"),Hn("icon"),Hn("text"),zn("select"),Mn("fetch"),Yn("onSetup",(function(){return t})),Gn("presets","normal",["normal","color","listpreview"]),Ln("columns",1),Mn("onAction"),Mn("onItemAction")]),t_=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o)
n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=L(r,e.getSystem().build)
vs(e,i)}))}
return Ho([Lo(so(),(function(n,o){var r,i=o
i.universal||(r=t.channel,P(i.channels,r)&&e(n,i.data))})),qo((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),n_=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),e_=[Tn("channel"),Rn("renderComponents"),Rn("updateState"),Rn("initialData")],o_=Ba({fields:e_,name:"reflecting",active:t_,apis:n_,state:Object.freeze({__proto__:null,init:function(){var t=Jn(w.none())
return{readState:function(){return t.get().fold((function(){return"none"}),(function(t){return t}))},get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(w.none())}}}})}),r_=e([Tn("toggleClass"),Tn("fetch"),Nu("onExecute"),Ln("getHotspot",w.some),Ln("getAnchorOverrides",e({})),sc(),Nu("onItemExecute"),Rn("lazySink"),Tn("dom"),Hu("onOpen"),el("splitDropdownBehaviours",[ly,gm,Om]),Ln("matchWidth",!1),Ln("useMinWidth",!1),Ln("eventOrder",{}),Rn("role")].concat(wy())),i_=Bl({factory:xg,schema:[Tn("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Ta([Om.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Io)},buttonBehaviours:Ta([Pm.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),u_=Bl({factory:xg,schema:[Tn("dom")],name:"button",defaults:function(){return{buttonBehaviours:Ta([Om.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),a_=e([i_,u_,Ml({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[Tn("text")],name:"aria-descriptor"}),Al({schema:[Ru()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),dy()]),c_=rf({name:"SplitDropdown",configFields:r_(),partFields:a_(),factory:function(n,e,o,r){var i,u=function(t){lf.getCurrent(t).each((function(t){xf.highlightFirst(t),gm.focusIn(t)}))},a=function(e){hy(n,(function(t){return t}),e,r,u,Ub.HighlightFirst).get(t)},c=function(t){var e=Wl(t,n,"button")
return Io(e),w.some(!0)},s=l(l({},Ho([qo((function(t,e){Ul(t,n,"aria-descriptor").each((function(n){var e=Dr("aria")
Cr(n.element,"id",e),Cr(t.element,"aria-describedby",e)}))}))])),zm(w.some(a))),f={repositionMenus:function(t){Pm.isOn(t)&&xy(t)}}
return{uid:n.uid,dom:n.dom,components:e,apis:f,eventOrder:l(l({},n.eventOrder),((i={})[lo()]=["disabling","toggling","alloy.base.behaviour"],i)),events:s,behaviours:rl(n.splitDropdownBehaviours,[ly.config({others:{sandbox:function(t){var e=Wl(t,n,"arrow")
return yy(n,t,{onOpen:function(){Pm.on(e),Pm.on(t)},onClose:function(){Pm.off(e),Pm.off(t)}})}}}),gm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t){return a(t),w.some(!0)}}),Om.config({}),Pm.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),s_=function(t){return{isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)}}},l_=function(t){return{setActive:function(n){Pm.set(t,n)},isActive:function(){return Pm.isOn(t)},isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)}}},f_=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},d_=Dr("focus-button"),m_=["checklist","ordered-list"],g_=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],p_=function(t,n,e,o,r,i){var u,a=function(t){return Gp.isRtl()&&P(m_,t)?t+"-rtl":t},c=Gp.isRtl()&&t.exists((function(t){return P(g_,t)}))
return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:f_(e,i)},components:jh([t.map((function(t){return HS(a(t),i.icons)})),n.map((function(t){return NS(t,"tox-tbtn",i)}))]),eventOrder:((u={})[We()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Ta([Ph(i.isReadOnly),Dh(),xm("common-button-display-events",[Lo(We(),(function(t,n){n.event.prevent(),Fo(t,d_)}))])].concat(o.map((function(e){return o_.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return jh([t.icon.map((function(t){return HS(a(t),i.icons)})),t.text.map((function(t){return NS(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},h_=function(n,e,o){var r,i=Jn(t),u=p_(n.icon,n.text,n.tooltip,w.none(),w.none(),o)
return xg.sketch({dom:u.dom,components:u.components,eventOrder:jS,buttonBehaviours:Ta([xm("toolbar-button-events",[(r={onAction:n.onAction,getApi:e.getApi},$o((function(t,n){Hh(r,t)((function(n){Do(t,LS,{buttonApi:n}),r.onAction(n)}))}))),zh(e,i),Nh(e,i)]),Ph((function(){return n.disabled||o.isReadOnly()})),Dh()].concat(e.toolbarButtonBehaviours))})},v_=function(t,n,e){return h_(t,{toolbarButtonBehaviours:[].concat(0<e.length?[xm("toolbarButtonWith",e)]:[]),getApi:s_,onSetup:t.onSetup},n)},b_=function(t,n,e){return Ft(h_(t,{toolbarButtonBehaviours:[ym.config({}),Pm.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[xm("toolbarToggleButtonWith",e)]:[]),getApi:l_,onSetup:t.onSetup},n))},y_=function(t,n){return Lo(LS,(function(e,o){var r,i=t.get(e),u=(r=i,{hide:function(){return Fo(r,po())},getValue:function(){return nl.getValue(r)}})
n.onAction(u,o.event.buttonApi)}))},x_=function(t,n){var e,o,r,u,a=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),c=wg(Nb.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:a,selectOnFocus:!0,inputBehaviours:Ta([gm.config({mode:"special",onEnter:function(t){return s.findPrimary(t).map((function(t){return Io(t),!0}))},onLeft:function(t,n){return n.cut(),w.none()},onRight:function(t,n){return n.cut(),w.none()}})])})),s=(e=c,o=t.commands,r=n,u=L(o,(function(t){return wg(function(t,n,e){var o,r,i,u,a,c,s,d,m,g,p,h,v={backstage:{shared:{providers:e}}}
return"contextformtogglebutton"===n.type?(s=t,m=v,(g=(d=n).original).primary,p=f(g,["primary"]),h=mn(Jg(l(l({},p),{type:"togglebutton",onAction:function(){}}))),b_(h,m.backstage.shared.providers,[y_(s,d)])):(o=t,i=v,(u=(r=n).original).primary,a=f(u,["primary"]),c=mn(Yg(l(l({},a),{type:"button",onAction:function(){}}))),v_(c,i.backstage.shared.providers,[y_(o,r)]))}(e,t,r))})),{asSpecs:function(){return L(u,(function(t){return t.asSpec()}))},findPrimary:function(t){return rt(o,(function(n,e){return n.primary?w.from(u[e]).bind((function(n){return n.getOpt(t)})).filter(i(ih.isDisabled)):w.none()}))}})
return[{title:w.none(),items:[c.asSpec()]},{title:w.none(),items:s.asSpecs()}]},w_=function(t,n){var e,o,r,i,u,a=uu(window),c=fu(ne(t.getContentAreaContainer())),s=mh(t)||gh(t)||hh(t),l=(e=c,o=a,r=Math.max(o.x,e.x),i=e.right-r,u=o.width-(r-o.x),{x:r,width:Math.min(i,u)}),f=l.x,d=l.width
if(t.inline&&!s)return lu(f,a.y,d,a.height)
var m=function(t,n,e,o){var r=ne(t.getContainer()),i=wu(r,".tox-editor-header").getOr(r),u=fu(i),a=u.y>=n.bottom,c=o&&!a
if(t.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom}
if(t.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)}
var s=fu(r)
return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(t,c,a,n.header.isPositionedAtTop()),g=m.y,p=m.bottom
return lu(f,g,d,p-g)},S_=function(t,n){var e=W(n,(function(n){return n.predicate(t.dom)})),o=U(e,(function(t){return"contexttoolbar"===t.type}))
return{contextToolbars:o.pass,contextForms:o.fail}},k_=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=mn(dn("ContextForm",op,a));(e[t]=c).launch.map((function(e){i["form:"+t]=l(l({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=bt(t)
return j(c,(function(n){var e=t[n]
"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&function(t,n){dn("ContextToolbar",rp,n).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))}(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},C_=Dr("forward-slide"),O_=Dr("backward-slide"),__=Dr("change-slide-event"),T_="tox-pop--resizing",E_=function(t,n,e){var o,r,i,u,a,c=e.dataset,s="basic"===c.type?function(){return L(c.data,(function(t){return wC(t,e.isSelectedFor,e.getPreviewFor)}))}:c.getData
return{items:(o=n,r=e,i=function(t,n,e,i){var a=o.shared.providers.translate(t.title)
if("separator"===t.type)return w.some({type:"separator",text:a})
if("submenu"!==t.type)return w.some(l({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(i),disabled:e,onAction:r.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))
var c=J(t.getStyleItems(),(function(t){return u(t,n,i)}))
return 0===n&&c.length<=0?w.none():w.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return J(t.getStyleItems(),(function(t){return u(t,n,i)}))}})},u=function(t,n,e){var o="formatter"===t.type&&r.isInvalid(t)
return 0===n?o?[]:i(t,n,!1,e).toArray():i(t,n,o,e).toArray()},{validateItems:a=function(t){var n=r.getCurrentValue(),e=r.shouldHide?0:1
return J(t,(function(t){return u(t,e,n)}))},getFetch:function(t,n){return function(e,o){var r=n(),i=a(r)
o(KS(i,ap.CLOSE_ON_EXECUTE,t,!1))}}}),getStyleItems:s}},B_=function(n,e,o){var r=E_(0,e,o),i=r.items,u=r.getStyleItems
return GS({text:o.icon.isSome()?w.none():w.some(""),icon:o.icon,tooltip:w.from(o.tooltip),role:w.none(),fetch:i.getFetch(e,u),onSetup:function(e){return o.setInitialValue.each((function(t){return t(e.getComponent())})),o.nodeChangeHandler.map((function(t){var o=t(e.getComponent())
return n.on("NodeChange",o),function(){n.off("NodeChange",o)}})).getOr(t)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};(Dk=Fk=Fk||{})[Dk.SemiColon=0]="SemiColon",Dk[Dk.Space=1]="Space"
var A_,M_,F_,D_,I_,R_,V_=function(t,n,e,o){var r,i
return{type:"basic",data:(i=t.getParam(n,e,"string"),r=o===Fk.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),L(r,(function(t){var n=t,e=t,o=t.split("=")
return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}})))}},P_=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],H_=function(t){var n=function(n){var e=Y(P_,(function(n){return t.formatter.match(n.format)})).fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}))
Do(n,WS,{icon:"align-"+e})},e=w.some((function(t){return function(){return n(t)}})),o=w.some(n),r={type:"basic",data:P_}
return{tooltip:"Align",icon:w.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:w.none,getPreviewFor:function(t){return function(){return w.none()}},onAction:function(n){return function(){return Y(P_,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},z_=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],N_=function(t){var n=t.split(/\s*,\s*/)
return L(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},L_=function(t){var n=function(){var n=function(t){return t?N_(t)[0]:""},e=t.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():""
return{matchOpt:Y(o,(function(t){var e=t.format
return e.toLowerCase()===r||n(e).toLowerCase()===n(r).toLowerCase()})).orThunk((function(){return function(t){var n
return 0===t.indexOf("-apple-system")&&(n=N_(t.toLowerCase()),$(z_,(function(t){return-1<n.indexOf(t.toLowerCase())})))}(r)?w.from({title:"System Font",format:r}):w.none()})),font:e}},e=function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(t){return t.title}))
Do(t,US,{text:i})},o=w.some((function(t){return function(){return e(t)}})),r=w.some(e),i=V_(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Fk.SemiColon)
return{tooltip:"Fonts",icon:w.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return w.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:function(){return!1}}},j_={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},U_=function(t){var n=function(){var n=w.none(),e=a.data,o=t.queryCommandValue("FontSize")
if(o)for(var r=function(t){var r=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):t
var e,o,r}(o,t),i=_t(j_,r).getOr("")
n=Y(e,(function(t){return t.format===o||t.format===r||t.format===i}))},i=3;n.isNone()&&0<=i;i--)r(i)
return{matchOpt:n,size:o}},o=e(w.none),r=function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(t){return t.title}))
Do(t,US,{text:i})},i=w.some((function(t){return function(){return r(t)}})),u=w.some(r),a=V_(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",Fk.Space)
return{tooltip:"Font sizes",icon:w.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:o,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},setInitialValue:u,nodeChangeHandler:i,dataset:a,shouldHide:!1,isInvalid:function(){return!1}}},W_=function(t,n,e){var o=n()
return rt(e,(function(n){return Y(o,(function(e){return t.formatter.matchNode(n,e.format)}))})).orThunk((function(){return t.formatter.match("p")?w.some({title:"Paragraph",format:"p"}):w.none()}))},G_=function(t){var n=t.selection.getStart(!0)||t.getBody()
return t.dom.getParents(n,(function(){return!0}),t.getBody())},X_=function(t){var n=Jn(w.none()),e=function(){return n.get().each(t)}
return{clear:function(){e(),n.set(w.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(w.some(t))}}},Y_=function(){return X_((function(t){return t.unbind()}))},q_=function(t,n){return function(e){var o=Y_(),r=function(){e.setActive(t.formatter.match(n))
var r=t.formatter.formatChanged(n,e.setActive)
o.set(r)}
return t.initialized?r():t.on("init",r),o.clear}},K_=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},J_=function(t){var n=function(n,e){var o=W_(t,(function(){return r.data}),n).fold((function(){return"Paragraph"}),(function(t){return t.title}))
Do(e,US,{text:o})},e=w.some((function(t){return function(e){return n(e.parents,t)}})),o=w.some((function(e){var o=G_(t)
n(o,e)})),r=V_(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",Fk.SemiColon)
return{tooltip:"Blocks",icon:w.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:w.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n)
return w.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:K_(t),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},$_=function(t,n){var e=function(n,e){var o=function(t){var n=t.items
return void 0!==n&&0<n.length?J(n,o):[{title:t.title,format:t.format}]},r=J(xC(t),o),i=W_(t,(function(){return r}),n).fold((function(){return"Paragraph"}),(function(t){return t.title}))
Do(e,US,{text:i})},o=w.some((function(t){return function(n){return e(n.parents,t)}})),r=w.some((function(n){var o=G_(t)
e(o,n)}))
return{tooltip:"Formats",icon:w.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:w.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n)
return void 0!==e?w.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):w.none()}},onAction:K_(t),setInitialValue:r,nodeChangeHandler:o,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},Q_=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Z_=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return pn(t)})).getOrDie()
return n(i,o,r)}},tT={button:Z_(Yg,(function(t,n){return e=t,o=n.backstage.shared.providers,v_(e,o,[])
var e,o})),togglebutton:Z_(Jg,(function(t,n){return e=t,o=n.backstage.shared.providers,b_(e,o,[])
var e,o})),menubutton:Z_(QO,(function(t,n){return $S(t,"tox-tbtn",n.backstage,w.none())})),splitbutton:Z_((function(t){return dn("SplitButton",ZO,t)}),(function(n,e){return function(n,e){var o,r,i,u,a=Dr("channel-update-split-dropdown-display"),c=function(t){return{isDisabled:function(){return ih.isDisabled(t)},setDisabled:function(n){return ih.set(t,n)},setIconFill:function(n,e){wu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Cr(t,"fill",e)}))},setIconStroke:function(n,e){wu(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Cr(t,"stroke",e)}))},setActive:function(n){Cr(t.element,"aria-pressed",n),wu(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return Pm.set(t,n)}))}))},isActive:function(){return wu(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(Pm.isOn)}))}}},s=Jn(t),f={getApi:c,onSetup:n.onSetup}
return c_.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:l({"aria-pressed":!1},f_(n.tooltip,e.providers))},onExecute:function(t){n.onAction(c(t))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:Ta([Vh(e.providers.isReadOnly),Dh(),xm("split-dropdown-events",[Lo(d_,Om.focus),zh(f,s),Nh(f,s)]),Oy.config({})]),eventOrder:((o={})[So()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:(r=c,i=n,u=e.providers,function(t){return Jb((function(t){return i.fetch(t)})).map((function(n){return w.from(Xv(Ft(Vv(Dr("menu-value"),n,(function(n){i.onItemAction(r(t),n)}),i.columns,i.presets,ap.CLOSE_ON_EXECUTE,i.select.getOr((function(){return!1})),u),{movement:Hv(i.columns,i.presets),menuBehaviours:Rp("auto"!==i.columns?[]:[qo((function(t,n){Ip(t,4,hp(i.presets)).each((function(n){var e=n.numRows,o=n.numColumns
gm.setGridSize(t,e,o)}))}))])})))}))}),parts:{menu:xp(0,n.columns,n.presets)},components:[c_.parts.button(p_(n.icon,n.text,w.none(),w.some(a),w.some([Pm.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),c_.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:kg("chevron-down",e.providers.icons)},buttonBehaviours:Ta([Vh(e.providers.isReadOnly),Dh()])}),c_.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}(n,e.backstage.shared)})),grouptoolbarbutton:Z_((function(t){return dn("GroupToolbarButton",KO,t)}),(function(t,n,e){var o,r,i,u,a,c,s=e.ui.registry.getAll().buttons,l=((o={})[ac]=n.backstage.shared.header.isPositionedAtTop()?Ou.TopToBottom:Ou.BottomToTop,o)
switch(yh(e)){case ip.floating:return r=t,i=n.backstage,u=function(t){return eT(e,{buttons:s,toolbar:t,allowToolbarGroups:!1},n,w.none())},a=l,c=i.shared,mO.sketch({lazySink:c.getSink,fetch:function(){return Jb((function(t){t(L(u(r.items),UO))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:p_(r.icon,r.text,r.tooltip,w.none(),w.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}})
default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return e=t,o=n.backstage,r=l({type:"advanced"},o.styleselect),B_(e,o,$_(e,r))
var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,B_(e,o,U_(e))
var e,o},fontSelectButton:function(t,n){return e=t,o=n.backstage,B_(e,o,L_(e))
var e,o},formatButton:function(t,n){return e=t,o=n.backstage,B_(e,o,J_(e))
var e,o},alignMenuButton:function(t,n){return e=t,o=n.backstage,B_(e,o,H_(e))
var e,o}},nT={styleselect:tT.styleSelectButton,fontsizeselect:tT.fontsizeSelectButton,fontselect:tT.fontSelectButton,formatselect:tT.formatButton,align:tT.alignMenuButton},eT=function(t,n,e,o){var r=function(t){var n,e,o,r=t.toolbar,i=t.buttons
return!1===r?[]:void 0===r||!0===r?(e=i,o=L(Q_,(function(t){var n=W(t.items,(function(t){return Tt(e,t)||Tt(nT,t)}))
return{name:t.name,items:n}})),W(o,(function(t){return 0<t.items.length}))):C(r)?(n=r.split("|"),L(n,(function(t){return{items:t.trim().split(" ")}}))):F(r,(function(t){return Tt(t,"name")&&Tt(t,"items")}))?r:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])}(n),i=L(r,(function(r){var i=J(r.items,(function(r){return 0===r.trim().length?[]:function(t,n,e,o,r,i){return _t(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return rt(t,(function(t){return _t(n,t+e.toLowerCase())}))}))})).fold((function(){return _t(nT,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return w.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?(u=r,a=t,_t(tT,(i=n).type).fold((function(){return console.error("skipping button defined by",i),w.none()}),(function(t){return w.some(t(i,u,a))}))):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),w.none())
var i,u,a}))}(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}))
return{title:w.from(t.translate(r.name)),items:i}}))
return W(i,(function(t){return 0<t.items.length}))},oT={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},rT={maxHeightFunction:Za(),maxWidthFunction:KC()},iT={onLtr:function(){return[da,ma,la,ca,fa,sa,vg,bg,pg,mg,hg,gg]},onRtl:function(){return[da,ma,fa,sa,la,ca,vg,bg,hg,gg,pg,mg]}},uT={onLtr:function(){return[ma,ca,sa,la,fa,da,vg,bg,pg,mg,hg,gg]},onRtl:function(){return[ma,sa,ca,fa,la,da,vg,bg,hg,gg,pg,mg]}},aT=function(t,n,e,o){var r,i,u=Be().deviceType.isTouch,a=Ni((r={sink:e,onEscape:function(){return t.focus(),w.some(!0)}},i=Jn([]),ag.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),ag.getContent(t).each((function(t){Ai(t.element,"visibility")})),ai(t.element,T_),Ai(t.element,"width")},inlineBehaviours:Ta([xm("context-toolbar-events",[Yo(eo(),(function(t,n){ai(t.element,T_),Ai(t.element,"width")})),Lo(__,(function(t,n){Ai(t.element,"width")
var e=Qi(t.element)
ag.setContent(t,n.event.contents),ui(t.element,T_)
var o=Qi(t.element)
ki(t.element,"width",e+"px"),ag.getContent(t).each((function(e){n.event.focus.bind((function(n){return Ra(n),Pa(t.element)})).orThunk((function(){return gm.focusIn(e),Va()}))})),yg.setTimeout((function(){ki(t.element,"width",o+"px")}),0)})),Lo(C_,(function(t,n){ag.getContent(t).each((function(t){i.set(i.get().concat([{bar:t,focus:Va()}]))})),Do(t,__,{contents:n.event.forwardContents,focus:w.none()})})),Lo(O_,(function(t,n){et(i.get()).each((function(n){i.set(i.get().slice(0,i.get().length-1)),Do(t,__,{contents:Li(n.bar),focus:n.focus})}))}))]),gm.config({mode:"special",onEscape:function(t){return et(i.get()).fold((function(){return r.onEscape()}),(function(n){return Fo(t,O_),w.some(!0)}))}})]),lazySink:function(){return at.value(r.sink)}}))),c=function(){return w_(t,o.backstage.shared)},s=function(){if(u()&&o.backstage.isContextMenuOpen())return!0
var n,e,r,i,a,s,l=(n=g.get().filter((function(t){return bi(ne(t))})).map((function(t){return t.getBoundingClientRect()})).getOrThunk((function(){return t.selection.getRng().getBoundingClientRect()})),e=t.inline?ou().top:du(ne(t.getBody())).y,{y:n.top+e,bottom:n.bottom+e}),f=c()
return r=l.y,i=l.bottom,a=f.y,s=f.bottom,!(Math.max(r,a)<=Math.min(i,s))},f=function(){ag.hide(a)},d=function(){m.get().each((function(t){var n=a.element
Ai(n,"display"),s()?ki(n,"display","none"):ms.positionWithinBounds(e,t,a,w.some(c()))}))},m=Jn(w.none()),g=Jn(w.none()),p=Jn(null),h=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:Ta([gm.config({mode:"acyclic"}),xm("pop-dialog-wrap-events",[qo((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return gm.focusIn(n)}))})),Ko((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},v=It((function(){return k_(n,(function(t){var n=b([t])
Do(a,C_,{forwardContents:h(n)})}))})),b=function(n){var e=t.ui.registry.getAll().buttons,r=v(),i=l(l({},e),r.formNavigators),u=yh(t)===ip.scrolling?ip.scrolling:ip.default,a=K(L(n,(function(n){return"contexttoolbar"===n.type?eT(t,{buttons:i,toolbar:n.items,allowToolbarGroups:!1},o,w.some(["form:"])):(e=n,r=o.backstage.shared.providers,x_(e,r))
var e,r})))
return qO({type:u,uid:Dr("context-toolbar"),initGroups:a,onEscape:w.none,cyclicKeying:!0,providers:o.backstage.shared.providers})}
t.on("contexttoolbar-show",(function(n){var e=v()
_t(e.lookupTable,n.toolbarKey).each((function(e){y([e],n.target===t?w.none():w.some(n)),ag.getContent(a).each(gm.focusIn)}))}))
var y=function(t,n){var e,r,i,l
S(),u()&&o.backstage.isContextMenuOpen()||(e=b(t),r=n.map(ne),i=function(t,n){var e,r,i="node"===t?o.backstage.shared.anchors.node(n):o.backstage.shared.anchors.cursor()
return Ft(i,(e=t,r=u(),"line"===e?{bubble:oc(12,0,oT),layouts:{onLtr:function(){return[ga]},onRtl:function(){return[pa]}},overrides:rT}:{bubble:oc(0,12,oT),layouts:r?uT:iT,overrides:rT}))}(t[0].position,r),m.set(w.some(i)),g.set(n),l=a.element,Ai(l,"display"),ag.showWithinBounds(a,i,h(e),(function(){return w.some(c())})),s()&&ki(l,"display","none"))},x=function(){var n,e,o,r,i,u,c
t.hasFocus()&&(n=v(),e=n,i=ne((o=t).getBody()),u=function(t){return Fe(t,i)},c=ne(o.selection.getNode()),(u(r=c)||De(i,r)?function(t,n,e){var o=S_(t,n)
if(0<o.contextForms.length)return w.some({elem:t,toolbars:[o.contextForms[0]]})
var r=S_(t,e)
if(0<r.contextForms.length)return w.some({elem:t,toolbars:[r.contextForms[0]]})
if(0<o.contextToolbars.length||0<r.contextToolbars.length){var i=function(t){if(t.length<=1)return t
var n=function(n){return H(t,(function(t){return t.position===n}))},e=function(n){return W(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node")
if(o||r){if(r&&o){var i=e("node"),u=L(e("selection"),(function(t){return l(l({},t),{position:"node"})}))
return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars))
return w.some({elem:t,toolbars:i})}return w.none()}(c,e.inNodeScope,e.inEditorScope).orThunk((function(){return function(t,n,e){return t(n)?w.none():Re(n,(function(t){var n=S_(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=0<r.length?r:function(t){if(t.length<=1)return t
var n=function(n){return Y(t,(function(t){return t.position===n}))}
return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return W(t,(function(t){return t.position===n}))}))}(o)
return 0<i.length?w.some({elem:t,toolbars:i}):w.none()}),t)}(u,c,e)})):w.none()).fold((function(){m.set(w.none()),ag.hide(a)}),(function(t){y(t.toolbars,w.some(t.elem.dom))})))},S=function(){var t=p.get()
null!==t&&(yg.clearTimeout(t),p.set(null))},k=function(t){S(),p.set(t)}
t.on("init",(function(){t.on(JC,f),t.on("ScrollContent ScrollWindow longpress",d),t.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){k(yg.setEditorTimeout(t,x,0))})),t.on("focusout",(function(n){yg.setEditorTimeout(t,(function(){Pa(e.element).isNone()&&Pa(a.element).isNone()&&(m.set(w.none()),ag.hide(a))}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&(m.set(w.none()),ag.hide(a))})),t.on("NodeChange",(function(n){Pa(a.element).fold((function(){k(yg.setEditorTimeout(t,x,0))}),(function(t){}))}))}))},cT=$l,sT=Il,lT=e([Ln("shell",!1),Tn("makeItem"),Ln("setupItem",t),il("listBehaviours",[ym])]),fT=Ml({name:"items",overrides:function(){return{behaviours:Ta([ym.config({})])}}}),dT=e([fT]),mT=rf({name:e("CustomList")(),configFields:lT(),partFields:dT(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[ym.config({})],components:[]}:{behaviours:[],components:n}
return{uid:t.uid,dom:t.dom,components:r.components,behaviours:rl(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){(function(n){return t.shell?w.some(n):Ul(n,t,"items")})(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=ym.contents(o),i=e.length,u=i-r.length,a=0<u?z(u,(function(){return t.makeItem()})):[],c=r.slice(i)
j(c,(function(t){return ym.remove(o,t)})),j(a,(function(t){return ym.append(o,t)}))
var s=ym.contents(o)
j(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),gT=t,pT=a,hT=e([]),vT=Object.freeze({__proto__:null,setup:gT,isDocked:pT,getBehaviours:hT}),bT=function(t){return(Ei(t,"position").is("fixed")?w.none():lr(t)).orThunk((function(){var n=Zn("span")
return cr(t).bind((function(t){hr(t,n)
var e=lr(n)
return yr(n),e}))}))},yT=function(t){return bT(t).map(Ki).getOrThunk((function(){return Yi(0,0)}))},xT=Bt([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),wT=function(t,n){var e=t.element
ui(e,n.transitionClass),ai(e,n.fadeOutClass),ui(e,n.fadeInClass),n.onShow(t)},ST=function(t,n){var e=t.element
ui(e,n.transitionClass),ai(e,n.fadeInClass),ui(e,n.fadeOutClass),n.onHide(t)},kT=function(t,n,e){return $(t,(function(t){switch(t){case"bottom":return r=e,n.bottom<=r.bottom
case"top":return o=e,n.y>=o.y}var o,r}))},CT=function(t,n){return n.getInitialPosition().map((function(n){return lu(n.bounds.x,n.bounds.y,Qi(t),Wi(t))}))},OT=function(t,n,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(w.none()),o.position){case"static":return w.some(xT.static())
case"absolute":var r=bT(t).map(fu).getOrThunk((function(){return fu(yi())}))
return w.some(xT.absolute(za("absolute",_t(o.style,"left").map((function(t){return n.x-r.x})),_t(o.style,"top").map((function(t){return n.y-r.y})),_t(o.style,"right").map((function(t){return r.right-n.right})),_t(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))))
default:return w.none()}}))},_T=function(t,n,e){var o,r,i,u=t.element
return Ei(u,"position").is("fixed")?(r=n,CT(o=u,i=e).filter((function(t){return kT(i.getModes(),t,r)})).bind((function(t){return OT(o,t,i)}))):function(t,n,e){var o=fu(t)
if(kT(e.getModes(),o,n))return w.none();(function(t,n,e){e.setInitialPosition(w.some({style:function(t){var n={},e=t.dom
if(fi(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o)
n[r]=e.style[r]}return n}(t),position:_i(t,"position")||"static",bounds:n}))})(t,o,e)
var r=mu(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y
return w.some(xT.fixed(za("fixed",w.some(i),c?w.some(u):w.none(),w.none(),c?w.none():w.some(a))))}(u,n,e)},TT=function(t,n){j(["left","right","top","bottom","position"],(function(n){return Ai(t.element,n)})),n.onUndocked(t)},ET=function(t,n,e){Na(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},BT=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u,a,c=(a=o,(u=i).y<a.bottom&&u.bottom>a.y)
c!==e.isVisible()&&(e.setVisible(c),r&&!c?(si(t.element,[n.fadeOutClass]),n.onHide(t)):(c?wT:ST)(t,n))}))}))},AT=function(t,n,e){var o,r,i,u,a
t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&BT(o,r,i,u),_T(o,u,i).each((function(t){i.setDocked(!a),t.fold((function(){return TT(o,r)}),(function(t){return ET(o,r,t)}),(function(t){BT(o,r,i,u,!0),ET(o,r,t)}))})))},MT=function(n,e,o){o.isDocked()&&function(n,e,o){var r,i,u=n.element
o.setDocked(!1),r=o,i=n.element,CT(i,r).bind((function(t){return OT(i,t,r)})).each((function(o){o.fold((function(){return TT(n,e)}),(function(t){return ET(n,e,t)}),t)})),o.setVisible(!0),e.contextual.each((function(t){li(u,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),AT(n,e,o)}(n,e,o)},FT=Object.freeze({__proto__:null,refresh:AT,reset:MT,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),DT=Object.freeze({__proto__:null,events:function(t,n){return Ho([Yo(eo(),(function(e,o){t.contextual.each((function(t){ci(e.element,t.transitionClass)&&(li(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()}))})),Lo(xo(),(function(e,o){AT(e,t,n)})),Lo(wo(),(function(e,o){MT(e,t,n)}))])}}),IT=[Nn("contextual",[Bn("fadeInClass"),Bn("fadeOutClass"),Bn("transitionClass"),Mn("lazyContext"),Hu("onShow"),Hu("onShown"),Hu("onHide"),Hu("onHidden")]),Yn("lazyViewport",mu),jn("modes",["top","bottom"],tn(wn)),Hu("onDocked"),Hu("onUndocked")],RT=Ba({fields:IT,name:"docking",active:DT,apis:FT,state:Object.freeze({__proto__:null,init:function(t){var n=Jn(!1),e=Jn(!0),o=Jn(w.none()),r=Jn(t.modes)
return Jr({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),VT={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},PT="tox-tinymce--toolbar-sticky-on",HT="tox-tinymce--toolbar-sticky-off",zT=function(t){var n=t.element
cr(n).each((function(e){var o,r,i="padding-"+RT.getModes(t)[0]
RT.isDocked(t)?(o=Qi(e),ki(n,"width",o+"px"),ki(e,i,Gi(r=n)+(parseInt(_i(r,"margin-top"),10)||0)+(parseInt(_i(r,"margin-bottom"),10)||0)+"px")):(Ai(n,"width"),Ai(e,i))}))},NT=function(t,n){n?(ai(t,VT.fadeOutClass),si(t,[VT.transitionClass,VT.fadeInClass])):(ai(t,VT.fadeInClass),si(t,[VT.fadeOutClass,VT.transitionClass]))},LT=function(t,n){var e=ne(t.getContainer())
n?(ui(e,PT),ai(e,HT)):(ui(e,HT),ai(e,PT))},jT=function(t,n){var e,o=Jn(w.none()),r=n.getSink,i=function(t){r().each((function(n){return t(n.element)}))},u=function(n){t.inline||zT(n),LT(t,RT.isDocked(n)),n.getSystem().broadcastOn([Ps()],{}),r().each((function(t){return t.getSystem().broadcastOn([Ps()],{})}))},a=t.inline?[]:[Da.config({channels:((e={})[LO()]={onReceive:zT},e)})]
return d([Om.config({}),RT.config({contextual:l({lazyContext:function(n){var e,o=Gi(n.element),r=t.inline?t.getContentAreaContainer():t.getContainer(),i=fu(ne(r)),u=i.height-o,a=i.y+(e=n,"top",P(RT.getModes(e),"top")?0:o)
return w.some(lu(i.x,a,i.width,u))},onShow:function(){i((function(t){return NT(t,!0)}))},onShown:function(t){i((function(t){return li(t,[VT.transitionClass,VT.fadeInClass])})),o.get().each((function(n){var e,r,i
e=t.element,i=rr(r=n),Va(i).filter((function(t){return!Fe(r,t)})).filter((function(t){return Fe(t,ne(i.dom.body))||De(e,t)})).each((function(){return Ra(r)})),o.set(w.none())}))},onHide:function(t){var n,e
o.set((n=t.element,e=r,Pa(n).orThunk((function(){return e().toOptional().bind((function(t){return Pa(t.element)}))})))),i((function(t){return NT(t,!1)}))},onHidden:function(){i((function(t){return li(t,[VT.transitionClass])}))}},VT),modes:[n.header.getDockingMode()],onDocked:u,onUndocked:u})],a)},UT=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(RT.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(zT)})),t.on("SkinLoaded",(function(){e().each((function(t){RT.isDocked(t)?RT.reset(t):RT.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(RT.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){RT.refresh(n)
var e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y=n.element
cd(y)&&(e=t,u=(i=rr(o=y)).dom.defaultView.innerHeight,a=ou(i),c=ne(e.elm),s=du(c),l=Wi(c),d=(f=s.y)+l,m=Ki(o),g=Wi(o),h=(p=m.top)+g,v=Math.abs(p-a.top)<2,b=Math.abs(h-(a.top+u))<2,v&&f<h?ru(a.left,f-g,i):b&&p<d&&(r=f-u+l+g,ru(a.left,r,i)))}))})),t.on("PostRender",(function(){LT(t,!1)}))},isDocked:function(t){return t().map(RT.isDocked).getOr(!1)},getBehaviours:jT}),WT=of({factory:function(t,n){var e={focus:gm.focusIn,setMenus:function(t,e){var o=L(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=QO(e).mapError((function(t){return pn(t)})).getOrDie()
return $S(o,"tox-mbtn",n.backstage,w.some("menuitem"))}))
ym.set(t,o)}}
return{uid:t.uid,dom:t.dom,components:[],behaviours:Ta([ym.config({}),xm("menubar-events",[qo((function(n){t.onSetup(n)})),Lo(qe(),(function(t,n){wu(t.element,".tox-mbtn--active").each((function(e){Su(n.event.target,".tox-mbtn").each((function(n){Fe(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){Cy.expand(t),Cy.close(e),Om.focus(t)}))}))}))}))})),Lo(_o(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){Cy.isOpen(e)&&(Cy.expand(t),Cy.close(e))}))}))}))]),gm.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),w.some(!0)}}),Sb.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Tn("dom"),Tn("uid"),Tn("onEscape"),Tn("backstage"),Ln("onSetup",t)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),GT="container",XT=[el("slotBehaviours",[])],YT=function(t){return"<alloy.field."+t+">"},qT=function(t,n){var e,o=function(n){return Yl(t)},r=function(n,e){return function(o,r){return Ul(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},i=function(t,n){return"true"!==Or(t.element,"aria-hidden")},u=r(i,!1),a=r((function(t,n){var e
i(t)&&(e=t.element,ki(e,"display","none"),Cr(e,"aria-hidden","true"),Do(t,To(),{name:n,visible:!1}))})),c=r((function(t,n){var e
i(t)||(e=t.element,Ai(e,"display"),Er(e,"aria-hidden"),Do(t,To(),{name:n,visible:!0}))})),s={getSlotNames:o,getSlot:function(n,e){return Ul(n,t,e)},isShowing:u,hideSlot:e=a,hideAllSlots:function(t){return function(t,n){j(n,(function(n){return e(t,n)}))}(t,o())},showSlot:c}
return{uid:t.uid,dom:t.dom,components:n,behaviours:ol(t.slotBehaviours),apis:s}},KT=wt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},qr),JT=l(l({},KT),{sketch:function(t){var n,e=(n=[],{slot:function(t,e){return n.push(t),Hl(GT,YT(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=L(r,(function(t){return Bl({name:t,pname:YT(t)})}))
return Zl(GT,XT,i,qT,o)}}),$T=Zt([Hn("icon"),Hn("tooltip"),Yn("onShow",t),Yn("onHide",t),Yn("onSetup",(function(){return t}))]),QT=function(t){return{element:function(){return t.element.dom}}},ZT=function(n,e){var o=L(bt(e),(function(t){var n=e[t],o=mn(dn("sidebar",$T,n))
return{name:t,getApi:QT,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}))
return L(o,(function(e){var r=Jn(t)
return n.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Rp([zh(e,r),Nh(e,r),Lo(To(),(function(t,n){var e=n.event
Y(o,(function(t){return t.name===e.name})).each((function(n){(e.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},tE=function(t){return lf.getCurrent(t).bind((function(t){return RO.isGrowing(t)||RO.hasGrown(t)?lf.getCurrent(t).bind((function(t){return Y(JT.getSlotNames(t),(function(n){return JT.isShowing(t,n)}))})):w.none()}))},nE=Dr("FixSizeEvent"),eE=Dr("AutoSizeEvent"),oE=function(t){var n,e,o,r=Qn(t),i=fr(r),u=(e=void 0!==(n=r).dom.attributes?n.dom.attributes:[],X(e,(function(t,n){var e
return"class"===n.name?t:l(l({},t),((e={})[n.name]=n.value,e))}),{})),a=(o=r,Array.prototype.slice.call(o.dom.classList,0)),c=0===i.length?{}:{innerHtml:wr(r)}
return l({tag:Qo(r),classes:a,attributes:u},c)},rE=sT.optional({factory:WT,name:"menubar",schema:[Tn("backstage")]}),iE=sT.optional({factory:{sketch:function(t){return mT.sketch({uid:t.uid,dom:t.dom,listBehaviours:Ta([gm.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return qO({type:t.type,uid:Dr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),w.some(!0)}})},setupItem:function(t,n,e,o){ZC.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[Tn("dom"),Tn("onEscape")]}),uE=sT.optional({factory:{sketch:function(t){var n
return((n=t).type===ip.sliding?YO:n.type===ip.floating?XO:qO)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),w.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[Tn("dom"),Tn("onEscape"),Tn("getSink")]}),aE=sT.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?jT:hT
return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Ta(e(n,t.sharedBackstage))}}},name:"header",schema:[Tn("dom")]}),cE=sT.optional({name:"socket",schema:[Tn("dom")]}),sE=sT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Ta([Sb.config({}),Om.config({}),RO.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){lf.getCurrent(t).each(JT.hideAllSlots),Fo(t,eE)},onGrown:function(t){Fo(t,eE)},onStartGrow:function(t){Do(t,nE,{width:Ei(t.element,"width").getOr("")})},onStartShrink:function(t){Do(t,nE,{width:Qi(t.element)+"px"})}}),ym.config({}),lf.config({find:function(t){var n=ym.contents(t)
return nt(n)}})])}],behaviours:Ta([_w(0),xm("sidebar-sliding-events",[Lo(nE,(function(t,n){ki(t.element,"width",n.event.width)})),Lo(eE,(function(t,n){Ai(t.element,"width")}))])])}}},name:"sidebar",schema:[Tn("dom")]}),lE=sT.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Ta([ym.config({})]),components:[]}}},name:"throbber",schema:[Tn("dom")]}),fE=rf({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return cT.getPart(n,t,"socket")},setSidebar:function(n,e){cT.getPart(n,t,"sidebar").each((function(t){return function(t,n){lf.getCurrent(t).each((function(t){return ym.set(t,[(e=n,JT.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:ZT(t,e),slotBehaviours:Rp([qo((function(t){return JT.hideAllSlots(t)}))])}})))])
var e}))}(t,e)}))},toggleSidebar:function(n,e){cT.getPart(n,t,"sidebar").each((function(t){return n=t,o=e,void lf.getCurrent(n).each((function(t){lf.getCurrent(t).each((function(n){RO.hasGrown(t)?JT.isShowing(n,o)?RO.shrink(t):(JT.hideAllSlots(n),JT.showSlot(n,o)):(JT.hideAllSlots(n),JT.showSlot(n,o),RO.grow(t))}))}))
var n,o}))},whichSidebar:function(n){return cT.getPart(n,t,"sidebar").bind(tE).getOrNull()},getHeader:function(n){return cT.getPart(n,t,"header")},getToolbar:function(n){return cT.getPart(n,t,"toolbar")},setToolbar:function(n,e){cT.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){cT.getPart(n,t,"multiple-toolbar").each((function(t){mT.setItems(t,e)}))},refreshToolbar:function(n){cT.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){cT.getPart(n,t,"toolbar").each((function(t){var n,e
e=function(n){return n(t)},null!=(n=t.getApis().toggle)?w.some(e(n)):w.none()}))},isToolbarDrawerToggled:function(n){return cT.getPart(n,t,"toolbar").bind((function(t){return w.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return cT.getPart(n,t,"throbber")},focusToolbar:function(n){cT.getPart(n,t,"toolbar").orThunk((function(){return cT.getPart(n,t,"multiple-toolbar")})).each((function(t){gm.focusIn(t)}))},setMenubar:function(n,e){cT.getPart(n,t,"menubar").each((function(t){WT.setMenus(t,e)}))},focusMenubar:function(n){cT.getPart(n,t,"menubar").each((function(t){WT.focus(t)}))}}
return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[Tn("dom"),Tn("behaviours")],partFields:[aE,rE,uE,iE,cE,sE,lE],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=L(e,UO)
t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=L(e,(function(t){return L(t,UO)}))
t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),dE={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},mE=function(t){return"string"==typeof t?t.split(" "):t},gE=function(t,n){var e=l(l({},dE),n.menus),o=0<bt(n.menus).length,r=void 0===n.menubar||!0===n.menubar?mE("file edit view insert format tools table help"):mE(!1===n.menubar?"":n.menubar),i=W(r,(function(t){return o&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||dE.hasOwnProperty(t)})),u=L(i,(function(o){var r,i,u,a=e[o]
return r={title:a.title,items:mE(a.items)},i=n,u=t.getParam("removed_menuitems","").split(/[ ,]/),{text:r.title,getItems:function(){return J(r.items,(function(t){var n=t.toLowerCase()
return 0===n.trim().length||H(u,(function(t){return t===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:i.menuItems[n]?[i.menuItems[n]]:[]}))}}}))
return W(u,(function(t){return 0<t.getItems().length&&H(t.getItems(),(function(t){return"separator"!==t.type}))}))},pE=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")}
return function(){t.initialized?n():t.on("init",n)}},hE=function(t,n){var e,o,r,i,u,a,c=(r=(e=n).getParam("skin"),i=e.getParam("skin_url"),!1!==r&&(o=r||"oxide",i=i?e.documentBaseURI.toAbsolute(i):uh.baseURL+"/skins/ui/"+o),i)
c&&(u=c+"/skin.min.css",n.contentCSS.push(c+(t?"/content.inline":"/content")+".min.css")),0==(!1===n.getParam("skin"))&&u?((a=n.ui.styleSheetLoader).load(u,pE(n),function(t,n){return function(){return e={message:n},t.fire("SkinLoadError",e)
var e}}(n,"Skin could not be loaded")),n.on("remove",(function(){return a.unload(u)}))):pE(n)()},vE=r(hE,!1),bE=r(hE,!0),yE=function(t,n,e,o){var r,i=n.outerContainer,u=e.toolbar,a=e.buttons
F(u,C)?(r=u.map((function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups}
return eT(t,r,{backstage:o},w.none())})),fE.setToolbars(i,r)):fE.setToolbar(i,eT(t,e,{backstage:o},w.none()))},xE=Wp.DOM,wE=Be(),SE=wE.os.isiOS()&&wE.os.version.major<=12,kE=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=Jn(0),u=n.outerContainer
vE(t)
var a,c,s=ne(r.targetNode),l=hi(pi(s))
a=s,c=n.mothership,Cs(a,c,gr),ks(l,n.uiMothership),t.on("PostRender",(function(){yE(t,n,e,o),i.set(t.getWin().innerWidth),fE.setMenubar(u,gE(t,e)),fE.setSidebar(u,e.sidebar),function(t,n){var e=t.getWin(),o=t.getDoc().documentElement,r=Jn(Yi(e.innerWidth,e.innerHeight)),i=Jn(Yi(o.offsetWidth,o.offsetHeight)),u=function(){var n=r.get()
n.left===e.innerWidth&&n.top===e.innerHeight||(r.set(Yi(e.innerWidth,e.innerHeight)),yv(t))},a=function(){var n=t.getDoc().documentElement,e=i.get()
e.left===n.offsetWidth&&e.top===n.offsetHeight||(i.set(Yi(n.offsetWidth,n.offsetHeight)),yv(t))},c=function(n){return e=n,t.fire("ScrollContent",e)
var e}
xE.bind(e,"resize",u),xE.bind(e,"scroll",c)
var s=Jv(ne(t.getBody()),"load",a),l=n.uiMothership.element
t.on("hide",(function(){ki(l,"display","none")})),t.on("show",(function(){Ai(l,"display")})),t.on("NodeChange",a),t.on("remove",(function(){s.unbind(),xE.unbind(e,"resize",u),xE.unbind(e,"scroll",c)}))}(t,n)}))
var f,d,m,g=fE.getSocket(u).getOrDie("Could not find expected socket element")
SE&&(Ci(g.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),d=function(){t.fire("ScrollContent")},20,m=null,f={cancel:function(){null!==m&&(clearTimeout(m),m=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]
null===m&&(m=setTimeout((function(){d.apply(null,t),m=null}),20))}},Kv(g.element,"scroll",f.throttle)),Fh(t,n),t.addCommand("ToggleSidebar",(function(n,e){fE.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return fE.whichSidebar(u)}))
var p=yh(t)
return p!==ip.sliding&&p!==ip.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth
e!==i.get()&&(fE.refreshToolbar(n.outerContainer),i.set(e))})),{iframeContainer:g.element.dom,editorContainer:u.element.dom}}}),CE=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?w.some(parseInt(""+t,10)):w.none()},OE=function(t){return M(t)?t+"px":t},_E=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return n<t}))
return o.or(r).getOr(t)},TE=function(t){var n=ch(t),e=sh(t),o=fh(t)
return CE(n).map((function(t){return _E(t,e,o)}))},EE=function(t,n){var e=fu(t)
return{pos:n?e.y:e.bottom,bounds:e}},BE=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=Jn(null),s=ne(r.targetNode),l=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=Wp.DOM,c=_h(t),s=Eh(t),l=fh(t).or(TE(t)),f=o.shared.header,d=f.isPositionedAtTop,m=yh(t),g=m===ip.sliding||m===ip.floating,p=Jn(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold((function(){return 0}),(function(t){return 1<t.components().length?Wi(t.components()[1].element):0})):0},b=function(){i.broadcastOn([Ps()],{})},y=function(t){var e,o,i,a,f,m
void 0===t&&(t=!1),h()&&(c||(e=l.getOrThunk((function(){var t=CE(_i(yi(),"margin-left")).getOr(0)
return Qi(yi())-Ki(n).left+t})),ki(r.get().element,"max-width",e+"px")),g&&fE.refreshToolbar(u),c||(o=fE.getToolbar(u),i=v(o),a=fu(n),f=d()?Math.max(a.y-Wi(r.get().element)+i,0):a.bottom,Ci(u.element,{position:"absolute",top:Math.round(f)+"px",left:Math.round(a.x)+"px"})),s&&(m=r.get(),t?RT.reset(m):RT.refresh(m)),b())},x=function(e){var o,i
void 0===e&&(e=!0),!c&&s&&h()&&(o=f.getDockingMode(),(i=function(e){switch(kh(t)){case vh.auto:var o=fE.getToolbar(u),r=v(o),i=Wi(e.element)-r,a=fu(n)
if(a.y>i)return"top"
var c=ur(n),s=Math.max(c.dom.scrollHeight,Wi(c))
return a.bottom<s-i||mu().bottom<a.bottom-i?"bottom":"top"
case vh.bottom:return"bottom"
case vh.top:default:return"top"}}(r.get()))!==o&&(function(t){var n=r.get()
RT.setModes(n,[t]),f.setDockingMode(t)
var e=d()?Ou.TopToBottom:Ou.BottomToTop
Cr(n.element,ac,e)}(i),e&&y(!0)))}
return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),ki(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),Ai(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(ki(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),ki(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}}(t,s,n,o,c),f=t.getParam("toolbar_persist",!1,"boolean")
bE(t)
var d=function(){var r,d
c.get()?l.show():(c.set(fE.getHeader(a).getOrDie()),r=Oh(d=t).getOrThunk((function(){return hi(pi(ne(d.getElement())))})),ks(r,i),ks(r,u),yE(t,n,e,o),fE.setMenubar(a,gE(t,e)),l.show(),function(t,n,e,o){var r=Jn(EE(n,e.isPositionedAtTop())),i=function(o){var i=EE(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width
r.set({pos:u,bounds:a}),f&&yv(t,o),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))}
o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){yg.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}))
var u=Y_()
u.set(Jv(ne(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,l,f),t.nodeChanged())}
t.on("show",d),t.on("hide",l.hide),f||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",(function(){(t.hasFocus()||f)&&d()})),Fh(t,n)
var m={show:function(){l.show()},hide:function(){l.hide()}}
return{editorContainer:a.element.dom,api:m}}}),AE=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},ME=function(t){var n;(function(t){var n,e
!function(t){kk.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:q_(t,n.name),onAction:AE(t,n.name)})}))
for(var n=1;n<=6;n++){var e="h"+n
t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:q_(t,e),onAction:AE(t,e)})}}(t),n=t,kk.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})})),e=t,kk.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:q_(e,t.name)})}))})(t),n=t,kk.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:AE(n,"code")})},FE=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())}
return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},DE={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},IE=(M_="[eE][+-]?[0-9]+",D_=["Infinity",(A_="[0-9]+")+"\\."+(F_=function(t){return"(?:"+t+")?"})(A_)+F_(M_),"\\."+A_+F_(M_),A_+F_(M_)].join("|"),new RegExp("^([+-]?(?:"+D_+"))(.*)$")),RE=function(t){return function(t,n){return w.from(IE.exec(t)).bind((function(t){var e,o=Number(t[1]),r=t[2]
return e=r,H(n,(function(t){return H(DE[t],(function(t){return e===t}))}))?w.some({value:o,unit:r}):w.none()}))}(t,["fixed","relative","empty"]).map((function(t){return t.value+t.unit})).getOr(t)},VE=function(t){var n=t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),e=new Map,o=X_((function(t){return t.destroy()})),r=function(){var n=RE(t.queryCommandValue("LineHeight"))
w.from(e.get(n)).fold((function(){return o.clear()}),(function(t){o.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)}))}
return t.on("nodeChange",r),L(n,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(RE(i),a),u+1===n.length&&r(),function(){0===u&&(t.off("nodeChange",r),o.clear())}},onAction:function(){return t.execCommand("LineHeight",!1,i)}}}))},PE=function(t,n){var e,o,r,i
!function(t){kk.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:q_(t,n.name)})}))
t.ui.registry.addButton("alignnone",{tooltip:"No alignment",onAction:function(){return t.execCommand("JustifyNone")},icon:"align-none"})}(t),ME(t),function(t,n){var e,o,r,i,u,a,c,s,f,d,m,g,p,h
r=E_(0,o=n,H_(e=t)),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}}),a=E_(0,u=n,L_(i=t)),i.ui.registry.addNestedMenuItem("fontformats",{text:u.shared.providers.translate("Fonts"),getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=t,f=l({type:"advanced"},(s=n).styleselect),d=E_(0,s,$_(c,f)),c.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return d.items.validateItems(d.getStyleItems())}}),g=E_(0,n,J_(m=t)),m.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return g.items.validateItems(g.getStyleItems())}}),h=E_(0,n,U_(p=t)),p.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return h.items.validateItems(h.getStyleItems())}})}(t,n),function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return FE(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return FE(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return FE(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return FE(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})}(t),function(t){(function(t){t.addCommand("mceApplyTextcolor",(function(n,e){var o,r,i
r=n,i=e,(o=t).undoManager.transact((function(){o.focus(),o.formatter.apply(r,{value:i}),o.nodeChanged()}))})),t.addCommand("mceRemoveTextcolor",(function(n){var e,o
o=n,(e=t).undoManager.transact((function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()}))}))})(t)
var n=Jn(null),e=Jn(null)
Dv(t,"forecolor","forecolor","Text color",n),Dv(t,"backcolor","hilitecolor","Background color",e),Iv(t,"forecolor","forecolor","Text color"),Iv(t,"backcolor","hilitecolor","Background color")}(t),(o=e=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return o.execCommand("mceToggleVisualAid")}}),(r=e).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(t,n){t.setActive(n.hasVisual)
var e=function(n){t.setActive(n.hasVisual)}
return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(t,r)},onAction:function(){r.execCommand("mceToggleVisualAid")}}),(i=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"))
var e=function(){t.setDisabled(!n.queryCommandState("outdent"))}
return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,i)},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return VE(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(VE(e))}})}(t)},HE=function(t,n){return{anchor:"makeshift",x:t,y:n}},zE=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},NE=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(zE(t)){var n=t.touches[0]
return HE(n.pageX,n.pageY)}return HE(t.pageX,t.pageY)}(n):function(t,n){var e,o,r,i=Wp.DOM.getPos(t)
return e=n,o=i.x,r=i.y,HE(e.x+o,e.y+r)}(t.getContentAreaContainer(),function(t){if(zE(t)){var n=t.touches[0]
return HE(n.clientX,n.clientY)}return HE(t.clientX,t.clientY)}(n)):LE(t)},LE=function(t){return{anchor:"selection",root:ne(t.selection.getNode())}},jE=function(t){return{anchor:"node",node:w.some(ne(t.selection.getNode())),root:ne(t.getBody())}},UE=function(t,n,e,o,r,i){var u=e(),a=i?jE(t):NE(t,n)
KS(u,ap.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),ag.showMenuAt(r,a,{menu:{markers:bp("normal")},data:t})}))},WE={onLtr:function(){return[ma,ca,sa,la,fa,da,vg,bg,pg,mg,hg,gg]},onRtl:function(){return[ma,sa,ca,fa,la,da,vg,bg,hg,gg,pg,mg]}},GE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},XE=function(t,n,e,o,r,i){var u,a=Be(),c=a.os.isiOS(),s=a.os.isOSX(),f=a.os.isAndroid(),d=a.deviceType.isTouch(),m=function(){var u=e();(function(t,n,e,o,r,i,u){var a,c,s=i?jE(t):(a=t,c=n,l({bubble:oc(0,12,GE),layouts:WE,overrides:{maxWidthFunction:KC(),maxHeightFunction:Za()}},NE(a,c)))
KS(e,ap.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),ag.showMenuWithinBounds(r,s,{menu:{markers:bp("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return w.some(w_(t,o.shared))})),t.fire(JC)}))})(t,n,u,o,r,i,!(f||c||s&&d))}
!s&&!c||i?(f&&!i&&t.selection.setCursorLocation(n.target,0),m()):(u=function(){!function(t){var n=t.selection.getRng(),e=function(){yg.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()}
t.once("touchend",e)
var o=function(t){t.preventDefault(),t.stopImmediatePropagation()}
t.on("mousedown",o,!0)
var r=function(){return i()}
t.once("longpresscancel",r)
var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),m()},function(t,n){var e=t.selection
if(e.isCollapsed()||n.touches.length<1)return!1
var o=n.touches[0],r=e.getRng()
return Ic(t.getWin(),vc.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?u():(t.once("selectionchange",u),t.once("touchend",(function(){return t.off("selectionchange",u)}))))},YE=function(t){return"string"==typeof t?t.split(/[ ,]/):t},qE=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},KE=function(t){return C(t)?"|"===t:"separator"===t.type},JE={type:"separator"},$E=function(t){if(C(t))return t
switch(t.type){case"separator":return JE
case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var n=t.getSubmenuItems()
return C(n)?n:L(n,$E)}}
default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:(n=t.onAction,function(){return n()})}}var n},QE=function(t,n){if(0===n.length)return t
var e=et(t).filter((function(t){return!KE(t)})).fold((function(){return[]}),(function(t){return[JE]}))
return t.concat(e).concat(n).concat([JE])},ZE=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},tB=function(t,n){return ZE(t,n)?t.selection.getStart(!0):n.target},nB=function(t,n,e){var o=Be().deviceType.isTouch,r=Ni(ag.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Ta([xm("dismissContextMenu",[Lo(Co(),(function(n,e){Rs.close(n),t.focus()}))])])})),i=function(t){return ag.hide(r)},u=function(n){var i,u
qE(t)&&n.preventDefault(),i=t,n.ctrlKey&&!qE(i)||!1===t.getParam("contextmenu")||(u=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string")
if(ZE(t,n))return!0
if(e){var o=tB(t,n)
return Qv(ne(o),e)}return!1}(t,n),(o()?XE:UE)(t,n,(function(){var e,o,r,i=tB(t,n),u=t.ui.registry.getAll(),a=function(t){return e=(n=t).ui.registry.getAll().contextMenus,w.from(n.getParam("contextmenu")).map(YE).getOrThunk((function(){return W(YE("link linkchecker image imagetools table spellchecker configurepermanentpen"),(function(t){return Tt(e,t)}))}))
var n,e}(t)
return e=u.contextMenus,o=i,0<(r=X(a,(function(t,n){if(Tt(e,n)){var r=e[n].update(o)
if(C(r))return QE(t,r.split(" "))
if(0<r.length){var i=L(r,$E)
return QE(t,i)}return t}return t.concat([n])}),[])).length&&KE(r[r.length-1])&&r.pop(),r}),e,r,u))}
t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow")
t.on(n,i),t.on("longpress contextmenu",u)}))},eB=Bt([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),oB=function(t){return function(n){return n.translate(-t.left,-t.top)}},rB=function(t){return function(n){return n.translate(t.left,t.top)}},iB=function(t){return function(n,e){return X(t,(function(t,n){return n(t)}),Yi(n,e))}},uB=function(t,n,e){return t.fold(iB([rB(e),oB(n)]),iB([oB(n)]),iB([]))},aB=function(t,n,e){return t.fold(iB([rB(e)]),iB([]),iB([rB(n)]))},cB=function(t,n,e){return t.fold(iB([]),iB([oB(e)]),iB([rB(n),oB(e)]))},sB=function(t,n,e){var o=t.fold((function(t,n){return{position:w.some("absolute"),left:w.some(t+"px"),top:w.some(n+"px")}}),(function(t,n){return{position:w.some("absolute"),left:w.some(t-e.left+"px"),top:w.some(n-e.top+"px")}}),(function(t,n){return{position:w.some("fixed"),left:w.some(t+"px"),top:w.some(n+"px")}}))
return l({right:w.none(),bottom:w.none()},o)},lB=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o)
return r(i.getOr(a.left),u.getOr(a.top))}}
return t.fold(r(cB,fB),r(aB,dB),r(uB,mB))},fB=eB.offset,dB=eB.absolute,mB=eB.fixed,gB=function(t,n){var e=Or(t,n)
return E(e)?NaN:parseInt(e,10)},pB=function(t,n,e,o,r,i){var u,a,c,s=function(t,n,e,o){return r=n,i=t.element,u=gB(i,r.leftAttr),a=gB(i,r.topAttr),(isNaN(u)||isNaN(a)?w.none():w.some(Yi(u,a))).fold((function(){return e}),(function(t){return mB(t.left+o.left,t.top+o.top)}))
var r,i,u,a}(t,n,e,o),l=(n.mustSnap?vB:bB)(t,n,s,r,i),f=uB(s,r,i)
return u=n,a=f,c=t.element,Cr(c,u.leftAttr,a.left+"px"),Cr(c,u.topAttr,a.top+"px"),l.fold((function(){return{coord:mB(f.left,f.top),extra:w.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},hB=function(t,n,e,o){return rt(t,(function(t){var r,i,u,a,c,s,l,f,d=t.sensor
return r=n,i=d,u=t.range.left,a=t.range.top,l=aB(r,c=e,s=o),f=aB(i,c,s),Math.abs(l.left-f.left)<=u&&Math.abs(l.top-f.top)<=a?w.some({output:lB(t.output,n,e,o),extra:t.extra}):w.none()}))},vB=function(t,n,e,o,r){var i=n.getSnapPoints(t)
return hB(i,e,o,r).orThunk((function(){return X(i,(function(t,n){var i,u,a,c,s,l,f,d,m=n.sensor,g=(i=e,u=m,n.range.left,n.range.top,s=aB(i,a=o,c=r),l=aB(u,a,c),f=Math.abs(s.left-l.left),d=Math.abs(s.top-l.top),Yi(f,d))
return t.deltas.fold((function(){return{deltas:w.some(g),snap:w.some(n)}}),(function(e){return(g.left+g.top)/2<=(e.left+e.top)/2?{deltas:w.some(g),snap:w.some(n)}:t}))}),{deltas:w.none(),snap:w.none()}).snap.map((function(t){return{output:lB(t.output,e,o,r),extra:t.extra}}))}))},bB=function(t,n,e,o,r){var i=n.getSnapPoints(t)
return hB(i,e,o,r)},yB=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r,i,u,a,c,s,l,f=n.getTarget(t.element)
n.repositionTarget&&(r=rr(t.element),s=ou(r),l=i=yT(f),u={coord:lB((c=o).output,c.output,s,l),extra:c.extra},a=sB(u.coord,0,i),Oi(f,a))}}),xB="data-initial-z-index",wB=function(t,n){var e
t.getSystem().addToGui(n),cr((e=n).element).filter(tr).each((function(t){Ei(t,"z-index").each((function(n){Cr(t,xB,n)})),ki(t,"z-index",_i(e.element,"z-index"))}))},SB=function(t){cr(t.element).filter(tr).each((function(t){_r(t,xB).fold((function(){return Ai(t,"z-index")}),(function(n){return ki(t,"z-index",n)})),Er(t,xB)})),t.getSystem().removeFromGui(t)},kB=function(t,n,e){return t.getSystem().build(pb.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},CB=Nn("snaps",[Tn("getSnapPoints"),Hu("onSensor"),Tn("leftAttr"),Tn("topAttr"),Ln("lazyViewport",mu),Ln("mustSnap",!1)]),OB=[Ln("useFixed",a),Tn("blockerClass"),Ln("getTarget",o),Ln("onDrag",t),Ln("repositionTarget",!0),Ln("onDrop",t),Yn("getBounds",mu),CB],_B=function(t,n){return{bounds:t.getBounds(),height:Gi(n.element),width:Zi(n.element)}},TB=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return _B(n,t)}))
i.each((function(e){var o,r,i,a,c,s,l,f,d,m,g
o=t,i=u,a=e,g=(r=n).getTarget(o.element),r.repositionTarget&&(c=rr(o.element),s=ou(c),l=yT(g),f=function(t){return n=Ei(t,"left"),e=Ei(t,"top"),o=Ei(t,"position"),r=function(t,n,e){return("fixed"===e?mB:fB)(parseInt(t,10),parseInt(n,10))},(n.isSome()&&e.isSome()&&o.isSome()?w.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):w.none()).getOrThunk((function(){var n=Ki(t)
return dB(n.left,n.top)}))
var n,e,o,r}(g),d=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h=n.fold((function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold((function(t,e){return fB(t+n,e+u)}),(function(t,e){return dB(t+n,e+u)}),(function(t,e){return mB(t+n,e+u)}))),c=uB(a,o,r)
return mB(c.left,c.top)}),(function(n){var u=pB(t,n,e,i,o,r)
return u.extra.each((function(e){n.onSensor(t,e)})),u.coord}))
return a=h,c=o,s=r,f=(l=u).bounds,d=aB(a,c,s),m=qa(d.left,f.x,f.x+f.width-l.width),g=qa(d.top,f.y,f.y+f.height-l.height),p=dB(m,g),a.fold((function(){var t=cB(p,c,s)
return fB(t.left,t.top)}),(function(){return p}),(function(){var t=uB(p,c,s)
return mB(t.left,t.top)}))}(o,r.snaps,f,s,l,a,i),m=sB(d,0,l),Oi(g,m)),r.onDrag(o,g,a)}))},EB=function(t,n,e,o){n.each(SB),e.snaps.each((function(n){(function(t,n){var e,o
e=n,o=t.element,Er(o,e.leftAttr),Er(o,e.topAttr)})(t,n)}))
var r=e.getTarget(t.element)
o.reset(),e.onDrop(t,r)},BB=function(t){return function(n,e){var o=function(t){e.setStartData(_B(n,t))}
return Ho(d([Lo(xo(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o)))}},AB=Object.freeze({__proto__:null,getData:function(t){return w.from(Yi(t.x,t.y))},getDelta:function(t,n){return Yi(n.left-t.left,n.top-t.top)}}),MB=function(t,n,e){return[Lo(We(),(function(o,r){var i,u,a,c,s
0===r.event.raw.button&&(r.stop(),a={drop:i=function(){return EB(o,w.some(c),t,n)},delayDrop:(u=Zv(i,200)).schedule,forceDrop:i,move:function(e){u.cancel(),TB(o,t,n,AB,e)}},c=kB(o,t.blockerClass,(s=a,Ho([Lo(We(),s.forceDrop),Lo(Ye(),s.drop),Lo(Ge(),(function(t,n){s.move(n.event)})),Lo(Xe(),s.delayDrop)]))),e(o),wB(o,c))}))]},FB=d(OB,[ju("dragger",{handlers:BB(MB)})]),DB=Object.freeze({__proto__:null,getData:function(t){var n,e=t.raw.touches
return 1===e.length?(n=e[0],w.some(Yi(n.clientX,n.clientY))):w.none()},getDelta:function(t,n){return Yi(n.left-t.left,n.top-t.top)}}),IB=function(t,n,e){var o=Jn(w.none())
return[Lo(Ne(),(function(r,i){i.stop()
var u,a=function(){EB(r,o.get(),t,n),o.set(w.none())},c={drop:a,delayDrop:function(){},forceDrop:a,move:function(e){TB(r,t,n,DB,e)}},s=kB(r,t.blockerClass,(u=c,Ho([Lo(Ne(),u.forceDrop),Lo(je(),u.drop),Lo(Ue(),u.drop),Lo(Le(),(function(t,n){u.move(n.event)}))])))
o.set(w.some(s)),e(r),wB(r,s)})),Lo(Le(),(function(e,o){o.stop(),TB(e,t,n,DB,o.event)})),Lo(je(),(function(e,r){r.stop(),EB(e,o.get(),t,n),o.set(w.none())})),Lo(Ue(),(function(e){EB(e,o.get(),t,n),o.set(w.none())}))]},RB=d(OB,[ju("dragger",{handlers:BB(IB)})]),VB=d(OB,[ju("dragger",{handlers:BB((function(t,n,e){return d(MB(t,n,e),IB(t,n,e))}))})]),PB=Ma({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:FB,touch:RB,mouseOrTouch:VB}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:w.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=w.none(),n=w.none(),o=e({})
return Jr({readState:o,reset:function(){t=w.none(),n=w.none()},update:function(n,e){return n.getData(e).bind((function(e){return o=n,r=e,i=t.map((function(t){return o.getDelta(t,r)})),t=w.some(r),i
var o,r,i}))},getStartData:function(){return n},setStartData:function(t){n=w.some(t)}})}}),apis:yB}),HB=function(t,n,e,o,r,i){return t.fold((function(){return PB.snap({sensor:dB(e-20,o-20),range:Yi(r,i),output:dB(w.some(e),w.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect()
return PB.snap({sensor:dB(r,i),range:Yi(40,40),output:dB(w.some(e-u.width/2),w.some(o-u.height/2)),extra:{td:n}})}))},zB=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r,i,u=o.td
r=n.get(),i=u,r.exists((function(t){return Fe(t,i)}))||(n.set(w.some(u)),e(u))},mustSnap:!0}},NB=function(t){return wg(xg.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Ta([PB.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Oy.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},LB=function(t,n){var e=Jn([]),o=Jn([]),r=Jn(!1),i=Jn(w.none()),u=Jn(w.none()),a=function(t){var e=du(t)
return HB(f.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=du(t)
return HB(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=zB((function(){return L(e.get(),a)}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),l=zB((function(){return L(o.get(),c)}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),f=NB(s),d=NB(l),m=Ni(f.asSpec()),g=Ni(d.asSpec()),p=function(n,e,o,r){var i=o(e)
PB.snapTo(n,i),function(n,e,o,r){var i=e.dom.getBoundingClientRect()
Ai(n.element,"display")
var u=ar(ne(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&ki(n.element,"display","none")}(n,e,(function(t){return t[r]<0}),(function(t,n){return t[r]>n}))},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")}
Be().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(bs(n,m),bs(n,g),r.set(!0)),i.set(w.some(t.start)),u.set(w.some(t.finish)),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),t.on("TableSelectionClear",(function(){r.get()&&(ws(m),ws(g),r.set(!1)),i.set(w.none()),u.set(w.none())})))};(R_=I_=I_||{})[R_.None=0]="None",R_[R_.Both=1]="Both",R_[R_.Vertical=2]="Vertical"
var jB,UB,WB=function(t,n){var e,o,r,i,u,a
return{dom:{tag:"div",classes:["tox-statusbar"]},components:(u=function(){var e,o,r,i,u,a=[]
return t.getParam("elementpath",!0,"boolean")&&a.push(function(t,n,e){return n.delimiter||(n.delimiter="»"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Ta([gm.config({mode:"flow",selector:"div[role=button]"}),ih.config({disabled:e.isReadOnly}),Dh(),Sb.config({}),ym.config({}),xm("elementPathEvents",[qo((function(o,r){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return gm.focusIn(o)})),t.on("NodeChange",(function(r){var i,u,a=function(n){for(var e=[],o=n.length;0<o--;){var r=n[o]
if(1===r.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0
if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r})
if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents)
0<a.length?ym.set(o,(i=L(a||[],(function(n,o){return xg.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:Ta([Rh(e.isReadOnly),Dh()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},X(i.slice(1),(function(t,n){var e=t
return e.push(u),e.push(n),e}),[i[0]]))):ym.set(o,[])}))}))])]),components:[]}}(t,{},n)),t.hasPlugin("wordcount")&&a.push((e=t,o=n,i=function(t,n,e){return ym.set(t,[Pi(o.translate(["{0} "+e,n[e]]))])},xg.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Ta([Rh(o.isReadOnly),Dh(),Sb.config({}),ym.config({}),nl.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),xm("wordcount-events",[$o((function(t){var n=nl.getValue(t),e="words"===n.mode?"characters":"words"
nl.setValue(t,{mode:e,count:n.count}),i(t,n.count,e)})),qo((function(t){e.on("wordCountUpdate",(function(n){var e=nl.getValue(t).mode
nl.setValue(t,{mode:e,count:n.wordCount}),i(t,n.wordCount,e)}))}))])]),eventOrder:((r={})[lo()]=["disabling","alloy.base.behaviour","wordcount-events"],r)}))),t.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(u=Gp.translate(["Powered by {0}","Tiny"]))+'">'+u+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),o=!(e=t).hasPlugin("autoresize"),(a=!1===(r=e.getParam("resize",o))?I_.None:"both"===r?I_.Both:I_.Vertical)!==I_.None&&u.push((i=a,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize"),"aria-hidden":"true"},innerHtml:kg("resize-handle",n.icons)},behaviours:Ta([PB.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,e,o){(function(t,n,e){var o,r,i,u,a,c,s=ne(t.getContainer()),l=(o=t,r=n,i=e,u=Wi(s),a=Qi(s),(c={}).height=_E(u+r.top,lh(o),dh(o)),i===I_.Both&&(c.width=_E(a+r.left,sh(o),fh(o))),c)
xt(l,(function(t,n){return ki(s,n,OE(t))})),t.fire("ResizeEditor")})(t,o,i)},blockerClass:"tox-blocker"})])})),u)}},GB=function(t){var n,e=t.inline,o=e?BE:kE,r=Eh(t)?UT:vT,i=w.none(),u=Be(),a=u.browser.isIE()?["tox-platform-ie"]:[],c=u.deviceType.isTouch()?["tox-platform-touch"]:[],s=Ch(t),f=Gp.isRtl()?{attributes:{dir:"rtl"}}:{},d={attributes:((n={})[ac]=s?Ou.BottomToTop:Ou.TopToBottom,n)},m=function(){return i.bind(fE.getHeader)},g=Ni({dom:l({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(c)},f),behaviours:Ta([ms.config({useFixed:function(){return r.isDocked(m)}})])}),p=function(){return at.value(g)},h=wg({dom:{tag:"div",classes:["tox-anchorbar"]}}),v=function(){return i.bind((function(t){return fE.getThrobber(t)})).getOrDie("Could not find throbber element")},b=qC(g,t,(function(){return i.bind((function(t){return h.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),y=fE.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:b,onEscape:function(){t.focus()}}),x=yh(t),S=fE.parts.toolbar(l({dom:{tag:"div",classes:["tox-toolbar"]},getSink:p,providers:b.shared.providers,onEscape:function(){t.focus()},type:x,lazyToolbar:function(){return i.bind((function(t){return fE.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return m().getOrDie("Could not find header element")}},d)),k=fE.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:b.shared.providers,onEscape:function(){t.focus()},type:x}),C=fE.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),O=fE.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),_=fE.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:b}),T=t.getParam("statusbar",!0,"boolean")&&!e?w.some(WB(t,b.shared.providers)):w.none(),E={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[C,O]},B=hh(t),A=gh(t),F=mh(t),D=fE.parts.header({dom:l({tag:"div",classes:["tox-editor-header"]},d),components:K([F?[y]:[],B?[k]:A?[S]:[],_h(t)?[]:[h.asSpec()]]),sticky:Eh(t),editor:t,sharedBackstage:b.shared}),I=K([s?[]:[D],e?[]:[E],s?[D]:[]]),R=K([[{dom:{tag:"div",classes:["tox-editor-container"]},components:I}],e?[]:T.toArray(),[_]]),V=Th(t),P=l(l({role:"application"},Gp.isRtl()?{dir:"rtl"}:{}),V?{"aria-hidden":"true"}:{}),H=Ni(fE.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(s?["tox-tinymce--toolbar-bottom"]:[]).concat(c).concat(a),styles:l({visibility:"hidden"},V?{opacity:"0",border:"0"}:{}),attributes:P},components:R,behaviours:Ta([gm.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}))
i=w.some(H)
t.shortcuts.add("alt+F9","focus menubar",(function(){fE.focusMenubar(H)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){fE.focusToolbar(H)})),t.addCommand("ToggleToolbarDrawer",(function(){fE.toggleToolbarDrawer(H)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return fE.isToolbarDrawerToggled(H)}))
var z,N,L,U,W,G,X,Y,q,J,$,Q,Z,tt,nt,et,ot=hb(H),rt=hb(g)
z=t,N=ot,L=rt,U=function(t,n){j([N,L],(function(e){e.broadcastEvent(t,n)}))},W=function(t,n){j([N,L],(function(e){e.broadcastOn([t],n)}))},G=function(t){return W(Vs(),{target:t.target})},X=Kv(ne(document),"touchstart",G),Y=Kv(ne(document),"touchmove",(function(t){return U(bo(),t)})),q=Kv(ne(document),"touchend",(function(t){return U(yo(),t)})),J=Kv(ne(document),"mousedown",G),$=Kv(ne(document),"mouseup",(function(t){0===t.raw.button&&W(Hs(),{target:t.target})})),Q=function(t){return W(Vs(),{target:ne(t.target)})},Z=function(t){0===t.button&&W(Hs(),{target:ne(t.target)})},tt=function(t){return U(xo(),$v(t))},nt=function(t){W(Ps(),{}),U(wo(),$v(t))},et=function(){return W(Ps(),{})},z.on("PostRender",(function(){z.on("click",Q),z.on("tap",Q),z.on("mouseup",Z),z.on("ScrollWindow",tt),z.on("ResizeWindow",nt),z.on("ResizeEditor",et)})),z.on("remove",(function(){z.off("click",Q),z.off("tap",Q),z.off("mouseup",Z),z.off("ScrollWindow",tt),z.off("ResizeWindow",nt),z.off("ResizeEditor",et),J.unbind(),X.unbind(),Y.unbind(),q.unbind(),$.unbind()})),z.on("detach",(function(){Os(N),Os(L),N.destroy(),L.destroy()}))
var it=function(){var n,e=OE(function(t){var n,e,o,r
return(e=ah(n=t),o=lh(n),r=dh(n),CE(e).map((function(t){return _E(t,o,r)}))).getOr(ah(t))}(t)),o=OE(TE(n=t).getOr(ch(n)))
return t.inline||(Bi("div","width",o)&&ki(H.element,"width",o),Bi("div","height",e)?ki(H.element,"height",e):ki(H.element,"height","200px")),e}
return{mothership:ot,uiMothership:rt,backstage:b,renderUI:function(){var n,e,i,u,a,c,s,f
r.setup(t,b.shared,m),PE(t,b),nB(t,p,b),e=(n=t).ui.registry.getAll().sidebars,j(bt(e),(function(t){var o=e[t],r=function(){return w.from(n.queryCommandValue("ToggleSidebar")).is(t)}
n.ui.registry.addToggleButton(t,{icon:o.icon,tooltip:o.tooltip,onAction:function(e){n.execCommand("ToggleSidebar",!1,t),e.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())}
return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})})),i=t,u=v,a=b.shared,c=Jn(!1),s=Jn(w.none()),f=function(t){t!==c.get()&&(function(t,n,e){var o=t.element
!0===n?(ym.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:oE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Ta([gm.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),Om.config({})])}]),Ai(o,"display"),Er(o,"aria-hidden")):(ym.set(t,[]),ki(o,"display","none"),Cr(o,"aria-hidden","true"))}(u(),t,a.providers),c.set(t))},i.on("ProgressState",(function(t){var n
s.get().each(yg.clearTimeout),M(t.time)?(n=yg.setEditorTimeout(i,(function(){return f(t.state)}),t.time),s.set(w.some(n))):(f(t.state),s.set(w.none()))})),wt(t.getParam("toolbar_groups",{},"object"),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}))
var d,h=t.ui.registry.getAll(),y=h.buttons,S=h.menuItems,k=h.contextToolbars,C=h.sidebars,O=ph(t),_={menuItems:S,menus:(d=t.getParam("menu"))?wt(d,(function(t){return l(l({},t),{items:t.items})})):{},menubar:t.getParam("menubar"),toolbar:O.getOrThunk((function(){return t.getParam("toolbar",!0)})),allowToolbarGroups:x===ip.floating,buttons:y,sidebar:C}
aT(t,k,g,{backstage:b}),LB(t,g)
var T=t.getElement(),E=it(),B={mothership:ot,uiMothership:rt,outerContainer:H},A={targetNode:T,height:E}
return o.render(t,B,_,b,A)},getUi:function(){return{channels:{broadcastAll:rt.broadcast,broadcastOn:rt.broadcastOn,register:function(){}}}}}},XB=e([Tn("lazySink"),Rn("dragBlockClass"),Yn("getBounds",mu),Ln("useTabstopAt",c),Ln("eventOrder",{}),el("modalBehaviours",[gm]),zu("onExecute"),Lu("onEscape")]),YB={sketch:o},qB=e([Ml({name:"draghandle",overrides:function(t,n){return{behaviours:Ta([PB.config({mode:"mouse",getTarget:function(t){return xu(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Bl({schema:[Tn("dom")],name:"title"}),Bl({factory:YB,schema:[Tn("dom")],name:"close"}),Bl({factory:YB,schema:[Tn("dom")],name:"body"}),Ml({factory:YB,schema:[Tn("dom")],name:"footer"}),Al({factory:{sketch:function(t,n){return l(l({},t),{dom:n.dom,components:n.components})}},schema:[Ln("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Ln("components",[])],name:"blocker"})]),KB=rf({name:"ModalDialog",configFields:XB(),partFields:qB(),factory:function(t,n,e,r){var i,u=Dr("alloy.dialog.busy"),a=Dr("alloy.dialog.idle"),c=Ta([gm.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),Om.config({})]),s=Dr("modal-events"),f=l(l({},t.eventOrder),((i={})[So()]=[s].concat(t.eventOrder["alloy.system.attached"]||[]),i))
return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){var e=t.lazySink(n).getOrDie(),o=Jn(w.none()),i=r.blocker(),s=e.getSystem().build(l(l({},i),{components:i.components.concat([Li(n)]),behaviours:Ta([Om.config({}),xm("dialog-blocker-events",[Yo(Ke(),(function(){gm.focusIn(n)})),Lo(a,(function(t,e){Tr(n.element,"aria-busy")&&(Er(n.element,"aria-busy"),o.get().each((function(t){return ym.remove(n,t)})))})),Lo(u,(function(t,e){Cr(n.element,"aria-busy","true")
var r=e.event.getBusySpec
o.get().each((function(t){ym.remove(n,t)}))
var i=r(n,c),u=t.getSystem().build(i)
o.set(w.some(u)),ym.append(n,Li(u)),u.hasConfigured(gm)&&gm.focusIn(u)}))])])}))
bs(e,s),gm.focusIn(n)},hide:function(t){cr(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){ws(t)}))}))},getBody:function(n){return Wl(n,t,"body")},getFooter:function(n){return Wl(n,t,"footer")},setIdle:function(t){Fo(t,a)},setBusy:function(t,n){Do(t,u,{getBusySpec:n})}},eventOrder:f,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:rl(t.modalBehaviours,[ym.config({}),gm.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),xm(s,[qo((function(n){var e,r,i,u,a,c
e=n.element,r=Wl(n,t,"title").element,i=_r(e,"id").fold((function(){var t=Dr("dialog-label")
return Cr(r,"id",t),t}),o),Cr(e,"aria-labelledby",i),u=n.element,a=Wl(n,t,"body").element,c=w.from(Or(u,"id")).fold((function(){var t=Dr("dialog-describe")
return Cr(a,"id",t),t}),o),Cr(u,"aria-describedby",c)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),JB=Zt([Bn("type"),Bn("name")].concat(Ep)),$B=Sn,QB=[un("name","name",zt((function(){return Dr("button-name")})),wn),Hn("icon"),Gn("align","end",["start","end"]),Xn("primary",!1),Xn("disabled",!1)],ZB=d(QB,[Bn("text")]),tA=d([An("type",["submit","cancel","custom"])],ZB),nA=d([An("type",["menu"]),Hn("text"),Hn("tooltip"),Hn("icon"),In("items",JB)],QB),eA=vn("type",{submit:tA,cancel:tA,custom:tA,menu:nA}),oA=[Bn("type"),Bn("text"),An("level",["info","warn","error","success"]),Bn("icon"),Ln("url","")],rA=Zt(oA),iA=[Bn("type"),Bn("text"),Xn("disabled",!1),Xn("primary",!1),un("name","name",zt((function(){return Dr("button-name")})),wn),Hn("icon"),Xn("borderless",!1)],uA=Zt(iA),aA=[Bn("type"),Bn("name"),Bn("label"),Xn("disabled",!1)],cA=Zt(aA),sA=Sn,lA=[Bn("type"),Bn("name")],fA=lA.concat([Hn("label")]),dA=fA.concat([Ln("columns","auto")]),mA=Zt(dA),gA=sn([Bn("value"),Bn("text"),Bn("icon")]),pA=Zt(fA),hA=wn,vA=Zt(fA),bA=wn,yA=lA.concat([Wn("tag","textarea"),Bn("scriptId"),Bn("scriptUrl"),(void 0,jn("settings",undefined,On))]),xA=lA.concat([Wn("tag","textarea"),Mn("init")]),wA=ln((function(t){return dn("customeditor.old",Qt(xA),t).orThunk((function(){return dn("customeditor.new",Qt(yA),t)}))})),SA=wn,kA=Zt(fA),CA=tn(cn),OA=function(t){return[Bn("type"),En("columns",xn),t]},_A=[Bn("type"),Bn("html"),Gn("presets","presentation",["presentation","document"])],TA=Zt(_A),EA=fA.concat([Xn("sandboxed",!0)]),BA=Zt(EA),AA=wn,MA=fA.concat([En("currentState",Zt([Tn("blob"),Bn("url")]))]),FA=Zt(MA),DA=fA.concat([Hn("inputMode"),Hn("placeholder"),Xn("maximized",!1),Xn("disabled",!1)]),IA=Zt(DA),RA=wn,VA=[Bn("text"),Bn("value")],PA=[Bn("text"),In("items",(jB=function(){return HA},UB=It((function(){return jB()})),{extract:function(t,n,e){return UB().extract(t,n,e)},toString:function(){return UB().toString()}}))],HA=nn([Zt(VA),Zt(PA)]),zA=fA.concat([In("items",HA),Xn("disabled",!1)]),NA=Zt(zA),LA=wn,jA=fA.concat([Dn("items",[Bn("text"),Bn("value")]),Un("size",1),Xn("disabled",!1)]),UA=Zt(jA),WA=wn,GA=fA.concat([Xn("constrain",!0),Xn("disabled",!1)]),XA=Zt(GA),YA=Zt([Bn("width"),Bn("height")]),qA=[Bn("type"),In("header",wn),In("cells",tn(wn))],KA=Zt(qA),JA=fA.concat([Hn("placeholder"),Xn("maximized",!1),Xn("disabled",!1)]),$A=Zt(JA),QA=wn,ZA=fA.concat([Gn("filetype","file",["image","media","file"]),Ln("disabled",!1)]),tM=Zt(ZA),nM=Zt([Bn("value"),Ln("meta",{})]),eM=function(t){return un("items","items",Pt(),tn(ln((function(n){return dn("Checking item of "+t,oM,n).fold((function(t){return at.error(pn(t))}),(function(t){return at.value(t)}))}))))},oM=function(t){return{extract:function(n,e,o){return t().extract(n,e,o)},toString:function(){return t().toString()}}}((function(){return hn("type",{alertbanner:rA,bar:Zt((n=eM("bar"),[Bn("type"),n])),button:uA,checkbox:cA,colorinput:pA,colorpicker:vA,dropzone:kA,grid:Zt(OA(eM("grid"))),iframe:BA,input:IA,listbox:NA,selectbox:UA,sizeinput:XA,textarea:$A,urlinput:tM,customeditor:wA,htmlpanel:TA,imagetools:FA,collection:mA,label:Zt((t=eM("label"),[Bn("type"),Bn("label"),t])),table:KA,panel:iM})
var t,n})),rM=[Bn("type"),Ln("classes",[]),In("items",oM)],iM=Zt(rM),uM=[un("name","name",zt((function(){return Dr("tab-name")})),wn),Bn("title"),In("items",oM)],aM=[Bn("type"),Dn("tabs",uM)],cM=Zt(aM),sM=ZB,lM=eA,fM=Zt([Bn("title"),En("body",hn("type",{panel:iM,tabpanel:cM})),Wn("size","normal"),In("buttons",lM),Ln("initialData",{}),Yn("onAction",t),Yn("onChange",t),Yn("onSubmit",t),Yn("onClose",t),Yn("onCancel",t),Ln("onTabChange",t)]),dM=Zt(d([An("type",["cancel","custom"])],sM)),mM=Zt([Bn("title"),Bn("url"),Pn("height"),Pn("width"),Vn("buttons",tn(dM)),Yn("onAction",t),Yn("onCancel",t),Yn("onClose",t),Yn("onMessage",t)]),gM=function(t){return O(t)?[t].concat(J(Ot(t),gM)):_(t)?J(t,gM):[]},pM=function(t){return C(t.type)&&C(t.name)},hM={checkbox:sA,colorinput:hA,colorpicker:bA,dropzone:CA,input:RA,iframe:AA,sizeinput:YA,selectbox:WA,listbox:LA,size:YA,textarea:QA,urlinput:nM,customeditor:SA,collection:gA,togglemenuitem:$B},vM=function(t){var n=W(gM(t),pM),e=J(n,(function(t){return n=t,w.from(hM[n.type]).fold((function(){return[]}),(function(n){return[En(t.name,n)]}))
var n}))
return Zt(e)},bM=function(t){return{internalDialog:mn(dn("dialog",fM,t)),dataValidator:vM(t),initialData:t.initialData}},yM={open:function(t,n){var e=bM(n)
return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(mn(dn("dialog",mM,n)))},redial:bM},xM=function(t){var n=[],e={}
return xt(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),0<n.length?at.error(n):at.value(e)},wM=of({name:"TabButton",configFields:[Ln("uid",void 0),Tn("value"),un("dom","dom",Nt((function(){return{attributes:{role:"tab",id:Dr("aria"),"aria-selected":"false"}}})),bn()),Rn("action"),Ln("domModification",{}),el("tabButtonBehaviours",[Om,gm,nl]),Tn("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:zm(t.action),behaviours:rl(t.tabButtonBehaviours,[Om.config({}),gm.config({mode:"execution",useSpace:!0,useEnter:!0}),nl.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),SM=e([Tn("tabs"),Tn("dom"),Ln("clickToDismiss",!1),el("tabbarBehaviours",[xf,gm]),Vu(["tabClass","selectedClass"])]),kM=Fl({factory:wM,name:"tabs",unit:"tab",overrides:function(n){var e=function(t,n){xf.dehighlight(t,n),Do(t,Bo(),{tabbar:t,button:n})},o=function(t,n){xf.highlight(t,n),Do(t,Eo(),{tabbar:t,button:n})}
return{action:function(r){var i=r.getSystem().getByUid(n.uid).getOrDie(),u=xf.isHighlighted(i,r);(u&&n.clickToDismiss?e:u?t:o)(i,r)},domModification:{classes:[n.markers.tabClass]}}}}),CM=e([kM]),OM=rf({name:"Tabbar",configFields:SM(),partFields:CM(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:rl(t.tabbarBehaviours,[xf.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Cr(n.element,"aria-selected","true")},onDehighlight:function(t,n){Cr(n.element,"aria-selected","false")}}),gm.config({mode:"flow",getInitial:function(t){return xf.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),_M=of({name:"Tabview",configFields:[el("tabviewBehaviours",[ym])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:rl(t.tabviewBehaviours,[ym.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),TM=e([Ln("selectFirst",!0),Hu("onChangeTab"),Hu("onDismissTab"),Ln("tabs",[]),el("tabSectionBehaviours",[])]),EM=Bl({factory:OM,schema:[Tn("dom"),Fn("markers",[Tn("tabClass"),Tn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),BM=Bl({factory:_M,name:"tabview"}),AM=e([EM,BM]),MM=rf({name:"TabSection",configFields:TM(),partFields:AM(),factory:function(t,n,e,o){var r=function(n,e){Ul(n,t,"tabbar").each((function(t){e(t).each(Io)}))}
return{uid:t.uid,dom:t.dom,components:n,behaviours:ol(t.tabSectionBehaviours),events:Ho(K([t.selectFirst?[qo((function(t,n){r(t,xf.getFirst)}))]:[],[Lo(Eo(),(function(n,e){var o,r,i=e.event.button
o=i,r=nl.getValue(o),Ul(o,t,"tabview").each((function(n){Y(t.tabs,(function(t){return t.value===r})).each((function(e){var r=e.view()
_r(o.element,"id").each((function(t){Cr(n.element,"aria-labelledby",t)})),ym.set(n,r),t.onChangeTab(n,o,r)}))}))})),Lo(Bo(),(function(n,e){var o=e.event.button
t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return Ul(n,t,"tabview").map((function(t){return ym.contents(t)})).getOr([])},showTab:function(t,n){r(t,(function(t){var e=xf.getCandidates(t)
return Y(e,(function(t){return nl.getValue(t)===n})).filter((function(n){return!xf.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),FM=function(t,n){ki(t,"height",n+"px"),Be().browser.isIE()?Ai(t,"flex-basis"):ki(t,"flex-basis",n+"px")},DM=function(t,n,e){xu(t,'[role="dialog"]').each((function(t){wu(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return ki(n,"height","0"),ki(n,"flex-basis","0"),Math.min(e,(i=n,u=o,a=ur(r=t).dom,c=xu(r,".tox-dialog-wrap").getOr(r),s="fixed"===_i(c,"position")?Math.max(a.clientHeight,window.innerHeight):Math.max(a.offsetHeight,a.scrollHeight),l=Wi(i),f=i.dom.offsetLeft>=u.dom.offsetLeft+Qi(u)?Math.max(Wi(u),l):l,d=parseInt(_i(r,"margin-top"),10)||0,m=parseInt(_i(r,"margin-bottom"),10)||0,s-(Wi(r)+d+m-f)))
var r,i,u,a,c,s,l,f,d,m})).each((function(t){FM(n,t)}))}))}))},IM=function(t){return wu(t,'[role="tabpanel"]')},RM=function(t){var n
return{smartTabHeight:(n=Jn(w.none()),{extraEvents:[qo((function(e){var o=e.element
IM(o).each((function(r){var i
ki(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o,i,u,a=(i=r,u=e,L(o=t,(function(t,n){ym.set(u,o[n].view())
var e=i.dom.getBoundingClientRect()
return ym.set(u,[]),e.height}))),c=nt(tt(a,(function(t,n){return n<t?-1:t<n?1:0})))
n.set(c)})),DM(o,r,n),Ai(r,"visibility"),i=e,nt(t).each((function(t){return MM.showTab(i,t.value)})),yg.requestAnimationFrame((function(){DM(o,r,n)}))}))})),Lo(wo(),(function(t){var e=t.element
IM(e).each((function(t){DM(e,t,n)}))})),Lo(Rb,(function(t,e){var o=t.element
IM(o).each((function(t){var e=Va()
ki(t,"visibility","hidden")
var r=Ei(t,"height").map((function(t){return parseInt(t,10)}))
Ai(t,"height"),Ai(t,"flex-basis")
var i=t.dom.getBoundingClientRect().height
r.forall((function(t){return t<i}))?(n.set(w.from(i)),DM(o,t,n)):r.each((function(n){FM(t,n)})),Ai(t,"visibility"),e.each(Ra)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},VM="send-data-to-section",PM="send-data-to-view",HM=Dr("update-dialog"),zM=Dr("update-title"),NM=Dr("update-body"),LM=Dr("update-footer"),jM=Dr("body-send-message"),UM=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:l(l({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:Ta([_w(0),o_.config({channel:NM,updateState:function(t,n){return w.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(u=t.body,a=e,c=Jn({}),s=function(t){var n=nl.getValue(t),e=xM(n).getOr({}),o=c.get(),r=Ft(o,e)
c.set(r)},l=function(t){var n=c.get()
nl.setValue(t,n)},f=Jn(null),d=L(u.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:a.shared.providers.translate(t.title)},view:function(){return[vw.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"]},components:L(t.items,(function(t){return fC(n,t,a)})),formBehaviours:Ta([gm.config({mode:"acyclic",useTabstopAt:i(jw)}),xm("TabView.form.events",[qo(l),Ko(s)]),Da.config({channels:Ut([{key:VM,value:{onReceive:s}},{key:PM,value:{onReceive:l}}])})])}}))]}}})),m=RM(d).smartTabHeight,MM.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=nl.getValue(n)
Do(t,Ib,{name:o,oldName:f.get()}),f.set(o)},tabs:d,components:[MM.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[OM.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Ta([Sb.config({})])}),MM.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:m.selectFirst,tabSectionBehaviours:Ta([xm("tabpanel",m.extraEvents),gm.config({mode:"acyclic"}),lf.config({find:function(t){return nt(MM.getViewItems(t))}}),nl.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([VM],{}),c.get()},setValue:function(t,n){c.set(n),t.getSystem().broadcastOn([PM],{})}}})])}))]
default:return[(n=t.body,o=e,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(r=wg(vw.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:L(n.items,(function(n){return fC(t,n,o)}))}})))).asSpec()]}],behaviours:Ta([gm.config({mode:"acyclic",useTabstopAt:i(jw)}),Ow(r),Fw(r,{postprocess:function(t){return xM(t).fold((function(t){return console.error(t),{}}),(function(t){return t}))}})])})]}var n,o,r,u,a,c,s,l,f,d,m},initialData:t})])}},WM=Gh.deviceType.isTouch(),GM=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},XM=function(t,n){return KB.parts.close(xg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Ta([Sb.config({})])}))},YM=function(){return KB.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},qM=function(t,n){return KB.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:oE("<p>"+n.translate(t)+"</p>")}]}]})},KM=function(t){return KB.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},JM=function(t,n){return[pb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),pb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},$M=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll"
return KB.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),w.some(!0)},useTabstopAt:function(t){return!jw(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:l({position:"relative"},t.extraStyles)},components:d([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:oE('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:WM?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:Ta(d([Om.config({}),xm("dialog-events",t.dialogEvents.concat([Yo(Ke(),(function(t,n){gm.focusIn(t)}))])),xm("scroll-lock",[qo((function(){ui(yi(),i)})),Ko((function(){ai(yi(),i)}))])],t.extraBehaviours)),eventOrder:l(((n={})[lo()]=["dialog-events"],n[So()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[ko()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},QM=function(t){return xg.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:kg("close",t.icons)}}],action:function(t){Fo(t,Bb)}})},ZM=function(t,n,e){var o=function(t){return[Pi(e.translate(t.title))]}
return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:l({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:Ta([o_.config({channel:zM,renderComponents:o})])}},tF=function(){return{dom:oE('<div class="tox-dialog__draghandle"></div>')}},nF=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=KB.parts.title(ZM(e,w.none(),o)),i=KB.parts.draghandle(tF()),u=KB.parts.close(QM(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),pb.sketch({dom:oE('<div class="tox-dialog__header"></div>'),components:a})
var e,o,r,i,u,a},eF=function(t,n){return{onClose:function(){return n.closeWindow()},onBlock:function(n){KB.setBusy(t(),(function(t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.message},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:oE('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){KB.setIdle(t())}}},oF=function(t,n,e,o){var r
return Ni($M(l(l({},t),{lazySink:o.shared.getSink,extraBehaviours:d([o_.config({channel:HM,updateState:function(t,n){return w.some(n)},initialData:n}),Rw({})],t.extraBehaviours),onEscape:function(t){Fo(t,Bb)},dialogEvents:e,eventOrder:((r={})[so()]=["reflecting","receiving"],r[So()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],r[ko()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],r)})))},rF=function(t){return L(t,(function(t){return"menu"===t.type?(e=L((n=t).items,(function(t){var n=Jn(!1)
return l(l({},t),{storage:n})})),l(l({},n),{items:e})):t
var n,e}))},iF=function(t){return X(t,(function(t,n){return"menu"!==n.type?t:X(n.items,(function(t,n){return t[n.name]=n.storage,t}),t)}),{})},uF=function(t,n){return[Go(Ke(),Lw),t(Eb,(function(t,e){n.onClose(),e.onClose()})),t(Bb,(function(t,n,e,o){n.onCancel(t),Fo(o,Eb)})),Lo(Db,(function(t,e){return n.onUnblock()})),Lo(Fb,(function(t,e){return n.onBlock(e.event)}))]},aF=function(t,n,e){var o=function(n,e){return Lo(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){o_.getState(t).get().each((function(e){n(e.internalDialog,t)}))}
return d(uF(o,n),[o(Mb,(function(t,n){return n.onSubmit(t)})),o(Tb,(function(t,n,e){n.onChange(t,{name:e.name})})),o(Ab,(function(t,n,o,r){var i=function(){return gm.focusIn(r)},u=function(t){return Tr(t,"disabled")||_r(t,"aria-disabled").exists((function(t){return"true"===t}))},a=pi(r.element),c=Va(a)
n.onAction(t,{name:o.name,value:o.value}),Va(a).fold(i,(function(t){u(t)||c.exists((function(n){return De(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!De(n.element,t)})).each(i)}))})),o(Ib,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),Ko((function(n){var e=t()
nl.setValue(n,e.getData())}))])},cF=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=U(e,(function(t){return"start"===t.align})),r=function(t,n){return pb.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:L(n,(function(t){return t.memento.asSpec()}))})}
return[r("start",o.pass),r("end",o.fail)]},sF=function(t,n){return{dom:oE('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Ta([o_.config({channel:LM,initialData:t,updateState:function(t,e){var o=L(e.buttons,(function(t){var e,o,r=wg((o=n,ik(e=t,e.type,o)))
return{name:t.name,align:t.align,memento:r}}))
return w.some({lookupByName:function(t,n){return e=t,r=n,Y(o,(function(t){return t.name===r})).bind((function(t){return t.memento.getOpt(e)}))
var e,r},footerButtons:o})},renderComponents:cF})])}},lF=sF,fF=function(t,n){return KB.parts.footer(sF(t,n))},dF=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=lf.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper())
return vw.getField(e,n).fold((function(){var o=t.getFooter()
return o_.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return w.some(t)}))}return w.none()},mF=function(t,n,e){var o=function(n){var e=t.getRoot()
e.getSystem().isConnected()&&n(e)},r={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=nl.getValue(o),i=wt(e,(function(t){return t.get()}))
return l(l({},r),i)},setData:function(n){o((function(o){var i,u,a=r.getData(),c=l(l({},a),n),s=(i=c,u=t.getRoot(),o_.getState(u).get().map((function(t){return mn(dn("data",t.dataValidator,i))})).getOr(i)),f=t.getFormWrapper()
nl.setValue(f,s),xt(e,(function(t,n){Tt(c,n)&&t.set(c[n])}))}))},disable:function(n){dF(t,n).each(ih.disable)},enable:function(n){dF(t,n).each(ih.enable)},focus:function(n){dF(t,n).each(Om.focus)},block:function(t){if(!C(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument")
o((function(n){Do(n,Fb,{message:t})}))},unblock:function(){o((function(t){Fo(t,Db)}))},showTab:function(n){o((function(e){var o=t.getBody()
o_.getState(o).get().exists((function(t){return t.isTabPanel()}))&&lf.getCurrent(o).each((function(t){MM.showTab(t,n)}))}))},redial:function(t){o((function(e){var o=n(t)
e.getSystem().broadcastOn([HM],o),e.getSystem().broadcastOn([zM],o.internalDialog),e.getSystem().broadcastOn([NM],o.internalDialog),e.getSystem().broadcastOn([LM],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(t){Fo(t,Eb)}))}}
return r},gF=tinymce.util.Tools.resolve("tinymce.util.URI"),pF=["insertContent","setContent","execCommand","close","block","unblock"],hF=function(t){return O(t)&&-1!==pF.indexOf(t.mceAction)},vF=function(t,n,e,o){var r,u,a,c,s=nF(t.title,o),f=(u={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[zw({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Ta([Sb.config({}),Om.config({})])})]}],behaviours:Ta([gm.config({mode:"acyclic",useTabstopAt:i(jw)})])},KB.parts.body(u)),m=t.buttons.bind((function(t){return 0===t.length?w.none():w.some(fF({buttons:t},o))})),g=function(t,n){var e=function(n,e){return Lo(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){o_.getState(t).get().each((function(e){n(e,t)}))}
return d(uF(e,n),[e(Ab,(function(t,n,e){n.onAction(t,{name:e.name})}))])}((function(){return k}),eF((function(){return S}),n)),p=l(l({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),h=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],v=new gF(t.url,{base_uri:new gF(window.location.href)}),b=v.protocol+"://"+v.host+(v.port?":"+v.port:""),y=Jn(w.none()),x=[xm("messages",[qo((function(){var n=Kv(ne(window),"message",(function(n){var o,r
v.isSameOrigin(new gF(n.raw.origin))&&(o=n.raw.data,hF(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content)
break
case"setContent":t.setContent(e.content)
break
case"execCommand":var o=!!T(e.ui)&&e.ui
t.execCommand(e.cmd,o,e.value)
break
case"close":n.close()
break
case"block":n.block(e.message)
break
case"unblock":n.unblock()}}(e,k,o):!hF(r=o)&&O(r)&&Tt(r,"mceAction")&&t.onMessage(k,o))}))
y.set(w.some(n))})),Ko((function(){y.get().each((function(t){return t.unbind()}))}))]),Da.config({channels:((r={})[jM]={onReceive:function(t,n){wu(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,b)}))}},r)})],S=oF({header:s,body:f,footer:m,extraClasses:h,extraBehaviours:x,extraStyles:p},t,g,o),k=(c=function(t){a.getSystem().isConnected()&&t(a)},{block:function(t){if(!C(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument")
c((function(n){Do(n,Fb,{message:t})}))},unblock:function(){c((function(t){Fo(t,Db)}))},close:function(){c((function(t){Fo(t,Eb)}))},sendMessage:function(t){c((function(n){n.getSystem().broadcastOn([jM],t)}))}})
return{dialog:a=S,instanceApi:k}},bF=function(t){var n,e,o,r,i=t.backstage,u=t.editor,a=Eh(u),c=(e=(n=t).backstage.shared,{open:function(t,o){var r=function(){KB.hide(c),o()},i=wg(ik({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:w.none()},"cancel",n.backstage)),u=YM(),a=XM(r,e.providers),c=Ni($M({lazySink:function(){return e.getSink()},header:GM(u,a),body:qM(t,e.providers),footer:w.some(KM(JM([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Lo(Bb,r)],eventOrder:{}}))
KB.show(c)
var s=i.get(c)
Om.focus(s)}}),s=(r=(o=t).backstage.shared,{open:function(t,n){var e=function(t){KB.hide(s),n(t)},i=wg(ik({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:w.none()},"submit",o.backstage)),u=ik({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:w.none()},"cancel",o.backstage),a=YM(),c=XM((function(){return e(!1)}),r.providers),s=Ni($M({lazySink:function(){return r.getSink()},header:GM(a,c),body:qM(t,r.providers),footer:w.some(KM(JM([],[u,i.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Lo(Bb,(function(){return e(!1)})),Lo(Mb,(function(){return e(!0)}))],eventOrder:{}}))
KB.show(s)
var l=i.get(s)
Om.focus(l)}}),f=function(t,n){return yM.open((function(t,e,o){var r=e,u=function(t,n,e){var o,r,i,u=nF(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=UM(o,w.none(),r,!1),KB.parts.body(i)),c=rF(t.internalDialog.buttons),s=iF(c),l=fF({buttons:c},e),f=aF((function(){return p}),eF((function(){return g}),n),e.shared.getSink),d="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],m={header:u,body:a,footer:w.some(l),extraClasses:d,extraBehaviours:[],extraStyles:{}},g=oF(m,t,f,e),p=mF({getRoot:function(){return g},getBody:function(){return KB.getBody(g)},getFooter:function(){return KB.getFooter(g)},getFormWrapper:function(){var t=KB.getBody(g)
return lf.getCurrent(t).getOr(t)}},n.redial,s)
return{dialog:g,instanceApi:p}}({dataValidator:o,initialData:r,internalDialog:t},{redial:yM.redial,closeWindow:function(){KB.hide(u.dialog),n(u.instanceApi)}},i)
return KB.show(u.dialog),u.instanceApi.setData(r),u.instanceApi}),t)},m=function(t,n,e,o){return yM.open((function(t,r,c){var s,f,m,g=mn(dn("data",c,r)),p=(s=Jn(w.none()),{clear:function(){return s.set(w.none())},set:function(t){return s.set(w.some(t))},isSet:function(){return s.get().isSome()},on:function(t){return s.get().each(t)}}),h=i.shared.header.isPositionedAtTop(),v=function(){return p.on((function(t){ag.reposition(t),RT.refresh(t)}))},b=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=Dr("dialog-label"),g=Dr("dialog-content"),p=wg((u={title:t.internalDialog.title,draggable:!0},a=m,c=e.shared.providers,pb.sketch({dom:oE('<div class="tox-dialog__header"></div>'),components:[ZM(u,w.some(a),c),tF(),QM(c)],containerBehaviours:Ta([PB.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Su(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),h=wg((s={body:t.internalDialog.body},l=g,f=e,d=o,UM(s,w.some(l),f,d))),v=rF(t.internalDialog.buttons),b=iF(v),y=wg(lF({buttons:v},e)),x=aF((function(){return k}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}},e.shared.getSink),S=Ni({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((r={role:"dialog"})["aria-labelledby"]=m,r["aria-describedby"]=""+g,r)},eventOrder:((i={})[so()]=[o_.name(),Da.name()],i[lo()]=["execute-on-form"],i[So()]=["reflecting","execute-on-form"],i),behaviours:Ta([gm.config({mode:"cyclic",onEscape:function(t){return Fo(t,Eb),w.some(!0)},useTabstopAt:function(t){return!jw(t)&&("button"!==Qo(t)||"disabled"!==Or(t,"disabled"))}}),o_.config({channel:HM,updateState:function(t,n){return w.some(n)},initialData:t}),Om.config({}),xm("execute-on-form",x.concat([Yo(Ke(),(function(t,n){gm.focusIn(t)}))])),Rw({})]),components:[p.asSpec(),h.asSpec(),y.asSpec()]}),k=mF({getRoot:function(){return S},getFooter:function(){return y.get(S)},getBody:function(){return h.get(S)},getFormWrapper:function(){var t=h.get(S)
return lf.getCurrent(t).getOr(t)}},n.redial,b)
return{dialog:S,instanceApi:k}}({dataValidator:c,initialData:g,internalDialog:t},{redial:yM.redial,closeWindow:function(){p.on(ag.hide),u.off("ResizeEditor",v),p.clear(),e(b.instanceApi)}},i,o),y=Ni(ag.sketch(l(l({lazySink:i.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},h?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Ta(d([xm("window-manager-inline-events",[Lo(Co(),(function(t,n){Fo(b.dialog,Bb)}))])],(f=u,m=h,a&&m?[]:[RT.config({contextual:{lazyContext:function(){return w.some(fu(ne(f.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return Qv(e=n,".tox-alert-dialog")||Qv(e,".tox-confirm-dialog")
var e}})))
return p.set(y),ag.showWithin(y,n,Li(b.dialog),w.some(yi())),a&&h||(RT.refresh(y),u.on("ResizeEditor",v)),b.instanceApi.setData(g),gm.focusIn(b.dialog),b.instanceApi}),t)}
return{open:function(t,n,e){return void 0!==n&&"toolbar"===n.inline?m(t,i.shared.anchors.inlineDialog(),e,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?m(t,i.shared.anchors.cursor(),e,n.ariaAttrs):f(t,e)},openUrl:function(t,n){return function(t,n){return yM.openUrl((function(t){var e=vF(t,{closeWindow:function(){KB.hide(e.dialog),n(e.instanceApi)}},u,i)
return KB.show(e.dialog),e.instanceApi}),t)}(t,n)},alert:function(t,n){c.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){s.open(t,(function(t){n(t)}))}}}
s.add("silver",(function(t){var n=GB(t),o=n.uiMothership,r=n.backstage,i=n.renderUI,u=n.getUi
Yv(t,r.shared)
var a=bF({editor:t,backstage:r})
return{renderUI:i,getWindowManagerImpl:e(a),getNotificationManagerImpl:function(){return function(t,n,e){var o=n.backstage
return{open:function(t,r){var i=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),u=function(){r(),ag.hide(c)},a=Ni(Og.sketch({text:t.text,level:P(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:w.from(t.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=Ni(ag.sketch(l({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})))
return e.add(c),0<t.timeout&&yg.setTimeout((function(){u()}),t.timeout),{close:u,moveTo:function(t,n){ag.showAt(c,{anchor:"makeshift",x:t,y:n},Li(a))},moveRel:function(t,e){var o,r
"banner"!==e?(o=function(t){switch(t){case"bc-bc":return bg
case"tc-tc":return vg
case"tc-bc":return da
case"bc-tc":default:return ma}}(e),r={anchor:"node",root:yi(),node:w.some(ne(t)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}},ag.showAt(c,r,Li(a))):ag.showAt(c,n.backstage.shared.anchors.banner(),Li(a))},text:function(t){Og.updateText(a,t)},settings:t,getEl:function(){return a.element.dom},progressBar:{value:function(t){Og.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){var n
j(t,(function(t){return t.moveTo(0,0)})),0<(n=t).length&&(nt(n).each((function(t){return t.moveRel(null,"banner")})),j(n,(function(t,e){0<e&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},getArgs:function(t){return t.settings}}}(0,{backstage:r},o)},ui:u()}}))}()
